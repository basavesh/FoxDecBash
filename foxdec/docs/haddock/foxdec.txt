-- Hoogle documentation, generated by Haddock
-- See Hoogle, http://www.haskell.org/hoogle/


-- | Formaly Verified x86-64 Decompilation
--   
--   This package contains tools for decompilation based on formal methods.
@package foxdec
@version 0.1.0.0

module Base
showHex :: (Integral a, Show a) => a -> String
showHex_list :: (Integral a, Show a) => [a] -> [Char]
showHex_set :: IntSet -> [Char]
showHex_option :: (Integral a, Show a) => Maybe a -> [Char]
readHex' :: (Eq a, Num a) => String -> a
im_lookup :: [Char] -> IntMap p -> Key -> p
findString :: Eq a => [a] -> [a] -> Maybe Int
strip_parentheses :: [Char] -> [Char]
bytes_to_word :: [Word8] -> Word64
word_to_sint :: Int -> Word64 -> Int
data Graph
Edges :: IntMap IntSet -> Graph
graph_add_edges :: Graph -> Key -> IntSet -> Graph
graph_delete :: Graph -> Key -> Graph
graph_is_parent :: Graph -> Key -> Bool
graph_is_edge :: Graph -> Key -> Key -> Bool
graph_nontrivial_scc :: Graph -> IntSet
graph_find_next :: Graph -> Maybe Int
hex_color_of_text :: String -> String
hex_colors :: [[Char]]
instance GHC.Generics.Generic Base.Graph
instance Data.Serialize.Serialize Base.Graph
instance SCC.IntGraph Base.Graph

module X86_Datastructures
data Instr
Instr :: Int -> Maybe Prefix -> Opcode -> Maybe Operand -> Maybe Operand -> Maybe Operand -> Maybe String -> Int -> Instr

-- | address
[i_addr] :: Instr -> Int

-- | prefix, e.g., lock or repz
[i_prefix] :: Instr -> Maybe Prefix

-- | opcode (see data Opcode)
[i_opcode] :: Instr -> Opcode

-- | optional: operand
[i_op1] :: Instr -> Maybe Operand

-- | optional: operand
[i_op2] :: Instr -> Maybe Operand

-- | optional: operand
[i_op3] :: Instr -> Maybe Operand

-- | annotation, e.g., <a>+ 10</a>
[i_annot] :: Instr -> Maybe String

-- | size of instruction
[i_size] :: Instr -> Int

-- | Instruction prefixes
data Prefix
InvalidPrefix :: Prefix
REP :: Prefix
REPZ :: Prefix
LOCK :: Prefix
BND :: Prefix

-- | Registers
data Register
InvalidRegister :: Register
RIP :: Register
EIP :: Register
RAX :: Register
EAX :: Register
AX :: Register
AH :: Register
AL :: Register
RBX :: Register
EBX :: Register
BX :: Register
BH :: Register
BL :: Register
RCX :: Register
ECX :: Register
CX :: Register
CH :: Register
CL :: Register
RDX :: Register
EDX :: Register
DX :: Register
DH :: Register
DL :: Register
RDI :: Register
EDI :: Register
DI :: Register
DIL :: Register
RSI :: Register
ESI :: Register
SI :: Register
SIL :: Register
RSP :: Register
ESP :: Register
SP :: Register
SPL :: Register
RBP :: Register
EBP :: Register
BP :: Register
BPL :: Register
R15 :: Register
R15D :: Register
R15W :: Register
R15B :: Register
R14 :: Register
R14D :: Register
R14W :: Register
R14B :: Register
R13 :: Register
R13D :: Register
R13W :: Register
R13B :: Register
R12 :: Register
R12D :: Register
R12W :: Register
R12B :: Register
R11 :: Register
R11D :: Register
R11W :: Register
R11B :: Register
R10 :: Register
R10D :: Register
R10W :: Register
R10B :: Register
R9 :: Register
R9D :: Register
R9W :: Register
R9B :: Register
R8 :: Register
R8D :: Register
R8W :: Register
R8B :: Register
CS :: Register
DS :: Register
ES :: Register
FS :: Register
GS :: Register
SS :: Register
EIZ :: Register
RIZ :: Register
ST0 :: Register
ST1 :: Register
ST2 :: Register
ST3 :: Register
ST4 :: Register
ST5 :: Register
ST6 :: Register
ST7 :: Register
XMM0 :: Register
XMM1 :: Register
XMM2 :: Register
XMM3 :: Register
XMM4 :: Register
XMM5 :: Register
XMM6 :: Register
XMM7 :: Register
XMM8 :: Register
XMM9 :: Register
XMM10 :: Register
XMM11 :: Register
XMM12 :: Register
XMM13 :: Register
XMM14 :: Register
XMM15 :: Register
XMM0_L :: Register
XMM1_L :: Register
XMM2_L :: Register
XMM3_L :: Register
XMM4_L :: Register
XMM5_L :: Register
XMM6_L :: Register
XMM7_L :: Register
XMM8_L :: Register
XMM9_L :: Register
XMM10_L :: Register
XMM11_L :: Register
XMM12_L :: Register
XMM13_L :: Register
XMM14_L :: Register
XMM15_L :: Register

-- | Flags
data Flag
ZF :: Flag
CF :: Flag
SF :: Flag
OF :: Flag
PF :: Flag
InvalidFlag :: Flag

-- | An unresolved address, within the operand of an instruction.
data Address

-- | Reading a pointer from a register
FromReg :: Register -> Address

-- | Immediate address
AddrImm :: Int -> Address

-- | Minus
AddrMinus :: Address -> Address -> Address

-- | Plus
AddrPlus :: Address -> Address -> Address

-- | Times
AddrTimes :: Address -> Address -> Address

-- | Size directive, e.g., qword ptr, in bytes
SizeDir :: Int -> Address -> Address

-- | Operands of an instruction
data Operand

-- | Unresolved addresses
Address :: Address -> Operand

-- | Registers
Reg :: Register -> Operand

-- | Immediates
Immediate :: Word64 -> Operand

-- | Opcodes / mnemonics
data Opcode
InvalidOpcode :: Opcode
AAA :: Opcode
AAD :: Opcode
AAM :: Opcode
AAS :: Opcode
ADC :: Opcode
ADD :: Opcode
ADDPD :: Opcode
ADDPS :: Opcode
ADDSD :: Opcode
ADDSS :: Opcode
ADDSUBPD :: Opcode
ADDUBPS :: Opcode
AND :: Opcode
ANDNPD :: Opcode
ANDNPS :: Opcode
ANDPD :: Opcode
ANDPS :: Opcode
ARPL :: Opcode
BLENDVPS :: Opcode
BOUND :: Opcode
BSF :: Opcode
BSR :: Opcode
BT :: Opcode
BTC :: Opcode
BTR :: Opcode
BTS :: Opcode
CALL :: Opcode
CALLF :: Opcode
CBW :: Opcode
CDQ :: Opcode
CDQE :: Opcode
CLC :: Opcode
CLD :: Opcode
CLFLUSH :: Opcode
CLI :: Opcode
CLTS :: Opcode
CMC :: Opcode
CMOVA :: Opcode
CMOVAE :: Opcode
CMOVB :: Opcode
CMOVBE :: Opcode
CMOVC :: Opcode
CMOVE :: Opcode
CMOVG :: Opcode
CMOVGE :: Opcode
CMOVL :: Opcode
CMOVLE :: Opcode
CMOVNA :: Opcode
CMOVNAE :: Opcode
CMOVNB :: Opcode
CMOVNBE :: Opcode
CMOVNC :: Opcode
CMOVNE :: Opcode
CMOVNG :: Opcode
CMOVNGE :: Opcode
CMOVNL :: Opcode
CMOVNLE :: Opcode
CMOVNO :: Opcode
CMOVNP :: Opcode
CMOVNS :: Opcode
CMOVNZ :: Opcode
CMOVO :: Opcode
CMOVP :: Opcode
CMOVPE :: Opcode
CMOVPO :: Opcode
CMOVS :: Opcode
CMOVZ :: Opcode
CMP :: Opcode
CMPEQSD :: Opcode
CMPNEQSD :: Opcode
CMPLTSD :: Opcode
CMPS :: Opcode
CMPSB :: Opcode
CMPSD :: Opcode
CMPXCHG :: Opcode
CMPXCHG16B :: Opcode
CMPXCHG8B :: Opcode
COMISD :: Opcode
COMISS :: Opcode
CPUID :: Opcode
CQO :: Opcode
CVTDQ2PD :: Opcode
CVTSD2SS :: Opcode
CVTSI2SD :: Opcode
CVTSI2SS :: Opcode
CVTSS2SD :: Opcode
CVTTSD2SI :: Opcode
CVTTSS2SI :: Opcode
CVTTPD2DQ :: Opcode
CWD :: Opcode
CWDE :: Opcode
DAA :: Opcode
DAS :: Opcode
DEC :: Opcode
DIV :: Opcode
DIVPD :: Opcode
DIVPS :: Opcode
DIVSD :: Opcode
DIVSS :: Opcode
EMMS :: Opcode
ENDBR64 :: Opcode
ENTER :: Opcode
EXTRACTPS :: Opcode
FABS :: Opcode
FADD :: Opcode
FADDP :: Opcode
FBLD :: Opcode
FBSTP :: Opcode
FCHS :: Opcode
FCLEX :: Opcode
FCMOVB :: Opcode
FCMOVBE :: Opcode
FCMOVE :: Opcode
FCMOVNB :: Opcode
FCMOVNBE :: Opcode
FCMOVNE :: Opcode
FCMOVNU :: Opcode
FCMOVU :: Opcode
FCOM :: Opcode
FCOMI :: Opcode
FCOMIP :: Opcode
FCOMP :: Opcode
FCOMPI :: Opcode
FCOMPP :: Opcode
FCOS :: Opcode
FDIV :: Opcode
FDIVP :: Opcode
FDIVR :: Opcode
FDIVRP :: Opcode
FFREE :: Opcode
FRNDINT :: Opcode
FIADD :: Opcode
FICOM :: Opcode
FICOMP :: Opcode
FIDIV :: Opcode
FIDIVR :: Opcode
FILD :: Opcode
FIMUL :: Opcode
FINIT :: Opcode
FIST :: Opcode
FISTP :: Opcode
FISTPP :: Opcode
FISTTP :: Opcode
FISUB :: Opcode
FISUBR :: Opcode
FLD :: Opcode
FLD1 :: Opcode
FLDCW :: Opcode
FLDENV :: Opcode
FLDL2E :: Opcode
FLDL2T :: Opcode
FLDLG2 :: Opcode
FLDLN2 :: Opcode
FLDPI :: Opcode
FLDZ :: Opcode
FMUL :: Opcode
FMULP :: Opcode
FNOP :: Opcode
FNINIT :: Opcode
FNSTCW :: Opcode
FPREM1 :: Opcode
FRSTOR :: Opcode
FSAVE :: Opcode
FSIN :: Opcode
FSINCOS :: Opcode
FSCALE :: Opcode
FSQRT :: Opcode
FST :: Opcode
FSTCW :: Opcode
FSTENV :: Opcode
FSTP :: Opcode
FSTSW :: Opcode
FSUB :: Opcode
FSUBP :: Opcode
FSUBR :: Opcode
FSUBRP :: Opcode
FTST :: Opcode
FUCOM :: Opcode
FUCOMI :: Opcode
FUCOMIP :: Opcode
FUCOMP :: Opcode
FUCOMPI :: Opcode
FUCOMPP :: Opcode
FXAM :: Opcode
FXCH :: Opcode
FXRSTOR :: Opcode
FXSAVE :: Opcode
FXTRACT :: Opcode
HADDPD :: Opcode
HADDPS :: Opcode
HLT :: Opcode
HSUBPD :: Opcode
HSUBPS :: Opcode
IDIV :: Opcode
IMUL :: Opcode
BSWAP :: Opcode
IN :: Opcode
INC :: Opcode
INS :: Opcode
INSD :: Opcode
INT :: Opcode
INT3 :: Opcode
INTO :: Opcode
INVD :: Opcode
INVLPG :: Opcode
INVPCID :: Opcode
IRET :: Opcode
IRETD :: Opcode
IRETQ :: Opcode
JA :: Opcode
JAE :: Opcode
JB :: Opcode
JBE :: Opcode
JC :: Opcode
JCXZ :: Opcode
JE :: Opcode
JECXZ :: Opcode
JG :: Opcode
JGE :: Opcode
JL :: Opcode
JLE :: Opcode
JMP :: Opcode
JMPF :: Opcode
JMPN :: Opcode
JNAE :: Opcode
JNA :: Opcode
JNB :: Opcode
JNBE :: Opcode
JNC :: Opcode
JNG :: Opcode
JNE :: Opcode
JNGE :: Opcode
JNLE :: Opcode
JNL :: Opcode
JNO :: Opcode
JNP :: Opcode
JNS :: Opcode
JNZ :: Opcode
JO :: Opcode
JP :: Opcode
JPE :: Opcode
JPO :: Opcode
JRCXZ :: Opcode
JS :: Opcode
JZ :: Opcode
LAHF :: Opcode
LAR :: Opcode
LDDQU :: Opcode
LDMXCSR :: Opcode
LDS :: Opcode
LEA :: Opcode
LEAVE :: Opcode
LES :: Opcode
LFENCE :: Opcode
LFS :: Opcode
LGDT :: Opcode
LGS :: Opcode
LIDT :: Opcode
LLDT :: Opcode
LMSW :: Opcode
LODS :: Opcode
LODSB :: Opcode
LODSD :: Opcode
LODSW :: Opcode
LOOP :: Opcode
LOOPE :: Opcode
LOOPNE :: Opcode
LSL :: Opcode
LSS :: Opcode
LTR :: Opcode
MASKMOVQ :: Opcode
MAXPD :: Opcode
MAXPS :: Opcode
MAXSD :: Opcode
MAXSS :: Opcode
MFENCE :: Opcode
MINPD :: Opcode
MINPS :: Opcode
MINSD :: Opcode
MINSS :: Opcode
MONITOR :: Opcode
MOV :: Opcode
MOVABS :: Opcode
MOVAPD :: Opcode
MOVAPS :: Opcode
MOVD :: Opcode
MOVDDUP :: Opcode
MOVDQA :: Opcode
MOVDQU :: Opcode
MOVHPD :: Opcode
MOVHPS :: Opcode
MOVLHPS :: Opcode
MOVLPD :: Opcode
MOVLPS :: Opcode
MOVLSDUP :: Opcode
MOVMSKPD :: Opcode
MOVMSKPS :: Opcode
MOVNTDQ :: Opcode
MOVNTPD :: Opcode
MOVNTPS :: Opcode
MOVNTQ :: Opcode
MOVQ :: Opcode
MOVS :: Opcode
MOVSD :: Opcode
MOVSLDUP :: Opcode
MOVSS :: Opcode
MOVSQ :: Opcode
MOVSX :: Opcode
MOVSXB :: Opcode
MOVSXD :: Opcode
MOVSXW :: Opcode
MOVUPD :: Opcode
MOVUPS :: Opcode
MOVZX :: Opcode
MOVZXB :: Opcode
MOVZXW :: Opcode
MUL :: Opcode
MULPD :: Opcode
MULPS :: Opcode
MULSD :: Opcode
MULSS :: Opcode
MWAIT :: Opcode
NEG :: Opcode
NOP :: Opcode
NOT :: Opcode
OR :: Opcode
ORPD :: Opcode
ORPS :: Opcode
OUT :: Opcode
OUTS :: Opcode
PACKSSDW :: Opcode
PACKSSWB :: Opcode
PADDB :: Opcode
PADDD :: Opcode
PADDQ :: Opcode
PADDSB :: Opcode
PADDSW :: Opcode
PADDUSB :: Opcode
PADDUSW :: Opcode
PADDW :: Opcode
PAND :: Opcode
PANDN :: Opcode
PAUSE :: Opcode
PAVGB :: Opcode
PAVGW :: Opcode
PCLMULQDQ :: Opcode
PCMPEQB :: Opcode
PCMPEQD :: Opcode
PCMPGTB :: Opcode
PCMPGTD :: Opcode
PEXTRB :: Opcode
PEXTRD :: Opcode
PEXTRQ :: Opcode
PINSRD :: Opcode
PINSRQ :: Opcode
PMADDWD :: Opcode
PMAXSW :: Opcode
PMAXUB :: Opcode
PMAXUD :: Opcode
PMAXUQ :: Opcode
PMINSD :: Opcode
PMINSW :: Opcode
PMINUB :: Opcode
PMINUD :: Opcode
PMOVMSKB :: Opcode
PMOVSXDQ :: Opcode
PMOVZXDQ :: Opcode
PMOVSXBD :: Opcode
PMOVZXBD :: Opcode
PMULLD :: Opcode
PMULLQ :: Opcode
PMULHUW :: Opcode
PMULHW :: Opcode
PMULLW :: Opcode
PMULUDQ :: Opcode
POP :: Opcode
POPA :: Opcode
POPAD :: Opcode
POPF :: Opcode
POPFD :: Opcode
POPFQ :: Opcode
POR :: Opcode
PREFETCHNTA :: Opcode
PREFETCHT0 :: Opcode
PREFETCHT1 :: Opcode
PREFETCHT2 :: Opcode
PSADBW :: Opcode
PSHUFB :: Opcode
PSHUFD :: Opcode
PSHUFLW :: Opcode
PSLLD :: Opcode
PSLLDQ :: Opcode
PSLLQ :: Opcode
PSLLW :: Opcode
PSRAD :: Opcode
PSRAW :: Opcode
PSRLD :: Opcode
PSRLDQ :: Opcode
PSRLQ :: Opcode
PSRLW :: Opcode
PSUBB :: Opcode
PSUBD :: Opcode
PSUBQ :: Opcode
PSUBSB :: Opcode
PSUBSQ :: Opcode
PSUBUSB :: Opcode
PSUBUSW :: Opcode
PSUBW :: Opcode
PTEST :: Opcode
PUNPCKLBW :: Opcode
PUNPCKLWD :: Opcode
PUNPCKLDQ :: Opcode
PUNPCKLQDQ :: Opcode
PUSH :: Opcode
PUSHA :: Opcode
PUSHAD :: Opcode
PUSHF :: Opcode
PUSHFD :: Opcode
PUSHFQ :: Opcode
PXOR :: Opcode
RCL :: Opcode
RCPPS :: Opcode
RCPSS :: Opcode
RCR :: Opcode
RDMSR :: Opcode
RDPMC :: Opcode
RDTSC :: Opcode
RET :: Opcode
RETF :: Opcode
RETN :: Opcode
ROL :: Opcode
ROR :: Opcode
ROUNDSD :: Opcode
ROUNDSS :: Opcode
RSM :: Opcode
RSQRTPS :: Opcode
RSQRTSS :: Opcode
SAHF :: Opcode
SAL :: Opcode
SAR :: Opcode
SBB :: Opcode
SCAS :: Opcode
SCASB :: Opcode
SCASD :: Opcode
SETA :: Opcode
SETAE :: Opcode
SETB :: Opcode
SETBE :: Opcode
SETC :: Opcode
SETE :: Opcode
SETG :: Opcode
SETGE :: Opcode
SETL :: Opcode
SETLE :: Opcode
SETNA :: Opcode
SETNAE :: Opcode
SETNB :: Opcode
SETNBE :: Opcode
SETNC :: Opcode
SETNE :: Opcode
SETNG :: Opcode
SETNGE :: Opcode
SETNL :: Opcode
SETNLE :: Opcode
SETNO :: Opcode
SETNP :: Opcode
SETNS :: Opcode
SETNZ :: Opcode
SETO :: Opcode
SETP :: Opcode
SETPE :: Opcode
SETPO :: Opcode
SETS :: Opcode
SETZ :: Opcode
SFENCE :: Opcode
SGDT :: Opcode
SHL :: Opcode
SHLD :: Opcode
SHR :: Opcode
SHRD :: Opcode
SIDT :: Opcode
SLDT :: Opcode
SMSW :: Opcode
SQRTPD :: Opcode
SQRTPS :: Opcode
SQRTSD :: Opcode
SQRTSS :: Opcode
STC :: Opcode
STD :: Opcode
STI :: Opcode
STMXCSR :: Opcode
STOS :: Opcode
STOSD :: Opcode
STR :: Opcode
SUB :: Opcode
SUBPD :: Opcode
SUBPS :: Opcode
SUBSD :: Opcode
SUBSS :: Opcode
SWAPGS :: Opcode
SYSCALL :: Opcode
SYSENTER :: Opcode
SYSEXIT :: Opcode
SYSRET :: Opcode
TEST :: Opcode
UCOMISD :: Opcode
UCOMISS :: Opcode
UD2 :: Opcode
UNPCKHPD :: Opcode
UNPCKHPS :: Opcode
UNPCKLPD :: Opcode
UNPCKLPS :: Opcode
VERR :: Opcode
VERW :: Opcode
VMCALL :: Opcode
VMCLEAR :: Opcode
VMLAUNCH :: Opcode
VMPTRLD :: Opcode
VMPTRST :: Opcode
VMREAD :: Opcode
VMRESUME :: Opcode
VMWRITE :: Opcode
VMXOFF :: Opcode
VMXON :: Opcode
WAIT :: Opcode
WBINVD :: Opcode
WRFSBASE :: Opcode
WRGSBASE :: Opcode
WRMSR :: Opcode
XADD :: Opcode
XCHG :: Opcode
XLAT :: Opcode
XLATB :: Opcode
XSETBV :: Opcode
XSAVEOPT :: Opcode
XRSTOR :: Opcode
XOR :: Opcode
XORPD :: Opcode
XORPS :: Opcode

-- | Showing unresolved address (inner part within a ptr[...])
show_address' :: Address -> [Char]

-- | Showing unresolved address
show_address :: Address -> [Char]

-- | Showing a size directive
show_size_directive :: (Eq a, Num a, Show a) => a -> [Char]

-- | Showing an operand
show_operand' :: Operand -> [Char]

-- | Showing an optional operand
show_operand :: Show a => Maybe a -> [Char]

-- | Showing an optional annotation
show_annot :: Maybe [Char] -> [Char]

-- | Showing an optional prefix
show_prefix :: Show a => Maybe a -> [Char]

-- | Showing an instruction
show_instruction :: Instr -> [Char]

-- | The size of the operand, in bytes
operand_size :: Operand -> Int

-- | Returns true iff m is the mnemonic of a conditional jump
is_cond_jump :: Opcode -> Bool

-- | Returns true iff m is the mnemonic of a halting instruction
is_halt :: Opcode -> Bool

-- | Returns true iff m is the mnemonic of a jump
is_jump :: Opcode -> Bool

-- | Returns true iff m is the mnemonic of a call
is_call :: Opcode -> Bool

-- | Returns true iff m is the mnemonic of a return
is_ret :: Opcode -> Bool

-- | List of 128 bit registers
reg128 :: [Register]

-- | List of 80 bit registers
reg80 :: [Register]

-- | List of 64 bit registers
reg64 :: [Register]

-- | List of 32 bit registers
reg32 :: [Register]

-- | List of 16 bit registers
reg16 :: [Register]

-- | List of 8 bit registers
reg8 :: [Register]

-- | The size of the given register, in bytes.
reg_size :: Num p => Register -> p

-- | Matches register names to the real registers E.g.: EAX is actually a
--   part of RAX
real_reg :: Register -> Register
instance GHC.Generics.Generic X86_Datastructures.Prefix
instance GHC.Read.Read X86_Datastructures.Prefix
instance GHC.Classes.Ord X86_Datastructures.Prefix
instance GHC.Classes.Eq X86_Datastructures.Prefix
instance GHC.Show.Show X86_Datastructures.Prefix
instance GHC.Generics.Generic X86_Datastructures.Register
instance GHC.Classes.Ord X86_Datastructures.Register
instance GHC.Read.Read X86_Datastructures.Register
instance GHC.Classes.Eq X86_Datastructures.Register
instance GHC.Show.Show X86_Datastructures.Register
instance GHC.Classes.Ord X86_Datastructures.Flag
instance GHC.Classes.Eq X86_Datastructures.Flag
instance GHC.Show.Show X86_Datastructures.Flag
instance GHC.Generics.Generic X86_Datastructures.Address
instance GHC.Classes.Ord X86_Datastructures.Address
instance GHC.Classes.Eq X86_Datastructures.Address
instance GHC.Generics.Generic X86_Datastructures.Operand
instance GHC.Classes.Ord X86_Datastructures.Operand
instance GHC.Classes.Eq X86_Datastructures.Operand
instance GHC.Generics.Generic X86_Datastructures.Opcode
instance GHC.Classes.Ord X86_Datastructures.Opcode
instance GHC.Read.Read X86_Datastructures.Opcode
instance GHC.Classes.Eq X86_Datastructures.Opcode
instance GHC.Show.Show X86_Datastructures.Opcode
instance GHC.Generics.Generic X86_Datastructures.Instr
instance GHC.Classes.Ord X86_Datastructures.Instr
instance GHC.Classes.Eq X86_Datastructures.Instr
instance Data.Serialize.Serialize X86_Datastructures.Instr
instance GHC.Show.Show X86_Datastructures.Instr
instance Data.Serialize.Serialize X86_Datastructures.Opcode
instance Data.Serialize.Serialize X86_Datastructures.Operand
instance GHC.Show.Show X86_Datastructures.Operand
instance Data.Serialize.Serialize X86_Datastructures.Address
instance GHC.Show.Show X86_Datastructures.Address
instance Data.Serialize.Serialize X86_Datastructures.Register
instance Data.Serialize.Serialize X86_Datastructures.Prefix

module SimplePred

-- | A symbolic predicate consists of:
--   
--   <ul>
--   <li>A mapping from stateparts to symbolic expressions.</li>
--   <li>The status of the flags.</li>
--   <li>A set of verification conditions.</li>
--   <li>The <tt><a>StateMuddleStatus</a></tt></li>
--   </ul>
data Pred
Predicate :: Map StatePart SimpleExpr -> FlagStatus -> Set VerificationCondition -> StateMuddleStatus -> Pred

-- | A statepart is either a register or a region in memory
data StatePart

-- | A register
SP_Reg :: Register -> StatePart

-- | A region with a symbolic address and an immediate size.
SP_Mem :: SimpleExpr -> Int -> StatePart

-- | A symbolic expression with as leafs either immediates, variables, or
--   stateparts. A variable is a constant represneting some initial value,
--   e.g., RDI0. A statepart evaluates to its current value, e.g., RDI.
data SimpleExpr

-- | Bottom (unknown value)
Bottom :: BotTyp -> Set BotSrc -> SimpleExpr

-- | A variable representing the initial value stored in the statepart
--   (e.g., RSP0)
SE_Var :: StatePart -> SimpleExpr

-- | An immediate word
SE_Immediate :: Word64 -> SimpleExpr

-- | The value stored currently in the statepart
SE_StatePart :: StatePart -> SimpleExpr

-- | Application of an <tt><a>Operator</a></tt> to the list of arguments
SE_Op :: Operator -> [SimpleExpr] -> SimpleExpr

-- | Taking the lower bits of a value
SE_Bit :: Int -> SimpleExpr -> SimpleExpr

-- | Sign extension
SE_SExtend :: Int -> Int -> SimpleExpr -> SimpleExpr

-- | Overwriting certain bits of a value with bits from another value
SE_Overwrite :: Int -> SimpleExpr -> SimpleExpr -> SimpleExpr

-- | Symbolically represent the status of all flags in the current state
data FlagStatus

-- | No information known, flags could have any value
None :: FlagStatus

-- | The flags are set by the x86 CMP instruction applied to the given
--   operands.
FS_CMP :: Maybe Bool -> Operand -> Operand -> FlagStatus

-- | A verification condition is either: * A precondition of the form: &gt;
--   Precondition (a0,si0) (a1,si1) This formulates that at the initial
--   state the two regions must be separate. * An assertion of the form:
--   &gt; Assertion a (a0,si0) (a1,si1) This formulates that dynamically,
--   whenever address a is executed, the two regions are asserted to be
--   separate. * A function constraint of the form: &gt; FunctionConstraint
--   foo [(RDI, v0), (RSI, v1), ...] This formulates that a function call
--   to function foo with values v0, v1, ... stored in the registers should
--   not overwrite any part of the local stack frame of the caller.
data VerificationCondition

-- | Precondition: lhs SEP rhs
Precondition :: SimpleExpr -> Int -> SimpleExpr -> Int -> VerificationCondition

-- | Assertion: @address, lhs SEP rhs
Assertion :: SimpleExpr -> SimpleExpr -> Int -> SimpleExpr -> Int -> VerificationCondition

-- | Function name, with param registers
FunctionConstraint :: String -> [(Register, SimpleExpr)] -> VerificationCondition

-- | Have functions been called by the current function?
data StateMuddleStatus

-- | No function calls have been executed
Clean :: StateMuddleStatus

-- | All function calls were to external functions
ExternalOnly :: StateMuddleStatus

-- | At least one internal function has been called
Muddled :: StateMuddleStatus

-- | Bot represents an unknown (bottom) value. We annotate each occurence
--   of Bot with a BotTyp. This type indicates where the bottom value
--   originates from. We don't use this, i.e., all bottoms are created
--   equal. The only bottom that has semantics meaning is the last one,
--   non-determinstically picking a value from a set.
data BotTyp

-- | Abstraction joined two terms to Bottom
FromAbstraction :: BotTyp

-- | A read from two possibly overlapping regions
FromOverlap :: BotTyp

-- | A write to two possibly overlapping regions
FromMemWrite :: BotTyp

-- | A function call was executed, setting stateparts to bottom
FromCall :: BotTyp

-- | An instruction with unknown semantics
FromSemantics :: BotTyp

-- | Reading from memory not written to yet
FromUninitializedMemory :: BotTyp

-- | Should not happen, but if a register writes to a registeralias with
--   unknown bit size
FromBitMode :: BotTyp

-- | The expression evaluates to one of the expressions in the set
FromNonDeterminism :: Set SimpleExpr -> BotTyp

-- | Bot represents an unknown (bottom) value. We annotate each occurence
--   of Bot with a BotSrc. This indicates the sources that are used to
--   compute the bottom value. For example, the symbolic expressions
--   <tt>RDI0</tt> and <tt>RSI0</tt> are joined to a Bottom value with
--   sources <tt>{RDI0,RSI0}</tt>. We don't use this, i.e., all bottoms are
--   created equal. It is, however, very convenient for debugging.
data BotSrc
Src_SP :: StatePart -> BotSrc
Src_Function :: String -> BotSrc

-- | An operator is a pure operation over bit-vectors, annotated with the
--   bit-size of its operands. For example, <tt>Plus 64</tt> denotes 64-bit
--   addition. <tt>Udiv</tt> and <tt>Times</tt> are operators op type <tt>w
--   -&gt; w -&gt; w</tt> with all words same length. <tt>Div</tt> and
--   <tt>Div_Rem</tt> are operators of type <tt>w -&gt; w -&gt; w -&gt;
--   w</tt> performing concatenation of the first two words and then doing
--   division/remainder.
data Operator
Plus :: Int -> Operator
Minus :: Int -> Operator
Times :: Int -> Operator
And :: Int -> Operator
Or :: Int -> Operator
Xor :: Int -> Operator
Not :: Int -> Operator
SetXX :: Operator
Bsr :: Int -> Operator
Div_Rem :: Int -> Operator
Div :: Int -> Operator
Shl :: Int -> Operator
Shr :: Int -> Operator
Sar :: Int -> Operator
Udiv :: Int -> Operator
Ror :: Int -> Operator
Rol :: Int -> Operator
Bswap :: Int -> Operator
Pextr :: Int -> Operator

-- | A symbolic expression that is used as a pointer, can be matched to one
--   (or more) of the following types. This happens in over-approximative
--   fashion, i.e., if we don't know we just guess all of these. However,
--   an expression such as <tt>RSP0 - 16</tt> is guessed to be
--   <tt>Local</tt>, an immediate address within the data sections is
--   guessed to be <tt>Global</tt>. The <tt>Local</tt> and <tt>Global</tt>
--   address spaces are assumed to be separate.
data AddrType
Heap :: AddrType
Global :: AddrType
Local :: AddrType

-- | Returns the set of registers occuring in the symbolic expression.
regs_of :: SimpleExpr -> Set Register

-- | Returns the set of sources (state parts used to compute the
--   expression) of an expression.
srcs_of_expr :: SimpleExpr -> Set BotSrc

-- | Returns the set of sources (state parts used to compute the
--   expression) of two expressions.
srcs_of_exprs :: SimpleExpr -> SimpleExpr -> Set BotSrc

-- | Returns true iff the expression contains Bot
contains_bot :: SimpleExpr -> Bool

-- | Returns true iff the statepart contains Bot
contains_bot_sp :: StatePart -> Bool
add_assertion :: SimpleExpr -> SimpleExpr -> Int -> SimpleExpr -> Int -> Pred -> Pred
add_precondition :: SimpleExpr -> Int -> SimpleExpr -> Int -> Pred -> Pred
add_function_constraint :: String -> [(Register, SimpleExpr)] -> Pred -> Pred
is_precondition :: VerificationCondition -> Bool
is_assertion :: VerificationCondition -> Bool
is_func_constraint :: VerificationCondition -> Bool
all_bot_satisfy :: (BotTyp -> Set BotSrc -> Bool) -> SimpleExpr -> Bool
simp :: SimpleExpr -> SimpleExpr
trim_expr :: SimpleExpr -> SimpleExpr
count_instructions_with_assertions :: Set VerificationCondition -> Int
instance GHC.Generics.Generic SimplePred.AddrType
instance GHC.Classes.Ord SimplePred.AddrType
instance GHC.Classes.Eq SimplePred.AddrType
instance GHC.Generics.Generic SimplePred.Operator
instance GHC.Classes.Ord SimplePred.Operator
instance GHC.Classes.Eq SimplePred.Operator
instance GHC.Generics.Generic SimplePred.BotTyp
instance GHC.Classes.Ord SimplePred.BotTyp
instance GHC.Classes.Eq SimplePred.BotTyp
instance GHC.Generics.Generic SimplePred.BotSrc
instance GHC.Classes.Ord SimplePred.BotSrc
instance GHC.Classes.Eq SimplePred.BotSrc
instance GHC.Generics.Generic SimplePred.SimpleExpr
instance GHC.Classes.Ord SimplePred.SimpleExpr
instance GHC.Classes.Eq SimplePred.SimpleExpr
instance GHC.Generics.Generic SimplePred.StatePart
instance GHC.Classes.Ord SimplePred.StatePart
instance GHC.Classes.Eq SimplePred.StatePart
instance GHC.Classes.Ord SimplePred.FlagStatus
instance GHC.Classes.Eq SimplePred.FlagStatus
instance GHC.Generics.Generic SimplePred.FlagStatus
instance GHC.Classes.Ord SimplePred.VerificationCondition
instance GHC.Classes.Eq SimplePred.VerificationCondition
instance GHC.Generics.Generic SimplePred.VerificationCondition
instance GHC.Classes.Ord SimplePred.StateMuddleStatus
instance GHC.Show.Show SimplePred.StateMuddleStatus
instance GHC.Classes.Eq SimplePred.StateMuddleStatus
instance GHC.Generics.Generic SimplePred.StateMuddleStatus
instance GHC.Classes.Ord SimplePred.Pred
instance GHC.Classes.Eq SimplePred.Pred
instance GHC.Generics.Generic SimplePred.Pred
instance Data.Serialize.Serialize SimplePred.Pred
instance GHC.Show.Show SimplePred.Pred
instance Data.Serialize.Serialize SimplePred.StateMuddleStatus
instance GHC.Show.Show SimplePred.VerificationCondition
instance Data.Serialize.Serialize SimplePred.VerificationCondition
instance Data.Serialize.Serialize SimplePred.FlagStatus
instance GHC.Show.Show SimplePred.FlagStatus
instance GHC.Show.Show SimplePred.BotTyp
instance GHC.Show.Show SimplePred.BotSrc
instance GHC.Show.Show SimplePred.SimpleExpr
instance GHC.Show.Show SimplePred.StatePart
instance Data.Serialize.Serialize SimplePred.BotTyp
instance Data.Serialize.Serialize SimplePred.BotSrc
instance Data.Serialize.Serialize SimplePred.StatePart
instance Data.Serialize.Serialize SimplePred.SimpleExpr
instance GHC.Show.Show SimplePred.Operator
instance Data.Serialize.Serialize SimplePred.Operator
instance GHC.Show.Show SimplePred.AddrType
instance Data.Serialize.Serialize SimplePred.AddrType

module DisassembleCapstone
disasm_config :: Integral a => [Word8] -> a -> Disassembler ()
mk_operands :: Show a => a -> [Char] -> [Maybe Operand]
trim :: [Char] -> [Char]
mk_instr :: CsInsn -> Instr
disassemble :: IntMap Word8 -> Int -> IO (Maybe Instr)

module Conventions

-- | In this file, we eumerate assumptions made on calling conventions and
--   over external functions.
--   
--   A list of function names of functions that never return.
exiting_functon_calls :: [[Char]]

-- | An overview of which sections can be modified by external functions.
--   Other sections are assumed NOT to be modified by external functions.
sections_modifiable_by_external_functions :: [([Char], [Char])]

-- | Sections in the following list are assumed not to be modifiable during
--   execution, i.e., constant.
section_is_unwritable :: ([Char], [Char]) -> Bool

-- | A list if registers that are non-volatile, i.e., that must be
--   preserved by a function (callee-saved)
callee_saved_registers :: [Register]

-- | A list of registers that may be used for return values
return_registers :: [Register]

-- | A list of registers used as parameters
parameter_registers :: [Register]

-- | An overapproximation of the maximum number of entries in a jump table.
--   Does not affect soundness, but if the value is set too low, then more
--   indirections may be left unresolved.
max_jump_table_size :: Integer


-- | A <tt><a>Context</a></tt> stores all the information retrieved from
--   the binary, as well as the command-line parameters passed to FoxDec.
--   Moreover, it stores information obtained during verification, such as
--   CFGs, invariants, etc. (see <tt><a>Context</a></tt>).
--   
--   Module <a>VerificationReportInterface</a> provides functions for
--   obtaining and interfacing with a <tt>Context</tt>.
module Context

-- | A control flow graph with blocks and edges. A blockID (represented as
--   an <tt>Int</tt>) is a unique identifier of a basic block. We store
--   basic blocks twice: once as addresses, and once as instructions.
data CFG
CFG :: IntMap [Int] -> IntMap IntSet -> IntMap Int -> Int -> IntMap [Instr] -> CFG

-- | A mapping of blockIDs to instruction addresses
[cfg_blocks] :: CFG -> IntMap [Int]

-- | A mapping of blockIDs to sets of blocKIDs
[cfg_edges] :: CFG -> IntMap IntSet

-- | A mapping of instruction addresses to blockIDs
[cfg_addr_to_blockID] :: CFG -> IntMap Int

-- | A fresh blockID
[cfg_fresh] :: CFG -> Int

-- | A mapping of blockIDs to lists of disassembled instructions.
[cfg_instrs] :: CFG -> IntMap [Instr]

-- | Per instruction address, a set of jump targets.
type Indirections = IntMap IntSet

-- | Sections: segment names, section names, addresses and sizes.
type SectionsInfo = [(String, String, Int, Int)]

-- | An enumeration indicating the result of verification over a function
data VerificationResult

-- | Function was succesfully verified
VerificationSuccess :: VerificationResult

-- | Function was succesfully verified, but required assertions
VerificationSuccesWithAssertions :: VerificationResult

-- | Function contains an unresolved indirection
VerificationUnresolvedIndirection :: VerificationResult

-- | There was some verification error, e.g., return adresss overwrite
VerificationError :: VerificationResult

-- | The function has not been verified.
Unverified :: VerificationResult

-- | Invariants: a mapping of blockIDs to predicates
type Invariants = IntMap Pred

-- | For each leaf-node in a CFG we store the following info.
data NodeInfo

-- | The basic block behaves normally, e.g., a ret
Normal :: NodeInfo

-- | The basic block ends in an unresolved indirection
UnresolvedIndirection :: NodeInfo

-- | The basic blocks ends with, e.g., a call to exit()
Terminal :: NodeInfo

-- | Per function, we report on:
data Report
Report :: CFG -> Invariants -> Set (NodeInfo, Pred) -> VerificationResult -> Set VerificationCondition -> Report

-- | The control flow graph
[report_cfg] :: Report -> CFG

-- | The invariants
[report_invs] :: Report -> Invariants

-- | The postcondition(s)
[report_posts] :: Report -> Set (NodeInfo, Pred)

-- | The verification result
[report_result] :: Report -> VerificationResult

-- | The verification conditions
[report_vcs] :: Report -> Set VerificationCondition

-- | The context datastructure.
--   
--   <b>S</b>: Information <b>S</b>tatically obtained by reading from the
--   binary
--   
--   <b>D</b>: Information <b>D</b>ynamically updated during verification
data Context
Context :: IntMap Word8 -> IntMap String -> IntMap Bool -> Graph -> SectionsInfo -> String -> String -> Bool -> Indirections -> IntMap Report -> Context

-- | <b>S</b>: mapping from addresses to bytes (data and instructions from
--   the binary/executable)
[ctxt_dump] :: Context -> IntMap Word8

-- | <b>S</b>: the symbol table: a mapping of addresses to function names
--   for external functions
[ctxt_syms] :: Context -> IntMap String

-- | <b>D</b>: the currently known and verified entry addresses of
--   functions (true iff always terminating, i.e., non-returning)
[ctxt_calls] :: Context -> IntMap Bool

-- | <b>D</b>: a graph with an edge (e0,e1) if entry address e0 calls entry
--   address e1, and e0 and e1 have not been verified yet
[ctxt_entries] :: Context -> Graph

-- | <b>S</b>: information on segments/section
[ctxt_sections] :: Context -> SectionsInfo

-- | <b>S</b>: the name of the directory where the .dump, .entry, .sections
--   and .symbols files reside
[ctxt_dirname] :: Context -> String

-- | <b>S</b>: the name of the binary
[ctxt_name] :: Context -> String

-- | <b>S</b>: do we call graphviz to generate PDFs from .dot files?
[ctxt_generate_pdfs] :: Context -> Bool

-- | <b>D</b>: the currently known indirections
[ctxt_inds] :: Context -> Indirections

-- | <b>D</b>: a mapping from function entries to reports storing
--   verification results
[ctxt_report] :: Context -> IntMap Report

-- | Reading from a data section.
--   
--   Reads maximally up to 8 bytes. Returns <tt>Nothing</tt> if the given
--   address is out-of-range.
read_from_datasection :: Context -> Word64 -> Int -> Maybe Word64

-- | Find a section for an address (see <tt><a>SectionsInfo</a></tt>)
find_section_for_address :: Context -> Int -> Maybe (String, String, Int, Int)

-- | Fetching an instruction
--   
--   Returns <tt>Nothing</tt> if the given address is out-of-range.
fetch_instruction :: Context -> Int -> IO (Maybe Instr)

-- | Pretty printing an instruction
pp_instruction :: Context -> Instr -> String
instance GHC.Generics.Generic Context.CFG
instance GHC.Show.Show Context.CFG
instance GHC.Generics.Generic Context.VerificationResult
instance GHC.Classes.Eq Context.VerificationResult
instance GHC.Show.Show Context.VerificationResult
instance GHC.Classes.Ord Context.NodeInfo
instance GHC.Classes.Eq Context.NodeInfo
instance GHC.Generics.Generic Context.NodeInfo
instance GHC.Show.Show Context.NodeInfo
instance GHC.Generics.Generic Context.Report
instance GHC.Generics.Generic Context.Context
instance Data.Serialize.Serialize Context.Context
instance Data.Serialize.Serialize Context.Report
instance Data.Serialize.Serialize Context.NodeInfo
instance Data.Serialize.Serialize Context.VerificationResult
instance Data.Serialize.Serialize Context.CFG

module Propagation

-- | We assume a class where we can do predicate transformation through
--   function <tt>tau</tt>, and we can merge two predicates through
--   function <tt>join</tt>. Moreover, we assume an implementation of a
--   function <tt>implies</tt> that implements symbolic implication.
class (Show pred) => Propagator ctxt pred

-- | Predicate transformation for an edge in in a CFG, over a basic blocks.
tau :: Propagator ctxt pred => ctxt -> CFG -> Int -> Maybe Int -> pred -> pred

-- | A lattice-join
join :: Propagator ctxt pred => ctxt -> pred -> pred -> pred

-- | Symbolic implication
implies :: Propagator ctxt pred => ctxt -> pred -> pred -> Bool

-- | Start propagation at the given entry address with the given initial
--   predicate. Returns a set of invariants, i.e., a mapping of instruction
--   addresses to predicates.
do_prop :: Propagator ctxt pred => ctxt -> CFG -> Int -> pred -> IntMap pred

-- | The set of next blocks from the given block
post :: CFG -> Key -> IntSet

module CFG_Gen

-- | Resolving the operand of a jump/call can produce one of the following.
data ResolvedJumpTarget

-- | An indirect branch that has not been resolved yet
Unresolved :: ResolvedJumpTarget

-- | A call to external function f
External :: String -> ResolvedJumpTarget

-- | An internal call to the given address
ImmediateAddress :: Word64 -> ResolvedJumpTarget
address_has_instruction :: Integral a => Context -> a -> Bool
address_has_symbol :: Integral a => Context -> a -> Bool
address_is_external :: Integral a => Context -> a -> Bool
stepA :: Context -> Int -> Int -> IO (Either IntSet [Int])

-- | Fetching an instruction list given a block ID
fetch_block :: CFG -> Int -> [Instr]
cfg_gen :: Context -> Int -> IO (Either IntSet CFG)
cfg_to_dot :: Context -> CFG -> String
resolve_jump_target :: Context -> Instr -> [ResolvedJumpTarget]
operand_static_resolve :: Context -> Instr -> Maybe Operand -> ResolvedJumpTarget
get_internal_addresses :: Num a => ResolvedJumpTarget -> [a]
function_name_of_entry :: Context -> Int -> String
function_name_of_instruction :: Context -> Instr -> String
instruction_jumps_to_external :: Context -> Instr -> Bool
is_end_node :: CFG -> Key -> Bool
node_info_of :: Context -> CFG -> Key -> NodeInfo
show_invariants :: CFG -> Invariants -> String
instance GHC.Show.Show CFG_Gen.ResolvedJumpTarget
instance GHC.Classes.Eq CFG_Gen.ResolvedJumpTarget


-- | Symbolic execution of sequential lists of instructions of type
--   <tt><a>Instr</a></tt> on predicates of type <tt><a>Pred</a></tt>.
module SymbolicExecution

-- | Do predicate transformation over a basic block in a CFG. Given an edge
--   in the CFG from blockId to blockId', perform predicate transformation.
--   Parameter blockId' is needed to set the flags properly. If
--   <tt>Nothing</tt> is supplied, the flags are overapproximatively set to
--   <tt><a>None</a></tt>. We provide the option to skip the last
--   instruction, as sometimes we need to symbolically execute a block up
--   to but excluding the last instruction.
tau_blockID :: Context -> CFG -> Int -> Maybe Int -> Bool -> Pred -> Pred

-- | Do predicate transformation over a block of instructions. Does not
--   take into account flags, commonly function <tt><a>tau_blockID</a></tt>
--   should be used.
tau_b :: Context -> [Instr] -> State Pred ()

-- | The initial predicate. Given the currently known invariants and
--   postconditions, gather all stateparts occurring in the current
--   function. The initial predicate assign a variable to each statepart,
--   e.g.: <tt>RSP == RSP0, RDI == RDI, ...</tt>.
init_pred :: Invariants -> Set (NodeInfo, Pred) -> Pred

-- | Returns true iff the given statepart is preserved (unmodified) after a
--   function call. This happens if the statepart is local, if the address
--   belongs to an unwritable data section, or if the function call is
--   external and the statepart belongs to a section that cannot be
--   modified by external functions according to the <a>Conventions</a>.
statepart_is_preserved_after_function_call :: Context -> Instr -> StatePart -> Bool

-- | Given the currently known invariants and postconditions, gather all
--   stateparts occurring in the current function.
gather_stateparts :: Invariants -> Set (NodeInfo, Pred) -> Set StatePart

-- | Tries to guess if the symbolic expression is a pointer. Any immediate
--   that falls in the address range of the binary is highly likely a
--   pointer. A value stored in a memory location belonging to an external
--   function symbol is also highly likely a pointer.
expr_highly_likely_pointer :: Context -> SimpleExpr -> Bool
instance Propagation.Propagator Context.Context SimplePred.Pred


-- | After running FoxDec, a "verification report" (an object of type
--   <tt><a>Context</a></tt>) can be retrieved from the generated .report
--   file (see function <tt>ctxt_read_report</tt>). Essentially, this
--   module provides hooks into some of the information retrieved and
--   derived from the binary, including instructions, invariants, function
--   entry points, etc.
--   
--   A verification report is represented by the type
--   <tt><a>Context</a></tt>, as internally it is just the context passed
--   around and maintained during verification.
--   
--   The main flow is to read the .report file and use these functions to
--   retrieve information. The following example reads in a .report file
--   provided as first command-line parameter and outputs the function
--   entries:
--   
--   <pre>
--   main = do
--     args &lt;- getArgs
--     ctxt &lt;- ctxt_read_report $ head args
--     putStrLn $ show $ ctxt_get_function_entries ctxt
--   </pre>
--   
--   Some of the information is automatically also exported in plain-text
--   format, for easy access.
module VerificationReportInterface

-- | The return type when retrieving information from a verification
--   report: either an error message or a result.
type Retrieve a = Context -> Either String a

-- | Function Entries are simply integers
type FunctionEntry = Int

-- | Instruction Addresses are simply integers
type InstructionAddress = Int

-- | Read in the .report file from a file with the given file name. May
--   produce an error if no report can be read from the file. Returns the
--   verification report stored in the .report file.
ctxt_read_report :: String -> IO Context

-- | Retrieve all function entries.
--   
--   Returns a set of funtion entries.
ctxt_get_function_entries :: Retrieve (Set FunctionEntry)

-- | Retrieve all instruction addresses.
--   
--   Returns a set of instruction addresses.
ctxt_get_instruction_addresses :: Retrieve (Set InstructionAddress)

-- | Retrieve all indirections
--   
--   Returns, a mapping that provides for some instruction addresses a set
--   of jump targets.
ctxt_get_indirections :: Retrieve Indirections

-- | Retrieve instruction for a given instruction address, both as
--   datastructure and pretty-printed
ctxt_get_instruction :: InstructionAddress -> Retrieve (Instr, String)

-- | Retrieve invariant for a given function entry and instruction address
--   
--   An invariant is a predicate provding information over registers,
--   memory, flags, and verification conditions.
ctxt_get_invariant :: FunctionEntry -> InstructionAddress -> Retrieve Pred

-- | Retrieve all internal function calls for a given function entry
--   
--   Returns a set of function entries.
ctxt_get_internal_function_calls :: FunctionEntry -> Retrieve (Set FunctionEntry)

-- | Retrieve a CFG for a given function entry
ctxt_get_cfg :: FunctionEntry -> Retrieve CFG
