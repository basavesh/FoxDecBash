<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Analysis.ControlFlow</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">foxdec-0.1.0.0: Formally Verified x86-64 Decompilation</span><ul class="links" id="page-menu"><li><a href="src/Analysis.ControlFlow.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Analysis.ControlFlow</p></div><div id="description"><p class="caption">Description</p><div class="doc empty">&nbsp;</div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:cfg_gen">cfg_gen</a> :: <a href="Analysis-Context.html#t:Context" title="Analysis.Context">Context</a> -&gt; <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../containers-0.6.5.1/Data-Set.html#t:Set" title="Data.Set">Set</a> (<a href="X86-Instruction.html#t:Instruction" title="X86.Instruction">Instruction</a>, <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a>), <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a>)</li><li class="src short"><a href="#v:cfg_to_dot">cfg_to_dot</a> :: <a href="Analysis-Context.html#t:Context" title="Analysis.Context">Context</a> -&gt; <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a> -&gt; <a href="../base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a></li><li class="src short"><a href="#v:is_end_node">is_end_node</a> :: <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a> -&gt; <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:node_info_of">node_info_of</a> :: <a href="Analysis-Context.html#t:Context" title="Analysis.Context">Context</a> -&gt; <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a> -&gt; <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Analysis-Context.html#t:NodeInfo" title="Analysis.Context">NodeInfo</a></li><li class="src short"><a href="#v:stepA">stepA</a> :: <a href="Analysis-Context.html#t:Context" title="Analysis.Context">Context</a> -&gt; <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.14.3.0/Data-Either.html#t:Either" title="Data.Either">Either</a> (<a href="../containers-0.6.5.1/Data-Set.html#t:Set" title="Data.Set">Set</a> (<a href="X86-Instruction.html#t:Instruction" title="X86.Instruction">Instruction</a>, <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a>)) [(<a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>)])</li><li class="src short"><a href="#v:post">post</a> :: <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a> -&gt; <a href="../containers-0.6.5.1/Data-IntSet.html#t:Key" title="Data.IntSet">Key</a> -&gt; <a href="../containers-0.6.5.1/Data-IntSet.html#t:IntSet" title="Data.IntSet">IntSet</a></li><li class="src short"><a href="#v:fetch_block">fetch_block</a> :: <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a> -&gt; <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; [<a href="X86-Instruction.html#t:Instruction" title="X86.Instruction">Instruction</a>]</li><li class="src short"><a href="#v:resolve_jump_target">resolve_jump_target</a> :: <a href="Analysis-Context.html#t:Context" title="Analysis.Context">Context</a> -&gt; <a href="X86-Instruction.html#t:Instruction" title="X86.Instruction">Instruction</a> -&gt; [<a href="Data-JumpTarget.html#t:ResolvedJumpTarget" title="Data.JumpTarget">ResolvedJumpTarget</a>]</li><li class="src short"><a href="#v:get_internal_addresses">get_internal_addresses</a> :: <a href="Data-JumpTarget.html#t:ResolvedJumpTarget" title="Data.JumpTarget">ResolvedJumpTarget</a> -&gt; [<a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a>]</li><li class="src short"><a href="#v:instruction_jumps_to_external">instruction_jumps_to_external</a> :: <a href="Analysis-Context.html#t:Context" title="Analysis.Context">Context</a> -&gt; <a href="X86-Instruction.html#t:Instruction" title="X86.Instruction">Instruction</a> -&gt; <a href="../base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:show_block">show_block</a> :: <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a> -&gt; <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a></li><li class="src short"><a href="#v:show_invariants">show_invariants</a> :: <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a> -&gt; <a href="Analysis-Context.html#t:Invariants" title="Analysis.Context">Invariants</a> -&gt; <a href="../base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a></li><li class="src short"><a href="#v:isTerminal">isTerminal</a> :: <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a> -&gt; <a href="../containers-0.6.5.1/Data-IntSet.html#t:Key" title="Data.IntSet">Key</a> -&gt; <a href="../base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:cfg_gen" class="def">cfg_gen</a> <a href="src/Analysis.ControlFlow.html#cfg_gen" class="link">Source</a> <a href="#v:cfg_gen" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Analysis-Context.html#t:Context" title="Analysis.Context">Context</a></td><td class="doc"><p>The context</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p>The entry point of the function</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../containers-0.6.5.1/Data-Set.html#t:Set" title="Data.Set">Set</a> (<a href="X86-Instruction.html#t:Instruction" title="X86.Instruction">Instruction</a>, <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a>), <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Produce a CFG</p><p>Given the entry point of the function, generate either a CFG, or a set of new entry points to be analyzed first.
 The set of new entry points are function entries called by the current function, but for which we do not know yet whether they terminate or not.
 If a CFG is returned, then all function calls in that CFG have already been analyzed.</p></div></div><div class="top"><p class="src"><a id="v:cfg_to_dot" class="def">cfg_to_dot</a> <a href="src/Analysis.ControlFlow.html#cfg_to_dot" class="link">Source</a> <a href="#v:cfg_to_dot" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Analysis-Context.html#t:Context" title="Analysis.Context">Context</a></td><td class="doc"><p>The context</p></td></tr><tr><td class="src">-&gt; <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a></td><td class="doc"><p>The CFG</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Export a CFG to .dot file</p><p>Strongly connected components get the same color.</p></div></div><div class="top"><p class="src"><a id="v:is_end_node" class="def">is_end_node</a> <a href="src/Analysis.ControlFlow.html#is_end_node" class="link">Source</a> <a href="#v:is_end_node" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a></td><td class="doc"><p>The CFG</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p>The blockID</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Returns true if the given blockID is a leaf-node in the given CFG.</p></div></div><div class="top"><p class="src"><a id="v:node_info_of" class="def">node_info_of</a> <a href="src/Analysis.ControlFlow.html#node_info_of" class="link">Source</a> <a href="#v:node_info_of" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Analysis-Context.html#t:Context" title="Analysis.Context">Context</a></td><td class="doc"><p>The context</p></td></tr><tr><td class="src">-&gt; <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Analysis-Context.html#t:NodeInfo" title="Analysis.Context">NodeInfo</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Returns the <code><code><a href="Analysis-Context.html#t:NodeInfo" title="Analysis.Context">NodeInfo</a></code></code> of a given blockID.</p><p>Assumes the given blockID corresponds to a leaf-node.</p></div></div><div class="top"><p class="src"><a id="v:stepA" class="def">stepA</a> <a href="src/Analysis.ControlFlow.html#stepA" class="link">Source</a> <a href="#v:stepA" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Analysis-Context.html#t:Context" title="Analysis.Context">Context</a></td><td class="doc"><p>The context</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p>The entry address</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p>The instruction address</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.14.3.0/Data-Either.html#t:Either" title="Data.Either">Either</a> (<a href="../containers-0.6.5.1/Data-Set.html#t:Set" title="Data.Set">Set</a> (<a href="X86-Instruction.html#t:Instruction" title="X86.Instruction">Instruction</a>, <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a>)) [(<a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>)])</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>An abstract step function</p><p>Given the entry address of the function currently under investigation, and the instruction address of the current instruction,
 try to get the set of next instruction addresses.</p><p>This returns either:
   * a set of tuples <code>(i,a)</code> where <code>i</code> is an instruction and <code>a</code> its address. All these instructions are function calls that need to be analyzed before this current function entry can continue.
   * a list of tuples <code>(a,b)</code> where <code>a</code> is an instruction address that may follow the current instruction, and <code>b</code> is a Bool indicating whether that address belongs to a <code>call</code></p><p>TODO the Lefts are ignored so need no to return them</p></div></div><div class="top"><p class="src"><a id="v:post" class="def">post</a> :: <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a> -&gt; <a href="../containers-0.6.5.1/Data-IntSet.html#t:Key" title="Data.IntSet">Key</a> -&gt; <a href="../containers-0.6.5.1/Data-IntSet.html#t:IntSet" title="Data.IntSet">IntSet</a> <a href="src/Analysis.ControlFlow.html#post" class="link">Source</a> <a href="#v:post" class="selflink">#</a></p><div class="doc"><p>The set of next blocks from the given block in a CFG</p></div></div><div class="top"><p class="src"><a id="v:fetch_block" class="def">fetch_block</a> <a href="src/Analysis.ControlFlow.html#fetch_block" class="link">Source</a> <a href="#v:fetch_block" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a></td><td class="doc"><p>The CFG</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p>The blockID</p></td></tr><tr><td class="src">-&gt; [<a href="X86-Instruction.html#t:Instruction" title="X86.Instruction">Instruction</a>]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Fetching an instruction list given a block ID</p></div></div><div class="top"><p class="src"><a id="v:resolve_jump_target" class="def">resolve_jump_target</a> <a href="src/Analysis.ControlFlow.html#resolve_jump_target" class="link">Source</a> <a href="#v:resolve_jump_target" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Analysis-Context.html#t:Context" title="Analysis.Context">Context</a></td><td class="doc"><p>The context</p></td></tr><tr><td class="src">-&gt; <a href="X86-Instruction.html#t:Instruction" title="X86.Instruction">Instruction</a></td><td class="doc"><p>The instruction</p></td></tr><tr><td class="src">-&gt; [<a href="Data-JumpTarget.html#t:ResolvedJumpTarget" title="Data.JumpTarget">ResolvedJumpTarget</a>]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Resolves the first operand of a call or jump instruction.
 First tries to see if the instruction is an indirection, that has already been resolved.
 If not, try to statically resolve the first operand using <code><code><a href="Analysis-FunctionNames.html#v:operand_static_resolve" title="Analysis.FunctionNames">operand_static_resolve</a></code></code>.
 If that resolves to an immediate value, see if that immediate value corresponds to an external function or an internal function.</p><p>Returns a list of <code><code><a href="Data-JumpTarget.html#t:ResolvedJumpTarget" title="Data.JumpTarget">ResolvedJumpTarget</a></code></code>, since an indirection may be resolved to multiple targets.</p></div></div><div class="top"><p class="src"><a id="v:get_internal_addresses" class="def">get_internal_addresses</a> <a href="src/Analysis.ControlFlow.html#get_internal_addresses" class="link">Source</a> <a href="#v:get_internal_addresses" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Data-JumpTarget.html#t:ResolvedJumpTarget" title="Data.JumpTarget">ResolvedJumpTarget</a></td><td class="doc"><p>A resolved jump target</p></td></tr><tr><td class="src">-&gt; [<a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a>]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Given a resolved jump target, get a possibly empty list of internal addresses to which the jump target can jump.</p></div></div><div class="top"><p class="src"><a id="v:instruction_jumps_to_external" class="def">instruction_jumps_to_external</a> <a href="src/Analysis.ControlFlow.html#instruction_jumps_to_external" class="link">Source</a> <a href="#v:instruction_jumps_to_external" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Analysis-Context.html#t:Context" title="Analysis.Context">Context</a></td><td class="doc"><p>The context</p></td></tr><tr><td class="src">-&gt; <a href="X86-Instruction.html#t:Instruction" title="X86.Instruction">Instruction</a></td><td class="doc"><p>The instruction</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Returns true iff the instruction resolves to external targets only.</p></div></div><div class="top"><p class="src"><a id="v:show_block" class="def">show_block</a> <a href="src/Analysis.ControlFlow.html#show_block" class="link">Source</a> <a href="#v:show_block" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a></td><td class="doc"><p>The CFG</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p>The blockID</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Shows the block associated to the givern blockID.</p></div></div><div class="top"><p class="src"><a id="v:show_invariants" class="def">show_invariants</a> <a href="src/Analysis.ControlFlow.html#show_invariants" class="link">Source</a> <a href="#v:show_invariants" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a></td><td class="doc"><p>The CFG</p></td></tr><tr><td class="src">-&gt; <a href="Analysis-Context.html#t:Invariants" title="Analysis.Context">Invariants</a></td><td class="doc"><p>The invariants</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Shows invariants.</p></div></div><div class="top"><p class="src"><a id="v:isTerminal" class="def">isTerminal</a> :: <a href="Analysis-Context.html#t:CFG" title="Analysis.Context">CFG</a> -&gt; <a href="../containers-0.6.5.1/Data-IntSet.html#t:Key" title="Data.IntSet">Key</a> -&gt; <a href="../base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Analysis.ControlFlow.html#isTerminal" class="link">Source</a> <a href="#v:isTerminal" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>