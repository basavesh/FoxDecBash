<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures , FlexibleContexts, DeriveGeneric, StandaloneDeriving, StrictData #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">OutputGeneration.Metrics</span><span> </span><span class="hs-keyword">where</span><span> </span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Base.html"><span class="hs-identifier">Base</span></a></span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SValue.html"><span class="hs-identifier">Data.SValue</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.L0.html"><span class="hs-identifier">Data.L0</span></a></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.CFG.html"><span class="hs-identifier">Data.CFG</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Indirection.html"><span class="hs-identifier">Data.Indirection</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.VerificationCondition.html"><span class="hs-identifier">Data.VerificationCondition</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SymbolicExpression.html"><span class="hs-identifier">Data.SymbolicExpression</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html"><span class="hs-identifier">Data.X86.Instruction</span></a></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Binary.Generic.html"><span class="hs-identifier">Binary.Generic</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="WithNoAbstraction.Pointers.html"><span class="hs-identifier">WithNoAbstraction.Pointers</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IM</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IS</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unpack</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Unsafe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafePerformIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span id="mk_metrics"><span class="annot"><span class="annottext">mk_metrics :: p -&gt; L0 pred finit SValue -&gt; [Char]
</span><a href="OutputGeneration.Metrics.html#mk_metrics"><span class="hs-identifier hs-var hs-var">mk_metrics</span></a></span></span><span> </span><span id="local-6989586621679406641"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406641"><span class="hs-identifier hs-var">bin</span></a></span></span><span> </span><span id="local-6989586621679406642"><span class="annot"><span class="annottext">L0 pred finit SValue
</span><a href="#local-6989586621679406642"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679406645"><span class="annot"><span class="annottext">IntMap Indirections
</span><a href="#local-6989586621679406645"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679406646"><span class="annot"><span class="annottext">IntMap Indirections
</span><a href="#local-6989586621679406646"><span class="hs-identifier hs-var">unresolved</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Indirections -&gt; Bool)
-&gt; IntMap Indirections
-&gt; (IntMap Indirections, IntMap Indirections)
forall a. (a -&gt; Bool) -&gt; IntMap a -&gt; (IntMap a, IntMap a)
</span><span class="hs-identifier hs-var">IM.partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Indirections -&gt; Indirections -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Indirection -&gt; Indirections
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">S.singleton</span></span><span> </span><span class="annot"><span class="annottext">Indirection
</span><a href="Data.Indirection.html#Indirection_Unresolved"><span class="hs-identifier hs-var">Indirection_Unresolved</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IntMap Indirections -&gt; (IntMap Indirections, IntMap Indirections))
-&gt; IntMap Indirections
-&gt; (IntMap Indirections, IntMap Indirections)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue -&gt; IntMap Indirections
forall pred finit v. L0 pred finit v -&gt; IntMap Indirections
</span><a href="Data.L0.html#l0_indirections"><span class="hs-identifier hs-var">l0_indirections</span></a></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue
</span><a href="#local-6989586621679406642"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-46"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679406654"><span class="annot"><span class="annottext">IntMap Indirections
</span><a href="#local-6989586621679406654"><span class="hs-identifier hs-var">partially_resolved</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679406655"><span class="annot"><span class="annottext">IntMap Indirections
</span><a href="#local-6989586621679406655"><span class="hs-identifier hs-var">resolved</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Indirections -&gt; Bool)
-&gt; IntMap Indirections
-&gt; (IntMap Indirections, IntMap Indirections)
forall a. (a -&gt; Bool) -&gt; IntMap a -&gt; (IntMap a, IntMap a)
</span><span class="hs-identifier hs-var">IM.partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Indirection -&gt; Indirections -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">S.member</span></span><span> </span><span class="annot"><span class="annottext">Indirection
</span><a href="Data.Indirection.html#Indirection_Unresolved"><span class="hs-identifier hs-var">Indirection_Unresolved</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IntMap Indirections -&gt; (IntMap Indirections, IntMap Indirections))
-&gt; IntMap Indirections
-&gt; (IntMap Indirections, IntMap Indirections)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap Indirections
</span><a href="#local-6989586621679406645"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-47"></span><span>      </span><span id="local-6989586621679406657"><span class="annot"><span class="annottext">instrs :: [Instruction]
</span><a href="#local-6989586621679406657"><span class="hs-identifier hs-var hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue -&gt; [Instruction]
forall {pred} {finit} {v}. L0 pred finit v -&gt; [Instruction]
</span><a href="#local-6989586621679406658"><span class="hs-identifier hs-var">l0_get_all_instructions</span></a></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue
</span><a href="#local-6989586621679406642"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-48"></span><span>      </span><span id="local-6989586621679406660"><span class="annot"><span class="annottext">num_intrs :: Int
</span><a href="#local-6989586621679406660"><span class="hs-identifier hs-var hs-var">num_intrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instruction] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679406657"><span class="hs-identifier hs-var">instrs</span></a></span><span>
</span><span id="line-49"></span><span>      </span><span id="local-6989586621679406666"><span class="annot"><span class="annottext">avg_size :: Double
</span><a href="#local-6989586621679406666"><span class="hs-identifier hs-var hs-var">avg_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Double
forall a b. (Real a, Fractional b) =&gt; [a] -&gt; b
</span><a href="Base.html#average"><span class="hs-identifier hs-var">average</span></a></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Double) -&gt; [Int] -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Instruction -&gt; Int) -&gt; [Instruction] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; Int
</span><a href="Data.X86.Instruction.html#inSize"><span class="hs-identifier hs-var">inSize</span></a></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679406657"><span class="hs-identifier hs-var">instrs</span></a></span><span>
</span><span id="line-50"></span><span>      </span><span id="local-6989586621679406691"><span class="annot"><span class="annottext">num_expected_intrs :: Integer
</span><a href="#local-6989586621679406691"><span class="hs-identifier hs-var hs-var">num_expected_intrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Integer
forall b. Integral b =&gt; Double -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; Int
forall a. BinaryClass a =&gt; a -&gt; Int
</span><a href="Binary.Generic.html#binary_text_section_size"><span class="hs-identifier hs-var">binary_text_section_size</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406641"><span class="hs-identifier hs-var">bin</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679406666"><span class="hs-identifier hs-var">avg_size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>      </span><span id="local-6989586621679406697"><span class="annot"><span class="annottext">pars :: IntMap (PointerAnalysisResult SValue)
</span><a href="#local-6989586621679406697"><span class="hs-identifier hs-var hs-var">pars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntMap (IntMap (PointerAnalysisResult SValue))
-&gt; IntMap (PointerAnalysisResult SValue)
forall (f :: * -&gt; *) a. Foldable f =&gt; f (IntMap a) -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.unions</span></span><span> </span><span class="annot"><span class="annottext">(IntMap (IntMap (PointerAnalysisResult SValue))
 -&gt; IntMap (PointerAnalysisResult SValue))
-&gt; IntMap (IntMap (PointerAnalysisResult SValue))
-&gt; IntMap (PointerAnalysisResult SValue)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue
-&gt; IntMap (IntMap (PointerAnalysisResult SValue))
forall pred finit v.
L0 pred finit v -&gt; IntMap (IntMap (PointerAnalysisResult v))
</span><a href="Data.L0.html#l0_get_pars"><span class="hs-identifier hs-var">l0_get_pars</span></a></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue
</span><a href="#local-6989586621679406642"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-52"></span><span>      </span><span id="local-6989586621679406702"><span class="annot"><span class="annottext">pointerDesignations :: Map [Char] Int
</span><a href="#local-6989586621679406702"><span class="hs-identifier hs-var hs-var">pointerDesignations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p -&gt; IntMap (PointerAnalysisResult SValue) -&gt; Map [Char] Int
forall {p} {a}.
(BinaryClass p, Num a) =&gt;
p -&gt; IntMap (PointerAnalysisResult SValue) -&gt; Map [Char] a
</span><a href="OutputGeneration.Metrics.html#mk_metric_pointerDesignations"><span class="hs-identifier hs-var">mk_metric_pointerDesignations</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406641"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (PointerAnalysisResult SValue)
</span><a href="#local-6989586621679406697"><span class="hs-identifier hs-var">pars</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-53"></span><span>   </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-54"></span><span>       </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-------------&quot;</span></span><span>
</span><span id="line-55"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;INDIRECTIONS:&quot;</span></span><span>
</span><span id="line-56"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-------------&quot;</span></span><span>
</span><span id="line-57"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;#indirections:                   &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap Indirections -&gt; Int
forall a. IntMap a -&gt; Int
</span><span class="hs-identifier hs-var">IM.size</span></span><span> </span><span class="annot"><span class="annottext">(IntMap Indirections -&gt; Int) -&gt; IntMap Indirections -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue -&gt; IntMap Indirections
forall pred finit v. L0 pred finit v -&gt; IntMap Indirections
</span><a href="Data.L0.html#l0_indirections"><span class="hs-identifier hs-var">l0_indirections</span></a></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue
</span><a href="#local-6989586621679406642"><span class="hs-identifier hs-var">l0</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-58"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  (of which resolved):           &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap Indirections -&gt; Int
forall a. IntMap a -&gt; Int
</span><span class="hs-identifier hs-var">IM.size</span></span><span> </span><span class="annot"><span class="annottext">IntMap Indirections
</span><a href="#local-6989586621679406655"><span class="hs-identifier hs-var">resolved</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-59"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  (of which partially resolved): &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap Indirections -&gt; Int
forall a. IntMap a -&gt; Int
</span><span class="hs-identifier hs-var">IM.size</span></span><span> </span><span class="annot"><span class="annottext">IntMap Indirections
</span><a href="#local-6989586621679406654"><span class="hs-identifier hs-var">partially_resolved</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  (of which unresolved):         &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap Indirections -&gt; Int
forall a. IntMap a -&gt; Int
</span><span class="hs-identifier hs-var">IM.size</span></span><span> </span><span class="annot"><span class="annottext">IntMap Indirections
</span><a href="#local-6989586621679406646"><span class="hs-identifier hs-var">unresolved</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>     </span><span class="hs-special">,</span><span class="annot"><span class="annottext">IntMap Indirections -&gt; [Char]
</span><a href="Data.L0.html#show_indirections"><span class="hs-identifier hs-var">show_indirections</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap Indirections -&gt; [Char]) -&gt; IntMap Indirections -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Indirections -&gt; Bool)
-&gt; IntMap Indirections -&gt; IntMap Indirections
forall a. (a -&gt; Bool) -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Indirections -&gt; Indirections -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Indirection -&gt; Indirections
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">S.singleton</span></span><span> </span><span class="annot"><span class="annottext">Indirection
</span><a href="Data.Indirection.html#Indirection_Unresolved"><span class="hs-identifier hs-var">Indirection_Unresolved</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IntMap Indirections -&gt; IntMap Indirections)
-&gt; IntMap Indirections -&gt; IntMap Indirections
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue -&gt; IntMap Indirections
forall pred finit v. L0 pred finit v -&gt; IntMap Indirections
</span><a href="Data.L0.html#l0_indirections"><span class="hs-identifier hs-var">l0_indirections</span></a></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue
</span><a href="#local-6989586621679406642"><span class="hs-identifier hs-var">l0</span></a></span><span> </span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-64"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-------------&quot;</span></span><span>
</span><span id="line-65"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;INSTRUCTIONS:&quot;</span></span><span>
</span><span id="line-66"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-------------&quot;</span></span><span>
</span><span id="line-67"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;#instructions:                      &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679406660"><span class="hs-identifier hs-var">num_intrs</span></a></span><span>
</span><span id="line-68"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;average instruction size:           &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679406666"><span class="hs-identifier hs-var">avg_size</span></a></span><span>
</span><span id="line-69"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;estimate of expected #instructions: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679406691"><span class="hs-identifier hs-var">num_expected_intrs</span></a></span><span>
</span><span id="line-70"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;coverage:                           &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Base.html#round2dp"><span class="hs-identifier hs-var">round2dp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679406660"><span class="hs-identifier hs-var">num_intrs</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679406691"><span class="hs-identifier hs-var">num_expected_intrs</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;#instructions with memory access:   &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap (PointerAnalysisResult SValue) -&gt; Int
forall a. IntMap a -&gt; Int
</span><span class="hs-identifier hs-var">IM.size</span></span><span> </span><span class="annot"><span class="annottext">IntMap (PointerAnalysisResult SValue)
</span><a href="#local-6989586621679406697"><span class="hs-identifier hs-var">pars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  designations:                     &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[([Char], Double)] -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map [Char] Double -&gt; [([Char], Double)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.assocs</span></span><span> </span><span class="annot"><span class="annottext">(Map [Char] Double -&gt; [([Char], Double)])
-&gt; Map [Char] Double -&gt; [([Char], Double)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map [Char] Int -&gt; Map [Char] Double
</span><a href="OutputGeneration.Metrics.html#designations_to_percentages"><span class="hs-identifier hs-var">designations_to_percentages</span></a></span><span> </span><span class="annot"><span class="annottext">Map [Char] Int
</span><a href="#local-6989586621679406702"><span class="hs-identifier hs-var">pointerDesignations</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-75"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;----------&quot;</span></span><span>
</span><span id="line-76"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;FUNCTIONS:&quot;</span></span><span>
</span><span id="line-77"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;----------&quot;</span></span><span>
</span><span id="line-78"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;#lifted functions:                              &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap (finit, Maybe (FResult pred SValue)) -&gt; Int
forall a. IntMap a -&gt; Int
</span><span class="hs-identifier hs-var">IM.size</span></span><span> </span><span class="annot"><span class="annottext">(IntMap (finit, Maybe (FResult pred SValue)) -&gt; Int)
-&gt; IntMap (finit, Maybe (FResult pred SValue)) -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue -&gt; IntMap (finit, Maybe (FResult pred SValue))
forall pred finit v.
L0 pred finit v -&gt; IntMap (finit, Maybe (FResult pred v))
</span><a href="Data.L0.html#l0_functions"><span class="hs-identifier hs-var">l0_functions</span></a></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue
</span><a href="#local-6989586621679406642"><span class="hs-identifier hs-var">l0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  (of which ending in unresolved indirections): &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap (finit, Maybe (FResult pred SValue)) -&gt; Int
forall a. IntMap a -&gt; Int
</span><span class="hs-identifier hs-var">IM.size</span></span><span> </span><span class="annot"><span class="annottext">(IntMap (finit, Maybe (FResult pred SValue)) -&gt; Int)
-&gt; IntMap (finit, Maybe (FResult pred SValue)) -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((finit, Maybe (FResult pred SValue)) -&gt; Bool)
-&gt; IntMap (finit, Maybe (FResult pred SValue))
-&gt; IntMap (finit, Maybe (FResult pred SValue))
forall a. (a -&gt; Bool) -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Postcondition pred -&gt; Bool
forall {pred}. Postcondition pred -&gt; Bool
</span><a href="#local-6989586621679406714"><span class="hs-identifier hs-var">is_unresolved</span></a></span><span> </span><span class="annot"><span class="annottext">(Postcondition pred -&gt; Bool)
-&gt; ((finit, Maybe (FResult pred SValue)) -&gt; Postcondition pred)
-&gt; (finit, Maybe (FResult pred SValue))
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(finit, Maybe (FResult pred SValue)) -&gt; Postcondition pred
forall {a} {pred} {v}.
(a, Maybe (FResult pred v)) -&gt; Postcondition pred
</span><a href="#local-6989586621679406716"><span class="hs-identifier hs-var">get_post</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IntMap (finit, Maybe (FResult pred SValue))
 -&gt; IntMap (finit, Maybe (FResult pred SValue)))
-&gt; IntMap (finit, Maybe (FResult pred SValue))
-&gt; IntMap (finit, Maybe (FResult pred SValue))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue -&gt; IntMap (finit, Maybe (FResult pred SValue))
forall pred finit v.
L0 pred finit v -&gt; IntMap (finit, Maybe (FResult pred v))
</span><a href="Data.L0.html#l0_functions"><span class="hs-identifier hs-var">l0_functions</span></a></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue
</span><a href="#local-6989586621679406642"><span class="hs-identifier hs-var">l0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  (of which verification error):                &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap (finit, Maybe (FResult pred SValue)) -&gt; Int
forall a. IntMap a -&gt; Int
</span><span class="hs-identifier hs-var">IM.size</span></span><span> </span><span class="annot"><span class="annottext">(IntMap (finit, Maybe (FResult pred SValue)) -&gt; Int)
-&gt; IntMap (finit, Maybe (FResult pred SValue)) -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((finit, Maybe (FResult pred SValue)) -&gt; Bool)
-&gt; IntMap (finit, Maybe (FResult pred SValue))
-&gt; IntMap (finit, Maybe (FResult pred SValue))
forall a. (a -&gt; Bool) -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Postcondition pred -&gt; Bool
forall {pred}. Postcondition pred -&gt; Bool
</span><a href="#local-6989586621679406717"><span class="hs-identifier hs-var">is_error</span></a></span><span> </span><span class="annot"><span class="annottext">(Postcondition pred -&gt; Bool)
-&gt; ((finit, Maybe (FResult pred SValue)) -&gt; Postcondition pred)
-&gt; (finit, Maybe (FResult pred SValue))
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(finit, Maybe (FResult pred SValue)) -&gt; Postcondition pred
forall {a} {pred} {v}.
(a, Maybe (FResult pred v)) -&gt; Postcondition pred
</span><a href="#local-6989586621679406716"><span class="hs-identifier hs-var">get_post</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IntMap (finit, Maybe (FResult pred SValue))
 -&gt; IntMap (finit, Maybe (FResult pred SValue)))
-&gt; IntMap (finit, Maybe (FResult pred SValue))
-&gt; IntMap (finit, Maybe (FResult pred SValue))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue -&gt; IntMap (finit, Maybe (FResult pred SValue))
forall pred finit v.
L0 pred finit v -&gt; IntMap (finit, Maybe (FResult pred v))
</span><a href="Data.L0.html#l0_functions"><span class="hs-identifier hs-var">l0_functions</span></a></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue
</span><a href="#local-6989586621679406642"><span class="hs-identifier hs-var">l0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-83"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;----------&quot;</span></span><span>
</span><span id="line-84"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;OTHER:&quot;</span></span><span>
</span><span id="line-85"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;----------&quot;</span></span><span>     </span><span>
</span><span id="line-86"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;verificaton time: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue -&gt; [Char]
forall pred finit v. L0 pred finit v -&gt; [Char]
</span><a href="Data.L0.html#l0_time"><span class="hs-identifier hs-var">l0_time</span></a></span><span> </span><span class="annot"><span class="annottext">L0 pred finit SValue
</span><a href="#local-6989586621679406642"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-87"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-88"></span><span>   </span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-comment">--putStrLn $ show $ IM.filter is_error $ IM.map get_post $ l0_functions l0</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-comment">--putStrLn $ show $ IM.map get_cfg $ IM.filter (is_error . get_post) $ l0_functions l0</span><span>
</span><span id="line-91"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-92"></span><span>  </span><span id="local-6989586621679406716"><span class="annot"><span class="annottext">get_post :: (a, Maybe (FResult pred v)) -&gt; Postcondition pred
</span><a href="#local-6989586621679406716"><span class="hs-identifier hs-var hs-var">get_post</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679406719"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679406719"><span class="hs-identifier hs-var">finit</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.L0.html#FResult"><span class="hs-identifier hs-type">FResult</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679406721"><span class="annot"><span class="annottext">Postcondition pred
</span><a href="#local-6989586621679406721"><span class="hs-identifier hs-var">post</span></a></span></span><span> </span><span class="annot"><span class="annottext">Set Word64
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Set (VerificationCondition v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IntMap (PointerAnalysisResult v)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Postcondition pred
</span><a href="#local-6989586621679406721"><span class="hs-identifier hs-var">post</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span id="local-6989586621679406722"><span class="annot"><span class="annottext">get_cfg :: (a, Maybe (FResult pred v)) -&gt; CFG
</span><a href="#local-6989586621679406722"><span class="hs-identifier hs-var hs-var">get_cfg</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679406723"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679406723"><span class="hs-identifier hs-var">finit</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.L0.html#FResult"><span class="hs-identifier hs-type">FResult</span></a></span><span> </span><span id="local-6989586621679406724"><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679406724"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679406725"><span class="annot"><span class="annottext">Postcondition pred
</span><a href="#local-6989586621679406725"><span class="hs-identifier hs-var">post</span></a></span></span><span> </span><span class="annot"><span class="annottext">Set Word64
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Set (VerificationCondition v)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IntMap (PointerAnalysisResult v)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679406724"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621679406717"><span class="annot"><span class="annottext">is_error :: Postcondition pred -&gt; Bool
</span><a href="#local-6989586621679406717"><span class="hs-identifier hs-var hs-var">is_error</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.L0.html#VerificationError"><span class="hs-identifier hs-type">VerificationError</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, pred)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><a href="#local-6989586621679406717"><span class="hs-identifier hs-var">is_error</span></a></span><span> </span><span class="annot"><span class="annottext">Postcondition pred
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>  </span><span id="local-6989586621679406714"><span class="annot"><span class="annottext">is_unresolved :: Postcondition pred -&gt; Bool
</span><a href="#local-6989586621679406714"><span class="hs-identifier hs-var hs-var">is_unresolved</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.L0.html#HasUnresolvedIndirections"><span class="hs-identifier hs-type">HasUnresolvedIndirections</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><a href="#local-6989586621679406714"><span class="hs-identifier hs-var">is_unresolved</span></a></span><span> </span><span class="annot"><span class="annottext">Postcondition pred
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>  </span><span id="local-6989586621679406658"><span class="annot"><span class="annottext">l0_get_all_instructions :: L0 pred finit v -&gt; [Instruction]
</span><a href="#local-6989586621679406658"><span class="hs-identifier hs-var hs-var">l0_get_all_instructions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Instruction -&gt; [Instruction]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">S.toList</span></span><span> </span><span class="annot"><span class="annottext">(Set Instruction -&gt; [Instruction])
-&gt; (L0 pred finit v -&gt; Set Instruction)
-&gt; L0 pred finit v
-&gt; [Instruction]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Instruction] -&gt; Set Instruction
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Instruction] -&gt; Set Instruction)
-&gt; (L0 pred finit v -&gt; [Instruction])
-&gt; L0 pred finit v
-&gt; Set Instruction
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[Instruction]] -&gt; [Instruction]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Instruction]] -&gt; [Instruction])
-&gt; (L0 pred finit v -&gt; [[Instruction]])
-&gt; L0 pred finit v
-&gt; [Instruction]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CFG -&gt; [[Instruction]]) -&gt; [CFG] -&gt; [[Instruction]]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [Instruction] -&gt; [[Instruction]]
forall a. IntMap a -&gt; [a]
</span><span class="hs-identifier hs-var">IM.elems</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [Instruction] -&gt; [[Instruction]])
-&gt; (CFG -&gt; IntMap [Instruction]) -&gt; CFG -&gt; [[Instruction]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CFG -&gt; IntMap [Instruction]
</span><a href="Data.CFG.html#cfg_instrs"><span class="hs-identifier hs-var">cfg_instrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([CFG] -&gt; [[Instruction]])
-&gt; (L0 pred finit v -&gt; [CFG]) -&gt; L0 pred finit v -&gt; [[Instruction]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IntMap CFG -&gt; [CFG]
forall a. IntMap a -&gt; [a]
</span><span class="hs-identifier hs-var">IM.elems</span></span><span> </span><span class="annot"><span class="annottext">(IntMap CFG -&gt; [CFG])
-&gt; (L0 pred finit v -&gt; IntMap CFG) -&gt; L0 pred finit v -&gt; [CFG]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">L0 pred finit v -&gt; IntMap CFG
forall pred finit v. L0 pred finit v -&gt; IntMap CFG
</span><a href="Data.L0.html#l0_get_cfgs"><span class="hs-identifier hs-var">l0_get_cfgs</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span>  </span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span id="mk_metric_pointerDesignations"><span class="annot"><span class="annottext">mk_metric_pointerDesignations :: p -&gt; IntMap (PointerAnalysisResult SValue) -&gt; Map [Char] a
</span><a href="OutputGeneration.Metrics.html#mk_metric_pointerDesignations"><span class="hs-identifier hs-var hs-var">mk_metric_pointerDesignations</span></a></span></span><span> </span><span id="local-6989586621679406749"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406749"><span class="hs-identifier hs-var">bin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Map [Char] a -&gt; Map [Char] a)
-&gt; Map [Char] a -&gt; [[Char]] -&gt; Map [Char] a
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; [Char] -&gt; Map [Char] a -&gt; Map [Char] a
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.adjust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map [Char] a
</span><a href="#local-6989586621679406753"><span class="hs-identifier hs-var">init_m</span></a></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; Map [Char] a)
-&gt; (IntMap (PointerAnalysisResult SValue) -&gt; [[Char]])
-&gt; IntMap (PointerAnalysisResult SValue)
-&gt; Map [Char] a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Int, PointerAnalysisResult SValue) -&gt; [[Char]])
-&gt; [(Int, PointerAnalysisResult SValue)] -&gt; [[Char]]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">(Int, PointerAnalysisResult SValue) -&gt; [[Char]]
forall {p}. (p, PointerAnalysisResult SValue) -&gt; [[Char]]
</span><a href="#local-6989586621679406754"><span class="hs-identifier hs-var">get_specifity_per_instruction</span></a></span><span> </span><span class="annot"><span class="annottext">([(Int, PointerAnalysisResult SValue)] -&gt; [[Char]])
-&gt; (IntMap (PointerAnalysisResult SValue)
    -&gt; [(Int, PointerAnalysisResult SValue)])
-&gt; IntMap (PointerAnalysisResult SValue)
-&gt; [[Char]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IntMap (PointerAnalysisResult SValue)
-&gt; [(Int, PointerAnalysisResult SValue)]
forall a. IntMap a -&gt; [(Int, a)]
</span><span class="hs-identifier hs-var">IM.assocs</span></span><span>
</span><span id="line-107"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679406753"><span class="annot"><span class="annottext">init_m :: Map [Char] a
</span><a href="#local-6989586621679406753"><span class="hs-identifier hs-var hs-var">init_m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[([Char], a)] -&gt; Map [Char] a
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;U&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;CL&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;CG&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;CH&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;CLG&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;CLH&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;CGH&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;CLHG&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;AL&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;AG&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;AH&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ALG&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ALH&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;AGH&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ALHG&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621679406754"><span class="annot"><span class="annottext">get_specifity_per_instruction :: (p, PointerAnalysisResult SValue) -&gt; [[Char]]
</span><a href="#local-6989586621679406754"><span class="hs-identifier hs-var hs-var">get_specifity_per_instruction</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679406774"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406774"><span class="hs-identifier hs-var">entry</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="Data.VerificationCondition.html#PointerAnalysisResult"><span class="hs-identifier hs-type">PointerAnalysisResult</span></a></span><span> </span><span id="local-6989586621679406776"><span class="annot"><span class="annottext">Maybe SValue
</span><a href="#local-6989586621679406776"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679406777"><span class="annot"><span class="annottext">[Maybe SValue]
</span><a href="#local-6989586621679406777"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe SValue -&gt; [Char]) -&gt; [Maybe SValue] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; Maybe SValue -&gt; [Char]
forall {p}. p -&gt; Maybe SValue -&gt; [Char]
</span><a href="#local-6989586621679406778"><span class="hs-identifier hs-var">get_domains</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406774"><span class="hs-identifier hs-var">entry</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe SValue
</span><a href="#local-6989586621679406776"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- (w:rs) IF ALSO PRODUCING DATA OVER READS</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621679406778"><span class="annot"><span class="annottext">get_domains :: p -&gt; Maybe SValue -&gt; [Char]
</span><a href="#local-6989586621679406778"><span class="hs-identifier hs-var hs-var">get_domains</span></a></span></span><span> </span><span id="local-6989586621679406780"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406780"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe SValue
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Nothing&quot;</span></span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><a href="#local-6989586621679406778"><span class="hs-identifier hs-var">get_domains</span></a></span><span> </span><span id="local-6989586621679406781"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406781"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679406782"><span class="annot"><span class="annottext">SValue
</span><a href="#local-6989586621679406782"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p -&gt; SValue -&gt; [Char]
forall {p}. BinaryClass p =&gt; p -&gt; SValue -&gt; [Char]
</span><a href="OutputGeneration.Metrics.html#get_pointer_specifity_cpointer"><span class="hs-identifier hs-var">get_pointer_specifity_cpointer</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406749"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">SValue
</span><a href="#local-6989586621679406782"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- &quot;C&quot;     = Concrete</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- &quot;C+U&quot;   = Concrete plus unknown offset</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- &quot;U&quot;     = Unknown</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- &quot;A&quot;     = Addends</span><span>
</span><span id="line-120"></span><span id="get_pointer_specifity_cpointer"><span class="annot"><span class="annottext">get_pointer_specifity_cpointer :: p -&gt; SValue -&gt; [Char]
</span><a href="OutputGeneration.Metrics.html#get_pointer_specifity_cpointer"><span class="hs-identifier hs-var hs-var">get_pointer_specifity_cpointer</span></a></span></span><span> </span><span id="local-6989586621679406790"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406790"><span class="hs-identifier hs-var">bin</span></a></span></span><span> </span><span class="annot"><span class="annottext">SValue
</span><a href="Data.SValue.html#Top"><span class="hs-identifier hs-var">Top</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;U&quot;</span></span><span>
</span><span id="line-121"></span><span class="annot"><a href="OutputGeneration.Metrics.html#get_pointer_specifity_cpointer"><span class="hs-identifier hs-var">get_pointer_specifity_cpointer</span></a></span><span> </span><span id="local-6989586621679406792"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406792"><span class="hs-identifier hs-var">bin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SValue.html#SAddends"><span class="hs-identifier hs-type">SAddends</span></a></span><span> </span><span id="local-6989586621679406794"><span class="annot"><span class="annottext">NESet SimpleExpr
</span><a href="#local-6989586621679406794"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;A&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">p -&gt; NESet SimpleExpr -&gt; [Char]
forall {t :: * -&gt; *} {p}.
(Foldable t, BinaryClass p) =&gt;
p -&gt; t SimpleExpr -&gt; [Char]
</span><a href="OutputGeneration.Metrics.html#get_types"><span class="hs-identifier hs-var">get_types</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406792"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">NESet SimpleExpr
</span><a href="#local-6989586621679406794"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-122"></span><span class="annot"><a href="OutputGeneration.Metrics.html#get_pointer_specifity_cpointer"><span class="hs-identifier hs-var">get_pointer_specifity_cpointer</span></a></span><span> </span><span id="local-6989586621679406796"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406796"><span class="hs-identifier hs-var">bin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SValue.html#SConcrete"><span class="hs-identifier hs-type">SConcrete</span></a></span><span> </span><span id="local-6989586621679406798"><span class="annot"><span class="annottext">NESet SimpleExpr
</span><a href="#local-6989586621679406798"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;C&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">p -&gt; NESet SimpleExpr -&gt; [Char]
forall {t :: * -&gt; *} {p}.
(Foldable t, BinaryClass p) =&gt;
p -&gt; t SimpleExpr -&gt; [Char]
</span><a href="OutputGeneration.Metrics.html#get_types"><span class="hs-identifier hs-var">get_types</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406796"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">NESet SimpleExpr
</span><a href="#local-6989586621679406798"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span id="get_types"><span class="annot"><span class="annottext">get_types :: p -&gt; t SimpleExpr -&gt; [Char]
</span><a href="OutputGeneration.Metrics.html#get_types"><span class="hs-identifier hs-var hs-var">get_types</span></a></span></span><span> </span><span id="local-6989586621679406801"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406801"><span class="hs-identifier hs-var">bin</span></a></span></span><span> </span><span id="local-6989586621679406802"><span class="annot"><span class="annottext">t SimpleExpr
</span><a href="#local-6989586621679406802"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679406803"><span class="hs-identifier hs-var">local</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679406804"><span class="hs-identifier hs-var">global</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679406805"><span class="hs-identifier hs-var">heap</span></a></span><span>
</span><span id="line-125"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621679406803"><span class="annot"><span class="annottext">local :: [Char]
</span><a href="#local-6989586621679406803"><span class="hs-identifier hs-var hs-var">local</span></a></span></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(SimpleExpr -&gt; Bool) -&gt; t SimpleExpr -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; SimpleExpr -&gt; Bool
forall {bin}. BinaryClass bin =&gt; bin -&gt; SimpleExpr -&gt; Bool
</span><a href="WithNoAbstraction.Pointers.html#expr_is_maybe_local_pointer"><span class="hs-identifier hs-var">expr_is_maybe_local_pointer</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406801"><span class="hs-identifier hs-var">bin</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t SimpleExpr
</span><a href="#local-6989586621679406802"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;L&quot;</span></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679406804"><span class="annot"><span class="annottext">global :: [Char]
</span><a href="#local-6989586621679406804"><span class="hs-identifier hs-var hs-var">global</span></a></span></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(SimpleExpr -&gt; Bool) -&gt; t SimpleExpr -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; SimpleExpr -&gt; Bool
forall {bin}. BinaryClass bin =&gt; bin -&gt; SimpleExpr -&gt; Bool
</span><a href="WithNoAbstraction.Pointers.html#expr_is_maybe_global_pointer"><span class="hs-identifier hs-var">expr_is_maybe_global_pointer</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406801"><span class="hs-identifier hs-var">bin</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t SimpleExpr
</span><a href="#local-6989586621679406802"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;G&quot;</span></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-132"></span><span>  </span><span id="local-6989586621679406805"><span class="annot"><span class="annottext">heap :: [Char]
</span><a href="#local-6989586621679406805"><span class="hs-identifier hs-var hs-var">heap</span></a></span></span><span> </span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(SimpleExpr -&gt; Bool) -&gt; t SimpleExpr -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679406816"><span class="annot"><span class="annottext">SimpleExpr
</span><a href="#local-6989586621679406816"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; SimpleExpr -&gt; Bool
forall {bin}. BinaryClass bin =&gt; bin -&gt; SimpleExpr -&gt; Bool
</span><a href="WithNoAbstraction.Pointers.html#expr_is_maybe_global_pointer"><span class="hs-identifier hs-var">expr_is_maybe_global_pointer</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406801"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleExpr
</span><a href="#local-6989586621679406816"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; SimpleExpr -&gt; Bool
forall {bin}. BinaryClass bin =&gt; bin -&gt; SimpleExpr -&gt; Bool
</span><a href="WithNoAbstraction.Pointers.html#expr_is_maybe_local_pointer"><span class="hs-identifier hs-var">expr_is_maybe_local_pointer</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679406801"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleExpr
</span><a href="#local-6989586621679406816"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t SimpleExpr
</span><a href="#local-6989586621679406802"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;H&quot;</span></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><a href="OutputGeneration.Metrics.html#designations_to_percentages"><span class="hs-identifier hs-type">designations_to_percentages</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-138"></span><span id="designations_to_percentages"><span class="annot"><span class="annottext">designations_to_percentages :: Map [Char] Int -&gt; Map [Char] Double
</span><a href="OutputGeneration.Metrics.html#designations_to_percentages"><span class="hs-identifier hs-var hs-var">designations_to_percentages</span></a></span></span><span> </span><span id="local-6989586621679406819"><span class="annot"><span class="annottext">Map [Char] Int
</span><a href="#local-6989586621679406819"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; Map [Char] Int -&gt; Map [Char] Double
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">M.map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679406821"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679406821"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Double
forall {a} {b}. (Integral a, Integral b) =&gt; a -&gt; b -&gt; Double
</span><a href="#local-6989586621679406822"><span class="hs-identifier hs-var">mk_percentage</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679406821"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; Int -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; [Int] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map [Char] Int -&gt; [Int]
forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">M.elems</span></span><span> </span><span class="annot"><span class="annottext">Map [Char] Int
</span><a href="#local-6989586621679406819"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map [Char] Int
</span><a href="#local-6989586621679406819"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-139"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>  </span><span id="local-6989586621679406822"><span class="annot"><span class="annottext">mk_percentage :: a -&gt; b -&gt; Double
</span><a href="#local-6989586621679406822"><span class="hs-identifier hs-var hs-var">mk_percentage</span></a></span></span><span> </span><span id="local-6989586621679406856"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679406856"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679406857"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679406857"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Base.html#round2dp"><span class="hs-identifier hs-var">round2dp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679406856"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Double
forall {a} {b}. (Integral a, Integral b) =&gt; a -&gt; b -&gt; Double
</span><a href="OutputGeneration.Metrics.html#intDiv"><span class="hs-operator hs-var">`intDiv`</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679406857"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span id="local-6989586621679406859"><span id="local-6989586621679406860"><span class="annot"><a href="OutputGeneration.Metrics.html#intDiv"><span class="hs-identifier hs-type">intDiv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679406859"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679406860"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679406859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679406860"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span></span><span>
</span><span id="line-143"></span><span id="local-6989586621679406868"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679406868"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="intDiv"><span class="annot"><span class="annottext">intDiv :: forall {a} {b}. (Integral a, Integral b) =&gt; a -&gt; b -&gt; Double
</span><a href="OutputGeneration.Metrics.html#intDiv"><span class="hs-operator hs-var hs-var">`intDiv`</span></a></span></span><span> </span><span id="local-6989586621679406869"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679406869"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679406868"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679406869"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">{--

metrics = M.fromList [
  (&quot;#instructions&quot;,          &quot;number of covered instructions&quot;),
  (&quot;avgInstructionSize&quot;,     &quot;average instruction size&quot;),
  (&quot;#expectedInstructions&quot;,  &quot;expected number of instructions&quot;),
  (&quot;%instructionCoverage&quot;,   &quot;estimate of percentage of covered instructions&quot;),
  (&quot;#memWrites&quot;,             &quot;total number of instructions writing to memory&quot;),
  (&quot;pointerDesignations&quot;,    &quot;A, C, C+U, U&quot;),
  (&quot;%resolvedMemWrites&quot;,     &quot;percentage of pointers that are assigned a non-trivial domain&quot;),
  (&quot;specifityMetric&quot;,        &quot;weighted mean of pointer designations&quot;),

  (&quot;#functions&quot;,             &quot;total number of functions&quot;),
  (&quot;#functions_verified&quot;,    &quot;total number of verified functions&quot;),
  (&quot;#functions_unresolved&quot;,  &quot;total number of functions with unresolved indirections&quot;),
  (&quot;#functions_verif_error&quot;, &quot;total number of functions with verification error&quot;),

  (&quot;#resolved_jumps&quot;,        &quot;total number of resolved jumps&quot;),
  (&quot;#resolved_calls&quot;,        &quot;total number of resolved calls&quot;),
  (&quot;#unresolved_jumps&quot;,      &quot;total number of unresolved jumps&quot;),
  (&quot;#unresolved_calls&quot;,      &quot;total number of unresolved calls&quot;),

  (&quot;runningTime&quot;,            &quot;Running time in HH:MM:SS&quot;)
 ]


-- | Returns all generated metrics in JSON and pretty-printed
mk_metrics :: Context -&gt; (String,String)
mk_metrics ctxt =
  let instrs                          = S.toList $ ctxt_get_instructions ctxt
      avg_size                        = average $ map sizeof instrs
      text_section_size               = binary_text_section_size $ ctxt_binary ctxt
      num_expected_intrs              = floor (fromIntegral text_section_size / avg_size)
      num_intrs                       = length instrs
      instructionCoverage             = round2dp (fromIntegral num_intrs / fromIntegral num_expected_intrs * 100)
      mem_ops                         = ctxt_resolve_mem_operands ctxt
      pointerDesignations             = mk_metric_pointerDesignations ctxt mem_ops 
      pointerDesignationsPercentages  = designations_to_percentages pointerDesignations
      memWrites                       = sum $ M.elems pointerDesignations
      specifityMetric                 = specifityMetricOf pointerDesignationsPercentages
      resolvedMemWrites               = percentageResolvedMemWrites pointerDesignationsPercentages

      num_functions                   = IM.size $ ctxt_results ctxt
      num_verif_success               = num_of_verif_success ctxt
      num_verif_unresolved            = num_of_verif_unresolved ctxt
      num_verif_error                 = num_of_verif_error ctxt

      resolved_jumps                  = num_of_resolved_indirection_jumps ctxt
      resolved_calls                  = num_of_resolved_indirection_calls ctxt
      unresolved_jumps                = num_of_unres_inds ctxt isJump
      unresolved_calls                = num_of_unres_inds ctxt isCall

      runningTimeRepr                 = show_runningtime $ ctxt_runningtime ctxt

      metrics = map mk_metric [
                 (&quot;#instructions&quot;,            show num_intrs),
                 (&quot;avgInstructionSize&quot;,       show avg_size),
                 (&quot;#expectedInstructions&quot;,    show num_expected_intrs),
                 (&quot;%instructionCoverage&quot;,     show instructionCoverage),
                 (&quot;#memWrites&quot;,               show memWrites),
                 (&quot;pointerDesignations&quot;,      show $ M.toList pointerDesignationsPercentages),
                 (&quot;%resolvedMemWrites&quot;,       show resolvedMemWrites),
                 (&quot;specifityMetric&quot;,          show specifityMetric),
                 (&quot;#functions&quot;,               show num_functions),
                 (&quot;#functions_verified&quot;,      show num_verif_success),
                 (&quot;#functions_unresolved&quot;,    show num_verif_unresolved),
                 (&quot;#functions_verif_error&quot;,   show num_verif_error),
                 (&quot;#resolved_jumps&quot;,          show resolved_jumps),
                 (&quot;#resolved_calls&quot;,          show resolved_calls),
                 (&quot;#unresolved_jumps&quot;,        show unresolved_jumps),
                 (&quot;#unresolved_calls&quot;,        show unresolved_calls),
                 (&quot;runningTime&quot;,              runningTimeRepr)
                ] in
  (unpack $ encode metrics,intercalate &quot;\n&quot; $ map show_metric metrics)
 where
  mk_metric (name,value) = Metric name (metrics M.! name) value


  show_metric (Metric name desc value) =
    let str0 = name ++ replicate (metrics_metric_size - length name + 3) ' '
        str1 = str0 ++ &quot; (&quot; ++ desc ++ &quot;)&quot; in
      str1 ++ replicate (metrics_descr_size - length desc) ' ' ++ &quot; = &quot; ++ value

  designations_to_percentages :: M.Map String Int -&gt; M.Map String Double
  designations_to_percentages m = M.map (\v -&gt; mk_percentage v $ sum $ M.elems m) m
  
  mk_percentage x y = round2dp (x `intDiv` y * 100)


-- | Show time in HH:MM:SS
show_runningtime :: Int64 -&gt; String
show_runningtime secs = show hours ++ &quot;:&quot; ++ show minutes ++ &quot;:&quot; ++ show seconds
 where
  (hours,rem_hour)  = secs `divMod` 3600
  (minutes,seconds) = rem_hour `divMod` 60

-- | Number of functions successfully verified
num_of_verif_success = IM.size . IM.filter isVerificationSuccess . ctxt_results
 where
  isVerificationSuccess VerificationSuccess               = True
  isVerificationSuccess VerificationSuccesWithAssumptions = True
  isVerificationSuccess _                                 = False

-- | Number of functions with unresolved indirections
num_of_verif_unresolved = IM.size . IM.filter ((==) VerificationUnresolvedIndirection) . ctxt_results

-- | Number of functions with a verification error
num_of_verif_error = IM.size . IM.filter isVerificationError . ctxt_results
 where
  isVerificationError (VerificationError _) = True
  isVerificationError _                     = False

-- | Number of unresolved indirections
num_of_unres_inds ctxt chkKind = sum (map (num_of_unres_inds_in_cfg ctxt chkKind) $ IM.elems $ ctxt_cfgs ctxt)

-- | Number of unresolved indirections in the given CFG
num_of_unres_inds_in_cfg ctxt chkKind g = 
  let blocks  = IM.keys $ cfg_blocks g in
    length (filter (\b -&gt; node_info_of ctxt g b == UnresolvedIndirection &amp;&amp; ends_in_kind b) blocks)
 where
  ends_in_kind b = chkKind $ opcode $ last (fetch_block g b)

-- | Number of resolved indirections
num_of_resolved_indirection_calls ctxt = IM.size $ IM.filterWithKey (indirectionIsCall ctxt) $ ctxt_inds ctxt
 where
  indirectionIsCall ctxt a _ =
    case unsafePerformIO $ Analysis.Context.fetch_instruction ctxt $ fromIntegral a of -- Should be safe as result is immutable.
      Nothing -&gt; False
      Just i  -&gt; isCall $ opcode i
num_of_resolved_indirection_jumps ctxt = IM.size $ IM.filterWithKey (indirectionIsJump ctxt) $ ctxt_inds ctxt
 where
  indirectionIsJump ctxt a _ =
    case unsafePerformIO $ Analysis.Context.fetch_instruction ctxt $ fromIntegral a of -- Should be safe as result is immutable.
      Nothing -&gt; False
      Just i  -&gt; not $ isCall $ opcode i


-- | Number of instructions in CFG
num_of_instructions g = sum (map length $ IM.elems $ cfg_blocks g)

-- | Number of basic blocks in CFG
num_of_blocks g = IM.size $ cfg_blocks g

-- | Number of edges in CFG
num_of_edges g = sum (map IS.size $ IM.elems $ cfg_edges g)



percentageResolvedMemWrites :: M.Map String Double -&gt; Double
percentageResolvedMemWrites m = 100 - m M.! &quot;U&quot;


specifityMetricOf :: M.Map String Double -&gt; Double
specifityMetricOf m = m M.! &quot;C&quot; + 0.8*(m M.! &quot;A&quot;) + 0.6*(m M.! &quot;A&quot;)



metrics_metric_size = maximum $ map length $ M.keys metrics
metrics_descr_size  = maximum $ map length $ M.elems metrics


round2dp :: Double -&gt; Double
round2dp x = fromIntegral (round $ x * 1e2) / 1e2



intDiv :: (Integral a,Integral b) =&gt; a -&gt; b -&gt; Double
x `intDiv` y = fromIntegral x / fromIntegral y

data Metric = Metric {
  metrics_name  :: String, -- ^ Name of the metric
  metrics_desc  :: String, -- ^ Description of the metric
  metrics_value :: String  -- ^ Serialized value of the metric
 }
 deriving Generic

instance ToJSON Metric where
  toJSON = genericToJSON defaultOptions { sumEncoding = ObjectWithSingleField }

--}</span><span>
</span><span id="line-326"></span></pre></body></html>