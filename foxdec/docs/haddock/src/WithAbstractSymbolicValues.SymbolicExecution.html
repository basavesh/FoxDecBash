<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveGeneric, MultiParamTypeClasses, FunctionalDependencies, FlexibleContexts, StrictData #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">WithAbstractSymbolicValues.SymbolicExecution</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Base.html"><span class="hs-identifier">Base</span></a></span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html"><span class="hs-identifier">WithAbstractSymbolicValues.Class</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.FInit.html"><span class="hs-identifier">WithAbstractSymbolicValues.FInit</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Sstate.html"><span class="hs-identifier">WithAbstractSymbolicValues.Sstate</span></a></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Size.html"><span class="hs-identifier">Data.Size</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X86.Opcode.html"><span class="hs-identifier">Data.X86.Opcode</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html"><span class="hs-identifier">Data.X86.Instruction</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X86.Register.html"><span class="hs-identifier">Data.X86.Register</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SymbolicExpression.html"><span class="hs-identifier">Data.SymbolicExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SymbolicExpression.html#FlagStatus"><span class="hs-identifier">FlagStatus</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- TODO</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.JumpTarget.html"><span class="hs-identifier">Data.JumpTarget</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Indirection.html"><span class="hs-identifier">Data.Indirection</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.VerificationCondition.html"><span class="hs-identifier">Data.VerificationCondition</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Serialize</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Cereal</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IS</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IM</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NES</span></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">partition</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">intersectBy</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">nub</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span> </span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Extra</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State.Strict</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">join</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="annot"><span class="hs-comment">-- | Add a function_pointer_intro to the given symbolic predicate</span></span><span>
</span><span id="line-43"></span><span id="add_function_pointer"><span class="annot"><span class="annottext">add_function_pointer :: Word64
-&gt; Key
-&gt; (a, Set (VerificationCondition v))
-&gt; (a, Set (VerificationCondition v))
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#add_function_pointer"><span class="hs-identifier hs-var hs-var">add_function_pointer</span></a></span></span><span> </span><span id="local-6989586621679403813"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679403813"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679403814"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679403814"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679403815"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403815"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679403816"><span class="annot"><span class="annottext">Set (VerificationCondition v)
</span><a href="#local-6989586621679403816"><span class="hs-identifier hs-var">vcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679403817"><span class="annot"><span class="annottext">Set (VerificationCondition v)
</span><a href="#local-6989586621679403817"><span class="hs-identifier hs-var">match</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679403818"><span class="annot"><span class="annottext">Set (VerificationCondition v)
</span><a href="#local-6989586621679403818"><span class="hs-identifier hs-var">remainder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VerificationCondition v -&gt; Bool)
-&gt; Set (VerificationCondition v)
-&gt; (Set (VerificationCondition v), Set (VerificationCondition v))
forall a. (a -&gt; Bool) -&gt; Set a -&gt; (Set a, Set a)
</span><span class="hs-identifier hs-var">S.partition</span></span><span> </span><span class="annot"><span class="annottext">VerificationCondition v -&gt; Bool
forall {v}. VerificationCondition v -&gt; Bool
</span><a href="#local-6989586621679403820"><span class="hs-identifier hs-var">belongs_to_a</span></a></span><span> </span><span class="annot"><span class="annottext">Set (VerificationCondition v)
</span><a href="#local-6989586621679403816"><span class="hs-identifier hs-var">vcs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Set (VerificationCondition v) -&gt; [VerificationCondition v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">S.toList</span></span><span> </span><span class="annot"><span class="annottext">Set (VerificationCondition v)
</span><a href="#local-6989586621679403817"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-46"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403815"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">VerificationCondition v
-&gt; Set (VerificationCondition v) -&gt; Set (VerificationCondition v)
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">S.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; IntSet -&gt; VerificationCondition v
forall v. Word64 -&gt; IntSet -&gt; VerificationCondition v
</span><a href="Data.VerificationCondition.html#FunctionPointers"><span class="hs-identifier hs-var">FunctionPointers</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679403813"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(IntSet -&gt; VerificationCondition v)
-&gt; IntSet -&gt; VerificationCondition v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; IntSet
</span><span class="hs-identifier hs-var">IS.singleton</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679403814"><span class="hs-identifier hs-var">ptr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (VerificationCondition v)
</span><a href="#local-6989586621679403818"><span class="hs-identifier hs-var">remainder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="Data.VerificationCondition.html#FunctionPointers"><span class="hs-identifier hs-type">FunctionPointers</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679403825"><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679403825"><span class="hs-identifier hs-var">ptrs'</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403815"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">VerificationCondition v
-&gt; Set (VerificationCondition v) -&gt; Set (VerificationCondition v)
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">S.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; IntSet -&gt; VerificationCondition v
forall v. Word64 -&gt; IntSet -&gt; VerificationCondition v
</span><a href="Data.VerificationCondition.html#FunctionPointers"><span class="hs-identifier hs-var">FunctionPointers</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679403813"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(IntSet -&gt; VerificationCondition v)
-&gt; IntSet -&gt; VerificationCondition v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; IntSet -&gt; IntSet
</span><span class="hs-identifier hs-var">IS.insert</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679403814"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679403825"><span class="hs-identifier hs-var">ptrs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (VerificationCondition v)
</span><a href="#local-6989586621679403818"><span class="hs-identifier hs-var">remainder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>  </span><span id="local-6989586621679403820"><span class="annot"><span class="annottext">belongs_to_a :: VerificationCondition v -&gt; Bool
</span><a href="#local-6989586621679403820"><span class="hs-identifier hs-var hs-var">belongs_to_a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.VerificationCondition.html#FunctionPointers"><span class="hs-identifier hs-type">FunctionPointers</span></a></span><span> </span><span id="local-6989586621679403828"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679403828"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679403813"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679403828"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><a href="#local-6989586621679403820"><span class="hs-identifier hs-var">belongs_to_a</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationCondition v
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span id="add_pa_result"><span class="annot"><span class="annottext">add_pa_result :: Word64
-&gt; PointerAnalysisResult v
-&gt; (a, Set (VerificationCondition v))
-&gt; (a, Set (VerificationCondition v))
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#add_pa_result"><span class="hs-identifier hs-var hs-var">add_pa_result</span></a></span></span><span> </span><span id="local-6989586621679403835"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679403835"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679403836"><span class="annot"><span class="annottext">PointerAnalysisResult v
</span><a href="#local-6989586621679403836"><span class="hs-identifier hs-var">par</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679403837"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403837"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679403838"><span class="annot"><span class="annottext">Set (VerificationCondition v)
</span><a href="#local-6989586621679403838"><span class="hs-identifier hs-var">vcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403837"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">VerificationCondition v
-&gt; Set (VerificationCondition v) -&gt; Set (VerificationCondition v)
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">S.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; PointerAnalysisResult v -&gt; VerificationCondition v
forall v.
Word64 -&gt; PointerAnalysisResult v -&gt; VerificationCondition v
</span><a href="Data.VerificationCondition.html#PointerAnalysis"><span class="hs-identifier hs-var">PointerAnalysis</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679403835"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PointerAnalysisResult v
</span><a href="#local-6989586621679403836"><span class="hs-identifier hs-var">par</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (VerificationCondition v)
</span><a href="#local-6989586621679403838"><span class="hs-identifier hs-var">vcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><span class="hs-comment">-- | Given the address of an operand of an instruction, resolve it given the current state.</span></span><span>
</span><span id="line-66"></span><span id="local-6989586621679403545"><span id="local-6989586621679403546"><span id="local-6989586621679403547"><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sresolve_address"><span class="hs-identifier hs-type">sresolve_address</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#WithAbstractSymbolicValues"><span class="hs-identifier hs-type">WithAbstractSymbolicValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403545"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403546"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403547"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403545"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403546"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403547"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.VerificationCondition.html#VCS"><span class="hs-identifier hs-type">VCS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403546"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679403546"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-67"></span><span id="sresolve_address"><span class="annot"><span class="annottext">sresolve_address :: forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Operand -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sresolve_address"><span class="hs-identifier hs-var hs-var">sresolve_address</span></a></span></span><span> </span><span id="local-6989586621679403883"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403883"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Mem"><span class="hs-identifier hs-type">Op_Mem</span></a></span><span> </span><span id="local-6989586621679403885"><span class="annot"><span class="annottext">BitSize
</span><a href="#local-6989586621679403885"><span class="hs-identifier hs-var">si</span></a></span></span><span> </span><span id="local-6989586621679403886"><span class="annot"><span class="annottext">BitSize
</span><a href="#local-6989586621679403886"><span class="hs-identifier hs-var">aSi</span></a></span></span><span> </span><span id="local-6989586621679403887"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679403887"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621679403888"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679403888"><span class="hs-identifier hs-var">idx</span></a></span></span><span> </span><span id="local-6989586621679403889"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679403889"><span class="hs-identifier hs-var">scale</span></a></span></span><span> </span><span id="local-6989586621679403890"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679403890"><span class="hs-identifier hs-var">displ</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679403891"><span class="annot"><span class="annottext">SReg
</span><a href="#local-6989586621679403891"><span class="hs-identifier hs-var">seg</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-68"></span><span>  </span><span id="local-6989586621679403892"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679403892"><span class="hs-identifier hs-var">ra0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Operand -&gt; State (Sstate v p, VCS v) v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Operand -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sresolve_address"><span class="hs-identifier hs-var">sresolve_address</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403883"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BitSize
-&gt; BitSize
-&gt; Register
-&gt; Register
-&gt; Word8
-&gt; Key
-&gt; Maybe SReg
-&gt; Operand
</span><a href="Data.X86.Instruction.html#Op_Mem"><span class="hs-identifier hs-var">Op_Mem</span></a></span><span> </span><span class="annot"><span class="annottext">BitSize
</span><a href="#local-6989586621679403885"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; BitSize
</span><a href="Data.Size.html#BitSize"><span class="hs-identifier hs-var">BitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679403887"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679403888"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679403889"><span class="hs-identifier hs-var">scale</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679403890"><span class="hs-identifier hs-var">displ</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SReg
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>  </span><span id="local-6989586621679403894"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679403894"><span class="hs-identifier hs-var">ra1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Register -&gt; State (Sstate v p, VCS v) v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Register -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.Sstate.html#sread_reg"><span class="hs-identifier hs-var">sread_reg</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403883"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; State (Sstate v p, VCS v) v)
-&gt; Register -&gt; State (Sstate v p, VCS v) v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SReg -&gt; Register
</span><a href="Data.X86.Register.html#RegSeg"><span class="hs-identifier hs-var">RegSeg</span></a></span><span> </span><span class="annot"><span class="annottext">SReg
</span><a href="#local-6989586621679403891"><span class="hs-identifier hs-var">seg</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><span class="annottext">v -&gt; State (Sstate v p, VCS v) v
forall a. a -&gt; StateT (Sstate v p, VCS v) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; State (Sstate v p, VCS v) v)
-&gt; v -&gt; State (Sstate v p, VCS v) v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; SymbolicOperation v -&gt; v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; SymbolicOperation v -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#ssemantics"><span class="hs-identifier hs-var">ssemantics</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403883"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;plus&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SymbolicOperation v -&gt; v) -&gt; SymbolicOperation v -&gt; v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; SymbolicOperation v
forall v. v -&gt; v -&gt; SymbolicOperation v
</span><a href="WithAbstractSymbolicValues.Class.html#SO_Plus"><span class="hs-identifier hs-var">SO_Plus</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679403892"><span class="hs-identifier hs-var">ra0</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679403894"><span class="hs-identifier hs-var">ra1</span></a></span><span>
</span><span id="line-71"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sresolve_address"><span class="hs-identifier hs-var">sresolve_address</span></a></span><span> </span><span id="local-6989586621679403899"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403899"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Mem"><span class="hs-identifier hs-type">Op_Mem</span></a></span><span> </span><span id="local-6989586621679403900"><span class="annot"><span class="annottext">BitSize
</span><a href="#local-6989586621679403900"><span class="hs-identifier hs-var">si</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#BitSize"><span class="hs-identifier hs-type">BitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679403901"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679403901"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621679403902"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679403902"><span class="hs-identifier hs-var">idx</span></a></span></span><span> </span><span id="local-6989586621679403903"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679403903"><span class="hs-identifier hs-var">scale</span></a></span></span><span> </span><span id="local-6989586621679403904"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679403904"><span class="hs-identifier hs-var">displ</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe SReg
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679403903"><span class="hs-identifier hs-var">scale</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679403902"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Register -&gt; Register -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="Data.X86.Register.html#RegNone"><span class="hs-identifier hs-var">RegNone</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621679403908"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679403908"><span class="hs-identifier hs-var">idx_val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Register -&gt; State (Sstate v p, VCS v) v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Register -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.Sstate.html#sread_reg"><span class="hs-identifier hs-var">sread_reg</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403899"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679403902"><span class="hs-identifier hs-var">idx</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679403921"><span class="annot"><span class="annottext">ra1 :: v
</span><a href="#local-6989586621679403921"><span class="hs-identifier hs-var hs-var">ra1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; SymbolicOperation v -&gt; v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; SymbolicOperation v -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#ssemantics"><span class="hs-identifier hs-var">ssemantics</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403899"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;times&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SymbolicOperation v -&gt; v) -&gt; SymbolicOperation v -&gt; v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; SymbolicOperation v
forall v. v -&gt; v -&gt; SymbolicOperation v
</span><a href="WithAbstractSymbolicValues.Class.html#SO_Times"><span class="hs-identifier hs-var">SO_Times</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679403908"><span class="hs-identifier hs-var">idx_val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ctxt -&gt; Word8 -&gt; v
forall i. Integral i =&gt; ctxt -&gt; i -&gt; v
forall ctxt v p i.
(WithAbstractSymbolicValues ctxt v p, Integral i) =&gt;
ctxt -&gt; i -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#simmediate"><span class="hs-identifier hs-var">simmediate</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403899"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679403903"><span class="hs-identifier hs-var">scale</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>    </span><span id="local-6989586621679403924"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679403924"><span class="hs-identifier hs-var">ra0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Register -&gt; Key -&gt; State (Sstate v p, VCS v) v
forall {a} {ctxt} {a} {p}.
(Integral a, WithAbstractSymbolicValues ctxt a p) =&gt;
ctxt -&gt; Register -&gt; a -&gt; StateT (Sstate a p, VCS a) Identity a
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#add_base_displ"><span class="hs-identifier hs-var">add_base_displ</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403899"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679403901"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679403904"><span class="hs-identifier hs-var">displ</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="annottext">v -&gt; State (Sstate v p, VCS v) v
forall a. a -&gt; StateT (Sstate v p, VCS v) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; State (Sstate v p, VCS v) v)
-&gt; v -&gt; State (Sstate v p, VCS v) v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; SymbolicOperation v -&gt; v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; SymbolicOperation v -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#ssemantics"><span class="hs-identifier hs-var">ssemantics</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403899"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;plus&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SymbolicOperation v -&gt; v) -&gt; SymbolicOperation v -&gt; v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; SymbolicOperation v
forall v. v -&gt; v -&gt; SymbolicOperation v
</span><a href="WithAbstractSymbolicValues.Class.html#SO_Plus"><span class="hs-identifier hs-var">SO_Plus</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679403924"><span class="hs-identifier hs-var">ra0</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679403921"><span class="hs-identifier hs-var">ra1</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Register -&gt; Key -&gt; State (Sstate v p, VCS v) v
forall {a} {ctxt} {a} {p}.
(Integral a, WithAbstractSymbolicValues ctxt a p) =&gt;
ctxt -&gt; Register -&gt; a -&gt; StateT (Sstate a p, VCS a) Identity a
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#add_base_displ"><span class="hs-identifier hs-var">add_base_displ</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403899"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679403901"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679403904"><span class="hs-identifier hs-var">displ</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span id="add_base_displ"><span class="annot"><span class="annottext">add_base_displ :: ctxt -&gt; Register -&gt; a -&gt; StateT (Sstate a p, VCS a) Identity a
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#add_base_displ"><span class="hs-identifier hs-var hs-var">add_base_displ</span></a></span></span><span> </span><span id="local-6989586621679403970"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403970"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="Data.X86.Register.html#RegNone"><span class="hs-identifier hs-var">RegNone</span></a></span><span> </span><span id="local-6989586621679403971"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403971"><span class="hs-identifier hs-var">displ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; StateT (Sstate a p, VCS a) Identity a
forall a. a -&gt; StateT (Sstate a p, VCS a) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; StateT (Sstate a p, VCS a) Identity a)
-&gt; a -&gt; StateT (Sstate a p, VCS a) Identity a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Word64 -&gt; a
forall i. Integral i =&gt; ctxt -&gt; i -&gt; a
forall ctxt v p i.
(WithAbstractSymbolicValues ctxt v p, Integral i) =&gt;
ctxt -&gt; i -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#simmediate"><span class="hs-identifier hs-var">simmediate</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403970"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403971"><span class="hs-identifier hs-var">displ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#add_base_displ"><span class="hs-identifier hs-var">add_base_displ</span></a></span><span> </span><span id="local-6989586621679403972"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403972"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679403973"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679403973"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621679403974"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403974"><span class="hs-identifier hs-var">displ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-81"></span><span>  </span><span id="local-6989586621679403975"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403975"><span class="hs-identifier hs-var">ra0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Register -&gt; StateT (Sstate a p, VCS a) Identity a
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Register -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.Sstate.html#sread_reg"><span class="hs-identifier hs-var">sread_reg</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403972"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679403973"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><span class="annottext">a -&gt; StateT (Sstate a p, VCS a) Identity a
forall a. a -&gt; StateT (Sstate a p, VCS a) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; StateT (Sstate a p, VCS a) Identity a)
-&gt; a -&gt; StateT (Sstate a p, VCS a) Identity a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; SymbolicOperation a -&gt; a
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; SymbolicOperation v -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#ssemantics"><span class="hs-identifier hs-var">ssemantics</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403972"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;plus&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SymbolicOperation a -&gt; a) -&gt; SymbolicOperation a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; SymbolicOperation a
forall v. v -&gt; v -&gt; SymbolicOperation v
</span><a href="WithAbstractSymbolicValues.Class.html#SO_Plus"><span class="hs-identifier hs-var">SO_Plus</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403975"><span class="hs-identifier hs-var">ra0</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; SymbolicOperation a) -&gt; a -&gt; SymbolicOperation a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Word64 -&gt; a
forall i. Integral i =&gt; ctxt -&gt; i -&gt; a
forall ctxt v p i.
(WithAbstractSymbolicValues ctxt v p, Integral i) =&gt;
ctxt -&gt; i -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#simmediate"><span class="hs-identifier hs-var">simmediate</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679403972"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403974"><span class="hs-identifier hs-var">displ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span id="local-6989586621679403583"><span id="local-6989586621679403584"><span id="local-6989586621679403585"><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sread_operand"><span class="hs-identifier hs-type">sread_operand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#WithAbstractSymbolicValues"><span class="hs-identifier hs-type">WithAbstractSymbolicValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403583"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403584"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403585"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403583"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403584"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403585"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.VerificationCondition.html#VCS"><span class="hs-identifier hs-type">VCS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403584"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679403584"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-87"></span><span class="hs-comment">--sread_operand ctxt msg op | trace (&quot;sgeneric_cinstr: &quot;++ show op) False = error &quot;trace&quot;</span><span>
</span><span id="line-88"></span><span id="sread_operand"><span class="annot"><span class="annottext">sread_operand :: forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; Operand -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sread_operand"><span class="hs-identifier hs-var hs-var">sread_operand</span></a></span></span><span> </span><span id="local-6989586621679404026"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404026"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404027"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404027"><span class="hs-identifier hs-var">msg</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Imm"><span class="hs-identifier hs-type">Op_Imm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#BitSize"><span class="hs-identifier hs-type">BitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679404030"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404030"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; StateT (Sstate v p, VCS v) Identity v
forall a. a -&gt; StateT (Sstate v p, VCS v) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; StateT (Sstate v p, VCS v) Identity v)
-&gt; v -&gt; StateT (Sstate v p, VCS v) Identity v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Word64 -&gt; v
forall i. Integral i =&gt; ctxt -&gt; i -&gt; v
forall ctxt v p i.
(WithAbstractSymbolicValues ctxt v p, Integral i) =&gt;
ctxt -&gt; i -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#simmediate"><span class="hs-identifier hs-var">simmediate</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404026"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404030"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-89"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sread_operand"><span class="hs-identifier hs-var">sread_operand</span></a></span><span> </span><span id="local-6989586621679404031"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404031"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404032"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404032"><span class="hs-identifier hs-var">msg</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Imm"><span class="hs-identifier hs-type">Op_Imm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#BitSize"><span class="hs-identifier hs-type">BitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679404033"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404033"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; StateT (Sstate v p, VCS v) Identity v
forall a. a -&gt; StateT (Sstate v p, VCS v) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; StateT (Sstate v p, VCS v) Identity v)
-&gt; v -&gt; StateT (Sstate v p, VCS v) Identity v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Word64 -&gt; v
forall i. Integral i =&gt; ctxt -&gt; i -&gt; v
forall ctxt v p i.
(WithAbstractSymbolicValues ctxt v p, Integral i) =&gt;
ctxt -&gt; i -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#simmediate"><span class="hs-identifier hs-var">simmediate</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404031"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; v) -&gt; Word64 -&gt; v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
forall {a}. (Bits a, Num a) =&gt; a -&gt; a
</span><a href="Base.html#sextend_32_64"><span class="hs-identifier hs-var">sextend_32_64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404033"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-90"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sread_operand"><span class="hs-identifier hs-var">sread_operand</span></a></span><span> </span><span id="local-6989586621679404035"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404035"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404036"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404036"><span class="hs-identifier hs-var">msg</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Imm"><span class="hs-identifier hs-type">Op_Imm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#BitSize"><span class="hs-identifier hs-type">BitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679404037"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404037"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; StateT (Sstate v p, VCS v) Identity v
forall a. a -&gt; StateT (Sstate v p, VCS v) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; StateT (Sstate v p, VCS v) Identity v)
-&gt; v -&gt; StateT (Sstate v p, VCS v) Identity v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Word64 -&gt; v
forall i. Integral i =&gt; ctxt -&gt; i -&gt; v
forall ctxt v p i.
(WithAbstractSymbolicValues ctxt v p, Integral i) =&gt;
ctxt -&gt; i -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#simmediate"><span class="hs-identifier hs-var">simmediate</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404035"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; v) -&gt; Word64 -&gt; v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
forall {a}. (Bits a, Num a) =&gt; a -&gt; a
</span><a href="Base.html#sextend_16_64"><span class="hs-identifier hs-var">sextend_16_64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404037"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-91"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sread_operand"><span class="hs-identifier hs-var">sread_operand</span></a></span><span> </span><span id="local-6989586621679404039"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404039"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404040"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404040"><span class="hs-identifier hs-var">msg</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Imm"><span class="hs-identifier hs-type">Op_Imm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#BitSize"><span class="hs-identifier hs-type">BitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679404041"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404041"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; StateT (Sstate v p, VCS v) Identity v
forall a. a -&gt; StateT (Sstate v p, VCS v) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; StateT (Sstate v p, VCS v) Identity v)
-&gt; v -&gt; StateT (Sstate v p, VCS v) Identity v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Word64 -&gt; v
forall i. Integral i =&gt; ctxt -&gt; i -&gt; v
forall ctxt v p i.
(WithAbstractSymbolicValues ctxt v p, Integral i) =&gt;
ctxt -&gt; i -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#simmediate"><span class="hs-identifier hs-var">simmediate</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404039"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; v) -&gt; Word64 -&gt; v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
forall {a}. (Bits a, Num a) =&gt; a -&gt; a
</span><a href="Base.html#sextend_8_64"><span class="hs-identifier hs-var">sextend_8_64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404041"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-92"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sread_operand"><span class="hs-identifier hs-var">sread_operand</span></a></span><span> </span><span id="local-6989586621679404043"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404043"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404044"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404044"><span class="hs-identifier hs-var">msg</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Const"><span class="hs-identifier hs-type">Op_Const</span></a></span><span> </span><span id="local-6989586621679404046"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679404046"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; StateT (Sstate v p, VCS v) Identity v
forall a. a -&gt; StateT (Sstate v p, VCS v) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; StateT (Sstate v p, VCS v) Identity v)
-&gt; v -&gt; StateT (Sstate v p, VCS v) Identity v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Key -&gt; v
forall i. Integral i =&gt; ctxt -&gt; i -&gt; v
forall ctxt v p i.
(WithAbstractSymbolicValues ctxt v p, Integral i) =&gt;
ctxt -&gt; i -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#simmediate"><span class="hs-identifier hs-var">simmediate</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404043"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(Key -&gt; v) -&gt; Key -&gt; v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679404046"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-93"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sread_operand"><span class="hs-identifier hs-var">sread_operand</span></a></span><span> </span><span id="local-6989586621679404047"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404047"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404048"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404048"><span class="hs-identifier hs-var">msg</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Reg"><span class="hs-identifier hs-type">Op_Reg</span></a></span><span> </span><span id="local-6989586621679404050"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404050"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Register -&gt; StateT (Sstate v p, VCS v) Identity v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Register -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.Sstate.html#sread_reg"><span class="hs-identifier hs-var">sread_reg</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404047"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404050"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-94"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sread_operand"><span class="hs-identifier hs-var">sread_operand</span></a></span><span> </span><span id="local-6989586621679404051"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404051"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404052"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404052"><span class="hs-identifier hs-var">msg</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Near"><span class="hs-identifier hs-type">Op_Near</span></a></span><span> </span><span id="local-6989586621679404054"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404054"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; Operand -&gt; StateT (Sstate v p, VCS v) Identity v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; Operand -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sread_operand"><span class="hs-identifier hs-var">sread_operand</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404051"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404052"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404054"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-95"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sread_operand"><span class="hs-identifier hs-var">sread_operand</span></a></span><span> </span><span id="local-6989586621679404055"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404055"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404056"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404056"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679404057"><span class="annot"><span class="annottext">op :: Operand
</span><a href="#local-6989586621679404057"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Mem"><span class="hs-identifier hs-type">Op_Mem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#BitSize"><span class="hs-identifier hs-type">BitSize</span></a></span><span> </span><span id="local-6989586621679404058"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679404058"><span class="hs-identifier hs-var">si</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BitSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Register
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Register
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe SReg
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621679404059"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404059"><span class="hs-identifier hs-var">resolved_address</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Operand -&gt; StateT (Sstate v p, VCS v) Identity v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Operand -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sresolve_address"><span class="hs-identifier hs-var">sresolve_address</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404055"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404057"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><span class="annottext">ctxt
-&gt; String
-&gt; v
-&gt; Maybe ByteSize
-&gt; StateT (Sstate v p, VCS v) Identity v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt
-&gt; String -&gt; v -&gt; Maybe ByteSize -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.Sstate.html#sread_mem"><span class="hs-identifier hs-var">sread_mem</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404055"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404056"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404059"><span class="hs-identifier hs-var">resolved_address</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteSize -&gt; Maybe ByteSize
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ByteSize -&gt; Maybe ByteSize) -&gt; ByteSize -&gt; Maybe ByteSize
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; ByteSize
</span><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-var">ByteSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679404058"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Key -&gt; Key
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sread_operand"><span class="hs-identifier hs-var">sread_operand</span></a></span><span> </span><span id="local-6989586621679404063"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404063"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404064"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404064"><span class="hs-identifier hs-var">msg</span></a></span></span><span>    </span><span id="local-6989586621679404065"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404065"><span class="hs-identifier hs-var">op</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; StateT (Sstate v p, VCS v) Identity v
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT (Sstate v p, VCS v) Identity v)
-&gt; String -&gt; StateT (Sstate v p, VCS v) Identity v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String, Operand) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404064"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404065"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span id="local-6989586621679403603"><span id="local-6989586621679403604"><span id="local-6989586621679403605"><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#swrite_operand"><span class="hs-identifier hs-type">swrite_operand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#WithAbstractSymbolicValues"><span class="hs-identifier hs-type">WithAbstractSymbolicValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403603"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403604"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403605"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403603"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403604"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403604"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403605"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.VerificationCondition.html#VCS"><span class="hs-identifier hs-type">VCS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403604"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-102"></span><span id="swrite_operand"><span class="annot"><span class="annottext">swrite_operand :: forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt
-&gt; Instruction
-&gt; Bool
-&gt; Operand
-&gt; v
-&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#swrite_operand"><span class="hs-identifier hs-var hs-var">swrite_operand</span></a></span></span><span> </span><span id="local-6989586621679404083"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404083"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404084"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404084"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679404085"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679404085"><span class="hs-identifier hs-var">use_existing_value</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Reg"><span class="hs-identifier hs-type">Op_Reg</span></a></span><span> </span><span id="local-6989586621679404086"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404086"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>   </span><span id="local-6989586621679404087"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404087"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt
-&gt; String -&gt; Bool -&gt; Register -&gt; v -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt
-&gt; String -&gt; Bool -&gt; Register -&gt; v -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.Sstate.html#soverwrite_reg"><span class="hs-identifier hs-var">soverwrite_reg</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404083"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404084"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679404085"><span class="hs-identifier hs-var">use_existing_value</span></a></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404086"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404087"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-103"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#swrite_operand"><span class="hs-identifier hs-var">swrite_operand</span></a></span><span> </span><span id="local-6989586621679404089"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404089"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404090"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404090"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679404091"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679404091"><span class="hs-identifier hs-var">use_existing_value</span></a></span></span><span> </span><span id="local-6989586621679404092"><span class="annot"><span class="annottext">op :: Operand
</span><a href="#local-6989586621679404092"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Mem"><span class="hs-identifier hs-type">Op_Mem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#BitSize"><span class="hs-identifier hs-type">BitSize</span></a></span><span> </span><span id="local-6989586621679404093"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679404093"><span class="hs-identifier hs-var">si</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BitSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Register
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Register
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe SReg
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679404094"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404094"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621679404095"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404095"><span class="hs-identifier hs-var">resolved_address</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Operand -&gt; State (Sstate v p, VCS v) v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Operand -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sresolve_address"><span class="hs-identifier hs-var">sresolve_address</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404089"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404092"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><span class="annottext">ctxt
-&gt; Bool -&gt; v -&gt; Maybe ByteSize -&gt; v -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt
-&gt; Bool -&gt; v -&gt; Maybe ByteSize -&gt; v -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.Sstate.html#swrite_mem"><span class="hs-identifier hs-var">swrite_mem</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404089"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679404091"><span class="hs-identifier hs-var">use_existing_value</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404095"><span class="hs-identifier hs-var">resolved_address</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteSize -&gt; Maybe ByteSize
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ByteSize -&gt; Maybe ByteSize) -&gt; ByteSize -&gt; Maybe ByteSize
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; ByteSize
</span><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-var">ByteSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679404093"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Key -&gt; Key
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404094"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-106"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#swrite_operand"><span class="hs-identifier hs-var">swrite_operand</span></a></span><span> </span><span id="local-6989586621679404097"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404097"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404098"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404098"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679404099"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404099"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679404100"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404100"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; State (Sstate v p, VCS v) ()
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; State (Sstate v p, VCS v) ())
-&gt; String -&gt; State (Sstate v p, VCS v) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Instruction, Operand) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404098"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404099"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- TODO JE, other JMP aboves and JUMP lesses</span><span>
</span><span id="line-113"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#add_jump_to_pred"><span class="hs-identifier hs-type">add_jump_to_pred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SymbolicExpression.html#FlagStatus"><span class="hs-identifier hs-type">FlagStatus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SymbolicExpression.html#FlagStatus"><span class="hs-identifier hs-type">FlagStatus</span></a></span><span>
</span><span id="line-114"></span><span id="add_jump_to_pred"><span class="annot"><span class="annottext">add_jump_to_pred :: Instruction -&gt; Instruction -&gt; FlagStatus -&gt; FlagStatus
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#add_jump_to_pred"><span class="hs-identifier hs-var hs-var">add_jump_to_pred</span></a></span></span><span> </span><span id="local-6989586621679404102"><span class="annot"><span class="annottext">i0 :: Instruction
</span><a href="#local-6989586621679404102"><span class="hs-identifier hs-var">i0</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Prefix]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="Data.X86.Opcode.html#JA"><span class="hs-identifier hs-var">JA</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Operand
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Jmp"><span class="hs-identifier hs-type">Op_Jmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span class="annot"><span class="annottext">BitSize
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679404106"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404106"><span class="hs-identifier hs-var">trgt</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679404107"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404107"><span class="hs-identifier hs-var">i1</span></a></span></span><span> </span><span id="local-6989586621679404108"><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404108"><span class="hs-identifier hs-var">flg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404108"><span class="hs-identifier hs-var">flg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><a href="Data.SymbolicExpression.html#FS_CMP"><span class="hs-identifier hs-type">FS_CMP</span></a></span><span> </span><span id="local-6989586621679404110"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679404110"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679404111"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404111"><span class="hs-identifier hs-var">o1</span></a></span></span><span> </span><span id="local-6989586621679404112"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404112"><span class="hs-identifier hs-var">o2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; Word64
</span><a href="Data.X86.Instruction.html#inAddress"><span class="hs-identifier hs-var">inAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404107"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404106"><span class="hs-identifier hs-var">trgt</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Operand -&gt; Operand -&gt; FlagStatus
</span><a href="Data.SymbolicExpression.html#FS_CMP"><span class="hs-identifier hs-var">FS_CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404111"><span class="hs-identifier hs-var">o1</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404112"><span class="hs-identifier hs-var">o2</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Operand -&gt; Operand -&gt; FlagStatus
</span><a href="Data.SymbolicExpression.html#FS_CMP"><span class="hs-identifier hs-var">FS_CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404111"><span class="hs-identifier hs-var">o1</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404112"><span class="hs-identifier hs-var">o2</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><span class="annottext">FlagStatus
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404108"><span class="hs-identifier hs-var">flg</span></a></span><span>
</span><span id="line-118"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#add_jump_to_pred"><span class="hs-identifier hs-var">add_jump_to_pred</span></a></span><span> </span><span id="local-6989586621679404114"><span class="annot"><span class="annottext">i0 :: Instruction
</span><a href="#local-6989586621679404114"><span class="hs-identifier hs-var">i0</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Prefix]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="Data.X86.Opcode.html#JBE"><span class="hs-identifier hs-var">JBE</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Operand
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Jmp"><span class="hs-identifier hs-type">Op_Jmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span class="annot"><span class="annottext">BitSize
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679404116"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404116"><span class="hs-identifier hs-var">trgt</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679404117"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404117"><span class="hs-identifier hs-var">i1</span></a></span></span><span> </span><span id="local-6989586621679404118"><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404118"><span class="hs-identifier hs-var">flg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404118"><span class="hs-identifier hs-var">flg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><a href="Data.SymbolicExpression.html#FS_CMP"><span class="hs-identifier hs-type">FS_CMP</span></a></span><span> </span><span id="local-6989586621679404119"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679404119"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679404120"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404120"><span class="hs-identifier hs-var">o1</span></a></span></span><span> </span><span id="local-6989586621679404121"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404121"><span class="hs-identifier hs-var">o2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; Word64
</span><a href="Data.X86.Instruction.html#inAddress"><span class="hs-identifier hs-var">inAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404117"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404116"><span class="hs-identifier hs-var">trgt</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Operand -&gt; Operand -&gt; FlagStatus
</span><a href="Data.SymbolicExpression.html#FS_CMP"><span class="hs-identifier hs-var">FS_CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404120"><span class="hs-identifier hs-var">o1</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404121"><span class="hs-identifier hs-var">o2</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Operand -&gt; Operand -&gt; FlagStatus
</span><a href="Data.SymbolicExpression.html#FS_CMP"><span class="hs-identifier hs-var">FS_CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404120"><span class="hs-identifier hs-var">o1</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404121"><span class="hs-identifier hs-var">o2</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><span class="annottext">FlagStatus
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404118"><span class="hs-identifier hs-var">flg</span></a></span><span>
</span><span id="line-122"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#add_jump_to_pred"><span class="hs-identifier hs-var">add_jump_to_pred</span></a></span><span> </span><span id="local-6989586621679404122"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404122"><span class="hs-identifier hs-var">i0</span></a></span></span><span> </span><span id="local-6989586621679404123"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404123"><span class="hs-identifier hs-var">i1</span></a></span></span><span> </span><span id="local-6989586621679404124"><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404124"><span class="hs-identifier hs-var">flg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404124"><span class="hs-identifier hs-var">flg</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span id="local-6989586621679403619"><span id="local-6989586621679403620"><span id="local-6989586621679403621"><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sreturn"><span class="hs-identifier hs-type">sreturn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#WithAbstractSymbolicValues"><span class="hs-identifier hs-type">WithAbstractSymbolicValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403619"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403620"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403621"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403619"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403620"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403621"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.VerificationCondition.html#VCS"><span class="hs-identifier hs-type">VCS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403620"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-128"></span><span id="sreturn"><span class="annot"><span class="annottext">sreturn :: forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sreturn"><span class="hs-identifier hs-var hs-var">sreturn</span></a></span></span><span> </span><span id="local-6989586621679404141"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404141"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404142"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404142"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679404143"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404143"><span class="hs-identifier hs-var">rsp_value</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Register -&gt; State (Sstate v p, VCS v) v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Register -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.Sstate.html#sread_reg"><span class="hs-identifier hs-var">sread_reg</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404141"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GPR -&gt; Register
</span><a href="Data.X86.Register.html#Reg64"><span class="hs-identifier hs-var">Reg64</span></a></span><span> </span><span class="annot"><span class="annottext">GPR
</span><a href="Data.X86.Register.html#RSP"><span class="hs-identifier hs-var">RSP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621679404146"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404146"><span class="hs-identifier hs-var">ret_addr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; Operand -&gt; State (Sstate v p, VCS v) v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; Operand -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sread_operand"><span class="hs-identifier hs-var">sread_operand</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404141"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;return&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; State (Sstate v p, VCS v) v)
-&gt; Operand -&gt; State (Sstate v p, VCS v) v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteSize -&gt; Operand
</span><a href="Data.X86.Instruction.html#mk_RSP_mem_operand"><span class="hs-identifier hs-var">mk_RSP_mem_operand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; ByteSize
</span><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-var">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679404171"><span class="annot"><span class="annottext">rsp8 :: v
</span><a href="#local-6989586621679404171"><span class="hs-identifier hs-var hs-var">rsp8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; SymbolicOperation v -&gt; v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; SymbolicOperation v -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#ssemantics"><span class="hs-identifier hs-var">ssemantics</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404141"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;plus&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SymbolicOperation v -&gt; v) -&gt; SymbolicOperation v -&gt; v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; SymbolicOperation v
forall v. v -&gt; v -&gt; SymbolicOperation v
</span><a href="WithAbstractSymbolicValues.Class.html#SO_Plus"><span class="hs-identifier hs-var">SO_Plus</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404143"><span class="hs-identifier hs-var">rsp_value</span></a></span><span> </span><span class="annot"><span class="annottext">(v -&gt; SymbolicOperation v) -&gt; v -&gt; SymbolicOperation v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Integer -&gt; v
forall i. Integral i =&gt; ctxt -&gt; i -&gt; v
forall ctxt v p i.
(WithAbstractSymbolicValues ctxt v p, Integral i) =&gt;
ctxt -&gt; i -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#simmediate"><span class="hs-identifier hs-var">simmediate</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404141"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; Register -&gt; v -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; Register -&gt; v -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.Sstate.html#swrite_reg"><span class="hs-identifier hs-var">swrite_reg</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404141"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sret1&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GPR -&gt; Register
</span><a href="Data.X86.Register.html#Reg64"><span class="hs-identifier hs-var">Reg64</span></a></span><span> </span><span class="annot"><span class="annottext">GPR
</span><a href="Data.X86.Register.html#RSP"><span class="hs-identifier hs-var">RSP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404171"><span class="hs-identifier hs-var">rsp8</span></a></span><span>
</span><span id="line-133"></span><span>  </span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; Register -&gt; v -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; Register -&gt; v -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.Sstate.html#swrite_reg"><span class="hs-identifier hs-var">swrite_reg</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404141"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sret2&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GPR -&gt; Register
</span><a href="Data.X86.Register.html#Reg64"><span class="hs-identifier hs-var">Reg64</span></a></span><span> </span><span class="annot"><span class="annottext">GPR
</span><a href="Data.X86.Register.html#RIP"><span class="hs-identifier hs-var">RIP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404146"><span class="hs-identifier hs-var">ret_addr</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- LEA</span><span>
</span><span id="line-137"></span><span id="local-6989586621679403629"><span id="local-6989586621679403630"><span id="local-6989586621679403631"><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#slea"><span class="hs-identifier hs-type">slea</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#WithAbstractSymbolicValues"><span class="hs-identifier hs-type">WithAbstractSymbolicValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403629"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403630"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403631"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403629"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403630"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403631"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.VerificationCondition.html#VCS"><span class="hs-identifier hs-type">VCS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403630"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-138"></span><span id="slea"><span class="annot"><span class="annottext">slea :: forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt
-&gt; Instruction
-&gt; Operand
-&gt; Operand
-&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#slea"><span class="hs-identifier hs-var hs-var">slea</span></a></span></span><span> </span><span id="local-6989586621679404192"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404192"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404193"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404193"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679404194"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404194"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621679404195"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404195"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-139"></span><span>  </span><span id="local-6989586621679404196"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404196"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Operand -&gt; State (Sstate v p, VCS v) v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Operand -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sresolve_address"><span class="hs-identifier hs-var">sresolve_address</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404192"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404195"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="annottext">ctxt
-&gt; Instruction
-&gt; Bool
-&gt; Operand
-&gt; v
-&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt
-&gt; Instruction
-&gt; Bool
-&gt; Operand
-&gt; v
-&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#swrite_operand"><span class="hs-identifier hs-var">swrite_operand</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404192"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404193"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404194"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404196"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Bool
</span><a href="#local-6989586621679404197"><span class="hs-identifier hs-var">rip_relative</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404195"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; v -&gt; Maybe Word64
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; v -&gt; Maybe Word64
</span><a href="WithAbstractSymbolicValues.Class.html#stry_immediate"><span class="hs-identifier hs-var">stry_immediate</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404192"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404196"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-143"></span><span>      </span><span class="annot"><span class="annottext">Maybe Word64
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; State (Sstate v p, VCS v) ()
forall a. a -&gt; StateT (Sstate v p, VCS v) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679404199"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404199"><span class="hs-identifier hs-var">imm</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ctxt -&gt; Word64 -&gt; Bool
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Word64 -&gt; Bool
</span><a href="WithAbstractSymbolicValues.Class.html#saddress_has_instruction"><span class="hs-identifier hs-var">saddress_has_instruction</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404192"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404199"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">((Sstate v p, VCS v) -&gt; (Sstate v p, VCS v))
-&gt; State (Sstate v p, VCS v) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">(((Sstate v p, VCS v) -&gt; (Sstate v p, VCS v))
 -&gt; State (Sstate v p, VCS v) ())
-&gt; ((Sstate v p, VCS v) -&gt; (Sstate v p, VCS v))
-&gt; State (Sstate v p, VCS v) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Key -&gt; (Sstate v p, VCS v) -&gt; (Sstate v p, VCS v)
forall {v} {a}.
Ord v =&gt;
Word64
-&gt; Key
-&gt; (a, Set (VerificationCondition v))
-&gt; (a, Set (VerificationCondition v))
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#add_function_pointer"><span class="hs-identifier hs-var">add_function_pointer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; Word64
</span><a href="Data.X86.Instruction.html#inAddress"><span class="hs-identifier hs-var">inAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404193"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Key -&gt; (Sstate v p, VCS v) -&gt; (Sstate v p, VCS v))
-&gt; Key -&gt; (Sstate v p, VCS v) -&gt; (Sstate v p, VCS v)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Key
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404199"><span class="hs-identifier hs-var">imm</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">() -&gt; State (Sstate v p, VCS v) ()
forall a. a -&gt; StateT (Sstate v p, VCS v) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-keyword">else</span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><span class="annottext">() -&gt; State (Sstate v p, VCS v) ()
forall a. a -&gt; StateT (Sstate v p, VCS v) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679404197"><span class="annot"><span class="annottext">rip_relative :: Operand -&gt; Bool
</span><a href="#local-6989586621679404197"><span class="hs-identifier hs-var hs-var">rip_relative</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Mem"><span class="hs-identifier hs-type">Op_Mem</span></a></span><span> </span><span class="annot"><span class="annottext">BitSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BitSize
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679404205"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404205"><span class="hs-identifier hs-var">r0</span></a></span></span><span> </span><span id="local-6989586621679404206"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404206"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe SReg
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GPR -&gt; Register
</span><a href="Data.X86.Register.html#Reg64"><span class="hs-identifier hs-var">Reg64</span></a></span><span> </span><span class="annot"><span class="annottext">GPR
</span><a href="Data.X86.Register.html#RIP"><span class="hs-identifier hs-var">RIP</span></a></span><span> </span><span class="annot"><span class="annottext">Register -&gt; [Register] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404205"><span class="hs-identifier hs-var">r0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404206"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- MOV</span><span>
</span><span id="line-151"></span><span id="local-6989586621679403642"><span id="local-6989586621679403643"><span id="local-6989586621679403644"><span id="local-6989586621679403645"><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#smov"><span class="hs-identifier hs-type">smov</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#WithAbstractSymbolicValues"><span class="hs-identifier hs-type">WithAbstractSymbolicValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403642"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403643"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403644"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403642"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403645"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403643"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403644"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.VerificationCondition.html#VCS"><span class="hs-identifier hs-type">VCS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403643"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-152"></span><span id="smov"><span class="annot"><span class="annottext">smov :: forall ctxt v p a.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; a -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#smov"><span class="hs-identifier hs-var hs-var">smov</span></a></span></span><span> </span><span id="local-6989586621679404212"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404212"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404213"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679404213"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679404214"><span class="annot"><span class="annottext">i :: Instruction
</span><a href="#local-6989586621679404214"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span id="local-6989586621679404215"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404215"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679404216"><span class="annot"><span class="annottext">[Prefix]
</span><a href="#local-6989586621679404216"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="Data.X86.Opcode.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679404218"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404218"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679404219"><span class="annot"><span class="annottext">src :: Operand
</span><a href="#local-6989586621679404219"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Imm"><span class="hs-identifier hs-type">Op_Imm</span></a></span><span> </span><span class="annot"><span class="annottext">Immediate
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679404220"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679404220"><span class="hs-identifier hs-var">annot</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-comment">-- | saddress_has_instruction ctxt imm   = slea ctxt label dst (EffectiveAddress (AddressImm imm))</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sgeneric_cinstr"><span class="hs-identifier hs-var">sgeneric_cinstr</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404212"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404214"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-155"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#smov"><span class="hs-identifier hs-var">smov</span></a></span><span> </span><span id="local-6989586621679404222"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404222"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404223"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679404223"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679404224"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404224"><span class="hs-identifier hs-var">i</span></a></span></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sgeneric_cinstr"><span class="hs-identifier hs-var">sgeneric_cinstr</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404222"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404224"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span id="local-6989586621679404225"><span id="local-6989586621679404226"><span id="local-6989586621679404227"><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sgeneric_cinstr"><span class="hs-identifier hs-type">sgeneric_cinstr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#WithAbstractSymbolicValues"><span class="hs-identifier hs-type">WithAbstractSymbolicValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404225"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404226"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404227"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679404225"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404226"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404227"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.VerificationCondition.html#VCS"><span class="hs-identifier hs-type">VCS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404226"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-159"></span><span class="hs-comment">--sgeneric_cinstr ctxt i | trace (&quot;sgeneric_cinstr: &quot;++ show i) False = error &quot;trace&quot;</span><span>
</span><span id="line-160"></span><span id="sgeneric_cinstr"><span class="annot"><span class="annottext">sgeneric_cinstr :: forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sgeneric_cinstr"><span class="hs-identifier hs-var hs-var">sgeneric_cinstr</span></a></span></span><span> </span><span id="local-6989586621679404241"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404241"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404242"><span class="annot"><span class="annottext">i :: Instruction
</span><a href="#local-6989586621679404242"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span id="local-6989586621679404243"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404243"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679404244"><span class="annot"><span class="annottext">[Prefix]
</span><a href="#local-6989586621679404244"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span id="local-6989586621679404245"><span class="annot"><span class="annottext">Opcode
</span><a href="#local-6989586621679404245"><span class="hs-identifier hs-var">mnemonic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679404246"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404246"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679404247"><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621679404247"><span class="hs-identifier hs-var">srcs</span></a></span></span><span> </span><span id="local-6989586621679404248"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679404248"><span class="hs-identifier hs-var">annot</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621679404249"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621679404249"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; StateT (Sstate v p, VCS v) Identity v)
-&gt; [Operand] -&gt; StateT (Sstate v p, VCS v) Identity [v]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; Operand -&gt; StateT (Sstate v p, VCS v) Identity v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; Operand -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sread_operand"><span class="hs-identifier hs-var">sread_operand</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404241"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404242"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621679404247"><span class="hs-identifier hs-var">srcs</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><span class="annottext">ctxt
-&gt; Instruction
-&gt; Bool
-&gt; Operand
-&gt; v
-&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt
-&gt; Instruction
-&gt; Bool
-&gt; Operand
-&gt; v
-&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#swrite_operand"><span class="hs-identifier hs-var">swrite_operand</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404241"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404242"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404246"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">(v -&gt; State (Sstate v p, VCS v) ())
-&gt; v -&gt; State (Sstate v p, VCS v) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; SymbolicOperation v -&gt; v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; SymbolicOperation v -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#ssemantics"><span class="hs-identifier hs-var">ssemantics</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404241"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404242"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SymbolicOperation v -&gt; v) -&gt; SymbolicOperation v -&gt; v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; Key -&gt; Maybe Key -&gt; [v] -&gt; SymbolicOperation v
forall v. Opcode -&gt; Key -&gt; Maybe Key -&gt; [v] -&gt; SymbolicOperation v
</span><a href="WithAbstractSymbolicValues.Class.html#SO_Op"><span class="hs-identifier hs-var">SO_Op</span></a></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="#local-6989586621679404245"><span class="hs-identifier hs-var">mnemonic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteSize -&gt; Key
</span><a href="Data.Size.html#byteSize"><span class="hs-identifier hs-var">byteSize</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteSize -&gt; Key) -&gt; ByteSize -&gt; Key
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; ByteSize
</span><a href="Data.X86.Instruction.html#operand_size"><span class="hs-identifier hs-var">operand_size</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404246"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteSize -&gt; Key
</span><a href="Data.Size.html#byteSize"><span class="hs-identifier hs-var">byteSize</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteSize -&gt; Key) -&gt; Maybe ByteSize -&gt; Maybe Key
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Operand] -&gt; Maybe ByteSize
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#maybe_operand_size"><span class="hs-identifier hs-var">maybe_operand_size</span></a></span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621679404247"><span class="hs-identifier hs-var">srcs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621679404249"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span id="maybe_operand_size"><span class="annot"><span class="annottext">maybe_operand_size :: [Operand] -&gt; Maybe ByteSize
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#maybe_operand_size"><span class="hs-identifier hs-var hs-var">maybe_operand_size</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteSize
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-166"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#maybe_operand_size"><span class="hs-identifier hs-var">maybe_operand_size</span></a></span><span> </span><span id="local-6989586621679404266"><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621679404266"><span class="hs-identifier hs-var">srcs</span></a></span></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Bool) -&gt; [Operand] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Bool
</span><a href="#local-6989586621679404268"><span class="hs-identifier hs-var">is_immediate</span></a></span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621679404266"><span class="hs-identifier hs-var">srcs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteSize
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679404269"><span class="annot"><span class="annottext">sizes :: [ByteSize]
</span><a href="#local-6989586621679404269"><span class="hs-identifier hs-var hs-var">sizes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; ByteSize) -&gt; [Operand] -&gt; [ByteSize]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; ByteSize
</span><a href="Data.X86.Instruction.html#operand_size"><span class="hs-identifier hs-var">operand_size</span></a></span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621679404266"><span class="hs-identifier hs-var">srcs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-170"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(ByteSize -&gt; Bool) -&gt; [ByteSize] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteSize -&gt; ByteSize -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteSize] -&gt; ByteSize
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[ByteSize]
</span><a href="#local-6989586621679404269"><span class="hs-identifier hs-var">sizes</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteSize] -&gt; [ByteSize]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[ByteSize]
</span><a href="#local-6989586621679404269"><span class="hs-identifier hs-var">sizes</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><span class="annottext">ByteSize -&gt; Maybe ByteSize
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ByteSize -&gt; Maybe ByteSize) -&gt; ByteSize -&gt; Maybe ByteSize
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ByteSize] -&gt; ByteSize
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[ByteSize]
</span><a href="#local-6989586621679404269"><span class="hs-identifier hs-var">sizes</span></a></span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-keyword">else</span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><span class="annottext">Maybe ByteSize
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-174"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-175"></span><span>  </span><span id="local-6989586621679404268"><span class="annot"><span class="annottext">is_immediate :: Operand -&gt; Bool
</span><a href="#local-6989586621679404268"><span class="hs-identifier hs-var hs-var">is_immediate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Imm"><span class="hs-identifier hs-type">Op_Imm</span></a></span><span> </span><span class="annot"><span class="annottext">Immediate
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-176"></span><span>  </span><span class="annot"><a href="#local-6989586621679404268"><span class="hs-identifier hs-var">is_immediate</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span id="local-6989586621679404273"><span id="local-6989586621679404274"><span id="local-6989586621679404275"><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sexec_cinstr"><span class="hs-identifier hs-type">sexec_cinstr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#WithAbstractSymbolicValues"><span class="hs-identifier hs-type">WithAbstractSymbolicValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404273"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404274"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404275"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679404273"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404274"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404275"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.VerificationCondition.html#VCS"><span class="hs-identifier hs-type">VCS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404274"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-179"></span><span class="hs-comment">--sexec_cinstr ctxt i | trace (&quot;sexec_cinstr: &quot;++ show i) False = error &quot;trace&quot;</span><span>
</span><span id="line-180"></span><span id="sexec_cinstr"><span class="annot"><span class="annottext">sexec_cinstr :: forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sexec_cinstr"><span class="hs-identifier hs-var hs-var">sexec_cinstr</span></a></span></span><span> </span><span id="local-6989586621679404307"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404307"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404308"><span class="annot"><span class="annottext">i :: Instruction
</span><a href="#local-6989586621679404308"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span id="local-6989586621679404309"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404309"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679404310"><span class="annot"><span class="annottext">[Prefix]
</span><a href="#local-6989586621679404310"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span id="local-6989586621679404311"><span class="annot"><span class="annottext">Opcode
</span><a href="#local-6989586621679404311"><span class="hs-identifier hs-var">mnemonic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679404312"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404312"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679404313"><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621679404313"><span class="hs-identifier hs-var">srcs</span></a></span></span><span> </span><span id="local-6989586621679404314"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679404314"><span class="hs-identifier hs-var">annot</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="#local-6989586621679404311"><span class="hs-identifier hs-var">mnemonic</span></a></span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; Opcode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="Data.X86.Opcode.html#LEA"><span class="hs-identifier hs-var">LEA</span></a></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt
-&gt; Instruction
-&gt; Operand
-&gt; Operand
-&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt
-&gt; Instruction
-&gt; Operand
-&gt; Operand
-&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#slea"><span class="hs-identifier hs-var">slea</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404307"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404308"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404312"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; State (Sstate v p, VCS v) ())
-&gt; Operand -&gt; State (Sstate v p, VCS v) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Operand] -&gt; Operand
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621679404313"><span class="hs-identifier hs-var">srcs</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="#local-6989586621679404311"><span class="hs-identifier hs-var">mnemonic</span></a></span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; Opcode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="Data.X86.Opcode.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; v -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p a.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; a -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#smov"><span class="hs-identifier hs-var">smov</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404307"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#top"><span class="hs-identifier hs-var">top</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404307"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404308"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="#local-6989586621679404311"><span class="hs-identifier hs-var">mnemonic</span></a></span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; [Opcode] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Opcode]
</span><a href="#local-6989586621679404317"><span class="hs-identifier hs-var">xors</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404312"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Operand] -&gt; Operand
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621679404313"><span class="hs-identifier hs-var">srcs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt
-&gt; Instruction
-&gt; Bool
-&gt; Operand
-&gt; v
-&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt
-&gt; Instruction
-&gt; Bool
-&gt; Operand
-&gt; v
-&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#swrite_operand"><span class="hs-identifier hs-var">swrite_operand</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404307"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404308"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404312"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">(v -&gt; State (Sstate v p, VCS v) ())
-&gt; v -&gt; State (Sstate v p, VCS v) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Integer -&gt; v
forall i. Integral i =&gt; ctxt -&gt; i -&gt; v
forall ctxt v p i.
(WithAbstractSymbolicValues ctxt v p, Integral i) =&gt;
ctxt -&gt; i -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#simmediate"><span class="hs-identifier hs-var">simmediate</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404307"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sgeneric_cinstr"><span class="hs-identifier hs-var">sgeneric_cinstr</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404307"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404308"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-185"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>  </span><span id="local-6989586621679404317"><span class="annot"><span class="annottext">xors :: [Opcode]
</span><a href="#local-6989586621679404317"><span class="hs-identifier hs-var hs-var">xors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Opcode
</span><a href="Data.X86.Opcode.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Opcode
</span><a href="Data.X86.Opcode.html#PXOR"><span class="hs-identifier hs-var">PXOR</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-187"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sexec_cinstr"><span class="hs-identifier hs-var">sexec_cinstr</span></a></span><span> </span><span id="local-6989586621679404320"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404320"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404321"><span class="annot"><span class="annottext">i :: Instruction
</span><a href="#local-6989586621679404321"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span id="local-6989586621679404322"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404322"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679404323"><span class="annot"><span class="annottext">[Prefix]
</span><a href="#local-6989586621679404323"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span id="local-6989586621679404324"><span class="annot"><span class="annottext">Opcode
</span><a href="#local-6989586621679404324"><span class="hs-identifier hs-var">mnemonic</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Operand
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; Bool
</span><a href="Data.X86.Opcode.html#isRet"><span class="hs-identifier hs-var">isRet</span></a></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="#local-6989586621679404324"><span class="hs-identifier hs-var">mnemonic</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sreturn"><span class="hs-identifier hs-var">sreturn</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404320"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404321"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; Bool
</span><a href="Data.X86.Opcode.html#isJump"><span class="hs-identifier hs-var">isJump</span></a></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="#local-6989586621679404324"><span class="hs-identifier hs-var">mnemonic</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.Class.html#sjump"><span class="hs-identifier hs-var">sjump</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404320"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404321"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; Bool
</span><a href="Data.X86.Opcode.html#isCall"><span class="hs-identifier hs-var">isCall</span></a></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="#local-6989586621679404324"><span class="hs-identifier hs-var">mnemonic</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.Class.html#scall"><span class="hs-identifier hs-var">scall</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404320"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404321"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; State (Sstate v p, VCS v) ()
forall a. a -&gt; StateT (Sstate v p, VCS v) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span id="local-6989586621679404330"><span id="local-6989586621679404331"><span id="local-6989586621679404332"><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sset_rip"><span class="hs-identifier hs-type">sset_rip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#WithAbstractSymbolicValues"><span class="hs-identifier hs-type">WithAbstractSymbolicValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404330"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404331"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404332"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679404330"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404331"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404332"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.VerificationCondition.html#VCS"><span class="hs-identifier hs-type">VCS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404331"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-199"></span><span id="sset_rip"><span class="annot"><span class="annottext">sset_rip :: forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sset_rip"><span class="hs-identifier hs-var hs-var">sset_rip</span></a></span></span><span> </span><span id="local-6989586621679404341"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404341"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404342"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404342"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; Register -&gt; v -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; Register -&gt; v -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.Sstate.html#swrite_reg"><span class="hs-identifier hs-var">swrite_reg</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404341"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sset_rip&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GPR -&gt; Register
</span><a href="Data.X86.Register.html#Reg64"><span class="hs-identifier hs-var">Reg64</span></a></span><span> </span><span class="annot"><span class="annottext">GPR
</span><a href="Data.X86.Register.html#RIP"><span class="hs-identifier hs-var">RIP</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ctxt -&gt; Word64 -&gt; v
forall i. Integral i =&gt; ctxt -&gt; i -&gt; v
forall ctxt v p i.
(WithAbstractSymbolicValues ctxt v p, Integral i) =&gt;
ctxt -&gt; i -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#simmediate"><span class="hs-identifier hs-var">simmediate</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404341"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; v) -&gt; Word64 -&gt; v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; Word64
</span><a href="Data.X86.Instruction.html#inAddress"><span class="hs-identifier hs-var">inAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404342"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Key -&gt; Word64) -&gt; Key -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; Key
</span><a href="Data.X86.Instruction.html#inSize"><span class="hs-identifier hs-var">inSize</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404342"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span id="local-6989586621679403673"><span id="local-6989586621679403674"><span id="local-6989586621679403675"><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sexec_instr"><span class="hs-identifier hs-type">sexec_instr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#WithAbstractSymbolicValues"><span class="hs-identifier hs-type">WithAbstractSymbolicValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403673"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403674"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403675"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403673"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403674"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403675"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.VerificationCondition.html#VCS"><span class="hs-identifier hs-type">VCS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403674"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-202"></span><span class="hs-comment">--sexec_instr ctxt i | trace (&quot;sexec_isntr: &quot;++ show i) False = error &quot;trace&quot;</span><span>
</span><span id="line-203"></span><span id="sexec_instr"><span class="annot"><span class="annottext">sexec_instr :: forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Bool -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sexec_instr"><span class="hs-identifier hs-var hs-var">sexec_instr</span></a></span></span><span> </span><span id="local-6989586621679404364"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404364"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404365"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679404365"><span class="hs-identifier hs-var">store_pointer_analysis</span></a></span></span><span> </span><span id="local-6989586621679404366"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404366"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><span class="annottext">ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sset_rip"><span class="hs-identifier hs-var">sset_rip</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404364"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404366"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679404367"><span class="annot"><span class="annottext">i_c :: [Instruction]
</span><a href="#local-6989586621679404367"><span class="hs-identifier hs-var hs-var">i_c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; [Instruction]
</span><a href="Data.X86.Instruction.html#canonicalize"><span class="hs-identifier hs-var">canonicalize</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404366"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><span class="annottext">[Instruction] -&gt; State (Sstate v p, VCS v) ()
forall {m :: * -&gt; *}.
MonadState (Sstate v p, VCS v) m =&gt;
[Instruction] -&gt; m ()
</span><a href="#local-6989586621679404369"><span class="hs-identifier hs-var">maybe_store_pointer_analysis_result</span></a></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679404367"><span class="hs-identifier hs-var">i_c</span></a></span><span>
</span><span id="line-208"></span><span>  </span><span class="annot"><span class="annottext">(Instruction -&gt; State (Sstate v p, VCS v) ())
-&gt; [Instruction] -&gt; State (Sstate v p, VCS v) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sexec_cinstr"><span class="hs-identifier hs-var">sexec_cinstr</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404364"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679404367"><span class="hs-identifier hs-var">i_c</span></a></span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><span class="annottext">ctxt -&gt; v -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; v -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.Sstate.html#swrite_flags"><span class="hs-identifier hs-var">swrite_flags</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404364"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#top"><span class="hs-identifier hs-var">top</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404364"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404366"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span>
</span><span id="line-210"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621679404369"><span class="annot"><span class="annottext">maybe_store_pointer_analysis_result :: [Instruction] -&gt; m ()
</span><a href="#local-6989586621679404369"><span class="hs-identifier hs-var hs-var">maybe_store_pointer_analysis_result</span></a></span></span><span> </span><span id="local-6989586621679404393"><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679404393"><span class="hs-identifier hs-var">i_c</span></a></span></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; Opcode
</span><a href="Data.X86.Instruction.html#inOperation"><span class="hs-identifier hs-var">inOperation</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404366"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; Opcode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="Data.X86.Opcode.html#LEA"><span class="hs-identifier hs-var">LEA</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679404365"><span class="hs-identifier hs-var">store_pointer_analysis</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-214"></span><span>      </span><span id="local-6989586621679404395"><span class="annot"><span class="annottext">Maybe (PointerAnalysisResult v)
</span><a href="#local-6989586621679404395"><span class="hs-identifier hs-var">par</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Sstate v p, VCS v) -&gt; Maybe (PointerAnalysisResult v))
-&gt; m (Maybe (PointerAnalysisResult v))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">(((Sstate v p, VCS v) -&gt; Maybe (PointerAnalysisResult v))
 -&gt; m (Maybe (PointerAnalysisResult v)))
-&gt; ((Sstate v p, VCS v) -&gt; Maybe (PointerAnalysisResult v))
-&gt; m (Maybe (PointerAnalysisResult v))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
-&gt; (Sstate v p, VCS v) -&gt; Maybe (PointerAnalysisResult v)
forall {b}.
[Instruction] -&gt; (Sstate v p, b) -&gt; Maybe (PointerAnalysisResult v)
</span><a href="#local-6989586621679404397"><span class="hs-identifier hs-var">mk_pointer_analysis_result</span></a></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679404393"><span class="hs-identifier hs-var">i_c</span></a></span><span>
</span><span id="line-215"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (PointerAnalysisResult v)
</span><a href="#local-6989586621679404395"><span class="hs-identifier hs-var">par</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">Maybe (PointerAnalysisResult v)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679404398"><span class="annot"><span class="annottext">PointerAnalysisResult v
</span><a href="#local-6989586621679404398"><span class="hs-identifier hs-var">par</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((Sstate v p, VCS v) -&gt; (Sstate v p, VCS v)) -&gt; m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">(((Sstate v p, VCS v) -&gt; (Sstate v p, VCS v)) -&gt; m ())
-&gt; ((Sstate v p, VCS v) -&gt; (Sstate v p, VCS v)) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64
-&gt; PointerAnalysisResult v
-&gt; (Sstate v p, VCS v)
-&gt; (Sstate v p, VCS v)
forall {v} {a}.
Ord v =&gt;
Word64
-&gt; PointerAnalysisResult v
-&gt; (a, Set (VerificationCondition v))
-&gt; (a, Set (VerificationCondition v))
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#add_pa_result"><span class="hs-identifier hs-var">add_pa_result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; Word64
</span><a href="Data.X86.Instruction.html#inAddress"><span class="hs-identifier hs-var">inAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404366"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PointerAnalysisResult v
</span><a href="#local-6989586621679404398"><span class="hs-identifier hs-var">par</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621679404397"><span class="annot"><span class="annottext">mk_pointer_analysis_result :: [Instruction] -&gt; (Sstate v p, b) -&gt; Maybe (PointerAnalysisResult v)
</span><a href="#local-6989586621679404397"><span class="hs-identifier hs-var hs-var">mk_pointer_analysis_result</span></a></span></span><span> </span><span id="local-6989586621679404403"><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679404403"><span class="hs-identifier hs-var">i_c</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679404404"><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404404"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679404409"><span class="annot"><span class="annottext">Maybe Operand
</span><a href="#local-6989586621679404409"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679404410"><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621679404410"><span class="hs-identifier hs-var">srcs</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; Maybe Operand
</span><a href="Data.X86.Instruction.html#inDest"><span class="hs-identifier hs-var">inDest</span></a></span><span> </span><span class="annot"><span class="annottext">(Instruction -&gt; Maybe Operand) -&gt; Instruction -&gt; Maybe Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Instruction] -&gt; Instruction
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679404403"><span class="hs-identifier hs-var">i_c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; [Operand]
</span><a href="Data.X86.Instruction.html#inOperands"><span class="hs-identifier hs-var">inOperands</span></a></span><span> </span><span class="annot"><span class="annottext">(Instruction -&gt; [Operand]) -&gt; Instruction -&gt; [Operand]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Instruction] -&gt; Instruction
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679404403"><span class="hs-identifier hs-var">i_c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>        </span><span id="local-6989586621679404415"><span class="annot"><span class="annottext">resolved_w :: Maybe v
</span><a href="#local-6989586621679404415"><span class="hs-identifier hs-var hs-var">resolved_w</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Operand
</span><a href="#local-6989586621679404409"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Operand -&gt; (Operand -&gt; Maybe v) -&gt; Maybe v
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Sstate v p -&gt; Operand -&gt; Maybe v
</span><a href="#local-6989586621679404416"><span class="hs-identifier hs-var">resolve_mem_operand</span></a></span><span> </span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404404"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span>
</span><span id="line-223"></span><span>        </span><span id="local-6989586621679404417"><span class="annot"><span class="annottext">resolved_rs :: [Maybe v]
</span><a href="#local-6989586621679404417"><span class="hs-identifier hs-var hs-var">resolved_rs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Maybe v) -&gt; [Operand] -&gt; [Maybe v]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sstate v p -&gt; Operand -&gt; Maybe v
</span><a href="#local-6989586621679404416"><span class="hs-identifier hs-var">resolve_mem_operand</span></a></span><span> </span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404404"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621679404410"><span class="hs-identifier hs-var">srcs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-224"></span><span>      </span><span class="hs-comment">--if any ((==) (Just $ top ctxt &quot;&quot;)) (resolved_w:resolved_rs) then</span><span>
</span><span id="line-225"></span><span>      </span><span class="hs-comment">--  traceShow (&quot;TOP PTR: &quot; ++ show i_c ++ &quot;\n&quot; ++ show p) $ Just $ PointerAnalysisResult resolved_w resolved_rs</span><span>
</span><span id="line-226"></span><span>      </span><span class="hs-comment">--else</span><span>
</span><span id="line-227"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(Maybe v -&gt; Bool) -&gt; [Maybe v] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe v -&gt; Maybe v -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="annot"><span class="annottext">Maybe v
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe v
</span><a href="#local-6989586621679404415"><span class="hs-identifier hs-var">resolved_w</span></a></span><span class="annot"><span class="annottext">Maybe v -&gt; [Maybe v] -&gt; [Maybe v]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Maybe v]
</span><a href="#local-6989586621679404417"><span class="hs-identifier hs-var">resolved_rs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><span class="annottext">PointerAnalysisResult v -&gt; Maybe (PointerAnalysisResult v)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(PointerAnalysisResult v -&gt; Maybe (PointerAnalysisResult v))
-&gt; PointerAnalysisResult v -&gt; Maybe (PointerAnalysisResult v)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe v -&gt; [Maybe v] -&gt; PointerAnalysisResult v
forall v. Maybe v -&gt; [Maybe v] -&gt; PointerAnalysisResult v
</span><a href="Data.VerificationCondition.html#PointerAnalysisResult"><span class="hs-identifier hs-var">PointerAnalysisResult</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe v
</span><a href="#local-6989586621679404415"><span class="hs-identifier hs-var">resolved_w</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe v]
</span><a href="#local-6989586621679404417"><span class="hs-identifier hs-var">resolved_rs</span></a></span><span>
</span><span id="line-229"></span><span>      </span><span class="hs-keyword">else</span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><span class="annottext">Maybe (PointerAnalysisResult v)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>  </span><span id="local-6989586621679404416"><span class="annot"><span class="annottext">resolve_mem_operand :: Sstate v p -&gt; Operand -&gt; Maybe v
</span><a href="#local-6989586621679404416"><span class="hs-identifier hs-var hs-var">resolve_mem_operand</span></a></span></span><span> </span><span id="local-6989586621679404428"><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404428"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679404429"><span class="annot"><span class="annottext">op :: Operand
</span><a href="#local-6989586621679404429"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Mem"><span class="hs-identifier hs-type">Op_Mem</span></a></span><span> </span><span id="local-6989586621679404430"><span class="annot"><span class="annottext">BitSize
</span><a href="#local-6989586621679404430"><span class="hs-identifier hs-var">si</span></a></span></span><span> </span><span class="annot"><span class="annottext">BitSize
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679404431"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404431"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span id="local-6989586621679404432"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404432"><span class="hs-identifier hs-var">idx</span></a></span></span><span> </span><span id="local-6989586621679404433"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679404433"><span class="hs-identifier hs-var">scale</span></a></span></span><span> </span><span id="local-6989586621679404434"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679404434"><span class="hs-identifier hs-var">displ</span></a></span></span><span> </span><span id="local-6989586621679404435"><span class="annot"><span class="annottext">Maybe SReg
</span><a href="#local-6989586621679404435"><span class="hs-identifier hs-var">seg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; Maybe v
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; Maybe v) -&gt; v -&gt; Maybe v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State (Sstate v p, VCS v) v -&gt; Sstate v p -&gt; v
forall v p a. State (Sstate v p, VCS v) a -&gt; Sstate v p -&gt; a
</span><a href="WithAbstractSymbolicValues.Sstate.html#evalSstate"><span class="hs-identifier hs-var">evalSstate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ctxt -&gt; Operand -&gt; State (Sstate v p, VCS v) v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Operand -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sresolve_address"><span class="hs-identifier hs-var">sresolve_address</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404364"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404429"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404428"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><a href="#local-6989586621679404416"><span class="hs-identifier hs-var">resolve_mem_operand</span></a></span><span> </span><span id="local-6989586621679404437"><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404437"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">Operand
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe v
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span id="local-6989586621679403701"><span id="local-6989586621679403702"><span id="local-6989586621679403703"><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sexec_block"><span class="hs-identifier hs-type">sexec_block</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#WithAbstractSymbolicValues"><span class="hs-identifier hs-type">WithAbstractSymbolicValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403701"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403702"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403703"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403701"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403702"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403703"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.VerificationCondition.html#VCS"><span class="hs-identifier hs-type">VCS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403702"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-239"></span><span id="sexec_block"><span class="annot"><span class="annottext">sexec_block :: forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt
-&gt; Bool
-&gt; [Instruction]
-&gt; Maybe [Instruction]
-&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sexec_block"><span class="hs-identifier hs-var hs-var">sexec_block</span></a></span></span><span> </span><span id="local-6989586621679404448"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404448"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404449"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679404449"><span class="hs-identifier hs-var">store_pointer_analysis</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="annot"><span class="annottext">Maybe [Instruction]
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateT (Sstate v p, VCS v) Identity ()
forall a. a -&gt; StateT (Sstate v p, VCS v) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span class="hs-comment">--sexec_block ctxt block next | trace (&quot;sexec_block: &quot;++ show (head block)) False = error &quot;trace&quot;</span><span>
</span><span id="line-241"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sexec_block"><span class="hs-identifier hs-var">sexec_block</span></a></span><span> </span><span id="local-6989586621679404450"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404450"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404451"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679404451"><span class="hs-identifier hs-var">store_pointer_analysis</span></a></span></span><span> </span><span id="local-6989586621679404452"><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679404452"><span class="hs-identifier hs-var">block</span></a></span></span><span> </span><span id="local-6989586621679404453"><span class="annot"><span class="annottext">Maybe [Instruction]
</span><a href="#local-6989586621679404453"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT (Sstate v p, VCS v) Identity ()
</span><a href="#local-6989586621679404454"><span class="hs-identifier hs-var">run</span></a></span><span>
</span><span id="line-242"></span><span> </span><span class="hs-keyword">where</span><span> </span><span>
</span><span id="line-243"></span><span>  </span><span id="local-6989586621679404454"><span class="annot"><span class="annottext">run :: StateT (Sstate v p, VCS v) Identity ()
</span><a href="#local-6989586621679404454"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-244"></span><span>    </span><span class="annot"><span class="annottext">(Instruction -&gt; StateT (Sstate v p, VCS v) Identity ())
-&gt; [Instruction] -&gt; StateT (Sstate v p, VCS v) Identity [()]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ctxt
-&gt; Bool -&gt; Instruction -&gt; StateT (Sstate v p, VCS v) Identity ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Bool -&gt; Instruction -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sexec_instr"><span class="hs-identifier hs-var">sexec_instr</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404450"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679404451"><span class="hs-identifier hs-var">store_pointer_analysis</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679404452"><span class="hs-identifier hs-var">block</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="annottext">Maybe [Instruction] -&gt; StateT (Sstate v p, VCS v) Identity ()
</span><a href="#local-6989586621679404468"><span class="hs-identifier hs-var">set_flagstatus</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [Instruction]
</span><a href="#local-6989586621679404453"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621679404468"><span class="annot"><span class="annottext">set_flagstatus :: Maybe [Instruction] -&gt; StateT (Sstate v p, VCS v) Identity ()
</span><a href="#local-6989586621679404468"><span class="hs-identifier hs-var hs-var">set_flagstatus</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe [Instruction]
</span><span class="hs-identifier hs-var">Nothing</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateT (Sstate v p, VCS v) Identity ()
forall a. a -&gt; StateT (Sstate v p, VCS v) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><a href="#local-6989586621679404468"><span class="hs-identifier hs-var">set_flagstatus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679404486"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404486"><span class="hs-identifier hs-var">i'</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Instruction]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><span class="annottext">ctxt
-&gt; String
-&gt; Register
-&gt; v
-&gt; StateT (Sstate v p, VCS v) Identity ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; Register -&gt; v -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.Sstate.html#swrite_reg"><span class="hs-identifier hs-var">swrite_reg</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404450"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;set_rip&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GPR -&gt; Register
</span><a href="Data.X86.Register.html#Reg64"><span class="hs-identifier hs-var">Reg64</span></a></span><span> </span><span class="annot"><span class="annottext">GPR
</span><a href="Data.X86.Register.html#RIP"><span class="hs-identifier hs-var">RIP</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ctxt -&gt; Word64 -&gt; v
forall i. Integral i =&gt; ctxt -&gt; i -&gt; v
forall ctxt v p i.
(WithAbstractSymbolicValues ctxt v p, Integral i) =&gt;
ctxt -&gt; i -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#simmediate"><span class="hs-identifier hs-var">simmediate</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404450"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; v) -&gt; Word64 -&gt; v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; Word64
</span><a href="Data.X86.Instruction.html#inAddress"><span class="hs-identifier hs-var">inAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679404486"><span class="hs-identifier hs-var">i'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><span class="annottext">((Sstate v p, VCS v) -&gt; (Sstate v p, VCS v))
-&gt; StateT (Sstate v p, VCS v) Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">(((Sstate v p, VCS v) -&gt; (Sstate v p, VCS v))
 -&gt; StateT (Sstate v p, VCS v) Identity ())
-&gt; ((Sstate v p, VCS v) -&gt; (Sstate v p, VCS v))
-&gt; StateT (Sstate v p, VCS v) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679404487"><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404487"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679404488"><span class="annot"><span class="annottext">VCS v
</span><a href="#local-6989586621679404488"><span class="hs-identifier hs-var">vcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404487"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#sflags"><span class="hs-identifier hs-var">sflags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#add_jump_to_pred"><span class="hs-identifier hs-type">add_jump_to_pred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">last</span></span><span> </span><span class="annot"><a href="#local-6989586621679404452"><span class="hs-identifier hs-type">block</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679404486"><span class="hs-identifier hs-type">i'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#sflags"><span class="hs-identifier hs-var">sflags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679404487"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VCS v
</span><a href="#local-6989586621679404488"><span class="hs-identifier hs-var">vcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span id="local-6989586621679403709"><span id="local-6989586621679403710"><span id="local-6989586621679403711"><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sjoin_mem"><span class="hs-identifier hs-type">sjoin_mem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#WithAbstractSymbolicValues"><span class="hs-identifier hs-type">WithAbstractSymbolicValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403709"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403710"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403711"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403709"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403710"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403711"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403710"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403711"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679403711"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679403710"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-255"></span><span id="sjoin_mem"><span class="annot"><span class="annottext">sjoin_mem :: forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt
-&gt; String -&gt; Sstate v p -&gt; Sstate v p -&gt; Map (p, Maybe ByteSize) v
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sjoin_mem"><span class="hs-identifier hs-var hs-var">sjoin_mem</span></a></span></span><span> </span><span id="local-6989586621679404499"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404499"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404500"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404500"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679404501"><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404501"><span class="hs-identifier hs-var">s0</span></a></span></span><span> </span><span id="local-6989586621679404502"><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404502"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679404511"><span class="annot"><span class="annottext">shared :: Map (p, Maybe ByteSize) v
</span><a href="#local-6989586621679404511"><span class="hs-identifier hs-var hs-var">shared</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v)
-&gt; Map (p, Maybe ByteSize) v
-&gt; Map (p, Maybe ByteSize) v
-&gt; Map (p, Maybe ByteSize) v
forall k a b c.
Ord k =&gt;
(a -&gt; b -&gt; c) -&gt; Map k a -&gt; Map k b -&gt; Map k c
</span><span class="hs-identifier hs-var">M.intersectionWith</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679404513"><span class="hs-identifier hs-var">join_values</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sstate v p -&gt; Map (p, Maybe ByteSize) v
forall v p. Sstate v p -&gt; Map (p, Maybe ByteSize) v
</span><a href="WithAbstractSymbolicValues.Class.html#smem"><span class="hs-identifier hs-var">smem</span></a></span><span> </span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404501"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sstate v p -&gt; Map (p, Maybe ByteSize) v
forall v p. Sstate v p -&gt; Map (p, Maybe ByteSize) v
</span><a href="WithAbstractSymbolicValues.Class.html#smem"><span class="hs-identifier hs-var">smem</span></a></span><span> </span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404502"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>      </span><span id="local-6989586621679404520"><span class="annot"><span class="annottext">from_s1 :: [(((p, Maybe ByteSize), v), Sstate v p)]
</span><a href="#local-6989586621679404520"><span class="hs-identifier hs-var hs-var">from_s1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((p, Maybe ByteSize), v)
 -&gt; (((p, Maybe ByteSize), v), Sstate v p))
-&gt; [((p, Maybe ByteSize), v)]
-&gt; [(((p, Maybe ByteSize), v), Sstate v p)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679404521"><span class="annot"><span class="annottext">((p, Maybe ByteSize), v)
</span><a href="#local-6989586621679404521"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((p, Maybe ByteSize), v)
</span><a href="#local-6989586621679404521"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404501"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([((p, Maybe ByteSize), v)]
 -&gt; [(((p, Maybe ByteSize), v), Sstate v p)])
-&gt; [((p, Maybe ByteSize), v)]
-&gt; [(((p, Maybe ByteSize), v), Sstate v p)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map (p, Maybe ByteSize) v -&gt; [((p, Maybe ByteSize), v)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.assocs</span></span><span> </span><span class="annot"><span class="annottext">(Map (p, Maybe ByteSize) v -&gt; [((p, Maybe ByteSize), v)])
-&gt; Map (p, Maybe ByteSize) v -&gt; [((p, Maybe ByteSize), v)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map (p, Maybe ByteSize) v
-&gt; Map (p, Maybe ByteSize) v -&gt; Map (p, Maybe ByteSize) v
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><span class="hs-identifier hs-var">M.difference</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sstate v p -&gt; Map (p, Maybe ByteSize) v
forall v p. Sstate v p -&gt; Map (p, Maybe ByteSize) v
</span><a href="WithAbstractSymbolicValues.Class.html#smem"><span class="hs-identifier hs-var">smem</span></a></span><span> </span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404502"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sstate v p -&gt; Map (p, Maybe ByteSize) v
forall v p. Sstate v p -&gt; Map (p, Maybe ByteSize) v
</span><a href="WithAbstractSymbolicValues.Class.html#smem"><span class="hs-identifier hs-var">smem</span></a></span><span> </span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404501"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>      </span><span id="local-6989586621679404529"><span class="annot"><span class="annottext">from_s0 :: [(((p, Maybe ByteSize), v), Sstate v p)]
</span><a href="#local-6989586621679404529"><span class="hs-identifier hs-var hs-var">from_s0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((p, Maybe ByteSize), v)
 -&gt; (((p, Maybe ByteSize), v), Sstate v p))
-&gt; [((p, Maybe ByteSize), v)]
-&gt; [(((p, Maybe ByteSize), v), Sstate v p)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679404530"><span class="annot"><span class="annottext">((p, Maybe ByteSize), v)
</span><a href="#local-6989586621679404530"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((p, Maybe ByteSize), v)
</span><a href="#local-6989586621679404530"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404502"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([((p, Maybe ByteSize), v)]
 -&gt; [(((p, Maybe ByteSize), v), Sstate v p)])
-&gt; [((p, Maybe ByteSize), v)]
-&gt; [(((p, Maybe ByteSize), v), Sstate v p)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map (p, Maybe ByteSize) v -&gt; [((p, Maybe ByteSize), v)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.assocs</span></span><span> </span><span class="annot"><span class="annottext">(Map (p, Maybe ByteSize) v -&gt; [((p, Maybe ByteSize), v)])
-&gt; Map (p, Maybe ByteSize) v -&gt; [((p, Maybe ByteSize), v)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map (p, Maybe ByteSize) v
-&gt; Map (p, Maybe ByteSize) v -&gt; Map (p, Maybe ByteSize) v
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><span class="hs-identifier hs-var">M.difference</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sstate v p -&gt; Map (p, Maybe ByteSize) v
forall v p. Sstate v p -&gt; Map (p, Maybe ByteSize) v
</span><a href="WithAbstractSymbolicValues.Class.html#smem"><span class="hs-identifier hs-var">smem</span></a></span><span> </span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404501"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sstate v p -&gt; Map (p, Maybe ByteSize) v
forall v p. Sstate v p -&gt; Map (p, Maybe ByteSize) v
</span><a href="WithAbstractSymbolicValues.Class.html#smem"><span class="hs-identifier hs-var">smem</span></a></span><span> </span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404502"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="annottext">Map (p, Maybe ByteSize) v
-&gt; [(((p, Maybe ByteSize), v), Sstate v p)]
-&gt; Map (p, Maybe ByteSize) v
</span><a href="#local-6989586621679404531"><span class="hs-identifier hs-var">sjoin_mem'</span></a></span><span> </span><span class="annot"><span class="annottext">Map (p, Maybe ByteSize) v
</span><a href="#local-6989586621679404511"><span class="hs-identifier hs-var">shared</span></a></span><span> </span><span class="annot"><span class="annottext">([(((p, Maybe ByteSize), v), Sstate v p)]
 -&gt; Map (p, Maybe ByteSize) v)
-&gt; [(((p, Maybe ByteSize), v), Sstate v p)]
-&gt; Map (p, Maybe ByteSize) v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(((p, Maybe ByteSize), v), Sstate v p)]
</span><a href="#local-6989586621679404520"><span class="hs-identifier hs-var">from_s1</span></a></span><span> </span><span class="annot"><span class="annottext">[(((p, Maybe ByteSize), v), Sstate v p)]
-&gt; [(((p, Maybe ByteSize), v), Sstate v p)]
-&gt; [(((p, Maybe ByteSize), v), Sstate v p)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(((p, Maybe ByteSize), v), Sstate v p)]
</span><a href="#local-6989586621679404529"><span class="hs-identifier hs-var">from_s0</span></a></span><span>
</span><span id="line-260"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679404531"><span class="annot"><span class="annottext">sjoin_mem' :: Map (p, Maybe ByteSize) v
-&gt; [(((p, Maybe ByteSize), v), Sstate v p)]
-&gt; Map (p, Maybe ByteSize) v
</span><a href="#local-6989586621679404531"><span class="hs-identifier hs-var hs-var">sjoin_mem'</span></a></span></span><span> </span><span id="local-6989586621679404532"><span class="annot"><span class="annottext">Map (p, Maybe ByteSize) v
</span><a href="#local-6989586621679404532"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (p, Maybe ByteSize) v
</span><a href="#local-6989586621679404532"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><a href="#local-6989586621679404531"><span class="hs-identifier hs-var">sjoin_mem'</span></a></span><span> </span><span id="local-6989586621679404533"><span class="annot"><span class="annottext">Map (p, Maybe ByteSize) v
</span><a href="#local-6989586621679404533"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679404534"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679404534"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679404535"><span class="annot"><span class="annottext">Maybe ByteSize
</span><a href="#local-6989586621679404535"><span class="hs-identifier hs-var">si</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621679404536"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404536"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621679404537"><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404537"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679404538"><span class="annot"><span class="annottext">[(((p, Maybe ByteSize), v), Sstate v p)]
</span><a href="#local-6989586621679404538"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679404560"><span class="annot"><span class="annottext">v' :: v
</span><a href="#local-6989586621679404560"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State (Sstate v p, VCS v) v -&gt; Sstate v p -&gt; v
forall v p a. State (Sstate v p, VCS v) a -&gt; Sstate v p -&gt; a
</span><a href="WithAbstractSymbolicValues.Sstate.html#evalSstate"><span class="hs-identifier hs-var">evalSstate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ctxt
-&gt; String -&gt; p -&gt; Maybe ByteSize -&gt; State (Sstate v p, VCS v) v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt
-&gt; String -&gt; p -&gt; Maybe ByteSize -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.Sstate.html#sread_mem_from_ptr"><span class="hs-identifier hs-var">sread_mem_from_ptr</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404499"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;joinmem&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(p, Maybe ByteSize, Sstate v p, Sstate v p) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679404534"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe ByteSize
</span><a href="#local-6989586621679404535"><span class="hs-identifier hs-var">si</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404501"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404502"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404500"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679404534"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteSize
</span><a href="#local-6989586621679404535"><span class="hs-identifier hs-var">si</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404537"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-264"></span><span>        </span><span id="local-6989586621679404562"><span class="annot"><span class="annottext">j :: v
</span><a href="#local-6989586621679404562"><span class="hs-identifier hs-var hs-var">j</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679404513"><span class="hs-identifier hs-var">join_values</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404536"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404560"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-265"></span><span>        </span><span id="local-6989586621679404572"><span class="annot"><span class="annottext">m' :: Map (p, Maybe ByteSize) v
</span><a href="#local-6989586621679404572"><span class="hs-identifier hs-var hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sstate v p -&gt; Map (p, Maybe ByteSize) v
forall v p. Sstate v p -&gt; Map (p, Maybe ByteSize) v
</span><a href="WithAbstractSymbolicValues.Class.html#smem"><span class="hs-identifier hs-var">smem</span></a></span><span> </span><span class="annot"><span class="annottext">(Sstate v p -&gt; Map (p, Maybe ByteSize) v)
-&gt; Sstate v p -&gt; Map (p, Maybe ByteSize) v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State (Sstate v p, VCS v) () -&gt; Sstate v p -&gt; Sstate v p
forall v p b.
State (Sstate v p, VCS v) b -&gt; Sstate v p -&gt; Sstate v p
</span><a href="WithAbstractSymbolicValues.Sstate.html#execSstate"><span class="hs-identifier hs-var">execSstate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ctxt
-&gt; Bool -&gt; p -&gt; Maybe ByteSize -&gt; v -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt
-&gt; Bool -&gt; p -&gt; Maybe ByteSize -&gt; v -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.Sstate.html#swrite_mem_to_ptr"><span class="hs-identifier hs-var">swrite_mem_to_ptr</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404499"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679404534"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteSize
</span><a href="#local-6989586621679404535"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404562"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Sstate v p -&gt; Sstate v p) -&gt; Sstate v p -&gt; Sstate v p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">sregs :: Map Register v
</span><a href="WithAbstractSymbolicValues.Class.html#sregs"><span class="hs-identifier hs-var">sregs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Register v
forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">smem :: Map (p, Maybe ByteSize) v
</span><a href="WithAbstractSymbolicValues.Class.html#smem"><span class="hs-identifier hs-var">smem</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (p, Maybe ByteSize) v
</span><a href="#local-6989586621679404533"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sflags :: FlagStatus
</span><a href="WithAbstractSymbolicValues.Class.html#sflags"><span class="hs-identifier hs-var">sflags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="Data.SymbolicExpression.html#None"><span class="hs-identifier hs-var">None</span></a></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-266"></span><span>      </span><span class="annot"><span class="annottext">Map (p, Maybe ByteSize) v
-&gt; [(((p, Maybe ByteSize), v), Sstate v p)]
-&gt; Map (p, Maybe ByteSize) v
</span><a href="#local-6989586621679404531"><span class="hs-identifier hs-var">sjoin_mem'</span></a></span><span> </span><span class="annot"><span class="annottext">Map (p, Maybe ByteSize) v
</span><a href="#local-6989586621679404572"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">[(((p, Maybe ByteSize), v), Sstate v p)]
</span><a href="#local-6989586621679404538"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679404513"><span class="annot"><span class="annottext">join_values :: v -&gt; v -&gt; v
</span><a href="#local-6989586621679404513"><span class="hs-identifier hs-var hs-var">join_values</span></a></span></span><span> </span><span id="local-6989586621679404591"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404591"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679404592"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404592"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; [v] -&gt; v
forall ctxt v p (t :: * -&gt; *).
(WithAbstractSymbolicValues ctxt v p, Foldable t) =&gt;
ctxt -&gt; String -&gt; t v -&gt; v
forall (t :: * -&gt; *). Foldable t =&gt; ctxt -&gt; String -&gt; t v -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#sjoin_values"><span class="hs-identifier hs-var">sjoin_values</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404499"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;States (mem value) &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404591"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; joined with &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404592"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404500"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404591"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404592"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span id="local-6989586621679403750"><span id="local-6989586621679403751"><span id="local-6989586621679403752"><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sjoin_regs"><span class="hs-identifier hs-type">sjoin_regs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#WithAbstractSymbolicValues"><span class="hs-identifier hs-type">WithAbstractSymbolicValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403750"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403751"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403752"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403750"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="Data.X86.Register.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403751"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="Data.X86.Register.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403751"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="Data.X86.Register.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403751"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-271"></span><span id="sjoin_regs"><span class="annot"><span class="annottext">sjoin_regs :: forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Map Register v -&gt; Map Register v -&gt; Map Register v
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sjoin_regs"><span class="hs-identifier hs-var hs-var">sjoin_regs</span></a></span></span><span> </span><span id="local-6989586621679404605"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404605"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404606"><span class="annot"><span class="annottext">Map Register v
</span><a href="#local-6989586621679404606"><span class="hs-identifier hs-var">r0</span></a></span></span><span> </span><span id="local-6989586621679404607"><span class="annot"><span class="annottext">Map Register v
</span><a href="#local-6989586621679404607"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679404611"><span class="annot"><span class="annottext">regs :: Map Register v
</span><a href="#local-6989586621679404611"><span class="hs-identifier hs-var hs-var">regs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Register -&gt; v -&gt; v -&gt; v)
-&gt; Map Register v -&gt; Map Register v -&gt; Map Register v
forall k a b c.
Ord k =&gt;
(k -&gt; a -&gt; b -&gt; c) -&gt; Map k a -&gt; Map k b -&gt; Map k c
</span><span class="hs-identifier hs-var">M.intersectionWithKey</span></span><span> </span><span class="annot"><span class="annottext">Register -&gt; v -&gt; v -&gt; v
forall {a}. Show a =&gt; a -&gt; v -&gt; v -&gt; v
</span><a href="#local-6989586621679404613"><span class="hs-identifier hs-var">join_reg</span></a></span><span> </span><span class="annot"><span class="annottext">Map Register v
</span><a href="#local-6989586621679404606"><span class="hs-identifier hs-var">r0</span></a></span><span> </span><span class="annot"><span class="annottext">Map Register v
</span><a href="#local-6989586621679404607"><span class="hs-identifier hs-var">r1</span></a></span><span>
</span><span id="line-273"></span><span>      </span><span id="local-6989586621679404615"><span class="annot"><span class="annottext">from0 :: Map Register v
</span><a href="#local-6989586621679404615"><span class="hs-identifier hs-var hs-var">from0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Register -&gt; v -&gt; v) -&gt; Map Register v -&gt; Map Register v
forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">M.mapWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679404617"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404617"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679404618"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404618"><span class="hs-identifier hs-var">v0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; Register -&gt; v
</span><a href="#local-6989586621679404619"><span class="hs-identifier hs-var">join_with_init_value</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404618"><span class="hs-identifier hs-var">v0</span></a></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404617"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map Register v -&gt; Map Register v)
-&gt; Map Register v -&gt; Map Register v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map Register v -&gt; Map Register v -&gt; Map Register v
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><span class="hs-identifier hs-var">M.difference</span></span><span> </span><span class="annot"><span class="annottext">Map Register v
</span><a href="#local-6989586621679404606"><span class="hs-identifier hs-var">r0</span></a></span><span> </span><span class="annot"><span class="annottext">Map Register v
</span><a href="#local-6989586621679404607"><span class="hs-identifier hs-var">r1</span></a></span><span>
</span><span id="line-274"></span><span>      </span><span id="local-6989586621679404621"><span class="annot"><span class="annottext">from1 :: Map Register v
</span><a href="#local-6989586621679404621"><span class="hs-identifier hs-var hs-var">from1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Register -&gt; v -&gt; v) -&gt; Map Register v -&gt; Map Register v
forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">M.mapWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679404622"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404622"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679404623"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404623"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; Register -&gt; v
</span><a href="#local-6989586621679404619"><span class="hs-identifier hs-var">join_with_init_value</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404623"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404622"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map Register v -&gt; Map Register v)
-&gt; Map Register v -&gt; Map Register v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map Register v -&gt; Map Register v -&gt; Map Register v
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><span class="hs-identifier hs-var">M.difference</span></span><span> </span><span class="annot"><span class="annottext">Map Register v
</span><a href="#local-6989586621679404607"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Map Register v
</span><a href="#local-6989586621679404606"><span class="hs-identifier hs-var">r0</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><span class="annottext">[Map Register v] -&gt; Map Register v
forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
f (Map k a) -&gt; Map k a
</span><span class="hs-identifier hs-var">M.unions</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Map Register v
</span><a href="#local-6989586621679404611"><span class="hs-identifier hs-var">regs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map Register v
</span><a href="#local-6989586621679404615"><span class="hs-identifier hs-var">from0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map Register v
</span><a href="#local-6989586621679404621"><span class="hs-identifier hs-var">from1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-276"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-277"></span><span>  </span><span id="local-6989586621679404613"><span class="annot"><span class="annottext">join_reg :: a -&gt; v -&gt; v -&gt; v
</span><a href="#local-6989586621679404613"><span class="hs-identifier hs-var hs-var">join_reg</span></a></span></span><span> </span><span id="local-6989586621679404638"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679404638"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679404639"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404639"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679404640"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404640"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404639"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404640"><span class="hs-identifier hs-var">b</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404639"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; [v] -&gt; v
forall ctxt v p (t :: * -&gt; *).
(WithAbstractSymbolicValues ctxt v p, Foldable t) =&gt;
ctxt -&gt; String -&gt; t v -&gt; v
forall (t :: * -&gt; *). Foldable t =&gt; ctxt -&gt; String -&gt; t v -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#sjoin_values"><span class="hs-identifier hs-var">sjoin_values</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404605"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;joinregs&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679404638"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404639"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404640"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span>  </span><span id="local-6989586621679404619"><span class="annot"><span class="annottext">join_with_init_value :: v -&gt; Register -&gt; v
</span><a href="#local-6989586621679404619"><span class="hs-identifier hs-var hs-var">join_with_init_value</span></a></span></span><span> </span><span id="local-6989586621679404653"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404653"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679404654"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404654"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; [v] -&gt; v
forall ctxt v p (t :: * -&gt; *).
(WithAbstractSymbolicValues ctxt v p, Foldable t) =&gt;
ctxt -&gt; String -&gt; t v -&gt; v
forall (t :: * -&gt; *). Foldable t =&gt; ctxt -&gt; String -&gt; t v -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#sjoin_values"><span class="hs-identifier hs-var">sjoin_values</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404605"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;joinregs2&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Register -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404654"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404653"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Register -&gt; v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Register -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#smk_init_reg_value"><span class="hs-identifier hs-var">smk_init_reg_value</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404605"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679404654"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-282"></span><span>  </span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">--sjoin_states ctxt msg s0 s1 | trace (&quot;sjoin_states&quot;) False = error &quot;trace&quot;</span><span>
</span><span id="line-285"></span><span id="sjoin_states"><span class="annot"><span class="annottext">sjoin_states :: p -&gt; String -&gt; Sstate v p -&gt; Sstate v p -&gt; Sstate v p
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sjoin_states"><span class="hs-identifier hs-var hs-var">sjoin_states</span></a></span></span><span> </span><span id="local-6989586621679404664"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679404664"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404665"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404665"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679404666"><span class="annot"><span class="annottext">s0 :: Sstate v p
</span><a href="#local-6989586621679404666"><span class="hs-identifier hs-var">s0</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span id="local-6989586621679404667"><span class="annot"><span class="annottext">Map Register v
</span><a href="#local-6989586621679404667"><span class="hs-identifier hs-var">regs0</span></a></span></span><span> </span><span id="local-6989586621679404668"><span class="annot"><span class="annottext">Map (p, Maybe ByteSize) v
</span><a href="#local-6989586621679404668"><span class="hs-identifier hs-var">mem0</span></a></span></span><span> </span><span id="local-6989586621679404669"><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404669"><span class="hs-identifier hs-var">flg0</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679404670"><span class="annot"><span class="annottext">s1 :: Sstate v p
</span><a href="#local-6989586621679404670"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span id="local-6989586621679404671"><span class="annot"><span class="annottext">Map Register v
</span><a href="#local-6989586621679404671"><span class="hs-identifier hs-var">regs1</span></a></span></span><span> </span><span id="local-6989586621679404672"><span class="annot"><span class="annottext">Map (p, Maybe ByteSize) v
</span><a href="#local-6989586621679404672"><span class="hs-identifier hs-var">mem1</span></a></span></span><span> </span><span id="local-6989586621679404673"><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404673"><span class="hs-identifier hs-var">flg1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679404674"><span class="annot"><span class="annottext">flg :: FlagStatus
</span><a href="#local-6989586621679404674"><span class="hs-identifier hs-var hs-var">flg</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlagStatus -&gt; FlagStatus -&gt; FlagStatus
</span><a href="#local-6989586621679404675"><span class="hs-identifier hs-var">join_flags</span></a></span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404669"><span class="hs-identifier hs-var">flg0</span></a></span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404673"><span class="hs-identifier hs-var">flg1</span></a></span><span>
</span><span id="line-287"></span><span>      </span><span id="local-6989586621679404685"><span class="annot"><span class="annottext">regs :: Map Register v
</span><a href="#local-6989586621679404685"><span class="hs-identifier hs-var hs-var">regs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p -&gt; Map Register v -&gt; Map Register v -&gt; Map Register v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Map Register v -&gt; Map Register v -&gt; Map Register v
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sjoin_regs"><span class="hs-identifier hs-var">sjoin_regs</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679404664"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Map Register v
</span><a href="#local-6989586621679404667"><span class="hs-identifier hs-var">regs0</span></a></span><span> </span><span class="annot"><span class="annottext">Map Register v
</span><a href="#local-6989586621679404671"><span class="hs-identifier hs-var">regs1</span></a></span><span>
</span><span id="line-288"></span><span>      </span><span id="local-6989586621679404695"><span class="annot"><span class="annottext">mem :: Map (p, Maybe ByteSize) v
</span><a href="#local-6989586621679404695"><span class="hs-identifier hs-var hs-var">mem</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
-&gt; String -&gt; Sstate v p -&gt; Sstate v p -&gt; Map (p, Maybe ByteSize) v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt
-&gt; String -&gt; Sstate v p -&gt; Sstate v p -&gt; Map (p, Maybe ByteSize) v
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sjoin_mem"><span class="hs-identifier hs-var">sjoin_mem</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679404664"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404665"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404666"><span class="hs-identifier hs-var">s0</span></a></span><span> </span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404670"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-289"></span><span>      </span><span id="local-6989586621679404696"><span class="annot"><span class="annottext">s' :: Sstate v p
</span><a href="#local-6989586621679404696"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Register v
-&gt; Map (p, Maybe ByteSize) v -&gt; FlagStatus -&gt; Sstate v p
forall v p.
Map Register v
-&gt; Map (p, Maybe ByteSize) v -&gt; FlagStatus -&gt; Sstate v p
</span><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-var">Sstate</span></a></span><span> </span><span class="annot"><span class="annottext">Map Register v
</span><a href="#local-6989586621679404685"><span class="hs-identifier hs-var">regs</span></a></span><span> </span><span class="annot"><span class="annottext">Map (p, Maybe ByteSize) v
</span><a href="#local-6989586621679404695"><span class="hs-identifier hs-var">mem</span></a></span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404674"><span class="hs-identifier hs-var">flg</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-290"></span><span>     </span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404696"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-291"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-292"></span><span>  </span><span id="local-6989586621679404675"><span class="annot"><span class="annottext">join_flags :: FlagStatus -&gt; FlagStatus -&gt; FlagStatus
</span><a href="#local-6989586621679404675"><span class="hs-identifier hs-var hs-var">join_flags</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SymbolicExpression.html#FS_CMP"><span class="hs-identifier hs-type">FS_CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679404705"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404705"><span class="hs-identifier hs-var">o0</span></a></span></span><span> </span><span id="local-6989586621679404706"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404706"><span class="hs-identifier hs-var">v0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SymbolicExpression.html#FS_CMP"><span class="hs-identifier hs-type">FS_CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679404707"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404707"><span class="hs-identifier hs-var">o0'</span></a></span></span><span> </span><span id="local-6989586621679404708"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404708"><span class="hs-identifier hs-var">v0'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404669"><span class="hs-identifier hs-var">flg0</span></a></span><span> </span><span class="annot"><span class="annottext">FlagStatus -&gt; FlagStatus -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404673"><span class="hs-identifier hs-var">flg1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404669"><span class="hs-identifier hs-var">flg0</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404705"><span class="hs-identifier hs-var">o0</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404707"><span class="hs-identifier hs-var">o0'</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="Data.SymbolicExpression.html#None"><span class="hs-identifier hs-var">None</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-296"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404706"><span class="hs-identifier hs-var">v0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404708"><span class="hs-identifier hs-var">v0'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-297"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Imm"><span class="hs-identifier hs-type">Op_Imm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span id="local-6989586621679404709"><span class="annot"><span class="annottext">BitSize
</span><a href="#local-6989586621679404709"><span class="hs-identifier hs-var">si0</span></a></span></span><span> </span><span id="local-6989586621679404710"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404710"><span class="hs-identifier hs-var">n0</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="Data.X86.Instruction.html#Op_Imm"><span class="hs-identifier hs-type">Op_Imm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span id="local-6989586621679404711"><span class="annot"><span class="annottext">BitSize
</span><a href="#local-6989586621679404711"><span class="hs-identifier hs-var">si1</span></a></span></span><span> </span><span id="local-6989586621679404712"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404712"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Operand -&gt; Operand -&gt; FlagStatus
</span><a href="Data.SymbolicExpression.html#FS_CMP"><span class="hs-identifier hs-var">FS_CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621679404705"><span class="hs-identifier hs-var">o0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Immediate -&gt; Operand
</span><a href="Data.X86.Instruction.html#Op_Imm"><span class="hs-identifier hs-var">Op_Imm</span></a></span><span> </span><span class="annot"><span class="annottext">(Immediate -&gt; Operand) -&gt; Immediate -&gt; Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BitSize -&gt; Word64 -&gt; Immediate
</span><a href="Data.X86.Instruction.html#Immediate"><span class="hs-identifier hs-var">Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BitSize -&gt; BitSize -&gt; BitSize
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">BitSize
</span><a href="#local-6989586621679404709"><span class="hs-identifier hs-var">si0</span></a></span><span> </span><span class="annot"><span class="annottext">BitSize
</span><a href="#local-6989586621679404711"><span class="hs-identifier hs-var">si1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404710"><span class="hs-identifier hs-var">n0</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679404712"><span class="hs-identifier hs-var">n1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>        </span><span class="annot"><span class="annottext">(Operand, Operand)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="Data.SymbolicExpression.html#None"><span class="hs-identifier hs-var">None</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="annot"><a href="#local-6989586621679404675"><span class="hs-identifier hs-var">join_flags</span></a></span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><span class="hs-identifier">_</span></span><span> </span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404669"><span class="hs-identifier hs-var">flg0</span></a></span><span> </span><span class="annot"><span class="annottext">FlagStatus -&gt; FlagStatus -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404673"><span class="hs-identifier hs-var">flg1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="#local-6989586621679404669"><span class="hs-identifier hs-var">flg0</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><a href="Data.SymbolicExpression.html#None"><span class="hs-identifier hs-var">None</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="annot"><span class="hs-comment">-- | The supremum of a list of predicates</span></span><span>
</span><span id="line-305"></span><span id="local-6989586621679403772"><span id="local-6989586621679403773"><span id="local-6989586621679403774"><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#supremum"><span class="hs-identifier hs-type">supremum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#WithAbstractSymbolicValues"><span class="hs-identifier hs-type">WithAbstractSymbolicValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403772"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403773"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403774"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403772"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403773"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403774"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403773"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403774"><span class="hs-identifier hs-type">p</span></a></span></span></span></span><span>
</span><span id="line-306"></span><span id="supremum"><span class="annot"><span class="annottext">supremum :: forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; [Sstate v p] -&gt; Sstate v p
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#supremum"><span class="hs-identifier hs-var hs-var">supremum</span></a></span></span><span> </span><span id="local-6989586621679404720"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404720"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Sstate v p
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Sstate v p) -&gt; String -&gt; Sstate v p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot compute supremum of []&quot;</span></span><span>
</span><span id="line-307"></span><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#supremum"><span class="hs-identifier hs-var">supremum</span></a></span><span> </span><span id="local-6989586621679404721"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404721"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404722"><span class="annot"><span class="annottext">[Sstate v p]
</span><a href="#local-6989586621679404722"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Sstate v p -&gt; Sstate v p -&gt; Sstate v p)
-&gt; [Sstate v p] -&gt; Sstate v p
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldr1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ctxt -&gt; String -&gt; Sstate v p -&gt; Sstate v p -&gt; Sstate v p
forall {p} {v} {p}.
WithAbstractSymbolicValues p v p =&gt;
p -&gt; String -&gt; Sstate v p -&gt; Sstate v p -&gt; Sstate v p
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sjoin_states"><span class="hs-identifier hs-var">sjoin_states</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404721"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;supremum&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Sstate v p]
</span><a href="#local-6989586621679404722"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span id="simplies"><span class="annot"><span class="annottext">simplies :: p -&gt; Sstate v p -&gt; Sstate v p -&gt; Bool
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#simplies"><span class="hs-identifier hs-var hs-var">simplies</span></a></span></span><span> </span><span id="local-6989586621679404736"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679404736"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679404737"><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404737"><span class="hs-identifier hs-var">s0</span></a></span></span><span> </span><span id="local-6989586621679404738"><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404738"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679404748"><span class="annot"><span class="annottext">j :: Sstate v p
</span><a href="#local-6989586621679404748"><span class="hs-identifier hs-var hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sstate v p -&gt; Sstate v p
</span><a href="#local-6989586621679404749"><span class="hs-identifier hs-var">set_rip</span></a></span><span> </span><span class="annot"><span class="annottext">(Sstate v p -&gt; Sstate v p) -&gt; Sstate v p -&gt; Sstate v p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">p -&gt; String -&gt; Sstate v p -&gt; Sstate v p -&gt; Sstate v p
forall {p} {v} {p}.
WithAbstractSymbolicValues p v p =&gt;
p -&gt; String -&gt; Sstate v p -&gt; Sstate v p -&gt; Sstate v p
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sjoin_states"><span class="hs-identifier hs-var">sjoin_states</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679404736"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;simplies&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404737"><span class="hs-identifier hs-var">s0</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#sflags"><span class="hs-identifier hs-var">sflags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SymbolicExpression.html#None"><span class="hs-identifier hs-type">None</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404738"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#sflags"><span class="hs-identifier hs-var">sflags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SymbolicExpression.html#None"><span class="hs-identifier hs-type">None</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404748"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Sstate v p -&gt; Sstate v p -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Sstate v p -&gt; Sstate v p
</span><a href="#local-6989586621679404749"><span class="hs-identifier hs-var">set_rip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sstate v p
</span><a href="#local-6989586621679404737"><span class="hs-identifier hs-var">s0</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#sflags"><span class="hs-identifier hs-var">sflags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SymbolicExpression.html#None"><span class="hs-identifier hs-type">None</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-312"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-314"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-comment">-- trace (&quot;s0:\n&quot; ++ show s0 ++ &quot;\ns1:\n&quot; ++ show s1 ++ &quot;\nj:\n&quot; ++ show j) False</span><span>
</span><span id="line-315"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>  </span><span id="local-6989586621679404749"><span class="annot"><span class="annottext">set_rip :: Sstate v p -&gt; Sstate v p
</span><a href="#local-6989586621679404749"><span class="hs-identifier hs-var hs-var">set_rip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State (Sstate v p, VCS v) () -&gt; Sstate v p -&gt; Sstate v p
forall v p b.
State (Sstate v p, VCS v) b -&gt; Sstate v p -&gt; Sstate v p
</span><a href="WithAbstractSymbolicValues.Sstate.html#execSstate"><span class="hs-identifier hs-var">execSstate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; String -&gt; Register -&gt; v -&gt; State (Sstate v p, VCS v) ()
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; String -&gt; Register -&gt; v -&gt; State (Sstate v p, VCS v) ()
</span><a href="WithAbstractSymbolicValues.Sstate.html#swrite_rreg"><span class="hs-identifier hs-var">swrite_rreg</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679404736"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;simplies&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GPR -&gt; Register
</span><a href="Data.X86.Register.html#Reg64"><span class="hs-identifier hs-var">Reg64</span></a></span><span> </span><span class="annot"><span class="annottext">GPR
</span><a href="Data.X86.Register.html#RIP"><span class="hs-identifier hs-var">RIP</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; Integer -&gt; v
forall i. Integral i =&gt; p -&gt; i -&gt; v
forall ctxt v p i.
(WithAbstractSymbolicValues ctxt v p, Integral i) =&gt;
ctxt -&gt; i -&gt; v
</span><a href="WithAbstractSymbolicValues.Class.html#simmediate"><span class="hs-identifier hs-var">simmediate</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679404736"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span id="local-6989586621679403784"><span id="local-6989586621679403785"><span id="local-6989586621679403786"><span class="annot"><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sverify_postcondition"><span class="hs-identifier hs-type">sverify_postcondition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#WithAbstractSymbolicValues"><span class="hs-identifier hs-type">WithAbstractSymbolicValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403784"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403785"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403786"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403784"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="WithAbstractSymbolicValues.Class.html#Sstate"><span class="hs-identifier hs-type">Sstate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403785"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403786"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-321"></span><span id="sverify_postcondition"><span class="annot"><span class="annottext">sverify_postcondition :: forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Sstate v p -&gt; Bool
</span><a href="WithAbstractSymbolicValues.SymbolicExecution.html#sverify_postcondition"><span class="hs-identifier hs-var hs-var">sverify_postcondition</span></a></span></span><span> </span><span id="local-6989586621679404776"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404776"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State (Sstate v p, VCS v) Bool -&gt; Sstate v p -&gt; Bool
forall v p a. State (Sstate v p, VCS v) a -&gt; Sstate v p -&gt; a
</span><a href="WithAbstractSymbolicValues.Sstate.html#evalSstate"><span class="hs-identifier hs-var">evalSstate</span></a></span><span> </span><span class="annot"><span class="annottext">State (Sstate v p, VCS v) Bool
</span><a href="#local-6989586621679404777"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-322"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-323"></span><span>  </span><span id="local-6989586621679404777"><span class="annot"><span class="annottext">check :: State (Sstate v p, VCS v) Bool
</span><a href="#local-6989586621679404777"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621679404793"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404793"><span class="hs-identifier hs-var">rsp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Register -&gt; State (Sstate v p, VCS v) v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Register -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.Sstate.html#sread_reg"><span class="hs-identifier hs-var">sread_reg</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404776"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GPR -&gt; Register
</span><a href="Data.X86.Register.html#Reg64"><span class="hs-identifier hs-var">Reg64</span></a></span><span> </span><span class="annot"><span class="annottext">GPR
</span><a href="Data.X86.Register.html#RSP"><span class="hs-identifier hs-var">RSP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>    </span><span id="local-6989586621679404794"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404794"><span class="hs-identifier hs-var">rip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; Register -&gt; State (Sstate v p, VCS v) v
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; Register -&gt; State (Sstate v p, VCS v) v
</span><a href="WithAbstractSymbolicValues.Sstate.html#sread_reg"><span class="hs-identifier hs-var">sread_reg</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404776"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GPR -&gt; Register
</span><a href="Data.X86.Register.html#Reg64"><span class="hs-identifier hs-var">Reg64</span></a></span><span> </span><span class="annot"><span class="annottext">GPR
</span><a href="Data.X86.Register.html#RIP"><span class="hs-identifier hs-var">RIP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; State (Sstate v p, VCS v) Bool
forall a. a -&gt; StateT (Sstate v p, VCS v) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; State (Sstate v p, VCS v) Bool)
-&gt; Bool -&gt; State (Sstate v p, VCS v) Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; v -&gt; v -&gt; Bool
forall ctxt v p.
WithAbstractSymbolicValues ctxt v p =&gt;
ctxt -&gt; v -&gt; v -&gt; Bool
</span><a href="WithAbstractSymbolicValues.Class.html#scheck_regs_in_postcondition"><span class="hs-identifier hs-var">scheck_regs_in_postcondition</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679404776"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404794"><span class="hs-identifier hs-var">rip</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679404793"><span class="hs-identifier hs-var">rsp</span></a></span><span> </span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span></pre></body></html>