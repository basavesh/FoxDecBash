<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures , FlexibleContexts, StrictData, DeriveGeneric, StandaloneDeriving #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_HADDOCK prune  #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="annot"><span class="hs-comment">{-|
Module      : NASM
Description : A datastructure for storing NASM code.
-}</span></span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">OutputGeneration.NASM.NASM</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Base.html"><span class="hs-identifier">Base</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X86.Opcode.html"><span class="hs-identifier">Data.X86.Opcode</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html"><span class="hs-identifier">Data.X86.Instruction</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Symbol.html"><span class="hs-identifier">Data.Symbol</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Size.html"><span class="hs-identifier">Data.Size</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.JumpTarget.html"><span class="hs-identifier">Data.JumpTarget</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Binary.Generic.html"><span class="hs-identifier">Binary.Generic</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X86.Register.html"><span class="hs-identifier">Data.X86.Register</span></a></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Serialize</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Cereal</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">put</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">encode</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">testBit</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IM</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IS</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Internal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">w2c</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="annot"><span class="hs-comment">-- | NASM contains external symbols, sections, and a footer</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">data</span><span> </span><span id="NASM"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM"><span class="hs-identifier hs-var">NASM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NASM"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM"><span class="hs-identifier hs-var">NASM</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-46"></span><span>  </span><span id="nasm_externals"><span class="annot"><span class="annottext">NASM -&gt; Set String
</span><a href="OutputGeneration.NASM.NASM.html#nasm_externals"><span class="hs-identifier hs-var hs-var">nasm_externals</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>  </span><span id="nasm_globals"><span class="annot"><span class="annottext">NASM -&gt; Set String
</span><a href="OutputGeneration.NASM.NASM.html#nasm_globals"><span class="hs-identifier hs-var hs-var">nasm_globals</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>  </span><span id="nasm_sections"><span class="annot"><span class="annottext">NASM -&gt; [NASM_Section]
</span><a href="OutputGeneration.NASM.NASM.html#nasm_sections"><span class="hs-identifier hs-var hs-var">nasm_sections</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Section"><span class="hs-identifier hs-type">NASM_Section</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>  </span><span id="nasm_footer"><span class="annot"><span class="annottext">NASM -&gt; [String]
</span><a href="OutputGeneration.NASM.NASM.html#nasm_footer"><span class="hs-identifier hs-var hs-var">nasm_footer</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-50"></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-51"></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391471"><span id="local-6989586621679391473"><span class="annot"><span class="annottext">(forall x. NASM -&gt; Rep NASM x)
-&gt; (forall x. Rep NASM x -&gt; NASM) -&gt; Generic NASM
forall x. Rep NASM x -&gt; NASM
forall x. NASM -&gt; Rep NASM x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. NASM -&gt; Rep NASM x
from :: forall x. NASM -&gt; Rep NASM x
$cto :: forall x. Rep NASM x -&gt; NASM
to :: forall x. Rep NASM x -&gt; NASM
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- | A NASM label is either a string, or a macro. The latter is used when referring to addresses within data sections.</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-55"></span><span class="hs-comment">--</span><span>
</span><span id="line-56"></span><span class="hs-comment">--    Macro &quot;&quot; &quot;.data&quot; 0x4000 0x23</span><span>
</span><span id="line-57"></span><span class="hs-comment">--</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- refers to segment &quot;&quot;, and the section &quot;.data&quot; that starts at immediate address 0x4000. So the real adress was 0x4023.</span><span>
</span><span id="line-59"></span><span class="hs-keyword">data</span><span> </span><span id="NASM_Label"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Label"><span class="hs-identifier hs-var">NASM_Label</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-60"></span><span>    </span><span id="Label"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#Label"><span class="hs-identifier hs-var">Label</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Normal label</span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Macro"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#Macro"><span class="hs-identifier hs-var">Macro</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Macro into data section (segment, section, a0, offset)</span></span><span>
</span><span id="line-62"></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391479"><span id="local-6989586621679391490"><span class="annot"><span class="annottext">NASM_Label -&gt; NASM_Label -&gt; Bool
(NASM_Label -&gt; NASM_Label -&gt; Bool)
-&gt; (NASM_Label -&gt; NASM_Label -&gt; Bool) -&gt; Eq NASM_Label
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: NASM_Label -&gt; NASM_Label -&gt; Bool
== :: NASM_Label -&gt; NASM_Label -&gt; Bool
$c/= :: NASM_Label -&gt; NASM_Label -&gt; Bool
/= :: NASM_Label -&gt; NASM_Label -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679391498"><span id="local-6989586621679391509"><span id="local-6989586621679391518"><span id="local-6989586621679391522"><span id="local-6989586621679391525"><span id="local-6989586621679391528"><span id="local-6989586621679391531"><span class="annot"><span class="annottext">Eq NASM_Label
Eq NASM_Label =&gt;
(NASM_Label -&gt; NASM_Label -&gt; Ordering)
-&gt; (NASM_Label -&gt; NASM_Label -&gt; Bool)
-&gt; (NASM_Label -&gt; NASM_Label -&gt; Bool)
-&gt; (NASM_Label -&gt; NASM_Label -&gt; Bool)
-&gt; (NASM_Label -&gt; NASM_Label -&gt; Bool)
-&gt; (NASM_Label -&gt; NASM_Label -&gt; NASM_Label)
-&gt; (NASM_Label -&gt; NASM_Label -&gt; NASM_Label)
-&gt; Ord NASM_Label
NASM_Label -&gt; NASM_Label -&gt; Bool
NASM_Label -&gt; NASM_Label -&gt; Ordering
NASM_Label -&gt; NASM_Label -&gt; NASM_Label
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: NASM_Label -&gt; NASM_Label -&gt; Ordering
compare :: NASM_Label -&gt; NASM_Label -&gt; Ordering
$c&lt; :: NASM_Label -&gt; NASM_Label -&gt; Bool
&lt; :: NASM_Label -&gt; NASM_Label -&gt; Bool
$c&lt;= :: NASM_Label -&gt; NASM_Label -&gt; Bool
&lt;= :: NASM_Label -&gt; NASM_Label -&gt; Bool
$c&gt; :: NASM_Label -&gt; NASM_Label -&gt; Bool
&gt; :: NASM_Label -&gt; NASM_Label -&gt; Bool
$c&gt;= :: NASM_Label -&gt; NASM_Label -&gt; Bool
&gt;= :: NASM_Label -&gt; NASM_Label -&gt; Bool
$cmax :: NASM_Label -&gt; NASM_Label -&gt; NASM_Label
max :: NASM_Label -&gt; NASM_Label -&gt; NASM_Label
$cmin :: NASM_Label -&gt; NASM_Label -&gt; NASM_Label
min :: NASM_Label -&gt; NASM_Label -&gt; NASM_Label
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679391536"><span id="local-6989586621679391538"><span class="annot"><span class="annottext">(forall x. NASM_Label -&gt; Rep NASM_Label x)
-&gt; (forall x. Rep NASM_Label x -&gt; NASM_Label) -&gt; Generic NASM_Label
forall x. Rep NASM_Label x -&gt; NASM_Label
forall x. NASM_Label -&gt; Rep NASM_Label x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. NASM_Label -&gt; Rep NASM_Label x
from :: forall x. NASM_Label -&gt; Rep NASM_Label x
$cto :: forall x. Rep NASM_Label x -&gt; NASM_Label
to :: forall x. Rep NASM_Label x -&gt; NASM_Label
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><span class="hs-comment">-- | A NASM section is either a NASM text section or NASM data section</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">data</span><span> </span><span id="NASM_Section"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Section"><span class="hs-identifier hs-var">NASM_Section</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NASM_Section_Text"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Section_Text"><span class="hs-identifier hs-var">NASM_Section_Text</span></a></span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_TextSection"><span class="hs-identifier hs-type">NASM_TextSection</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="NASM_Section_Data"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Section_Data"><span class="hs-identifier hs-var">NASM_Section_Data</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_DataSection"><span class="hs-identifier hs-type">NASM_DataSection</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679391543"><span id="local-6989586621679391545"><span class="annot"><span class="annottext">(forall x. NASM_Section -&gt; Rep NASM_Section x)
-&gt; (forall x. Rep NASM_Section x -&gt; NASM_Section)
-&gt; Generic NASM_Section
forall x. Rep NASM_Section x -&gt; NASM_Section
forall x. NASM_Section -&gt; Rep NASM_Section x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. NASM_Section -&gt; Rep NASM_Section x
from :: forall x. NASM_Section -&gt; Rep NASM_Section x
$cto :: forall x. Rep NASM_Section x -&gt; NASM_Section
to :: forall x. Rep NASM_Section x -&gt; NASM_Section
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | An annotation consists of an address that is being symbolized to a label and an offset.</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- The offset will often be 0.</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-72"></span><span class="hs-comment">--   0x1016 --&gt; L1000_2</span><span>
</span><span id="line-73"></span><span class="hs-comment">--   0x4028 --&gt; L_.bss_0x4020 + 0x8</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- Annotations translate to NASM comments, and have no effect on the actual NASM itself.</span><span>
</span><span id="line-75"></span><span class="hs-keyword">type</span><span> </span><span id="Annot"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#Annot"><span class="hs-identifier hs-var">Annot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">,</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Label"><span class="hs-identifier hs-type">NASM_Label</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | A NASM text section contains a name and an **ordered** list of basic blocks.</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- Each basic block has an ID and a list of lines.</span><span>
</span><span id="line-79"></span><span class="hs-keyword">data</span><span> </span><span id="NASM_TextSection"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_TextSection"><span class="hs-identifier hs-var">NASM_TextSection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NASM_TextSection"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_TextSection"><span class="hs-identifier hs-var">NASM_TextSection</span></a></span></span><span>  </span><span class="hs-special">{</span><span>
</span><span id="line-80"></span><span>  </span><span id="nasm_function_name"><span class="annot"><span class="annottext">NASM_TextSection -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#nasm_function_name"><span class="hs-identifier hs-var hs-var">nasm_function_name</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>  </span><span id="nasm_blocks"><span class="annot"><span class="annottext">NASM_TextSection -&gt; [(Int, [NASM_Line])]
</span><a href="OutputGeneration.NASM.NASM.html#nasm_blocks"><span class="hs-identifier hs-var hs-var">nasm_blocks</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Line"><span class="hs-identifier hs-type">NASM_Line</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- ^ A mapping of blockIDs to instructions</span></span><span>
</span><span id="line-82"></span><span>  </span><span id="nasm_cfg"><span class="annot"><span class="annottext">NASM_TextSection -&gt; IntMap IntSet
</span><a href="OutputGeneration.NASM.NASM.html#nasm_cfg"><span class="hs-identifier hs-var hs-var">nasm_cfg</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IM.IntMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IS.IntSet</span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679391552"><span id="local-6989586621679391554"><span class="annot"><span class="annottext">(forall x. NASM_TextSection -&gt; Rep NASM_TextSection x)
-&gt; (forall x. Rep NASM_TextSection x -&gt; NASM_TextSection)
-&gt; Generic NASM_TextSection
forall x. Rep NASM_TextSection x -&gt; NASM_TextSection
forall x. NASM_TextSection -&gt; Rep NASM_TextSection x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. NASM_TextSection -&gt; Rep NASM_TextSection x
from :: forall x. NASM_TextSection -&gt; Rep NASM_TextSection x
$cto :: forall x. Rep NASM_TextSection x -&gt; NASM_TextSection
to :: forall x. Rep NASM_TextSection x -&gt; NASM_TextSection
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="annot"><span class="hs-comment">-- | A NASM line is either a comment, an instruction or a label</span></span><span>
</span><span id="line-88"></span><span class="hs-keyword">data</span><span> </span><span id="NASM_Line"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Line"><span class="hs-identifier hs-var">NASM_Line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-89"></span><span>    </span><span id="NASM_Comment"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Comment"><span class="hs-identifier hs-var">NASM_Comment</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ A comment with an indentation level (number of spaces)</span></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NASM_Line"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Line"><span class="hs-identifier hs-var">NASM_Line</span></a></span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Instruction"><span class="hs-identifier hs-type">NASM_Instruction</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An instruction with an annotation</span></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NASM_Label"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Label"><span class="hs-identifier hs-var">NASM_Label</span></a></span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Label"><span class="hs-identifier hs-type">NASM_Label</span></a></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ A label</span></span><span>
</span><span id="line-92"></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391560"><span id="local-6989586621679391569"><span class="annot"><span class="annottext">NASM_Line -&gt; NASM_Line -&gt; Bool
(NASM_Line -&gt; NASM_Line -&gt; Bool)
-&gt; (NASM_Line -&gt; NASM_Line -&gt; Bool) -&gt; Eq NASM_Line
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: NASM_Line -&gt; NASM_Line -&gt; Bool
== :: NASM_Line -&gt; NASM_Line -&gt; Bool
$c/= :: NASM_Line -&gt; NASM_Line -&gt; Bool
/= :: NASM_Line -&gt; NASM_Line -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679391573"><span id="local-6989586621679391575"><span class="annot"><span class="annottext">(forall x. NASM_Line -&gt; Rep NASM_Line x)
-&gt; (forall x. Rep NASM_Line x -&gt; NASM_Line) -&gt; Generic NASM_Line
forall x. Rep NASM_Line x -&gt; NASM_Line
forall x. NASM_Line -&gt; Rep NASM_Line x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. NASM_Line -&gt; Rep NASM_Line x
from :: forall x. NASM_Line -&gt; Rep NASM_Line x
$cto :: forall x. Rep NASM_Line x -&gt; NASM_Line
to :: forall x. Rep NASM_Line x -&gt; NASM_Line
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="annot"><span class="hs-comment">-- | An instruction consists of a prefix, an opcode, a list of operands, a comment (possibly empty) and an annotation (possibly empty).</span></span><span>
</span><span id="line-96"></span><span class="hs-keyword">data</span><span> </span><span id="NASM_Instruction"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Instruction"><span class="hs-identifier hs-var">NASM_Instruction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NASM_Instruction"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Instruction"><span class="hs-identifier hs-var">NASM_Instruction</span></a></span></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">{</span><span>
</span><span id="line-98"></span><span>    </span><span id="nasm_prefix"><span class="annot"><span class="annottext">NASM_Instruction -&gt; Maybe Prefix
</span><a href="OutputGeneration.NASM.NASM.html#nasm_prefix"><span class="hs-identifier hs-var hs-var">nasm_prefix</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="nasm_mnemonic"><span class="annot"><span class="annottext">NASM_Instruction -&gt; Maybe Opcode
</span><a href="OutputGeneration.NASM.NASM.html#nasm_mnemonic"><span class="hs-identifier hs-var hs-var">nasm_mnemonic</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.X86.Opcode.html#Opcode"><span class="hs-identifier hs-type">Opcode</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="nasm_operands"><span class="annot"><span class="annottext">NASM_Instruction -&gt; [NASM_Operand]
</span><a href="OutputGeneration.NASM.NASM.html#nasm_operands"><span class="hs-identifier hs-var hs-var">nasm_operands</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand"><span class="hs-identifier hs-type">NASM_Operand</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="nasm_comment"><span class="annot"><span class="annottext">NASM_Instruction -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#nasm_comment"><span class="hs-identifier hs-var hs-var">nasm_comment</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="nasm_annot"><span class="annot"><span class="annottext">NASM_Instruction -&gt; Annot
</span><a href="OutputGeneration.NASM.NASM.html#nasm_annot"><span class="hs-identifier hs-var hs-var">nasm_annot</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#Annot"><span class="hs-identifier hs-type">Annot</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-104"></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391584"><span id="local-6989586621679391597"><span class="annot"><span class="annottext">NASM_Instruction -&gt; NASM_Instruction -&gt; Bool
(NASM_Instruction -&gt; NASM_Instruction -&gt; Bool)
-&gt; (NASM_Instruction -&gt; NASM_Instruction -&gt; Bool)
-&gt; Eq NASM_Instruction
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: NASM_Instruction -&gt; NASM_Instruction -&gt; Bool
== :: NASM_Instruction -&gt; NASM_Instruction -&gt; Bool
$c/= :: NASM_Instruction -&gt; NASM_Instruction -&gt; Bool
/= :: NASM_Instruction -&gt; NASM_Instruction -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679391607"><span id="local-6989586621679391609"><span class="annot"><span class="annottext">(forall x. NASM_Instruction -&gt; Rep NASM_Instruction x)
-&gt; (forall x. Rep NASM_Instruction x -&gt; NASM_Instruction)
-&gt; Generic NASM_Instruction
forall x. Rep NASM_Instruction x -&gt; NASM_Instruction
forall x. NASM_Instruction -&gt; Rep NASM_Instruction x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. NASM_Instruction -&gt; Rep NASM_Instruction x
from :: forall x. NASM_Instruction -&gt; Rep NASM_Instruction x
$cto :: forall x. Rep NASM_Instruction x -&gt; NASM_Instruction
to :: forall x. Rep NASM_Instruction x -&gt; NASM_Instruction
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- | A size directive for a memory operand in bytes. For example (4,True) is the size directive for a 4-byte memory operand.</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- It can be `False` to indicate that the operand should not be rendered (e.g, in case of an LEA instruction).</span><span>
</span><span id="line-109"></span><span class="hs-keyword">type</span><span> </span><span id="NASM_SizeDir"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_SizeDir"><span class="hs-identifier hs-var">NASM_SizeDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-keyword">data</span><span> </span><span id="NASM_Operand"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand"><span class="hs-identifier hs-var">NASM_Operand</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-112"></span><span>    </span><span id="NASM_Operand_Address"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Address"><span class="hs-identifier hs-var">NASM_Operand_Address</span></a></span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Address"><span class="hs-identifier hs-type">NASM_Address</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NASM_Operand_EffectiveAddress"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_EffectiveAddress"><span class="hs-identifier hs-var">NASM_Operand_EffectiveAddress</span></a></span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Address"><span class="hs-identifier hs-type">NASM_Address</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NASM_Operand_Reg"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Reg"><span class="hs-identifier hs-var">NASM_Operand_Reg</span></a></span></span><span> </span><span class="annot"><a href="Data.X86.Register.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NASM_Operand_Memory"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Memory"><span class="hs-identifier hs-var">NASM_Operand_Memory</span></a></span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_SizeDir"><span class="hs-identifier hs-type">NASM_SizeDir</span></a></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Address"><span class="hs-identifier hs-type">NASM_Address</span></a></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NASM_Operand_Immediate"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Immediate"><span class="hs-identifier hs-var">NASM_Operand_Immediate</span></a></span></span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span>
</span><span id="line-117"></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391617"><span id="local-6989586621679391631"><span class="annot"><span class="annottext">NASM_Operand -&gt; NASM_Operand -&gt; Bool
(NASM_Operand -&gt; NASM_Operand -&gt; Bool)
-&gt; (NASM_Operand -&gt; NASM_Operand -&gt; Bool) -&gt; Eq NASM_Operand
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: NASM_Operand -&gt; NASM_Operand -&gt; Bool
== :: NASM_Operand -&gt; NASM_Operand -&gt; Bool
$c/= :: NASM_Operand -&gt; NASM_Operand -&gt; Bool
/= :: NASM_Operand -&gt; NASM_Operand -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679391635"><span id="local-6989586621679391637"><span class="annot"><span class="annottext">(forall x. NASM_Operand -&gt; Rep NASM_Operand x)
-&gt; (forall x. Rep NASM_Operand x -&gt; NASM_Operand)
-&gt; Generic NASM_Operand
forall x. Rep NASM_Operand x -&gt; NASM_Operand
forall x. NASM_Operand -&gt; Rep NASM_Operand x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. NASM_Operand -&gt; Rep NASM_Operand x
from :: forall x. NASM_Operand -&gt; Rep NASM_Operand x
$cto :: forall x. Rep NASM_Operand x -&gt; NASM_Operand
to :: forall x. Rep NASM_Operand x -&gt; NASM_Operand
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="annot"><span class="hs-comment">-- | An address can either be a computation or some symbol.</span></span><span>
</span><span id="line-121"></span><span class="hs-keyword">data</span><span> </span><span id="NASM_Address"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Address"><span class="hs-identifier hs-var">NASM_Address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NASM_Addr_Compute"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Addr_Compute"><span class="hs-identifier hs-var">NASM_Addr_Compute</span></a></span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Address_Computation"><span class="hs-identifier hs-type">NASM_Address_Computation</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="NASM_Addr_Symbol"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Addr_Symbol"><span class="hs-identifier hs-var">NASM_Addr_Symbol</span></a></span></span><span> </span><span class="annot"><a href="Data.Symbol.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="NASM_Addr_Label"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Addr_Label"><span class="hs-identifier hs-var">NASM_Addr_Label</span></a></span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Label"><span class="hs-identifier hs-type">NASM_Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="NASM_JumpTarget"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_JumpTarget"><span class="hs-identifier hs-var">NASM_JumpTarget</span></a></span></span><span> </span><span class="annot"><a href="Data.JumpTarget.html#ResolvedJumpTarget"><span class="hs-identifier hs-type">ResolvedJumpTarget</span></a></span><span>
</span><span id="line-122"></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391644"><span id="local-6989586621679391655"><span class="annot"><span class="annottext">NASM_Address -&gt; NASM_Address -&gt; Bool
(NASM_Address -&gt; NASM_Address -&gt; Bool)
-&gt; (NASM_Address -&gt; NASM_Address -&gt; Bool) -&gt; Eq NASM_Address
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: NASM_Address -&gt; NASM_Address -&gt; Bool
== :: NASM_Address -&gt; NASM_Address -&gt; Bool
$c/= :: NASM_Address -&gt; NASM_Address -&gt; Bool
/= :: NASM_Address -&gt; NASM_Address -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679391658"><span id="local-6989586621679391660"><span class="annot"><span class="annottext">(forall x. NASM_Address -&gt; Rep NASM_Address x)
-&gt; (forall x. Rep NASM_Address x -&gt; NASM_Address)
-&gt; Generic NASM_Address
forall x. Rep NASM_Address x -&gt; NASM_Address
forall x. NASM_Address -&gt; Rep NASM_Address x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. NASM_Address -&gt; Rep NASM_Address x
from :: forall x. NASM_Address -&gt; Rep NASM_Address x
$cto :: forall x. Rep NASM_Address x -&gt; NASM_Address
to :: forall x. Rep NASM_Address x -&gt; NASM_Address
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="annot"><span class="hs-comment">-- | An address computation within an operand. The computation is: segment + [base + index*scale + disp]</span></span><span>
</span><span id="line-126"></span><span class="hs-keyword">data</span><span> </span><span id="NASM_Address_Computation"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Address_Computation"><span class="hs-identifier hs-var">NASM_Address_Computation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NASM_Address_Computation"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Address_Computation"><span class="hs-identifier hs-var">NASM_Address_Computation</span></a></span></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-special">{</span><span>
</span><span id="line-128"></span><span>    </span><span id="nasm_segment"><span class="annot"><span class="annottext">NASM_Address_Computation -&gt; Maybe Register
</span><a href="OutputGeneration.NASM.NASM.html#nasm_segment"><span class="hs-identifier hs-var hs-var">nasm_segment</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.X86.Register.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="nasm_index"><span class="annot"><span class="annottext">NASM_Address_Computation -&gt; Maybe Register
</span><a href="OutputGeneration.NASM.NASM.html#nasm_index"><span class="hs-identifier hs-var hs-var">nasm_index</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.X86.Register.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="nasm_scale"><span class="annot"><span class="annottext">NASM_Address_Computation -&gt; Word64
</span><a href="OutputGeneration.NASM.NASM.html#nasm_scale"><span class="hs-identifier hs-var hs-var">nasm_scale</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="nasm_base"><span class="annot"><span class="annottext">NASM_Address_Computation -&gt; Maybe Register
</span><a href="OutputGeneration.NASM.NASM.html#nasm_base"><span class="hs-identifier hs-var hs-var">nasm_base</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.X86.Register.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="nasm_displace"><span class="annot"><span class="annottext">NASM_Address_Computation -&gt; Maybe Word64
</span><a href="OutputGeneration.NASM.NASM.html#nasm_displace"><span class="hs-identifier hs-var hs-var">nasm_displace</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-134"></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391669"><span id="local-6989586621679391677"><span class="annot"><span class="annottext">NASM_Address_Computation -&gt; NASM_Address_Computation -&gt; Bool
(NASM_Address_Computation -&gt; NASM_Address_Computation -&gt; Bool)
-&gt; (NASM_Address_Computation -&gt; NASM_Address_Computation -&gt; Bool)
-&gt; Eq NASM_Address_Computation
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: NASM_Address_Computation -&gt; NASM_Address_Computation -&gt; Bool
== :: NASM_Address_Computation -&gt; NASM_Address_Computation -&gt; Bool
$c/= :: NASM_Address_Computation -&gt; NASM_Address_Computation -&gt; Bool
/= :: NASM_Address_Computation -&gt; NASM_Address_Computation -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679391680"><span id="local-6989586621679391682"><span class="annot"><span class="annottext">(forall x.
 NASM_Address_Computation -&gt; Rep NASM_Address_Computation x)
-&gt; (forall x.
    Rep NASM_Address_Computation x -&gt; NASM_Address_Computation)
-&gt; Generic NASM_Address_Computation
forall x.
Rep NASM_Address_Computation x -&gt; NASM_Address_Computation
forall x.
NASM_Address_Computation -&gt; Rep NASM_Address_Computation x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x.
NASM_Address_Computation -&gt; Rep NASM_Address_Computation x
from :: forall x.
NASM_Address_Computation -&gt; Rep NASM_Address_Computation x
$cto :: forall x.
Rep NASM_Address_Computation x -&gt; NASM_Address_Computation
to :: forall x.
Rep NASM_Address_Computation x -&gt; NASM_Address_Computation
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | A data section consists of a list of data section entries.</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- Each DataEntry stores its address and a value.</span><span>
</span><span id="line-140"></span><span class="hs-keyword">data</span><span> </span><span id="NASM_DataEntry"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_DataEntry"><span class="hs-identifier hs-var">NASM_DataEntry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>    </span><span id="DataEntry_Byte"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#DataEntry_Byte"><span class="hs-identifier hs-var">DataEntry_Byte</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>                   </span><span class="annot"><span class="hs-comment">-- ^ A single byte</span></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DataEntry_String"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#DataEntry_String"><span class="hs-identifier hs-var">DataEntry_String</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span>               </span><span class="annot"><span class="hs-comment">-- ^ A string of characters (Word8) </span></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DataEntry_Pointer"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#DataEntry_Pointer"><span class="hs-identifier hs-var">DataEntry_Pointer</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Address"><span class="hs-identifier hs-type">NASM_Address</span></a></span><span class="hs-special">,</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#Annot"><span class="hs-identifier hs-type">Annot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ A pointer (a label or external symbol)</span></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DataEntry_BSS"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#DataEntry_BSS"><span class="hs-identifier hs-var">DataEntry_BSS</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                             </span><span class="annot"><span class="hs-comment">-- ^ A BSS section with a given size in bytes</span></span><span>
</span><span id="line-145"></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391689"><span id="local-6989586621679391691"><span class="annot"><span class="annottext">(forall x. NASM_DataEntry -&gt; Rep NASM_DataEntry x)
-&gt; (forall x. Rep NASM_DataEntry x -&gt; NASM_DataEntry)
-&gt; Generic NASM_DataEntry
forall x. Rep NASM_DataEntry x -&gt; NASM_DataEntry
forall x. NASM_DataEntry -&gt; Rep NASM_DataEntry x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. NASM_DataEntry -&gt; Rep NASM_DataEntry x
from :: forall x. NASM_DataEntry -&gt; Rep NASM_DataEntry x
$cto :: forall x. Rep NASM_DataEntry x -&gt; NASM_DataEntry
to :: forall x. Rep NASM_DataEntry x -&gt; NASM_DataEntry
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="annot"><span class="hs-comment">-- | A data section then consists of:</span></span><span>
</span><span id="line-148"></span><span class="hs-keyword">data</span><span> </span><span id="NASM_DataSection"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_DataSection"><span class="hs-identifier hs-var">NASM_DataSection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NASM_DataSection"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_DataSection"><span class="hs-identifier hs-var">NASM_DataSection</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-149"></span><span>  </span><span id="nasm_data_section"><span class="annot"><span class="annottext">NASM_DataSection -&gt; (String, String, Word64)
</span><a href="OutputGeneration.NASM.NASM.html#nasm_data_section"><span class="hs-identifier hs-var hs-var">nasm_data_section</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>              </span><span class="annot"><span class="hs-comment">-- ^ (segment,section,address)</span></span><span>
</span><span id="line-150"></span><span>  </span><span id="nasm_data_section_align"><span class="annot"><span class="annottext">NASM_DataSection -&gt; Int
</span><a href="OutputGeneration.NASM.NASM.html#nasm_data_section_align"><span class="hs-identifier hs-var hs-var">nasm_data_section_align</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>                           </span><span class="annot"><span class="hs-comment">-- ^ The alignment (0 if unknown)</span></span><span>
</span><span id="line-151"></span><span>  </span><span id="nasm_data_section_labels"><span class="annot"><span class="annottext">NASM_DataSection -&gt; IntMap (Set NASM_Label)
</span><a href="OutputGeneration.NASM.NASM.html#nasm_data_section_labels"><span class="hs-identifier hs-var hs-var">nasm_data_section_labels</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IM.IntMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Label"><span class="hs-identifier hs-type">NASM_Label</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Used internally only</span></span><span>
</span><span id="line-152"></span><span>  </span><span id="nasm_data_section_data"><span class="annot"><span class="annottext">NASM_DataSection -&gt; [NASM_DataEntry]
</span><a href="OutputGeneration.NASM.NASM.html#nasm_data_section_data"><span class="hs-identifier hs-var hs-var">nasm_data_section_data</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_DataEntry"><span class="hs-identifier hs-type">NASM_DataEntry</span></a></span><span class="hs-special">]</span><span>                </span><span class="annot"><span class="hs-comment">-- ^ A list of DataEntries</span></span><span>
</span><span id="line-153"></span><span class="hs-special">}</span><span>
</span><span id="line-154"></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391699"><span id="local-6989586621679391701"><span class="annot"><span class="annottext">(forall x. NASM_DataSection -&gt; Rep NASM_DataSection x)
-&gt; (forall x. Rep NASM_DataSection x -&gt; NASM_DataSection)
-&gt; Generic NASM_DataSection
forall x. Rep NASM_DataSection x -&gt; NASM_DataSection
forall x. NASM_DataSection -&gt; Rep NASM_DataSection x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. NASM_DataSection -&gt; Rep NASM_DataSection x
from :: forall x. NASM_DataSection -&gt; Rep NASM_DataSection x
$cto :: forall x. Rep NASM_DataSection x -&gt; NASM_DataSection
to :: forall x. Rep NASM_DataSection x -&gt; NASM_DataSection
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679391704"><span id="local-6989586621679391711"><span class="annot"><span class="hs-identifier hs-type">Cereal.Serialize</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Label"><span class="hs-identifier hs-type">NASM_Label</span></a></span></span></span><span>
</span><span id="line-159"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679391764"><span id="local-6989586621679391771"><span class="annot"><span class="hs-identifier hs-type">Cereal.Serialize</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Section"><span class="hs-identifier hs-type">NASM_Section</span></a></span></span></span><span>
</span><span id="line-160"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679391803"><span id="local-6989586621679391809"><span class="annot"><span class="hs-identifier hs-type">Cereal.Serialize</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_TextSection"><span class="hs-identifier hs-type">NASM_TextSection</span></a></span></span></span><span>
</span><span id="line-161"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679391856"><span id="local-6989586621679391862"><span class="annot"><span class="hs-identifier hs-type">Cereal.Serialize</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Line"><span class="hs-identifier hs-type">NASM_Line</span></a></span></span></span><span>
</span><span id="line-162"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679391918"><span id="local-6989586621679391924"><span class="annot"><span class="hs-identifier hs-type">Cereal.Serialize</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Instruction"><span class="hs-identifier hs-type">NASM_Instruction</span></a></span></span></span><span>
</span><span id="line-163"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679391991"><span id="local-6989586621679391997"><span class="annot"><span class="hs-identifier hs-type">Cereal.Serialize</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand"><span class="hs-identifier hs-type">NASM_Operand</span></a></span></span></span><span>
</span><span id="line-164"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392071"><span id="local-6989586621679392077"><span class="annot"><span class="hs-identifier hs-type">Cereal.Serialize</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Address"><span class="hs-identifier hs-type">NASM_Address</span></a></span></span></span><span>
</span><span id="line-165"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392146"><span id="local-6989586621679392152"><span class="annot"><span class="hs-identifier hs-type">Cereal.Serialize</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Address_Computation"><span class="hs-identifier hs-type">NASM_Address_Computation</span></a></span></span></span><span>
</span><span id="line-166"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392192"><span id="local-6989586621679392199"><span class="annot"><span class="hs-identifier hs-type">Cereal.Serialize</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_DataEntry"><span class="hs-identifier hs-type">NASM_DataEntry</span></a></span></span></span><span>
</span><span id="line-167"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392276"><span id="local-6989586621679392282"><span class="annot"><span class="hs-identifier hs-type">Cereal.Serialize</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_DataSection"><span class="hs-identifier hs-type">NASM_DataSection</span></a></span></span></span><span>
</span><span id="line-168"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392337"><span id="local-6989586621679392344"><span class="annot"><span class="hs-identifier hs-type">Cereal.Serialize</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM"><span class="hs-identifier hs-type">NASM</span></a></span></span></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span id="label_to_operand"><span class="annot"><span class="annottext">label_to_operand :: NASM_Label -&gt; NASM_Operand
</span><a href="OutputGeneration.NASM.NASM.html#label_to_operand"><span class="hs-identifier hs-var hs-var">label_to_operand</span></a></span></span><span> </span><span id="local-6989586621679392388"><span class="annot"><span class="annottext">NASM_Label
</span><a href="#local-6989586621679392388"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NASM_Address -&gt; NASM_Operand
</span><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Address"><span class="hs-identifier hs-var">NASM_Operand_Address</span></a></span><span> </span><span class="annot"><span class="annottext">(NASM_Address -&gt; NASM_Operand) -&gt; NASM_Address -&gt; NASM_Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NASM_Label -&gt; Maybe Word64 -&gt; NASM_Address
</span><a href="OutputGeneration.NASM.NASM.html#NASM_Addr_Label"><span class="hs-identifier hs-var">NASM_Addr_Label</span></a></span><span> </span><span class="annot"><span class="annottext">NASM_Label
</span><a href="#local-6989586621679392388"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-176"></span><span id="label_to_mem_operand"><span class="annot"><span class="annottext">label_to_mem_operand :: NASM_SizeDir -&gt; NASM_Label -&gt; NASM_Operand
</span><a href="OutputGeneration.NASM.NASM.html#label_to_mem_operand"><span class="hs-identifier hs-var hs-var">label_to_mem_operand</span></a></span></span><span> </span><span id="local-6989586621679392390"><span class="annot"><span class="annottext">NASM_SizeDir
</span><a href="#local-6989586621679392390"><span class="hs-identifier hs-var">sizedir</span></a></span></span><span> </span><span id="local-6989586621679392391"><span class="annot"><span class="annottext">NASM_Label
</span><a href="#local-6989586621679392391"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NASM_SizeDir -&gt; NASM_Address -&gt; NASM_Operand
</span><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Memory"><span class="hs-identifier hs-var">NASM_Operand_Memory</span></a></span><span> </span><span class="annot"><span class="annottext">NASM_SizeDir
</span><a href="#local-6989586621679392390"><span class="hs-identifier hs-var">sizedir</span></a></span><span> </span><span class="annot"><span class="annottext">(NASM_Address -&gt; NASM_Operand) -&gt; NASM_Address -&gt; NASM_Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NASM_Label -&gt; Maybe Word64 -&gt; NASM_Address
</span><a href="OutputGeneration.NASM.NASM.html#NASM_Addr_Label"><span class="hs-identifier hs-var">NASM_Addr_Label</span></a></span><span> </span><span class="annot"><span class="annottext">NASM_Label
</span><a href="#local-6989586621679392391"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-177"></span><span id="label_to_eff_operand"><span class="annot"><span class="annottext">label_to_eff_operand :: NASM_Label -&gt; NASM_Operand
</span><a href="OutputGeneration.NASM.NASM.html#label_to_eff_operand"><span class="hs-identifier hs-var hs-var">label_to_eff_operand</span></a></span></span><span> </span><span id="local-6989586621679392393"><span class="annot"><span class="annottext">NASM_Label
</span><a href="#local-6989586621679392393"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NASM_Address -&gt; NASM_Operand
</span><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_EffectiveAddress"><span class="hs-identifier hs-var">NASM_Operand_EffectiveAddress</span></a></span><span> </span><span class="annot"><span class="annottext">(NASM_Address -&gt; NASM_Operand) -&gt; NASM_Address -&gt; NASM_Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NASM_Label -&gt; Maybe Word64 -&gt; NASM_Address
</span><a href="OutputGeneration.NASM.NASM.html#NASM_Addr_Label"><span class="hs-identifier hs-var">NASM_Addr_Label</span></a></span><span> </span><span class="annot"><span class="annottext">NASM_Label
</span><a href="#local-6989586621679392393"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span id="mk_nasm_instr"><span class="annot"><span class="annottext">mk_nasm_instr :: Opcode -&gt; [NASM_Operand] -&gt; NASM_Instruction
</span><a href="OutputGeneration.NASM.NASM.html#mk_nasm_instr"><span class="hs-identifier hs-var hs-var">mk_nasm_instr</span></a></span></span><span> </span><span id="local-6989586621679392395"><span class="annot"><span class="annottext">Opcode
</span><a href="#local-6989586621679392395"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679392396"><span class="annot"><span class="annottext">[NASM_Operand]
</span><a href="#local-6989586621679392396"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Prefix
-&gt; Maybe Opcode
-&gt; [NASM_Operand]
-&gt; String
-&gt; Annot
-&gt; NASM_Instruction
</span><a href="OutputGeneration.NASM.NASM.html#NASM_Instruction"><span class="hs-identifier hs-var">NASM_Instruction</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Prefix
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Opcode -&gt; Maybe Opcode
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="#local-6989586621679392395"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NASM_Operand]
</span><a href="#local-6989586621679392396"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span id="empty_address"><span class="annot"><span class="annottext">empty_address :: NASM_Address_Computation
</span><a href="OutputGeneration.NASM.NASM.html#empty_address"><span class="hs-identifier hs-var hs-var">empty_address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Maybe Register
-&gt; Maybe Register
-&gt; Word64
-&gt; Maybe Register
-&gt; Maybe Word64
-&gt; NASM_Address_Computation
</span><a href="OutputGeneration.NASM.NASM.html#NASM_Address_Computation"><span class="hs-identifier hs-var">NASM_Address_Computation</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Register
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Register
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Maybe Register
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-special">(</span><span id="withAnnot"><span class="annot"><span class="annottext">withAnnot :: NASM_Instruction -&gt; Annot -&gt; NASM_Instruction
</span><a href="OutputGeneration.NASM.NASM.html#withAnnot"><span class="hs-identifier hs-var hs-var">withAnnot</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679392401"><span class="annot"><span class="annottext">NASM_Instruction
</span><a href="#local-6989586621679392401"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621679392402"><span class="annot"><span class="annottext">Annot
</span><a href="#local-6989586621679392402"><span class="hs-identifier hs-var">annot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NASM_Instruction
</span><a href="#local-6989586621679392401"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#nasm_annot"><span class="hs-identifier hs-var">nasm_annot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#nasm_annot"><span class="hs-identifier hs-var">nasm_annot</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392401"><span class="hs-identifier hs-type">instr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621679392402"><span class="hs-identifier hs-type">annot</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-188"></span><span class="hs-special">(</span><span id="withComment"><span class="annot"><span class="annottext">withComment :: NASM_Instruction -&gt; String -&gt; NASM_Instruction
</span><a href="OutputGeneration.NASM.NASM.html#withComment"><span class="hs-identifier hs-var hs-var">withComment</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679392404"><span class="annot"><span class="annottext">NASM_Instruction
</span><a href="#local-6989586621679392404"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621679392405"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392405"><span class="hs-identifier hs-var">comment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NASM_Instruction
</span><a href="#local-6989586621679392404"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#nasm_comment"><span class="hs-identifier hs-var">nasm_comment</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#nasm_comment"><span class="hs-identifier hs-var">nasm_comment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392404"><span class="hs-identifier hs-type">instr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621679392405"><span class="hs-identifier hs-type">comment</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- Pretty printing</span><span>
</span><span id="line-194"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392407"><span id="local-6989586621679392412"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_DataSection"><span class="hs-identifier hs-type">NASM_DataSection</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621679392420"><span class="annot"><span class="annottext">show :: NASM_DataSection -&gt; String
</span><a href="#local-6989586621679392420"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_DataSection"><span class="hs-identifier hs-type">NASM_DataSection</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679392422"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392422"><span class="hs-identifier hs-var">seg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679392423"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392423"><span class="hs-identifier hs-var">sec</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679392424"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392424"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679392425"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392425"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621679392426"><span class="annot"><span class="annottext">IntMap (Set NASM_Label)
</span><a href="#local-6989586621679392426"><span class="hs-identifier hs-var">labels</span></a></span></span><span> </span><span id="local-6989586621679392427"><span class="annot"><span class="annottext">[NASM_DataEntry]
</span><a href="#local-6989586621679392427"><span class="hs-identifier hs-var">entries</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;section &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392423"><span class="hs-identifier hs-var">sec</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall {a}. (Eq a, Num a, Show a) =&gt; a -&gt; String
</span><a href="#local-6989586621679392428"><span class="hs-identifier hs-var">show_align</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392425"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [NASM_DataEntry] -&gt; String
</span><a href="#local-6989586621679392429"><span class="hs-identifier hs-var">show_data</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[NASM_DataEntry]
</span><a href="#local-6989586621679392427"><span class="hs-identifier hs-var">entries</span></a></span><span>
</span><span id="line-196"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-197"></span><span>    </span><span id="local-6989586621679392429"><span class="annot"><span class="annottext">show_data :: Int -&gt; [NASM_DataEntry] -&gt; String
</span><a href="#local-6989586621679392429"><span class="hs-identifier hs-var hs-var">show_data</span></a></span></span><span> </span><span id="local-6989586621679392431"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392431"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679392432"><span class="hs-identifier hs-var">show_label</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392431"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><a href="#local-6989586621679392429"><span class="hs-identifier hs-var">show_data</span></a></span><span> </span><span id="local-6989586621679392433"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392433"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679392434"><span class="annot"><span class="annottext">NASM_DataEntry
</span><a href="#local-6989586621679392434"><span class="hs-identifier hs-var">e</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679392435"><span class="annot"><span class="annottext">[NASM_DataEntry]
</span><a href="#local-6989586621679392435"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679392432"><span class="hs-identifier hs-var">show_label</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392433"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NASM_DataEntry -&gt; String
</span><a href="#local-6989586621679392436"><span class="hs-identifier hs-var">show_entry</span></a></span><span> </span><span class="annot"><span class="annottext">NASM_DataEntry
</span><a href="#local-6989586621679392434"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [NASM_DataEntry] -&gt; String
</span><a href="#local-6989586621679392429"><span class="hs-identifier hs-var">show_data</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392433"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">NASM_DataEntry -&gt; Int
</span><a href="#local-6989586621679392438"><span class="hs-identifier hs-var">entry_length</span></a></span><span> </span><span class="annot"><span class="annottext">NASM_DataEntry
</span><a href="#local-6989586621679392434"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NASM_DataEntry]
</span><a href="#local-6989586621679392435"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621679392438"><span class="annot"><span class="annottext">entry_length :: NASM_DataEntry -&gt; Int
</span><a href="#local-6989586621679392438"><span class="hs-identifier hs-var hs-var">entry_length</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#DataEntry_Byte"><span class="hs-identifier hs-type">DataEntry_Byte</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><a href="#local-6989586621679392438"><span class="hs-identifier hs-var">entry_length</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#DataEntry_String"><span class="hs-identifier hs-type">DataEntry_String</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679392445"><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679392445"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679392445"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><a href="#local-6989586621679392438"><span class="hs-identifier hs-var">entry_length</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#DataEntry_Pointer"><span class="hs-identifier hs-type">DataEntry_Pointer</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">(NASM_Address, Annot)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><a href="#local-6989586621679392438"><span class="hs-identifier hs-var">entry_length</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#DataEntry_BSS"><span class="hs-identifier hs-type">DataEntry_BSS</span></a></span><span> </span><span id="local-6989586621679392447"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392447"><span class="hs-identifier hs-var">sz</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392447"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>    </span><span id="local-6989586621679392432"><span class="annot"><span class="annottext">show_label :: Int -&gt; String
</span><a href="#local-6989586621679392432"><span class="hs-identifier hs-var hs-var">show_label</span></a></span></span><span> </span><span id="local-6989586621679392450"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392450"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-206"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap (Set NASM_Label) -&gt; Maybe (Set NASM_Label)
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392450"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (Set NASM_Label)
</span><a href="#local-6989586621679392426"><span class="hs-identifier hs-var">labels</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Set NASM_Label)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679392452"><span class="annot"><span class="annottext">Set NASM_Label
</span><a href="#local-6989586621679392452"><span class="hs-identifier hs-var">labels</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(NASM_Label -&gt; String) -&gt; [NASM_Label] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679392454"><span class="annot"><span class="annottext">NASM_Label
</span><a href="#local-6989586621679392454"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NASM_Label -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NASM_Label
</span><a href="#local-6989586621679392454"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:\n&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([NASM_Label] -&gt; String) -&gt; [NASM_Label] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set NASM_Label -&gt; [NASM_Label]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">S.toList</span></span><span> </span><span class="annot"><span class="annottext">Set NASM_Label
</span><a href="#local-6989586621679392452"><span class="hs-identifier hs-var">labels</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>    </span><span id="local-6989586621679392436"><span class="annot"><span class="annottext">show_entry :: NASM_DataEntry -&gt; String
</span><a href="#local-6989586621679392436"><span class="hs-identifier hs-var hs-var">show_entry</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#DataEntry_Byte"><span class="hs-identifier hs-type">DataEntry_Byte</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679392461"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679392461"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;db 0&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679392461"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;h&quot;</span></span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><a href="#local-6989586621679392436"><span class="hs-identifier hs-var">show_entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#DataEntry_String"><span class="hs-identifier hs-type">DataEntry_String</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679392463"><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679392463"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;db `&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#word8s_to_string"><span class="hs-identifier hs-var">word8s_to_string</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679392463"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;`&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, 0&quot;</span></span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><a href="#local-6989586621679392436"><span class="hs-identifier hs-var">show_entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#DataEntry_Pointer"><span class="hs-identifier hs-type">DataEntry_Pointer</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679392465"><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392465"><span class="hs-identifier hs-var">ptr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679392466"><span class="annot"><span class="annottext">Annot
</span><a href="#local-6989586621679392466"><span class="hs-identifier hs-var">annot</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dq &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NASM_Address -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392465"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;    ; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Annot -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#render_annot"><span class="hs-identifier hs-var">render_annot</span></a></span><span> </span><span class="annot"><span class="annottext">Annot
</span><a href="#local-6989586621679392466"><span class="hs-identifier hs-var">annot</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><a href="#local-6989586621679392436"><span class="hs-identifier hs-var">show_entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#DataEntry_BSS"><span class="hs-identifier hs-type">DataEntry_BSS</span></a></span><span> </span><span id="local-6989586621679392468"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392468"><span class="hs-identifier hs-var">sz</span></a></span></span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;resb &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392468"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621679392428"><span class="annot"><span class="annottext">show_align :: a -&gt; String
</span><a href="#local-6989586621679392428"><span class="hs-identifier hs-var hs-var">show_align</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><a href="#local-6989586621679392428"><span class="hs-identifier hs-var">show_align</span></a></span><span> </span><span id="local-6989586621679392475"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392475"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; align=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392475"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span id="word8s_to_string"><span class="annot"><span class="annottext">word8s_to_string :: [Word8] -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#word8s_to_string"><span class="hs-identifier hs-var hs-var">word8s_to_string</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; String) -&gt; [Word8] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String
</span><a href="#local-6989586621679392477"><span class="hs-identifier hs-var">escape</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; String) -&gt; (Word8 -&gt; Char) -&gt; Word8 -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Char
</span><span class="hs-identifier hs-var">w2c</span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-219"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621679392477"><span class="annot"><span class="annottext">escape :: Char -&gt; String
</span><a href="#local-6989586621679392477"><span class="hs-identifier hs-var hs-var">escape</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\\\&quot;</span></span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><a href="#local-6989586621679392477"><span class="hs-identifier hs-var">escape</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'`'</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\`&quot;</span></span><span>
</span><span id="line-222"></span><span>  </span><span class="annot"><a href="#local-6989586621679392477"><span class="hs-identifier hs-var">escape</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\n&quot;</span></span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><a href="#local-6989586621679392477"><span class="hs-identifier hs-var">escape</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\t'</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\t&quot;</span></span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><a href="#local-6989586621679392477"><span class="hs-identifier hs-var">escape</span></a></span><span> </span><span id="local-6989586621679392479"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679392479"><span class="hs-identifier hs-var">c</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679392479"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392481"><span id="local-6989586621679392486"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_TextSection"><span class="hs-identifier hs-type">NASM_TextSection</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-227"></span><span>  </span><span id="local-6989586621679392490"><span class="annot"><span class="annottext">show :: NASM_TextSection -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_TextSection"><span class="hs-identifier hs-type">NASM_TextSection</span></a></span><span> </span><span id="local-6989586621679392491"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392491"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679392492"><span class="annot"><span class="annottext">[(Int, [NASM_Line])]
</span><a href="#local-6989586621679392492"><span class="hs-identifier hs-var">blocks</span></a></span></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="#local-6989586621679392493"><span class="hs-identifier hs-var">comment_block</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Function: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392491"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n\n&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, [NASM_Line]) -&gt; String) -&gt; [(Int, [NASM_Line])] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Int, [NASM_Line]) -&gt; String
forall {a} {a}. Show a =&gt; (a, [a]) -&gt; String
</span><a href="#local-6989586621679392495"><span class="hs-identifier hs-var">render_block</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, [NASM_Line])]
</span><a href="#local-6989586621679392492"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n\n&quot;</span></span><span>
</span><span id="line-228"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621679392495"><span class="annot"><span class="annottext">render_block :: (a, [a]) -&gt; String
</span><a href="#local-6989586621679392495"><span class="hs-identifier hs-var hs-var">render_block</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679392498"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392498"><span class="hs-identifier hs-var">blockID</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679392499"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679392499"><span class="hs-identifier hs-var">lines</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; String) -&gt; [a] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679392499"><span class="hs-identifier hs-var">lines</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621679392500"><span class="annot"><span class="annottext">comment :: String -&gt; String
</span><a href="#local-6989586621679392500"><span class="hs-identifier hs-var hs-var">comment</span></a></span></span><span> </span><span id="local-6989586621679392501"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392501"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392501"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>    </span><span id="local-6989586621679392493"><span class="annot"><span class="annottext">comment_block :: [String] -&gt; String
</span><a href="#local-6989586621679392493"><span class="hs-identifier hs-var hs-var">comment_block</span></a></span></span><span> </span><span id="local-6989586621679392506"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679392506"><span class="hs-identifier hs-var">strs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall {t :: * -&gt; *} {t :: * -&gt; *} {a}.
(Foldable t, Foldable t) =&gt;
t (t a) -&gt; String
</span><a href="#local-6989586621679392507"><span class="hs-identifier hs-var">comment_block_delim</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679392506"><span class="hs-identifier hs-var">strs</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679392500"><span class="hs-identifier hs-var">comment</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679392506"><span class="hs-identifier hs-var">strs</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[String] -&gt; String
forall {t :: * -&gt; *} {t :: * -&gt; *} {a}.
(Foldable t, Foldable t) =&gt;
t (t a) -&gt; String
</span><a href="#local-6989586621679392507"><span class="hs-identifier hs-var">comment_block_delim</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679392506"><span class="hs-identifier hs-var">strs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621679392507"><span class="annot"><span class="annottext">comment_block_delim :: t (t a) -&gt; String
</span><a href="#local-6989586621679392507"><span class="hs-identifier hs-var hs-var">comment_block_delim</span></a></span></span><span> </span><span id="local-6989586621679392513"><span class="annot"><span class="annottext">t (t a)
</span><a href="#local-6989586621679392513"><span class="hs-identifier hs-var">strs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679392500"><span class="hs-identifier hs-var">comment</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; Int
forall a. t a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(t a -&gt; Int) -&gt; t a -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">t (t a) -&gt; t a
forall {t :: * -&gt; *} {t :: * -&gt; *} {a}.
(Foldable t, Foldable t) =&gt;
t (t a) -&gt; t a
</span><a href="#local-6989586621679392515"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="annot"><span class="annottext">t (t a)
</span><a href="#local-6989586621679392513"><span class="hs-identifier hs-var">strs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span> </span><span>
</span><span id="line-235"></span><span>    </span><span id="local-6989586621679392515"><span class="annot"><span class="annottext">max :: t (t a) -&gt; t a
</span><a href="#local-6989586621679392515"><span class="hs-identifier hs-var hs-var">max</span></a></span></span><span> </span><span id="local-6989586621679392521"><span class="annot"><span class="annottext">t (t a)
</span><a href="#local-6989586621679392521"><span class="hs-identifier hs-var">strs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(t a -&gt; t a -&gt; Ordering) -&gt; t (t a) -&gt; t a
forall (t :: * -&gt; *) a.
Foldable t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximumBy</span></span><span> </span><span class="annot"><span class="annottext">t a -&gt; t a -&gt; Ordering
forall {t :: * -&gt; *} {t :: * -&gt; *} {a} {a}.
(Foldable t, Foldable t) =&gt;
t a -&gt; t a -&gt; Ordering
</span><a href="#local-6989586621679392523"><span class="hs-identifier hs-var">compare_lengths</span></a></span><span> </span><span class="annot"><span class="annottext">t (t a)
</span><a href="#local-6989586621679392521"><span class="hs-identifier hs-var">strs</span></a></span><span>
</span><span id="line-236"></span><span>    </span><span id="local-6989586621679392523"><span class="annot"><span class="annottext">compare_lengths :: t a -&gt; t a -&gt; Ordering
</span><a href="#local-6989586621679392523"><span class="hs-identifier hs-var hs-var">compare_lengths</span></a></span></span><span> </span><span id="local-6989586621679392530"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679392530"><span class="hs-identifier hs-var">str0</span></a></span></span><span> </span><span id="local-6989586621679392531"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679392531"><span class="hs-identifier hs-var">str1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; Int
forall a. t a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679392530"><span class="hs-identifier hs-var">str0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; Int
forall a. t a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679392531"><span class="hs-identifier hs-var">str1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392534"><span id="local-6989586621679392538"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Line"><span class="hs-identifier hs-type">NASM_Line</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621679392543"><span class="annot"><span class="annottext">show :: NASM_Line -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Line"><span class="hs-identifier hs-type">NASM_Line</span></a></span><span> </span><span id="local-6989586621679392544"><span class="annot"><span class="annottext">NASM_Instruction
</span><a href="#local-6989586621679392544"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NASM_Instruction -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NASM_Instruction
</span><a href="#local-6989586621679392544"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Label"><span class="hs-identifier hs-type">NASM_Label</span></a></span><span> </span><span id="local-6989586621679392545"><span class="annot"><span class="annottext">NASM_Label
</span><a href="#local-6989586621679392545"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NASM_Label -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NASM_Label
</span><a href="#local-6989586621679392545"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Comment"><span class="hs-identifier hs-type">NASM_Comment</span></a></span><span> </span><span id="local-6989586621679392546"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392546"><span class="hs-identifier hs-var">indent</span></a></span></span><span> </span><span id="local-6989586621679392547"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392547"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392546"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392547"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392549"><span id="local-6989586621679392553"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Instruction"><span class="hs-identifier hs-type">NASM_Instruction</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621679392558"><span class="annot"><span class="annottext">show :: NASM_Instruction -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Instruction"><span class="hs-identifier hs-type">NASM_Instruction</span></a></span><span> </span><span id="local-6989586621679392559"><span class="annot"><span class="annottext">Maybe Prefix
</span><a href="#local-6989586621679392559"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span id="local-6989586621679392560"><span class="annot"><span class="annottext">Maybe Opcode
</span><a href="#local-6989586621679392560"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679392561"><span class="annot"><span class="annottext">[NASM_Operand]
</span><a href="#local-6989586621679392561"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621679392562"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392562"><span class="hs-identifier hs-var">comment</span></a></span></span><span> </span><span id="local-6989586621679392563"><span class="annot"><span class="annottext">Annot
</span><a href="#local-6989586621679392563"><span class="hs-identifier hs-var">annot</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; [String] -&gt; [String]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Maybe Prefix -&gt; String
</span><a href="#local-6989586621679392566"><span class="hs-identifier hs-var">show_prefix</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Prefix
</span><a href="#local-6989586621679392559"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Opcode -&gt; String
</span><a href="#local-6989586621679392567"><span class="hs-identifier hs-var">show_mnemonic</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Opcode
</span><a href="#local-6989586621679392560"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NASM_Operand] -&gt; String
</span><a href="#local-6989586621679392568"><span class="hs-identifier hs-var">show_ops</span></a></span><span> </span><span class="annot"><span class="annottext">[NASM_Operand]
</span><a href="#local-6989586621679392561"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392569"><span class="hs-identifier hs-var">mk_comment</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-251"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621679392566"><span class="annot"><span class="annottext">show_prefix :: Maybe Prefix -&gt; String
</span><a href="#local-6989586621679392566"><span class="hs-identifier hs-var hs-var">show_prefix</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Prefix
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><a href="#local-6989586621679392566"><span class="hs-identifier hs-var">show_prefix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Prefix
</span><a href="Data.X86.Instruction.html#PrefixRep"><span class="hs-identifier hs-var">PrefixRep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;REPZ&quot;</span></span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><a href="#local-6989586621679392566"><span class="hs-identifier hs-var">show_prefix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Prefix
</span><a href="Data.X86.Instruction.html#PrefixRepNE"><span class="hs-identifier hs-var">PrefixRepNE</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;REPNE&quot;</span></span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><a href="#local-6989586621679392566"><span class="hs-identifier hs-var">show_prefix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679392574"><span class="annot"><span class="annottext">Prefix
</span><a href="#local-6989586621679392574"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prefix -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Prefix
</span><a href="#local-6989586621679392574"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span>    </span><span id="local-6989586621679392567"><span class="annot"><span class="annottext">show_mnemonic :: Maybe Opcode -&gt; String
</span><a href="#local-6989586621679392567"><span class="hs-identifier hs-var hs-var">show_mnemonic</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Opcode
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-comment">-- NOT NEEDED, JUST FOR EASY DIFF</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><a href="#local-6989586621679392567"><span class="hs-identifier hs-var">show_mnemonic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="Data.X86.Opcode.html#JZ"><span class="hs-identifier hs-var">JZ</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;JE&quot;</span></span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><a href="#local-6989586621679392567"><span class="hs-identifier hs-var">show_mnemonic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="Data.X86.Opcode.html#JNZ"><span class="hs-identifier hs-var">JNZ</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;JNE&quot;</span></span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><a href="#local-6989586621679392567"><span class="hs-identifier hs-var">show_mnemonic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="Data.X86.Opcode.html#SETNBE"><span class="hs-identifier hs-var">SETNBE</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SETA&quot;</span></span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><a href="#local-6989586621679392567"><span class="hs-identifier hs-var">show_mnemonic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="Data.X86.Opcode.html#CMOVZ"><span class="hs-identifier hs-var">CMOVZ</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CMOVE&quot;</span></span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><a href="#local-6989586621679392567"><span class="hs-identifier hs-var">show_mnemonic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="Data.X86.Opcode.html#CMOVNZ"><span class="hs-identifier hs-var">CMOVNZ</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CMOVNE&quot;</span></span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><a href="#local-6989586621679392567"><span class="hs-identifier hs-var">show_mnemonic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="Data.X86.Opcode.html#SETNLE"><span class="hs-identifier hs-var">SETNLE</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SETG&quot;</span></span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><a href="#local-6989586621679392567"><span class="hs-identifier hs-var">show_mnemonic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679392583"><span class="annot"><span class="annottext">Opcode
</span><a href="#local-6989586621679392583"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Opcode
</span><a href="#local-6989586621679392583"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-266"></span><span> </span><span>
</span><span id="line-267"></span><span>    </span><span id="local-6989586621679392568"><span class="annot"><span class="annottext">show_ops :: [NASM_Operand] -&gt; String
</span><a href="#local-6989586621679392568"><span class="hs-identifier hs-var hs-var">show_ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; ([NASM_Operand] -&gt; [String]) -&gt; [NASM_Operand] -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(NASM_Operand -&gt; String) -&gt; [NASM_Operand] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">NASM_Operand -&gt; String
</span><a href="#local-6989586621679392584"><span class="hs-identifier hs-var">show_op</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621679392569"><span class="annot"><span class="annottext">mk_comment :: String
</span><a href="#local-6989586621679392569"><span class="hs-identifier hs-var hs-var">mk_comment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-270"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679392591"><span class="annot"><span class="annottext">str :: String
</span><a href="#local-6989586621679392591"><span class="hs-identifier hs-var hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Annot -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#render_annot"><span class="hs-identifier hs-var">render_annot</span></a></span><span> </span><span class="annot"><span class="annottext">Annot
</span><a href="#local-6989586621679392563"><span class="hs-identifier hs-var">annot</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-271"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392562"><span class="hs-identifier hs-var">comment</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392591"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-272"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392562"><span class="hs-identifier hs-var">comment</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392591"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; ; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392562"><span class="hs-identifier hs-var">comment</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;    ; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392591"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-273"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392562"><span class="hs-identifier hs-var">comment</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;    ; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392591"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-274"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; ; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392562"><span class="hs-identifier hs-var">comment</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679392593"><span class="annot"><span class="annottext">instr_op_size :: ByteSize
</span><a href="#local-6989586621679392593"><span class="hs-identifier hs-var hs-var">instr_op_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(NASM_Operand -&gt; Bool)
-&gt; [NASM_Operand] -&gt; ([NASM_Operand], [NASM_Operand])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="annot"><span class="annottext">NASM_Operand -&gt; Bool
</span><a href="#local-6989586621679392595"><span class="hs-identifier hs-var">isImmediate</span></a></span><span> </span><span class="annot"><span class="annottext">[NASM_Operand]
</span><a href="#local-6989586621679392561"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-278"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[NASM_Operand]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621679392596"><span class="annot"><span class="annottext">NASM_Operand
</span><a href="#local-6989586621679392596"><span class="hs-identifier hs-var">op</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[NASM_Operand]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NASM_Operand -&gt; ByteSize
</span><a href="#local-6989586621679392597"><span class="hs-identifier hs-var">operand_size</span></a></span><span> </span><span class="annot"><span class="annottext">NASM_Operand
</span><a href="#local-6989586621679392596"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-279"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">[</span><span id="local-6989586621679392598"><span class="annot"><span class="annottext">NASM_Operand
</span><a href="#local-6989586621679392598"><span class="hs-identifier hs-var">imm</span></a></span></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NASM_Operand -&gt; ByteSize
</span><a href="#local-6989586621679392597"><span class="hs-identifier hs-var">operand_size</span></a></span><span> </span><span class="annot"><span class="annottext">NASM_Operand
</span><a href="#local-6989586621679392598"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621679392595"><span class="annot"><span class="annottext">isImmediate :: NASM_Operand -&gt; Bool
</span><a href="#local-6989586621679392595"><span class="hs-identifier hs-var hs-var">isImmediate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Immediate"><span class="hs-identifier hs-type">NASM_Operand_Immediate</span></a></span><span> </span><span class="annot"><span class="annottext">Immediate
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><a href="#local-6989586621679392595"><span class="hs-identifier hs-var">isImmediate</span></a></span><span> </span><span class="annot"><span class="annottext">NASM_Operand
</span><span class="hs-identifier">_</span></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span>    </span><span id="local-6989586621679392584"><span class="annot"><span class="annottext">show_op :: NASM_Operand -&gt; String
</span><a href="#local-6989586621679392584"><span class="hs-identifier hs-var hs-var">show_op</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Reg"><span class="hs-identifier hs-type">NASM_Operand_Reg</span></a></span><span> </span><span id="local-6989586621679392725"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679392725"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Register -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679392725"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><a href="#local-6989586621679392584"><span class="hs-identifier hs-var">show_op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Address"><span class="hs-identifier hs-type">NASM_Operand_Address</span></a></span><span> </span><span id="local-6989586621679392726"><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392726"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NASM_Address -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392726"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><a href="#local-6989586621679392584"><span class="hs-identifier hs-var">show_op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_EffectiveAddress"><span class="hs-identifier hs-type">NASM_Operand_EffectiveAddress</span></a></span><span> </span><span id="local-6989586621679392727"><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392727"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NASM_Address -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392727"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><a href="#local-6989586621679392584"><span class="hs-identifier hs-var">show_op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Memory"><span class="hs-identifier hs-type">NASM_Operand_Memory</span></a></span><span> </span><span id="local-6989586621679392728"><span class="annot"><span class="annottext">NASM_SizeDir
</span><a href="#local-6989586621679392728"><span class="hs-identifier hs-var">sizedir</span></a></span></span><span> </span><span id="local-6989586621679392729"><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392729"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NASM_SizeDir -&gt; String
forall {a}. (Eq a, Num a) =&gt; (a, Bool) -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#show_nasm_sizedir"><span class="hs-identifier hs-var">show_nasm_sizedir</span></a></span><span> </span><span class="annot"><span class="annottext">NASM_SizeDir
</span><a href="#local-6989586621679392728"><span class="hs-identifier hs-var">sizedir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; [&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NASM_Address -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392729"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><a href="#local-6989586621679392584"><span class="hs-identifier hs-var">show_op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Immediate"><span class="hs-identifier hs-type">NASM_Operand_Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#BitSize"><span class="hs-identifier hs-type">BitSize</span></a></span><span> </span><span id="local-6989586621679392733"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392733"><span class="hs-identifier hs-var">si</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679392734"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-289"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteSize
</span><a href="#local-6989586621679392593"><span class="hs-identifier hs-var">instr_op_size</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392733"><span class="hs-identifier hs-var">si</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-290"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-291"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-292"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-293"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-296"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64
forall {a}. (Bits a, Num a) =&gt; a -&gt; a
</span><a href="Base.html#sextend_32_64"><span class="hs-identifier hs-var">sextend_32_64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64
forall {a}. (Bits a, Num a) =&gt; a -&gt; a
</span><a href="Base.html#sextend_16_64"><span class="hs-identifier hs-var">sextend_16_64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64
forall {a}. (Bits a, Num a) =&gt; a -&gt; a
</span><a href="Base.html#sextend_8_64"><span class="hs-identifier hs-var">sextend_8_64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-302"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64
forall {a}. (Bits a, Num a) =&gt; a -&gt; a
</span><a href="Base.html#sextend_16_32"><span class="hs-identifier hs-var">sextend_16_32</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64
forall {a}. (Bits a, Num a) =&gt; a -&gt; a
</span><a href="Base.html#sextend_8_32"><span class="hs-identifier hs-var">sextend_8_32</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-306"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-307"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-308"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64
forall {a}. (Bits a, Num a) =&gt; a -&gt; a
</span><a href="Base.html#sextend_8_16"><span class="hs-identifier hs-var">sextend_8_16</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-312"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-313"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392734"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-type">ByteSize</span></a></span><span> </span><span id="local-6989586621679392742"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392742"><span class="hs-identifier hs-var">si0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679392743"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392743"><span class="hs-identifier hs-var">si1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392742"><span class="hs-identifier hs-var">si0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392743"><span class="hs-identifier hs-var">si1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621679392597"><span class="annot"><span class="annottext">operand_size :: NASM_Operand -&gt; ByteSize
</span><a href="#local-6989586621679392597"><span class="hs-identifier hs-var hs-var">operand_size</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Reg"><span class="hs-identifier hs-type">NASM_Operand_Reg</span></a></span><span> </span><span id="local-6989586621679392748"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679392748"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Register -&gt; ByteSize
</span><a href="Data.X86.Register.html#regSize"><span class="hs-identifier hs-var">regSize</span></a></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679392748"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><a href="#local-6989586621679392597"><span class="hs-identifier hs-var">operand_size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Address"><span class="hs-identifier hs-type">NASM_Operand_Address</span></a></span><span> </span><span id="local-6989586621679392750"><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392750"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteSize
</span><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-var">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><a href="#local-6989586621679392597"><span class="hs-identifier hs-var">operand_size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_EffectiveAddress"><span class="hs-identifier hs-type">NASM_Operand_EffectiveAddress</span></a></span><span> </span><span id="local-6989586621679392751"><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392751"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteSize
</span><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-var">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><a href="#local-6989586621679392597"><span class="hs-identifier hs-var">operand_size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Memory"><span class="hs-identifier hs-type">NASM_Operand_Memory</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679392752"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392752"><span class="hs-identifier hs-var">si</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679392753"><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392753"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteSize
</span><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-var">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392752"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><a href="#local-6989586621679392597"><span class="hs-identifier hs-var">operand_size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Immediate"><span class="hs-identifier hs-type">NASM_Operand_Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#BitSize"><span class="hs-identifier hs-type">BitSize</span></a></span><span> </span><span id="local-6989586621679392754"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392754"><span class="hs-identifier hs-var">si</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679392755"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392755"><span class="hs-identifier hs-var">imm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteSize
</span><a href="Data.Size.html#ByteSize"><span class="hs-identifier hs-var">ByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ByteSize) -&gt; Int -&gt; ByteSize
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392754"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">--&quot;0x&quot; ++ showHex imm</span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-comment">--  show_op (NASM_Operand_Immediate (Immediate (BitSize 32) imm)) = &quot;0x&quot; ++ showHex imm -- showHex (sextend_32_64 imm)</span><span>
</span><span id="line-326"></span><span>   </span><span class="hs-comment">-- show_op (NASM_Operand_Immediate (Immediate (BitSize 16) imm)) = &quot;0x&quot; ++ showHex (sextend_16_64 imm)</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-comment">--show_op (NASM_Operand_Immediate (Immediate (BitSize 8)  imm)) = &quot;0x&quot; ++ showHex (sextend_8_64 imm)</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#render_annot"><span class="hs-identifier hs-type">render_annot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#Annot"><span class="hs-identifier hs-type">Annot</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-334"></span><span id="render_annot"><span class="annot"><span class="annottext">render_annot :: Annot -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#render_annot"><span class="hs-identifier hs-var hs-var">render_annot</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-335"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#render_annot"><span class="hs-identifier hs-var">render_annot</span></a></span><span> </span><span id="local-6989586621679392757"><span class="annot"><span class="annottext">Annot
</span><a href="#local-6989586621679392757"><span class="hs-identifier hs-var">m</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Word64, NASM_Label, Word64) -&gt; String) -&gt; Annot -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Word64, NASM_Label, Word64) -&gt; String
forall {a} {a} {a}.
(Show a, Integral a, Integral a) =&gt;
(a, a, a) -&gt; String
</span><a href="#local-6989586621679392758"><span class="hs-identifier hs-var">render_annot_elmt</span></a></span><span> </span><span class="annot"><span class="annottext">Annot
</span><a href="#local-6989586621679392757"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-337"></span><span>  </span><span id="local-6989586621679392758"><span class="annot"><span class="annottext">render_annot_elmt :: (a, a, a) -&gt; String
</span><a href="#local-6989586621679392758"><span class="hs-identifier hs-var hs-var">render_annot_elmt</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679392792"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392792"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679392793"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392793"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679392794"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392794"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392792"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392793"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392794"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; + 0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392794"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>    </span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392796"><span id="local-6989586621679392801"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand"><span class="hs-identifier hs-type">NASM_Operand</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-342"></span><span>  </span><span id="local-6989586621679392825"><span class="annot"><span class="annottext">show :: NASM_Operand -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Reg"><span class="hs-identifier hs-type">NASM_Operand_Reg</span></a></span><span> </span><span id="local-6989586621679392826"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679392826"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Register -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679392826"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-343"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Address"><span class="hs-identifier hs-type">NASM_Operand_Address</span></a></span><span> </span><span id="local-6989586621679392827"><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392827"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NASM_Address -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392827"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-344"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_EffectiveAddress"><span class="hs-identifier hs-type">NASM_Operand_EffectiveAddress</span></a></span><span> </span><span id="local-6989586621679392828"><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392828"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NASM_Address -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392828"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-345"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Memory"><span class="hs-identifier hs-type">NASM_Operand_Memory</span></a></span><span> </span><span id="local-6989586621679392829"><span class="annot"><span class="annottext">NASM_SizeDir
</span><a href="#local-6989586621679392829"><span class="hs-identifier hs-var">sizedir</span></a></span></span><span> </span><span id="local-6989586621679392830"><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392830"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NASM_SizeDir -&gt; String
forall {a}. (Eq a, Num a) =&gt; (a, Bool) -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#show_nasm_sizedir"><span class="hs-identifier hs-var">show_nasm_sizedir</span></a></span><span> </span><span class="annot"><span class="annottext">NASM_SizeDir
</span><a href="#local-6989586621679392829"><span class="hs-identifier hs-var">sizedir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; [&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NASM_Address -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NASM_Address
</span><a href="#local-6989586621679392830"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-346"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Immediate"><span class="hs-identifier hs-type">NASM_Operand_Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#BitSize"><span class="hs-identifier hs-type">BitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679392831"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392831"><span class="hs-identifier hs-var">imm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392831"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-347"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Immediate"><span class="hs-identifier hs-type">NASM_Operand_Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#BitSize"><span class="hs-identifier hs-type">BitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679392832"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392832"><span class="hs-identifier hs-var">imm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392832"><span class="hs-identifier hs-var">imm</span></a></span><span> </span><span class="hs-comment">-- showHex (sextend_32_64 imm)</span><span>
</span><span id="line-348"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Immediate"><span class="hs-identifier hs-type">NASM_Operand_Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#BitSize"><span class="hs-identifier hs-type">BitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679392833"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392833"><span class="hs-identifier hs-var">imm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64
forall {a}. (Bits a, Num a) =&gt; a -&gt; a
</span><a href="Base.html#sextend_16_64"><span class="hs-identifier hs-var">sextend_16_64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392833"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Operand_Immediate"><span class="hs-identifier hs-type">NASM_Operand_Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X86.Instruction.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Size.html#BitSize"><span class="hs-identifier hs-type">BitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>  </span><span id="local-6989586621679392834"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392834"><span class="hs-identifier hs-var">imm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64
forall {a}. (Bits a, Num a) =&gt; a -&gt; a
</span><a href="Base.html#sextend_8_64"><span class="hs-identifier hs-var">sextend_8_64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392834"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span id="show_nasm_sizedir"><span class="annot"><span class="annottext">show_nasm_sizedir :: (a, Bool) -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#show_nasm_sizedir"><span class="hs-identifier hs-var hs-var">show_nasm_sizedir</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-352"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#show_nasm_sizedir"><span class="hs-identifier hs-var">show_nasm_sizedir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;byte&quot;</span></span><span>
</span><span id="line-353"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#show_nasm_sizedir"><span class="hs-identifier hs-var">show_nasm_sizedir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;word&quot;</span></span><span>
</span><span id="line-354"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#show_nasm_sizedir"><span class="hs-identifier hs-var">show_nasm_sizedir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dword&quot;</span></span><span>
</span><span id="line-355"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#show_nasm_sizedir"><span class="hs-identifier hs-var">show_nasm_sizedir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">8</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;qword&quot;</span></span><span>
</span><span id="line-356"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#show_nasm_sizedir"><span class="hs-identifier hs-var">show_nasm_sizedir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">10</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tword&quot;</span></span><span>
</span><span id="line-357"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#show_nasm_sizedir"><span class="hs-identifier hs-var">show_nasm_sizedir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">16</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;oword&quot;</span></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392850"><span id="local-6989586621679392854"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Label"><span class="hs-identifier hs-type">NASM_Label</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621679392857"><span class="annot"><span class="annottext">show :: NASM_Label -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679392858"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392858"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392858"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-361"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#Macro"><span class="hs-identifier hs-type">Macro</span></a></span><span> </span><span id="local-6989586621679392859"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392859"><span class="hs-identifier hs-var">segment</span></a></span></span><span> </span><span id="local-6989586621679392860"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392860"><span class="hs-identifier hs-var">section</span></a></span></span><span> </span><span id="local-6989586621679392861"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392861"><span class="hs-identifier hs-var">a0</span></a></span></span><span> </span><span id="local-6989586621679392862"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392862"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Word64 -&gt; String
forall {a}. Integral a =&gt; String -&gt; String -&gt; a -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#show_macro_name"><span class="hs-identifier hs-var">show_macro_name</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392859"><span class="hs-identifier hs-var">segment</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392860"><span class="hs-identifier hs-var">section</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392861"><span class="hs-identifier hs-var">a0</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {p}. p -&gt; String
</span><a href="#local-6989586621679392864"><span class="hs-identifier hs-var">show_offset</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392862"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-362"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-363"></span><span>    </span><span id="local-6989586621679392864"><span class="annot"><span class="annottext">show_offset :: p -&gt; String
</span><a href="#local-6989586621679392864"><span class="hs-identifier hs-var hs-var">show_offset</span></a></span></span><span> </span><span id="local-6989586621679392866"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679392866"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392862"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span id="show_macro_name"><span class="annot"><span class="annottext">show_macro_name :: String -&gt; String -&gt; a -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#show_macro_name"><span class="hs-identifier hs-var hs-var">show_macro_name</span></a></span></span><span> </span><span id="local-6989586621679392879"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392879"><span class="hs-identifier hs-var">segment</span></a></span></span><span> </span><span id="local-6989586621679392880"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392880"><span class="hs-identifier hs-var">section</span></a></span></span><span> </span><span id="local-6989586621679392881"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392881"><span class="hs-identifier hs-var">a0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RELA&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; a -&gt; String
forall {a}. Integral a =&gt; String -&gt; String -&gt; a -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#section_name"><span class="hs-identifier hs-var">section_name</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392879"><span class="hs-identifier hs-var">segment</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392880"><span class="hs-identifier hs-var">section</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392881"><span class="hs-identifier hs-var">a0</span></a></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span id="section_name"><span class="annot"><span class="annottext">section_name :: String -&gt; String -&gt; a -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#section_name"><span class="hs-identifier hs-var hs-var">section_name</span></a></span></span><span> </span><span id="local-6989586621679392895"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392895"><span class="hs-identifier hs-var">segment</span></a></span></span><span> </span><span id="local-6989586621679392896"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392896"><span class="hs-identifier hs-var">section</span></a></span></span><span> </span><span id="local-6989586621679392897"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392897"><span class="hs-identifier hs-var">a0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392895"><span class="hs-identifier hs-var">segment</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392896"><span class="hs-identifier hs-var">section</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392897"><span class="hs-identifier hs-var">a0</span></a></span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392899"><span id="local-6989586621679392904"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Address_Computation"><span class="hs-identifier hs-type">NASM_Address_Computation</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-370"></span><span> </span><span id="local-6989586621679392909"><span class="annot"><span class="annottext">show :: NASM_Address_Computation -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Address_Computation"><span class="hs-identifier hs-type">NASM_Address_Computation</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Register
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Register
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Register
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ds:0&quot;</span></span><span> </span><span>
</span><span id="line-371"></span><span> </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Address_Computation"><span class="hs-identifier hs-type">NASM_Address_Computation</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Register
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Register
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Register
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ds:0&quot;</span></span><span> </span><span>
</span><span id="line-372"></span><span> </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Address_Computation"><span class="hs-identifier hs-type">NASM_Address_Computation</span></a></span><span> </span><span id="local-6989586621679392910"><span class="annot"><span class="annottext">Maybe Register
</span><a href="#local-6989586621679392910"><span class="hs-identifier hs-var">seg</span></a></span></span><span> </span><span id="local-6989586621679392911"><span class="annot"><span class="annottext">Maybe Register
</span><a href="#local-6989586621679392911"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621679392912"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392912"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span id="local-6989586621679392913"><span class="annot"><span class="annottext">Maybe Register
</span><a href="#local-6989586621679392913"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span id="local-6989586621679392914"><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679392914"><span class="hs-identifier hs-var">displ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-373"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679392916"><span class="annot"><span class="annottext">str0 :: String
</span><a href="#local-6989586621679392916"><span class="hs-identifier hs-var hs-var">str0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Register -&gt; String
forall {a}. Show a =&gt; Maybe a -&gt; String
</span><a href="#local-6989586621679392917"><span class="hs-identifier hs-var">show_seg</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Register
</span><a href="#local-6989586621679392910"><span class="hs-identifier hs-var">seg</span></a></span><span>
</span><span id="line-374"></span><span>       </span><span id="local-6989586621679392926"><span class="annot"><span class="annottext">str1 :: String
</span><a href="#local-6989586621679392926"><span class="hs-identifier hs-var hs-var">str1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; + &quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; [String] -&gt; [String]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe Register -&gt; String
forall {a}. Show a =&gt; Maybe a -&gt; String
</span><a href="#local-6989586621679392927"><span class="hs-identifier hs-var">show_base</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Register
</span><a href="#local-6989586621679392913"><span class="hs-identifier hs-var">base</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Register -&gt; Word64 -&gt; String
forall {a} {a}.
(Eq a, Num a, Show a, Show a) =&gt;
Maybe a -&gt; a -&gt; String
</span><a href="#local-6989586621679392928"><span class="hs-identifier hs-var">show_index_scale</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Register
</span><a href="#local-6989586621679392911"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679392912"><span class="hs-identifier hs-var">sc</span></a></span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-375"></span><span>       </span><span id="local-6989586621679392930"><span class="annot"><span class="annottext">str2 :: String
</span><a href="#local-6989586621679392930"><span class="hs-identifier hs-var hs-var">str2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Word64 -&gt; String
forall {a}. Integral a =&gt; String -&gt; Maybe a -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#show_displacement"><span class="hs-identifier hs-var">show_displacement</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392926"><span class="hs-identifier hs-var">str1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679392914"><span class="hs-identifier hs-var">displ</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-376"></span><span>     </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392916"><span class="hs-identifier hs-var">str0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392926"><span class="hs-identifier hs-var">str1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392930"><span class="hs-identifier hs-var">str2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-378"></span><span>   </span><span id="local-6989586621679392917"><span class="annot"><span class="annottext">show_seg :: Maybe a -&gt; String
</span><a href="#local-6989586621679392917"><span class="hs-identifier hs-var hs-var">show_seg</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-379"></span><span>   </span><span class="annot"><a href="#local-6989586621679392917"><span class="hs-identifier hs-var">show_seg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679392934"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392934"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392934"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span>   </span><span id="local-6989586621679392927"><span class="annot"><span class="annottext">show_base :: Maybe a -&gt; String
</span><a href="#local-6989586621679392927"><span class="hs-identifier hs-var hs-var">show_base</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-382"></span><span>   </span><span class="annot"><a href="#local-6989586621679392927"><span class="hs-identifier hs-var">show_base</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679392937"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392937"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392937"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span>   </span><span id="local-6989586621679392928"><span class="annot"><span class="annottext">show_index_scale :: Maybe a -&gt; a -&gt; String
</span><a href="#local-6989586621679392928"><span class="hs-identifier hs-var hs-var">show_index_scale</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-385"></span><span>   </span><span class="annot"><a href="#local-6989586621679392928"><span class="hs-identifier hs-var">show_index_scale</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679392949"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392949"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-386"></span><span>   </span><span class="annot"><a href="#local-6989586621679392928"><span class="hs-identifier hs-var">show_index_scale</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679392950"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392950"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392950"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-387"></span><span>   </span><span class="annot"><a href="#local-6989586621679392928"><span class="hs-identifier hs-var">show_index_scale</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679392951"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392951"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679392952"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392952"><span class="hs-identifier hs-var">imm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392951"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; * &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392952"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span id="show_displacement"><span class="annot"><span class="annottext">show_displacement :: String -&gt; Maybe a -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#show_displacement"><span class="hs-identifier hs-var hs-var">show_displacement</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-390"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#show_displacement"><span class="hs-identifier hs-var">show_displacement</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-391"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#show_displacement"><span class="hs-identifier hs-var">show_displacement</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679392974"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392974"><span class="hs-identifier hs-var">imm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392974"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-392"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#show_displacement"><span class="hs-identifier hs-var">show_displacement</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679392975"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392975"><span class="hs-identifier hs-var">imm</span></a></span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-identifier hs-var">testBit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392975"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">63</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; - 0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392975"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; + 0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392975"><span class="hs-identifier hs-var">imm</span></a></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392977"><span id="local-6989586621679392981"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Address"><span class="hs-identifier hs-type">NASM_Address</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-398"></span><span>  </span><span id="local-6989586621679392987"><span class="annot"><span class="annottext">show :: NASM_Address -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Addr_Compute"><span class="hs-identifier hs-type">NASM_Addr_Compute</span></a></span><span> </span><span id="local-6989586621679392988"><span class="annot"><span class="annottext">NASM_Address_Computation
</span><a href="#local-6989586621679392988"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NASM_Address_Computation -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NASM_Address_Computation
</span><a href="#local-6989586621679392988"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Addr_Symbol"><span class="hs-identifier hs-type">NASM_Addr_Symbol</span></a></span><span> </span><span id="local-6989586621679392989"><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679392989"><span class="hs-identifier hs-var">sym</span></a></span></span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Symbol -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#show_symbol"><span class="hs-identifier hs-var">show_symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679392989"><span class="hs-identifier hs-var">sym</span></a></span><span>
</span><span id="line-400"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_JumpTarget"><span class="hs-identifier hs-type">NASM_JumpTarget</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.JumpTarget.html#External"><span class="hs-identifier hs-type">External</span></a></span><span> </span><span id="local-6989586621679392992"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392992"><span class="hs-identifier hs-var">sym</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392992"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; wrt ..plt&quot;</span></span><span>
</span><span id="line-401"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_JumpTarget"><span class="hs-identifier hs-type">NASM_JumpTarget</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.JumpTarget.html#ExternalDeref"><span class="hs-identifier hs-type">ExternalDeref</span></a></span><span> </span><span id="local-6989586621679392994"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392994"><span class="hs-identifier hs-var">sym</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[ &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392994"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; ]&quot;</span></span><span>
</span><span id="line-402"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Addr_Label"><span class="hs-identifier hs-type">NASM_Addr_Label</span></a></span><span> </span><span id="local-6989586621679392995"><span class="annot"><span class="annottext">NASM_Label
</span><a href="#local-6989586621679392995"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679392996"><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679392996"><span class="hs-identifier hs-var">displ</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NASM_Label -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NASM_Label
</span><a href="#local-6989586621679392995"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Word64 -&gt; String
forall {a}. Integral a =&gt; String -&gt; Maybe a -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#show_displacement"><span class="hs-identifier hs-var">show_displacement</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NASM_Label -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NASM_Label
</span><a href="#local-6989586621679392995"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679392996"><span class="hs-identifier hs-var">displ</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span id="show_symbol"><span class="annot"><span class="annottext">show_symbol :: Symbol -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#show_symbol"><span class="hs-identifier hs-var hs-var">show_symbol</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Symbol.html#PointerToLabel"><span class="hs-identifier hs-type">PointerToLabel</span></a></span><span>  </span><span id="local-6989586621679392998"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392998"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392998"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; wrt ..plt&quot;</span></span><span>
</span><span id="line-406"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#show_symbol"><span class="hs-identifier hs-var">show_symbol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Symbol.html#PointerToLabel"><span class="hs-identifier hs-type">PointerToLabel</span></a></span><span>  </span><span id="local-6989586621679392999"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392999"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679392999"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-407"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#show_symbol"><span class="hs-identifier hs-var">show_symbol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Symbol.html#PointerToObject"><span class="hs-identifier hs-type">PointerToObject</span></a></span><span> </span><span id="local-6989586621679393001"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679393001"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679393001"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; wrt ..got&quot;</span></span><span>
</span><span id="line-408"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#show_symbol"><span class="hs-identifier hs-var">show_symbol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Symbol.html#PointerToObject"><span class="hs-identifier hs-type">PointerToObject</span></a></span><span> </span><span id="local-6989586621679393002"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679393002"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679393002"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; wrt ..got&quot;</span></span><span>
</span><span id="line-409"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#show_symbol"><span class="hs-identifier hs-var">show_symbol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Symbol.html#AddressOfLabel"><span class="hs-identifier hs-type">AddressOfLabel</span></a></span><span>  </span><span id="local-6989586621679393004"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679393004"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679393004"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-410"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#show_symbol"><span class="hs-identifier hs-var">show_symbol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Symbol.html#AddressOfObject"><span class="hs-identifier hs-type">AddressOfObject</span></a></span><span> </span><span id="local-6989586621679393006"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679393006"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679393006"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-411"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#show_symbol"><span class="hs-identifier hs-var">show_symbol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Symbol.html#Relocated_ResolvedObject"><span class="hs-identifier hs-type">Relocated_ResolvedObject</span></a></span><span> </span><span id="local-6989586621679393008"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679393008"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679393008"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="hs-comment">-- RENDERING TO JSON</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- We build a list of functions, for each of which we stores the following information:</span><span>
</span><span id="line-418"></span><span class="hs-keyword">data</span><span> </span><span id="JSON_NASM_Function"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#JSON_NASM_Function"><span class="hs-identifier hs-var">JSON_NASM_Function</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="JSON_NASM_Function"><span class="annot"><a href="OutputGeneration.NASM.NASM.html#JSON_NASM_Function"><span class="hs-identifier hs-var">JSON_NASM_Function</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-419"></span><span>    </span><span id="name"><span class="annot"><span class="annottext">JSON_NASM_Function -&gt; String
</span><a href="OutputGeneration.NASM.NASM.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The name of the function</span></span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="blocks"><span class="annot"><span class="annottext">JSON_NASM_Function -&gt; [(Int, [String])]
</span><a href="OutputGeneration.NASM.NASM.html#blocks"><span class="hs-identifier hs-var hs-var">blocks</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ A mapping from blocKIDs to rendered instructions</span></span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="control_flow"><span class="annot"><span class="annottext">JSON_NASM_Function -&gt; IntMap IntSet
</span><a href="OutputGeneration.NASM.NASM.html#control_flow"><span class="hs-identifier hs-var hs-var">control_flow</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IM.IntMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IS.IntSet</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ A mapping from blockIDs to sets of blockIDs</span></span><span>
</span><span id="line-422"></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-423"></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679393014"><span id="local-6989586621679393016"><span class="annot"><span class="annottext">(forall x. JSON_NASM_Function -&gt; Rep JSON_NASM_Function x)
-&gt; (forall x. Rep JSON_NASM_Function x -&gt; JSON_NASM_Function)
-&gt; Generic JSON_NASM_Function
forall x. Rep JSON_NASM_Function x -&gt; JSON_NASM_Function
forall x. JSON_NASM_Function -&gt; Rep JSON_NASM_Function x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. JSON_NASM_Function -&gt; Rep JSON_NASM_Function x
from :: forall x. JSON_NASM_Function -&gt; Rep JSON_NASM_Function x
$cto :: forall x. Rep JSON_NASM_Function x -&gt; JSON_NASM_Function
to :: forall x. Rep JSON_NASM_Function x -&gt; JSON_NASM_Function
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679393019"><span id="local-6989586621679393027"><span id="local-6989586621679393030"><span id="local-6989586621679393033"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#JSON_NASM_Function"><span class="hs-identifier hs-type">JSON_NASM_Function</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-426"></span><span>  </span><span id="local-6989586621679393251"><span class="annot"><span class="annottext">toEncoding :: JSON_NASM_Function -&gt; Encoding
</span><a href="#local-6989586621679393251"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; JSON_NASM_Function -&gt; Encoding
forall a.
(Generic a, GToJSON' Encoding Zero (Rep a)) =&gt;
Options -&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">genericToEncoding</span></span><span> </span><span class="annot"><span class="annottext">(Options -&gt; JSON_NASM_Function -&gt; Encoding)
-&gt; Options -&gt; JSON_NASM_Function -&gt; Encoding
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Options
</span><span class="hs-identifier hs-var">defaultOptions</span></span><span> </span><span class="hs-comment">--  { unwrapUnaryRecords = True }</span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span id="render_NASM_to_JSON"><span class="annot"><span class="annottext">render_NASM_to_JSON :: NASM -&gt; ByteString
</span><a href="OutputGeneration.NASM.NASM.html#render_NASM_to_JSON"><span class="hs-identifier hs-var hs-var">render_NASM_to_JSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM"><span class="hs-identifier hs-type">NASM</span></a></span><span> </span><span id="local-6989586621679393259"><span class="annot"><span class="annottext">Set String
</span><a href="#local-6989586621679393259"><span class="hs-identifier hs-var">externals</span></a></span></span><span> </span><span id="local-6989586621679393260"><span class="annot"><span class="annottext">Set String
</span><a href="#local-6989586621679393260"><span class="hs-identifier hs-var">globals</span></a></span></span><span> </span><span id="local-6989586621679393261"><span class="annot"><span class="annottext">[NASM_Section]
</span><a href="#local-6989586621679393261"><span class="hs-identifier hs-var">sections</span></a></span></span><span> </span><span id="local-6989586621679393262"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679393262"><span class="hs-identifier hs-var">footer</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[JSON_NASM_Function] -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encode</span></span><span> </span><span class="annot"><span class="annottext">([JSON_NASM_Function] -&gt; ByteString)
-&gt; [JSON_NASM_Function] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(NASM_Section -&gt; [JSON_NASM_Function])
-&gt; [NASM_Section] -&gt; [JSON_NASM_Function]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">NASM_Section -&gt; [JSON_NASM_Function]
</span><a href="OutputGeneration.NASM.NASM.html#toJSON_section"><span class="hs-identifier hs-var">toJSON_section</span></a></span><span> </span><span class="annot"><span class="annottext">[NASM_Section]
</span><a href="#local-6989586621679393261"><span class="hs-identifier hs-var">sections</span></a></span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span id="toJSON_section"><span class="annot"><span class="annottext">toJSON_section :: NASM_Section -&gt; [JSON_NASM_Function]
</span><a href="OutputGeneration.NASM.NASM.html#toJSON_section"><span class="hs-identifier hs-var hs-var">toJSON_section</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Section_Text"><span class="hs-identifier hs-type">NASM_Section_Text</span></a></span><span> </span><span id="local-6989586621679393265"><span class="annot"><span class="annottext">NASM_TextSection
</span><a href="#local-6989586621679393265"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">NASM_TextSection -&gt; JSON_NASM_Function
</span><a href="OutputGeneration.NASM.NASM.html#toJSON_text_section"><span class="hs-identifier hs-var">toJSON_text_section</span></a></span><span> </span><span class="annot"><span class="annottext">NASM_TextSection
</span><a href="#local-6989586621679393265"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-434"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#toJSON_section"><span class="hs-identifier hs-var">toJSON_section</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Section_Data"><span class="hs-identifier hs-type">NASM_Section_Data</span></a></span><span> </span><span class="annot"><span class="annottext">[NASM_DataSection]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span id="toJSON_text_section"><span class="annot"><span class="annottext">toJSON_text_section :: NASM_TextSection -&gt; JSON_NASM_Function
</span><a href="OutputGeneration.NASM.NASM.html#toJSON_text_section"><span class="hs-identifier hs-var hs-var">toJSON_text_section</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_TextSection"><span class="hs-identifier hs-type">NASM_TextSection</span></a></span><span> </span><span id="local-6989586621679393268"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679393268"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679393269"><span class="annot"><span class="annottext">[(Int, [NASM_Line])]
</span><a href="#local-6989586621679393269"><span class="hs-identifier hs-var">blocks</span></a></span></span><span> </span><span id="local-6989586621679393270"><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679393270"><span class="hs-identifier hs-var">cf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(Int, [String])] -&gt; IntMap IntSet -&gt; JSON_NASM_Function
</span><a href="OutputGeneration.NASM.NASM.html#JSON_NASM_Function"><span class="hs-identifier hs-var">JSON_NASM_Function</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679393268"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, [NASM_Line]) -&gt; (Int, [String]))
-&gt; [(Int, [NASM_Line])] -&gt; [(Int, [String])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Int, [NASM_Line]) -&gt; (Int, [String])
forall {t :: * -&gt; *} {a}.
Foldable t =&gt;
(a, t NASM_Line) -&gt; (a, [String])
</span><a href="#local-6989586621679393271"><span class="hs-identifier hs-var">render_block</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, [NASM_Line])]
</span><a href="#local-6989586621679393269"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679393270"><span class="hs-identifier hs-var">cf</span></a></span><span>
</span><span id="line-437"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-438"></span><span>  </span><span id="local-6989586621679393271"><span class="annot"><span class="annottext">render_block :: (a, t NASM_Line) -&gt; (a, [String])
</span><a href="#local-6989586621679393271"><span class="hs-identifier hs-var hs-var">render_block</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679393274"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679393274"><span class="hs-identifier hs-var">blockID</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679393275"><span class="annot"><span class="annottext">t NASM_Line
</span><a href="#local-6989586621679393275"><span class="hs-identifier hs-var">lines</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679393274"><span class="hs-identifier hs-var">blockID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(NASM_Line -&gt; [String]) -&gt; t NASM_Line -&gt; [String]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">NASM_Line -&gt; [String]
</span><a href="OutputGeneration.NASM.NASM.html#toJSON_line"><span class="hs-identifier hs-var">toJSON_line</span></a></span><span> </span><span class="annot"><span class="annottext">t NASM_Line
</span><a href="#local-6989586621679393275"><span class="hs-identifier hs-var">lines</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span id="toJSON_line"><span class="annot"><span class="annottext">toJSON_line :: NASM_Line -&gt; [String]
</span><a href="OutputGeneration.NASM.NASM.html#toJSON_line"><span class="hs-identifier hs-var hs-var">toJSON_line</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Comment"><span class="hs-identifier hs-type">NASM_Comment</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-441"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#toJSON_line"><span class="hs-identifier hs-var">toJSON_line</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Line"><span class="hs-identifier hs-type">NASM_Line</span></a></span><span> </span><span id="local-6989586621679393279"><span class="annot"><span class="annottext">NASM_Instruction
</span><a href="#local-6989586621679393279"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; String
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">';'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NASM_Instruction -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NASM_Instruction
</span><a href="#local-6989586621679393279"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-442"></span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#toJSON_line"><span class="hs-identifier hs-var">toJSON_line</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OutputGeneration.NASM.NASM.html#NASM_Label"><span class="hs-identifier hs-type">NASM_Label</span></a></span><span> </span><span class="annot"><span class="annottext">NASM_Label
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span></pre></body></html>