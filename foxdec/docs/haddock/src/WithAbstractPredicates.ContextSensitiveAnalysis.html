<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures , DeriveGeneric, BangPatterns, StrictData, ScopedTypeVariables, FunctionalDependencies, FlexibleInstances, UndecidableInstances, FlexibleContexts#-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">WithAbstractPredicates.ContextSensitiveAnalysis</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Base.html"><span class="hs-identifier">Base</span></a></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Config.html"><span class="hs-identifier">Config</span></a></span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="WithAbstractPredicates.Class.html"><span class="hs-identifier">WithAbstractPredicates.Class</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="WithAbstractPredicates.GenerateCFG.html"><span class="hs-identifier">WithAbstractPredicates.GenerateCFG</span></a></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="WithAbstractPredicates.GenerateInvariants.html"><span class="hs-identifier">WithAbstractPredicates.GenerateInvariants</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ControlFlow.html"><span class="hs-identifier">WithAbstractPredicates.ControlFlow</span></a></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.JumpTarget.html"><span class="hs-identifier">Data.JumpTarget</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Symbol.html"><span class="hs-identifier">Data.Symbol</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.L0.html"><span class="hs-identifier">Data.L0</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.CFG.html"><span class="hs-identifier">Data.CFG</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Indirection.html"><span class="hs-identifier">Data.Indirection</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.VerificationCondition.html"><span class="hs-identifier">Data.VerificationCondition</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X86.Opcode.html"><span class="hs-identifier">Data.X86.Opcode</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html"><span class="hs-identifier">Data.X86.Instruction</span></a></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Binary.Generic.html"><span class="hs-identifier">Binary.Generic</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Binary.FunctionNames.html"><span class="hs-identifier">Binary.FunctionNames</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Algorithm.SCC.html"><span class="hs-identifier">Algorithm.SCC</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.Extra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">firstJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.IORef</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IM</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IS</span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State.Strict</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Extra</span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">type</span><span> </span><span id="WithLifting"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#WithLifting"><span class="hs-identifier hs-var">WithLifting</span></a></span></span><span> </span><span id="local-6989586621679396969"><span class="annot"><a href="#local-6989586621679396969"><span class="hs-identifier hs-type">bin</span></a></span></span><span> </span><span id="local-6989586621679396970"><span class="annot"><a href="#local-6989586621679396970"><span class="hs-identifier hs-type">pred</span></a></span></span><span> </span><span id="local-6989586621679396971"><span class="annot"><a href="#local-6989586621679396971"><span class="hs-identifier hs-type">finit</span></a></span></span><span> </span><span id="local-6989586621679396972"><span class="annot"><a href="#local-6989586621679396972"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.L0.html#L0"><span class="hs-identifier hs-type">L0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396970"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396971"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396972"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679396969"><span class="hs-identifier hs-type">bin</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Config.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- A mapping of blockIDs to predicates</span><span>
</span><span id="line-67"></span><span class="hs-keyword">type</span><span> </span><span id="Invariants"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#Invariants"><span class="hs-identifier hs-var">Invariants</span></a></span></span><span> </span><span id="local-6989586621679396974"><span class="annot"><a href="#local-6989586621679396974"><span class="hs-identifier hs-type">pred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IM.IntMap</span></span><span> </span><span class="annot"><a href="#local-6989586621679396974"><span class="hs-identifier hs-type">pred</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">type</span><span> </span><span id="Recursions"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#Recursions"><span class="hs-identifier hs-var">Recursions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IM.IntMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IS.IntSet</span></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">data</span><span> </span><span id="AnalysisResult"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#AnalysisResult"><span class="hs-identifier hs-var">AnalysisResult</span></a></span></span><span> </span><span id="local-6989586621679396870"><span class="annot"><a href="#local-6989586621679396870"><span class="hs-identifier hs-type">pred</span></a></span></span><span> </span><span id="local-6989586621679396869"><span class="annot"><a href="#local-6989586621679396869"><span class="hs-identifier hs-type">finit</span></a></span></span><span> </span><span id="local-6989586621679396871"><span class="annot"><a href="#local-6989586621679396871"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FoundNewCalls"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#FoundNewCalls"><span class="hs-identifier hs-var">FoundNewCalls</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IM.IntMap</span></span><span> </span><span class="annot"><a href="#local-6989586621679396869"><span class="hs-identifier hs-type">finit</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="AnalyzedWithResult"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#AnalyzedWithResult"><span class="hs-identifier hs-var">AnalyzedWithResult</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.L0.html#FResult"><span class="hs-identifier hs-type">FResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396870"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396871"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- Lift the binary to the L0 representation</span><span>
</span><span id="line-86"></span><span id="local-6989586621679396557"><span id="local-6989586621679396558"><span id="local-6989586621679396559"><span id="local-6989586621679396560"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#lift_to_L0"><span class="hs-identifier hs-type">lift_to_L0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractPredicates.Class.html#WithAbstractPredicates"><span class="hs-identifier hs-type">WithAbstractPredicates</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396557"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396558"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396559"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396560"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Config.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679396557"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679396559"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.L0.html#L0"><span class="hs-identifier hs-type">L0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396558"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396559"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396560"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-87"></span><span id="lift_to_L0"><span class="annot"><span class="annottext">lift_to_L0 :: forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Config -&gt; bin -&gt; finit -&gt; IO (L0 pred finit v)
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#lift_to_L0"><span class="hs-identifier hs-var hs-var">lift_to_L0</span></a></span></span><span> </span><span id="local-6989586621679396987"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679396987"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679396988"><span class="annot"><span class="annottext">bin
</span><a href="#local-6989586621679396988"><span class="hs-identifier hs-var">bin</span></a></span></span><span> </span><span id="local-6989586621679396989"><span class="annot"><span class="annottext">finit
</span><a href="#local-6989586621679396989"><span class="hs-identifier hs-var">finit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679396990"><span class="annot"><span class="annottext">[Key]
</span><a href="#local-6989586621679396990"><span class="hs-identifier hs-var">entries</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Key]
</span><a href="#local-6989586621679396991"><span class="hs-identifier hs-var">get_entries</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679396992"><span class="annot"><span class="annottext">empty_L0 :: L0 pred finit v
</span><a href="#local-6989586621679396992"><span class="hs-identifier hs-var hs-var">empty_L0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntMap (finit, Maybe (FResult pred v))
-&gt; IntMap Indirections -&gt; String -&gt; L0 pred finit v
forall pred finit v.
IntMap (finit, Maybe (FResult pred v))
-&gt; IntMap Indirections -&gt; String -&gt; L0 pred finit v
</span><a href="Data.L0.html#L0"><span class="hs-identifier hs-var">L0</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (finit, Maybe (FResult pred v))
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span> </span><span class="annot"><span class="annottext">IntMap Indirections
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679396997"><span class="annot"><span class="annottext">init_L0 :: L0 pred finit v
</span><a href="#local-6989586621679396997"><span class="hs-identifier hs-var hs-var">init_L0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Key -&gt; L0 pred finit v -&gt; L0 pred finit v)
-&gt; L0 pred finit v -&gt; [Key] -&gt; L0 pred finit v
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679396999"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679396999"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Key -&gt; finit -&gt; L0 pred finit v -&gt; L0 pred finit v
forall {finit} {pred} {v}.
Key -&gt; finit -&gt; L0 pred finit v -&gt; L0 pred finit v
</span><a href="Data.L0.html#l0_insert_new_entry"><span class="hs-identifier hs-var">l0_insert_new_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679396999"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">finit
</span><a href="#local-6989586621679396989"><span class="hs-identifier hs-var">finit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">L0 pred finit v
forall {pred} {finit} {v}. L0 pred finit v
</span><a href="#local-6989586621679396992"><span class="hs-identifier hs-var">empty_L0</span></a></span><span> </span><span class="annot"><span class="annottext">[Key]
</span><a href="#local-6989586621679396990"><span class="hs-identifier hs-var">entries</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397001"><span class="annot"><span class="annottext">recs :: IntMap a
</span><a href="#local-6989586621679397001"><span class="hs-identifier hs-var hs-var">recs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntMap a
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397002"><span class="annot"><span class="annottext">entry_graph :: Graph
</span><a href="#local-6989586621679397002"><span class="hs-identifier hs-var hs-var">entry_graph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntMap IntSet -&gt; Graph
</span><a href="Base.html#Edges"><span class="hs-identifier hs-var">Edges</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap IntSet -&gt; Graph) -&gt; IntMap IntSet -&gt; Graph
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Key, IntSet)] -&gt; IntMap IntSet
forall a. [(Key, a)] -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Key] -&gt; [IntSet] -&gt; [(Key, IntSet)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Key]
</span><a href="#local-6989586621679396990"><span class="hs-identifier hs-var">entries</span></a></span><span> </span><span class="annot"><span class="annottext">([IntSet] -&gt; [(Key, IntSet)]) -&gt; [IntSet] -&gt; [(Key, IntSet)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; [IntSet]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><span class="hs-identifier hs-var">IS.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><span class="annottext">ReaderT (bin, Config) IO (L0 pred finit v)
-&gt; (bin, Config) -&gt; IO (L0 pred finit v)
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
-&gt; L0 pred finit v -&gt; ReaderT (bin, Config) IO (L0 pred finit v)
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m s
</span><span class="hs-identifier hs-var">execStateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph
-&gt; IntMap IntSet
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Graph -&gt; IntMap IntSet -&gt; WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreFunctionEntries"><span class="hs-identifier hs-var">exploreFunctionEntries</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397002"><span class="hs-identifier hs-var">entry_graph</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
forall a. IntMap a
</span><a href="#local-6989586621679397001"><span class="hs-identifier hs-var">recs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">L0 pred finit v
forall {pred} {v}. L0 pred finit v
</span><a href="#local-6989586621679396997"><span class="hs-identifier hs-var">init_L0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">bin
</span><a href="#local-6989586621679396988"><span class="hs-identifier hs-var">bin</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679396987"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679396991"><span class="annot"><span class="annottext">get_entries :: IO [Key]
</span><a href="#local-6989586621679396991"><span class="hs-identifier hs-var hs-var">get_entries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397018"><span class="annot"><span class="annottext">dirname :: String
</span><a href="#local-6989586621679397018"><span class="hs-identifier hs-var hs-var">dirname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">bin -&gt; String
forall a. BinaryClass a =&gt; a -&gt; String
</span><a href="Binary.Generic.html#binary_dir_name"><span class="hs-identifier hs-var">binary_dir_name</span></a></span><span> </span><span class="annot"><span class="annottext">bin
</span><a href="#local-6989586621679396988"><span class="hs-identifier hs-var">bin</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397021"><span class="annot"><span class="annottext">name :: String
</span><a href="#local-6989586621679397021"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">bin -&gt; String
forall a. BinaryClass a =&gt; a -&gt; String
</span><a href="Binary.Generic.html#binary_file_name"><span class="hs-identifier hs-var">binary_file_name</span></a></span><span> </span><span class="annot"><span class="annottext">bin
</span><a href="#local-6989586621679396988"><span class="hs-identifier hs-var">bin</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397023"><span class="annot"><span class="annottext">fname :: String
</span><a href="#local-6989586621679397023"><span class="hs-identifier hs-var hs-var">fname</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679397018"><span class="hs-identifier hs-var">dirname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679397021"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.entry&quot;</span></span><span> </span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">IO [Key] -&gt; IO [Key]
forall a. IO a -&gt; IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO [Key] -&gt; IO [Key]) -&gt; IO [Key] -&gt; IO [Key]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [Key]
</span><a href="#local-6989586621679397025"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO [Key]) -&gt; String -&gt; IO [Key]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679397023"><span class="hs-identifier hs-var">fname</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span id="local-6989586621679397025"><span class="annot"><span class="annottext">parse :: String -&gt; IO [Key]
</span><a href="#local-6989586621679397025"><span class="hs-identifier hs-var hs-var">parse</span></a></span></span><span> </span><span id="local-6989586621679397029"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679397029"><span class="hs-identifier hs-var">filename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679397030"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679397030"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><span class="hs-identifier hs-var">readFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679397029"><span class="hs-identifier hs-var">filename</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="annottext">[Key] -&gt; IO [Key]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([Key] -&gt; IO [Key]) -&gt; [Key] -&gt; IO [Key]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Key) -&gt; [String] -&gt; [Key]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Key
</span><a href="#local-6989586621679397032"><span class="hs-identifier hs-var">read_line</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [Key]) -&gt; [String] -&gt; [Key]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">lines</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679397030"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621679397032"><span class="annot"><span class="annottext">read_line :: String -&gt; Key
</span><a href="#local-6989586621679397032"><span class="hs-identifier hs-var hs-var">read_line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Key
forall a. (Eq a, Num a) =&gt; String -&gt; a
</span><a href="Base.html#readHex%27"><span class="hs-identifier hs-var">readHex'</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Key) -&gt; (String -&gt; String) -&gt; String -&gt; Key
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span id="local-6989586621679396612"><span id="local-6989586621679396613"><span id="local-6989586621679396614"><span id="local-6989586621679396615"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreFunctionEntries"><span class="hs-identifier hs-type">exploreFunctionEntries</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractPredicates.Class.html#WithAbstractPredicates"><span class="hs-identifier hs-type">WithAbstractPredicates</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396612"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396613"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396614"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396615"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Base.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#Recursions"><span class="hs-identifier hs-type">Recursions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#WithLifting"><span class="hs-identifier hs-type">WithLifting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396612"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396613"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396614"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396615"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-110"></span><span id="exploreFunctionEntries"><span class="annot"><span class="annottext">exploreFunctionEntries :: forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Graph -&gt; IntMap IntSet -&gt; WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreFunctionEntries"><span class="hs-identifier hs-var hs-var">exploreFunctionEntries</span></a></span></span><span> </span><span id="local-6989586621679397070"><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397070"><span class="hs-identifier hs-var">entries</span></a></span></span><span> </span><span id="local-6989586621679397071"><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397071"><span class="hs-identifier hs-var">recursions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-comment">-- Check if a (mutually) recursive function must be reconsidered as all its calls are done.</span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621679397072"><span class="annot"><span class="annottext">Maybe (Key, IntSet)
</span><a href="#local-6989586621679397072"><span class="hs-identifier hs-var">rec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IntMap IntSet -&gt; WithLifting bin pred finit v (Maybe (Key, IntSet))
forall bin pred finit v.
IntMap IntSet -&gt; WithLifting bin pred finit v (Maybe (Key, IntSet))
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#reconsider_mutual_recursive_call"><span class="hs-identifier hs-var">reconsider_mutual_recursive_call</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397071"><span class="hs-identifier hs-var">recursions</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Key, IntSet)
</span><a href="#local-6989586621679397072"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397074"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397074"><span class="hs-identifier hs-var">entry</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679397075"><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679397075"><span class="hs-identifier hs-var">trgts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-comment">-- If yes, then reinsert the function entry, remove the current known results and continue</span><span>
</span><span id="line-116"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; WithLifting bin pred finit v ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; WithLifting bin pred finit v ())
-&gt; IO () -&gt; WithLifting bin pred finit v ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Reconsidering (due to mutual recursion) entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397074"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; as all entries &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; String
</span><a href="Base.html#showHex_set"><span class="hs-identifier hs-var">showHex_set</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679397075"><span class="hs-identifier hs-var">trgts</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; are now done.&quot;</span></span><span>
</span><span id="line-117"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397079"><span class="annot"><span class="annottext">entries' :: Graph
</span><a href="#local-6989586621679397079"><span class="hs-identifier hs-var hs-var">entries'</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph -&gt; Key -&gt; IntSet -&gt; Graph
</span><a href="Base.html#graph_add_edges"><span class="hs-identifier hs-var">graph_add_edges</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397070"><span class="hs-identifier hs-var">entries</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397074"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><span class="hs-identifier hs-var">IS.empty</span></span><span> </span><span>
</span><span id="line-118"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397081"><span class="annot"><span class="annottext">recursions' :: IntMap IntSet
</span><a href="#local-6989586621679397081"><span class="hs-identifier hs-var hs-var">recursions'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key -&gt; IntMap IntSet -&gt; IntMap IntSet
forall a. Key -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.delete</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397074"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397071"><span class="hs-identifier hs-var">recursions</span></a></span><span>
</span><span id="line-119"></span><span>      </span><span class="annot"><span class="annottext">(L0 pred finit v -&gt; L0 pred finit v)
-&gt; WithLifting bin pred finit v ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((L0 pred finit v -&gt; L0 pred finit v)
 -&gt; WithLifting bin pred finit v ())
-&gt; (L0 pred finit v -&gt; L0 pred finit v)
-&gt; WithLifting bin pred finit v ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Maybe (FResult pred v) -&gt; L0 pred finit v -&gt; L0 pred finit v
forall {a} {pred} {v} {finit}.
Integral a =&gt;
a -&gt; Maybe (FResult pred v) -&gt; L0 pred finit v -&gt; L0 pred finit v
</span><a href="Data.L0.html#l0_adjust_result"><span class="hs-identifier hs-var">l0_adjust_result</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397074"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (FResult pred v)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-120"></span><span>      </span><span class="annot"><span class="annottext">Graph -&gt; IntMap IntSet -&gt; Word64 -&gt; WithLifting bin pred finit v ()
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Graph -&gt; IntMap IntSet -&gt; Word64 -&gt; WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreFunctionEntry"><span class="hs-identifier hs-var">exploreFunctionEntry</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397079"><span class="hs-identifier hs-var">entries'</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397081"><span class="hs-identifier hs-var">recursions'</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; WithLifting bin pred finit v ())
-&gt; Word64 -&gt; WithLifting bin pred finit v ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397074"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Key, IntSet)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-122"></span><span>      </span><span class="hs-comment">-- If not, find next entry to consider</span><span>
</span><span id="line-123"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Key
</span><a href="#local-6989586621679397086"><span class="hs-identifier hs-var">next_entry</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><span class="annottext">Maybe Key
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WithLifting bin pred finit v ()
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreDanglingFunctionPointers"><span class="hs-identifier hs-var">exploreDanglingFunctionPointers</span></a></span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679397088"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397088"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Graph -&gt; IntMap IntSet -&gt; Word64 -&gt; WithLifting bin pred finit v ()
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Graph -&gt; IntMap IntSet -&gt; Word64 -&gt; WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreFunctionEntry"><span class="hs-identifier hs-var">exploreFunctionEntry</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397070"><span class="hs-identifier hs-var">entries</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397071"><span class="hs-identifier hs-var">recursions</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; WithLifting bin pred finit v ())
-&gt; Word64 -&gt; WithLifting bin pred finit v ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397088"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-126"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-127"></span><span>  </span><span id="local-6989586621679397086"><span class="annot"><span class="annottext">next_entry :: Maybe Key
</span><a href="#local-6989586621679397086"><span class="hs-identifier hs-var hs-var">next_entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Key
</span><a href="#local-6989586621679397090"><span class="hs-identifier hs-var">try_end_node_from_node_to_be_reconsidered</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Key -&gt; Maybe Key -&gt; Maybe Key
forall a. Eq a =&gt; Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="Base.html#orTry"><span class="hs-operator hs-var">`orTry`</span></a></span><span> </span><span class="annot"><span class="annottext">Graph -&gt; Maybe Key
</span><a href="Algorithm.SCC.html#graph_find_next"><span class="hs-identifier hs-var">graph_find_next</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397070"><span class="hs-identifier hs-var">entries</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span id="local-6989586621679397090"><span class="annot"><span class="annottext">try_end_node_from_node_to_be_reconsidered :: Maybe Key
</span><a href="#local-6989586621679397090"><span class="hs-identifier hs-var hs-var">try_end_node_from_node_to_be_reconsidered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Key -&gt; Maybe Key) -&gt; [Key] -&gt; Maybe Key
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe b
</span><span class="hs-identifier hs-var">firstJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph -&gt; Key -&gt; Maybe Key
</span><a href="Base.html#try_find_end_node_from_node"><span class="hs-identifier hs-var">try_find_end_node_from_node</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397070"><span class="hs-identifier hs-var">entries</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Key] -&gt; Maybe Key) -&gt; [Key] -&gt; Maybe Key
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; [Key]
</span><span class="hs-identifier hs-var">IS.toList</span></span><span> </span><span class="annot"><span class="annottext">(IntSet -&gt; [Key]) -&gt; IntSet -&gt; [Key]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[IntSet] -&gt; IntSet
forall (f :: * -&gt; *). Foldable f =&gt; f IntSet -&gt; IntSet
</span><span class="hs-identifier hs-var">IS.unions</span></span><span> </span><span class="annot"><span class="annottext">([IntSet] -&gt; IntSet) -&gt; [IntSet] -&gt; IntSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet -&gt; [IntSet]
forall a. IntMap a -&gt; [a]
</span><span class="hs-identifier hs-var">IM.elems</span></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397071"><span class="hs-identifier hs-var">recursions</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span id="local-6989586621679396664"><span id="local-6989586621679396665"><span id="local-6989586621679396666"><span id="local-6989586621679396667"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreDanglingFunctionPointers"><span class="hs-identifier hs-type">exploreDanglingFunctionPointers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractPredicates.Class.html#WithAbstractPredicates"><span class="hs-identifier hs-type">WithAbstractPredicates</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396664"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396665"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396666"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396667"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#WithLifting"><span class="hs-identifier hs-type">WithLifting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396664"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396665"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396666"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396667"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-131"></span><span id="exploreDanglingFunctionPointers"><span class="annot"><span class="annottext">exploreDanglingFunctionPointers :: forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreDanglingFunctionPointers"><span class="hs-identifier hs-var hs-var">exploreDanglingFunctionPointers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-132"></span><span>  </span><span id="local-6989586621679397129"><span class="annot"><span class="annottext">L0 pred finit v
</span><a href="#local-6989586621679397129"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT
  (L0 pred finit v) (ReaderT (bin, Config) IO) (L0 pred finit v)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-133"></span><span>  </span><span id="local-6989586621679397131"><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397131"><span class="hs-identifier hs-var">static</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WithLifting bin pred finit v (Lifting bin pred finit v)
forall bin pred finit v.
WithLifting bin pred finit v (Lifting bin pred finit v)
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#mk_static"><span class="hs-identifier hs-var">mk_static</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397134"><span class="annot"><span class="annottext">fptrs :: [Key]
</span><a href="#local-6989586621679397134"><span class="hs-identifier hs-var hs-var">fptrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((finit, Maybe (FResult pred v)) -&gt; [Key])
-&gt; [(finit, Maybe (FResult pred v))] -&gt; [Key]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap (finit, Maybe (FResult pred v))
-&gt; (finit, Maybe (FResult pred v)) -&gt; [Key]
forall {a} {a} {pred} {v}.
IntMap a -&gt; (a, Maybe (FResult pred v)) -&gt; [Key]
</span><a href="#local-6989586621679397136"><span class="hs-identifier hs-var">get_dangling_function_pointers</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap (finit, Maybe (FResult pred v))
 -&gt; (finit, Maybe (FResult pred v)) -&gt; [Key])
-&gt; IntMap (finit, Maybe (FResult pred v))
-&gt; (finit, Maybe (FResult pred v))
-&gt; [Key]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">L0 pred finit v -&gt; IntMap (finit, Maybe (FResult pred v))
forall pred finit v.
L0 pred finit v -&gt; IntMap (finit, Maybe (FResult pred v))
</span><a href="Data.L0.html#l0_functions"><span class="hs-identifier hs-var">l0_functions</span></a></span><span> </span><span class="annot"><span class="annottext">L0 pred finit v
</span><a href="#local-6989586621679397129"><span class="hs-identifier hs-var">l0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(finit, Maybe (FResult pred v))] -&gt; [Key])
-&gt; [(finit, Maybe (FResult pred v))] -&gt; [Key]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap (finit, Maybe (FResult pred v))
-&gt; [(finit, Maybe (FResult pred v))]
forall a. IntMap a -&gt; [a]
</span><span class="hs-identifier hs-var">IM.elems</span></span><span> </span><span class="annot"><span class="annottext">(IntMap (finit, Maybe (FResult pred v))
 -&gt; [(finit, Maybe (FResult pred v))])
-&gt; IntMap (finit, Maybe (FResult pred v))
-&gt; [(finit, Maybe (FResult pred v))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">L0 pred finit v -&gt; IntMap (finit, Maybe (FResult pred v))
forall pred finit v.
L0 pred finit v -&gt; IntMap (finit, Maybe (FResult pred v))
</span><a href="Data.L0.html#l0_functions"><span class="hs-identifier hs-var">l0_functions</span></a></span><span> </span><span class="annot"><span class="annottext">L0 pred finit v
</span><a href="#local-6989586621679397129"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Key]
</span><a href="#local-6989586621679397134"><span class="hs-identifier hs-var">fptrs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WithLifting bin pred finit v ()
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreDanglingRelocations"><span class="hs-identifier hs-var">exploreDanglingRelocations</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><span class="annottext">[Key]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-140"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; WithLifting bin pred finit v ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; WithLifting bin pred finit v ())
-&gt; IO () -&gt; WithLifting bin pred finit v ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Dangling function pointers found: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntSet -&gt; String
</span><a href="Base.html#showHex_set"><span class="hs-identifier hs-var">showHex_set</span></a></span><span> </span><span class="annot"><span class="annottext">(IntSet -&gt; String) -&gt; IntSet -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Key] -&gt; IntSet
</span><span class="hs-identifier hs-var">IS.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Key]
</span><a href="#local-6989586621679397134"><span class="hs-identifier hs-var">fptrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n\n&quot;</span></span><span>
</span><span id="line-141"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397140"><span class="annot"><span class="annottext">entries' :: Graph
</span><a href="#local-6989586621679397140"><span class="hs-identifier hs-var hs-var">entries'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntMap IntSet -&gt; Graph
</span><a href="Base.html#Edges"><span class="hs-identifier hs-var">Edges</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap IntSet -&gt; Graph) -&gt; IntMap IntSet -&gt; Graph
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Key, IntSet)] -&gt; IntMap IntSet
forall a. [(Key, a)] -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Key] -&gt; [IntSet] -&gt; [(Key, IntSet)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Key]
</span><a href="#local-6989586621679397134"><span class="hs-identifier hs-var">fptrs</span></a></span><span> </span><span class="annot"><span class="annottext">([IntSet] -&gt; [(Key, IntSet)]) -&gt; [IntSet] -&gt; [(Key, IntSet)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; [IntSet]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><span class="hs-identifier hs-var">IS.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397150"><span class="annot"><span class="annottext">finit :: finit
</span><a href="#local-6989586621679397150"><span class="hs-identifier hs-var hs-var">finit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v -&gt; finit
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Lifting bin pred finit v -&gt; finit
</span><a href="WithAbstractPredicates.Class.html#new_finit"><span class="hs-identifier hs-var">new_finit</span></a></span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397131"><span class="hs-identifier hs-var">static</span></a></span><span>
</span><span id="line-143"></span><span>      </span><span class="annot"><span class="annottext">(Key -&gt; WithLifting bin pred finit v ())
-&gt; [Key] -&gt; WithLifting bin pred finit v ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679397153"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397153"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(L0 pred finit v -&gt; L0 pred finit v)
-&gt; WithLifting bin pred finit v ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((L0 pred finit v -&gt; L0 pred finit v)
 -&gt; WithLifting bin pred finit v ())
-&gt; (L0 pred finit v -&gt; L0 pred finit v)
-&gt; WithLifting bin pred finit v ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; finit -&gt; L0 pred finit v -&gt; L0 pred finit v
forall {finit} {pred} {v}.
Key -&gt; finit -&gt; L0 pred finit v -&gt; L0 pred finit v
</span><a href="Data.L0.html#l0_insert_new_entry"><span class="hs-identifier hs-var">l0_insert_new_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397153"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">finit
</span><a href="#local-6989586621679397150"><span class="hs-identifier hs-var">finit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Key]
</span><a href="#local-6989586621679397134"><span class="hs-identifier hs-var">fptrs</span></a></span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><span class="annottext">Graph -&gt; IntMap IntSet -&gt; WithLifting bin pred finit v ()
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Graph -&gt; IntMap IntSet -&gt; WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreFunctionEntries"><span class="hs-identifier hs-var">exploreFunctionEntries</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397140"><span class="hs-identifier hs-var">entries'</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span>
</span><span id="line-145"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-146"></span><span>  </span><span id="local-6989586621679397136"><span class="annot"><span class="annottext">get_dangling_function_pointers :: IntMap a -&gt; (a, Maybe (FResult pred v)) -&gt; [Key]
</span><a href="#local-6989586621679397136"><span class="hs-identifier hs-var hs-var">get_dangling_function_pointers</span></a></span></span><span> </span><span id="local-6989586621679397155"><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621679397155"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (FResult pred v)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><a href="#local-6989586621679397136"><span class="hs-identifier hs-var">get_dangling_function_pointers</span></a></span><span> </span><span id="local-6989586621679397156"><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621679397156"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679397157"><span class="annot"><span class="annottext">FResult pred v
</span><a href="#local-6989586621679397157"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VerificationCondition v -&gt; [Key])
-&gt; [VerificationCondition v] -&gt; [Key]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap a -&gt; VerificationCondition v -&gt; [Key]
forall {a} {v}. IntMap a -&gt; VerificationCondition v -&gt; [Key]
</span><a href="#local-6989586621679397158"><span class="hs-identifier hs-var">mkDanglingFunctionPointers</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621679397156"><span class="hs-identifier hs-var">l0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([VerificationCondition v] -&gt; [Key])
-&gt; [VerificationCondition v] -&gt; [Key]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set (VerificationCondition v) -&gt; [VerificationCondition v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">S.toList</span></span><span> </span><span class="annot"><span class="annottext">(Set (VerificationCondition v) -&gt; [VerificationCondition v])
-&gt; Set (VerificationCondition v) -&gt; [VerificationCondition v]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FResult pred v -&gt; Set (VerificationCondition v)
forall pred v. FResult pred v -&gt; Set (VerificationCondition v)
</span><a href="Data.L0.html#result_vcs"><span class="hs-identifier hs-var">result_vcs</span></a></span><span> </span><span class="annot"><span class="annottext">FResult pred v
</span><a href="#local-6989586621679397157"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679397158"><span class="annot"><span class="annottext">mkDanglingFunctionPointers :: IntMap a -&gt; VerificationCondition v -&gt; [Key]
</span><a href="#local-6989586621679397158"><span class="hs-identifier hs-var hs-var">mkDanglingFunctionPointers</span></a></span></span><span> </span><span id="local-6989586621679397162"><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621679397162"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.VerificationCondition.html#FunctionPointers"><span class="hs-identifier hs-type">FunctionPointers</span></a></span><span> </span><span id="local-6989586621679397164"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397164"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679397165"><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679397165"><span class="hs-identifier hs-var">ptrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Key -&gt; [Key]) -&gt; [Key] -&gt; [Key]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap a -&gt; Key -&gt; [Key]
forall {a}. IntMap a -&gt; Key -&gt; [Key]
</span><a href="#local-6989586621679397166"><span class="hs-identifier hs-var">isDangling</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621679397162"><span class="hs-identifier hs-var">l0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Key] -&gt; [Key]) -&gt; [Key] -&gt; [Key]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; [Key]
</span><span class="hs-identifier hs-var">IS.toList</span></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679397165"><span class="hs-identifier hs-var">ptrs</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679397166"><span class="annot"><span class="annottext">isDangling :: IntMap a -&gt; Key -&gt; [Key]
</span><a href="#local-6989586621679397166"><span class="hs-identifier hs-var hs-var">isDangling</span></a></span></span><span> </span><span id="local-6989586621679397167"><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621679397167"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span id="local-6989586621679397168"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397168"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Key -&gt; IntMap a -&gt; Maybe a
forall a. Key -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397168"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621679397167"><span class="hs-identifier hs-var">l0</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-153"></span><span>      </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397168"><span class="hs-identifier hs-var">ptr</span></a></span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-154"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span id="local-6989586621679397170"><span id="local-6989586621679397171"><span id="local-6989586621679397172"><span id="local-6989586621679397173"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreDanglingRelocations"><span class="hs-identifier hs-type">exploreDanglingRelocations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractPredicates.Class.html#WithAbstractPredicates"><span class="hs-identifier hs-type">WithAbstractPredicates</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397170"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397171"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397172"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397173"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#WithLifting"><span class="hs-identifier hs-type">WithLifting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397170"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397171"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397172"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397173"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-158"></span><span id="exploreDanglingRelocations"><span class="annot"><span class="annottext">exploreDanglingRelocations :: forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreDanglingRelocations"><span class="hs-identifier hs-var hs-var">exploreDanglingRelocations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679397213"><span class="annot"><span class="annottext">bin
</span><a href="#local-6989586621679397213"><span class="hs-identifier hs-var">bin</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Config
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (L0 pred finit v) (ReaderT (bin, Config) IO) (bin, Config)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-160"></span><span>  </span><span id="local-6989586621679397215"><span class="annot"><span class="annottext">[Relocation]
</span><a href="#local-6989586621679397215"><span class="hs-identifier hs-var">relocs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Relocation
 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool)
-&gt; [Relocation]
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Relocation]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="annot"><span class="annottext">Relocation
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool
forall {a} {pred} {finit} {v}.
BinaryClass a =&gt;
Relocation
-&gt; StateT (L0 pred finit v) (ReaderT (a, Config) IO) Bool
</span><a href="#local-6989586621679397217"><span class="hs-identifier hs-var">is_dangling</span></a></span><span> </span><span class="annot"><span class="annottext">([Relocation]
 -&gt; StateT
      (L0 pred finit v) (ReaderT (bin, Config) IO) [Relocation])
-&gt; [Relocation]
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Relocation]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Relocation -&gt; [Relocation]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">S.toList</span></span><span> </span><span class="annot"><span class="annottext">(Set Relocation -&gt; [Relocation]) -&gt; Set Relocation -&gt; [Relocation]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">bin -&gt; Set Relocation
forall a. BinaryClass a =&gt; a -&gt; Set Relocation
</span><a href="Binary.Generic.html#binary_get_relocations"><span class="hs-identifier hs-var">binary_get_relocations</span></a></span><span> </span><span class="annot"><span class="annottext">bin
</span><a href="#local-6989586621679397213"><span class="hs-identifier hs-var">bin</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Relocation]
</span><a href="#local-6989586621679397215"><span class="hs-identifier hs-var">relocs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WithLifting bin pred finit v ()
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#finishExploration"><span class="hs-identifier hs-var">finishExploration</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><span class="annottext">[Relocation]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-164"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; WithLifting bin pred finit v ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; WithLifting bin pred finit v ())
-&gt; IO () -&gt; WithLifting bin pred finit v ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Dangling relocations found: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Relocation] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[Relocation]
</span><a href="#local-6989586621679397215"><span class="hs-identifier hs-var">relocs</span></a></span><span>
</span><span id="line-165"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397222"><span class="annot"><span class="annottext">fptrs :: [Key]
</span><a href="#local-6989586621679397222"><span class="hs-identifier hs-var hs-var">fptrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Relocation -&gt; Key) -&gt; [Relocation] -&gt; [Key]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Relocation -&gt; Key
forall {b}. Num b =&gt; Relocation -&gt; b
</span><a href="#local-6989586621679397223"><span class="hs-identifier hs-var">get_fptr</span></a></span><span> </span><span class="annot"><span class="annottext">[Relocation]
</span><a href="#local-6989586621679397215"><span class="hs-identifier hs-var">relocs</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397224"><span class="annot"><span class="annottext">entries' :: Graph
</span><a href="#local-6989586621679397224"><span class="hs-identifier hs-var hs-var">entries'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntMap IntSet -&gt; Graph
</span><a href="Base.html#Edges"><span class="hs-identifier hs-var">Edges</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap IntSet -&gt; Graph) -&gt; IntMap IntSet -&gt; Graph
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Key, IntSet)] -&gt; IntMap IntSet
forall a. [(Key, a)] -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Key] -&gt; [IntSet] -&gt; [(Key, IntSet)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Key]
</span><a href="#local-6989586621679397222"><span class="hs-identifier hs-var">fptrs</span></a></span><span> </span><span class="annot"><span class="annottext">([IntSet] -&gt; [(Key, IntSet)]) -&gt; [IntSet] -&gt; [(Key, IntSet)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; [IntSet]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><span class="hs-identifier hs-var">IS.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>      </span><span id="local-6989586621679397225"><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397225"><span class="hs-identifier hs-var">static</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WithLifting bin pred finit v (Lifting bin pred finit v)
forall bin pred finit v.
WithLifting bin pred finit v (Lifting bin pred finit v)
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#mk_static"><span class="hs-identifier hs-var">mk_static</span></a></span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397235"><span class="annot"><span class="annottext">finit :: finit
</span><a href="#local-6989586621679397235"><span class="hs-identifier hs-var hs-var">finit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v -&gt; finit
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Lifting bin pred finit v -&gt; finit
</span><a href="WithAbstractPredicates.Class.html#new_finit"><span class="hs-identifier hs-var">new_finit</span></a></span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397225"><span class="hs-identifier hs-var">static</span></a></span><span>
</span><span id="line-170"></span><span>      </span><span class="annot"><span class="annottext">(Key -&gt; WithLifting bin pred finit v ())
-&gt; [Key] -&gt; WithLifting bin pred finit v ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679397236"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397236"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(L0 pred finit v -&gt; L0 pred finit v)
-&gt; WithLifting bin pred finit v ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((L0 pred finit v -&gt; L0 pred finit v)
 -&gt; WithLifting bin pred finit v ())
-&gt; (L0 pred finit v -&gt; L0 pred finit v)
-&gt; WithLifting bin pred finit v ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; finit -&gt; L0 pred finit v -&gt; L0 pred finit v
forall {finit} {pred} {v}.
Key -&gt; finit -&gt; L0 pred finit v -&gt; L0 pred finit v
</span><a href="Data.L0.html#l0_insert_new_entry"><span class="hs-identifier hs-var">l0_insert_new_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397236"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">finit
</span><a href="#local-6989586621679397235"><span class="hs-identifier hs-var">finit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Key]
</span><a href="#local-6989586621679397222"><span class="hs-identifier hs-var">fptrs</span></a></span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><span class="annottext">Graph -&gt; IntMap IntSet -&gt; WithLifting bin pred finit v ()
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Graph -&gt; IntMap IntSet -&gt; WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreFunctionEntries"><span class="hs-identifier hs-var">exploreFunctionEntries</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397224"><span class="hs-identifier hs-var">entries'</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span>
</span><span id="line-172"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621679397223"><span class="annot"><span class="annottext">get_fptr :: Relocation -&gt; b
</span><a href="#local-6989586621679397223"><span class="hs-identifier hs-var hs-var">get_fptr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Binary.Generic.html#Relocation"><span class="hs-identifier hs-type">Relocation</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679397242"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397242"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; b
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397242"><span class="hs-identifier hs-var">a1</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621679397217"><span class="annot"><span class="annottext">is_dangling :: Relocation
-&gt; StateT (L0 pred finit v) (ReaderT (a, Config) IO) Bool
</span><a href="#local-6989586621679397217"><span class="hs-identifier hs-var hs-var">is_dangling</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Binary.Generic.html#Relocation"><span class="hs-identifier hs-type">Relocation</span></a></span><span> </span><span id="local-6989586621679397252"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397252"><span class="hs-identifier hs-var">a0</span></a></span></span><span> </span><span id="local-6989586621679397253"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397253"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679397254"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397254"><span class="hs-identifier hs-var">bin</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Config
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (L0 pred finit v) (ReaderT (a, Config) IO) (a, Config)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397256"><span class="annot"><span class="annottext">valid_entry :: Bool
</span><a href="#local-6989586621679397256"><span class="hs-identifier hs-var hs-var">valid_entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Word64 -&gt; Bool
forall bin. BinaryClass bin =&gt; bin -&gt; Word64 -&gt; Bool
</span><a href="Binary.Generic.html#address_has_instruction"><span class="hs-identifier hs-var">address_has_instruction</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397254"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397253"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621679397258"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679397258"><span class="hs-identifier hs-var">has_been_done</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
-&gt; Word64 -&gt; StateT (L0 pred finit v) (ReaderT (a, Config) IO) Bool
forall bin pred finit v.
IntMap IntSet -&gt; Word64 -&gt; WithLifting bin pred finit v Bool
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#entry_has_been_done"><span class="hs-identifier hs-var">entry_has_been_done</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397253"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-comment">-- TODO a0 within data section?</span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; StateT (L0 pred finit v) (ReaderT (a, Config) IO) Bool
forall a. a -&gt; StateT (L0 pred finit v) (ReaderT (a, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; StateT (L0 pred finit v) (ReaderT (a, Config) IO) Bool)
-&gt; Bool -&gt; StateT (L0 pred finit v) (ReaderT (a, Config) IO) Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679397256"><span class="hs-identifier hs-var">valid_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679397258"><span class="hs-identifier hs-var">has_been_done</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span id="local-6989586621679396658"><span id="local-6989586621679396659"><span id="local-6989586621679396660"><span id="local-6989586621679396661"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreFunctionEntry"><span class="hs-identifier hs-type">exploreFunctionEntry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractPredicates.Class.html#WithAbstractPredicates"><span class="hs-identifier hs-type">WithAbstractPredicates</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396658"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396659"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396660"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396661"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Base.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#Recursions"><span class="hs-identifier hs-type">Recursions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#WithLifting"><span class="hs-identifier hs-type">WithLifting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396658"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396659"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396660"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396661"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-184"></span><span id="exploreFunctionEntry"><span class="annot"><span class="annottext">exploreFunctionEntry :: forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Graph -&gt; IntMap IntSet -&gt; Word64 -&gt; WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreFunctionEntry"><span class="hs-identifier hs-var hs-var">exploreFunctionEntry</span></a></span></span><span> </span><span id="local-6989586621679397271"><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397271"><span class="hs-identifier hs-var">entries</span></a></span></span><span> </span><span id="local-6989586621679397272"><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397272"><span class="hs-identifier hs-var">recursions</span></a></span></span><span> </span><span id="local-6989586621679397273"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397273"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679397274"><span class="annot"><span class="annottext">bin
</span><a href="#local-6989586621679397274"><span class="hs-identifier hs-var">bin</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Config
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (L0 pred finit v) (ReaderT (bin, Config) IO) (bin, Config)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397276"><span class="annot"><span class="annottext">valid_entry :: Bool
</span><a href="#local-6989586621679397276"><span class="hs-identifier hs-var hs-var">valid_entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">bin -&gt; Word64 -&gt; Bool
forall bin. BinaryClass bin =&gt; bin -&gt; Word64 -&gt; Bool
</span><a href="Binary.Generic.html#address_has_instruction"><span class="hs-identifier hs-var">address_has_instruction</span></a></span><span> </span><span class="annot"><span class="annottext">bin
</span><a href="#local-6989586621679397274"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397273"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span id="local-6989586621679397277"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679397277"><span class="hs-identifier hs-var">has_been_done</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IntMap IntSet -&gt; Word64 -&gt; WithLifting bin pred finit v Bool
forall bin pred finit v.
IntMap IntSet -&gt; Word64 -&gt; WithLifting bin pred finit v Bool
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#entry_has_been_done"><span class="hs-identifier hs-var">entry_has_been_done</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397272"><span class="hs-identifier hs-var">recursions</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397273"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; WithLifting bin pred finit v ()
forall {bin} {pred} {finit} {v}.
WithAbstractPredicates bin pred finit v =&gt;
Bool
-&gt; Bool -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
</span><a href="#local-6989586621679397278"><span class="hs-identifier hs-var">explore</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679397277"><span class="hs-identifier hs-var">has_been_done</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679397276"><span class="hs-identifier hs-var">valid_entry</span></a></span><span> </span><span>
</span><span id="line-189"></span><span> </span><span class="hs-keyword">where</span><span> </span><span>
</span><span id="line-190"></span><span>  </span><span id="local-6989586621679397278"><span class="annot"><span class="annottext">explore :: Bool
-&gt; Bool -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
</span><a href="#local-6989586621679397278"><span class="hs-identifier hs-var hs-var">explore</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-comment">-- Entry is not within a text section of the binary, delete it and continue</span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n\nEntry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397273"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; ignored.&quot;</span></span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="annottext">(L0 pred finit v -&gt; L0 pred finit v)
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((L0 pred finit v -&gt; L0 pred finit v)
 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; (L0 pred finit v -&gt; L0 pred finit v)
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64
-&gt; Maybe (FResult pred v) -&gt; L0 pred finit v -&gt; L0 pred finit v
forall {a} {pred} {v} {finit}.
Integral a =&gt;
a -&gt; Maybe (FResult pred v) -&gt; L0 pred finit v -&gt; L0 pred finit v
</span><a href="Data.L0.html#l0_adjust_result"><span class="hs-identifier hs-var">l0_adjust_result</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397273"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FResult pred v -&gt; Maybe (FResult pred v)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FResult pred v
forall {pred} {v}. FResult pred v
</span><a href="Data.L0.html#empty_result"><span class="hs-identifier hs-var">empty_result</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397337"><span class="annot"><span class="annottext">entries' :: Graph
</span><a href="#local-6989586621679397337"><span class="hs-identifier hs-var hs-var">entries'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph -&gt; Key -&gt; Graph
</span><a href="Base.html#graph_delete"><span class="hs-identifier hs-var">graph_delete</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397271"><span class="hs-identifier hs-var">entries</span></a></span><span> </span><span class="annot"><span class="annottext">(Key -&gt; Graph) -&gt; Key -&gt; Graph
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Key
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397273"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="annottext">Graph
-&gt; IntMap IntSet
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Graph -&gt; IntMap IntSet -&gt; WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreFunctionEntries"><span class="hs-identifier hs-var">exploreFunctionEntries</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397337"><span class="hs-identifier hs-var">entries'</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397272"><span class="hs-identifier hs-var">recursions</span></a></span><span>    </span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><a href="#local-6989586621679397278"><span class="hs-identifier hs-var">explore</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-comment">-- Entry is already done, delete it and continue</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397341"><span class="annot"><span class="annottext">entries' :: Graph
</span><a href="#local-6989586621679397341"><span class="hs-identifier hs-var hs-var">entries'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph -&gt; Key -&gt; Graph
</span><a href="Base.html#graph_delete"><span class="hs-identifier hs-var">graph_delete</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397271"><span class="hs-identifier hs-var">entries</span></a></span><span> </span><span class="annot"><span class="annottext">(Key -&gt; Graph) -&gt; Key -&gt; Graph
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Key
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397273"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="annottext">Graph
-&gt; IntMap IntSet
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Graph -&gt; IntMap IntSet -&gt; WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreFunctionEntries"><span class="hs-identifier hs-var">exploreFunctionEntries</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397341"><span class="hs-identifier hs-var">entries'</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397272"><span class="hs-identifier hs-var">recursions</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><a href="#local-6989586621679397278"><span class="hs-identifier hs-var">explore</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-comment">-- Entry is to be explored</span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621679397342"><span class="annot"><span class="annottext">L0 pred finit v
</span><a href="#local-6989586621679397342"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT
  (L0 pred finit v) (ReaderT (bin, Config) IO) (L0 pred finit v)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n\nEntry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397273"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; (#entries explored/to be explored: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap (finit, Maybe (FResult pred v)) -&gt; Key
forall a. IntMap a -&gt; Key
</span><span class="hs-identifier hs-var">IM.size</span></span><span> </span><span class="annot"><span class="annottext">(IntMap (finit, Maybe (FResult pred v)) -&gt; Key)
-&gt; IntMap (finit, Maybe (FResult pred v)) -&gt; Key
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">L0 pred finit v -&gt; IntMap (finit, Maybe (FResult pred v))
forall pred finit v.
L0 pred finit v -&gt; IntMap (finit, Maybe (FResult pred v))
</span><a href="Data.L0.html#l0_functions"><span class="hs-identifier hs-var">l0_functions</span></a></span><span> </span><span class="annot"><span class="annottext">L0 pred finit v
</span><a href="#local-6989586621679397342"><span class="hs-identifier hs-var">l0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntSet -&gt; Key
</span><span class="hs-identifier hs-var">IS.size</span></span><span> </span><span class="annot"><span class="annottext">(IntSet -&gt; Key) -&gt; IntSet -&gt; Key
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Graph -&gt; IntSet
forall g. IntGraph g =&gt; g -&gt; IntSet
</span><a href="Base.html#intgraph_V"><span class="hs-identifier hs-var">intgraph_V</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397271"><span class="hs-identifier hs-var">entries</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-205"></span><span>    </span><span id="local-6989586621679397346"><span class="annot"><span class="annottext">AnalysisResult pred finit v
</span><a href="#local-6989586621679397346"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word64
-&gt; WithLifting bin pred finit v (AnalysisResult pred finit v)
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Word64
-&gt; WithLifting bin pred finit v (AnalysisResult pred finit v)
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#analyze_entry"><span class="hs-identifier hs-var">analyze_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397273"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AnalysisResult pred finit v
</span><a href="#local-6989586621679397346"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-207"></span><span>      </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#FoundNewCalls"><span class="hs-identifier hs-type">FoundNewCalls</span></a></span><span> </span><span id="local-6989586621679397348"><span class="annot"><span class="annottext">IntMap finit
</span><a href="#local-6989586621679397348"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-208"></span><span>        </span><span class="hs-comment">-- Found calls to unexplored functions, or functions called with a new FInit</span><span>
</span><span id="line-209"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397349"><span class="annot"><span class="annottext">new_calls :: [(Key, finit)]
</span><a href="#local-6989586621679397349"><span class="hs-identifier hs-var hs-var">new_calls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntMap finit -&gt; [(Key, finit)]
forall a. IntMap a -&gt; [(Key, a)]
</span><span class="hs-identifier hs-var">IM.toList</span></span><span> </span><span class="annot"><span class="annottext">IntMap finit
</span><a href="#local-6989586621679397348"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-210"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397354"><span class="annot"><span class="annottext">entries' :: Graph
</span><a href="#local-6989586621679397354"><span class="hs-identifier hs-var hs-var">entries'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Key, finit) -&gt; Graph -&gt; Graph)
-&gt; Graph -&gt; [(Key, finit)] -&gt; Graph
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679397355"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397355"><span class="hs-identifier hs-var">trgt</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679397356"><span class="annot"><span class="annottext">finit
</span><a href="#local-6989586621679397356"><span class="hs-identifier hs-var">finit</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679397357"><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397357"><span class="hs-identifier hs-var">entries</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Graph -&gt; Key -&gt; IntSet -&gt; Graph
</span><a href="Base.html#graph_add_edges"><span class="hs-identifier hs-var">graph_add_edges</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397357"><span class="hs-identifier hs-var">entries</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Key
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397273"><span class="hs-identifier hs-var">entry</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; IntSet
</span><span class="hs-identifier hs-var">IS.singleton</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397355"><span class="hs-identifier hs-var">trgt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397271"><span class="hs-identifier hs-var">entries</span></a></span><span> </span><span class="annot"><span class="annottext">[(Key, finit)]
</span><a href="#local-6989586621679397349"><span class="hs-identifier hs-var">new_calls</span></a></span><span>
</span><span id="line-211"></span><span>        </span><span class="annot"><span class="annottext">((Key, finit)
 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; [(Key, finit)]
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679397359"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397359"><span class="hs-identifier hs-var">trgt</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679397360"><span class="annot"><span class="annottext">finit
</span><a href="#local-6989586621679397360"><span class="hs-identifier hs-var">finit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(L0 pred finit v -&gt; L0 pred finit v)
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((L0 pred finit v -&gt; L0 pred finit v)
 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; (L0 pred finit v -&gt; L0 pred finit v)
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; finit -&gt; L0 pred finit v -&gt; L0 pred finit v
forall {finit} {pred} {v}.
Key -&gt; finit -&gt; L0 pred finit v -&gt; L0 pred finit v
</span><a href="Data.L0.html#l0_insert_new_entry"><span class="hs-identifier hs-var">l0_insert_new_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397359"><span class="hs-identifier hs-var">trgt</span></a></span><span> </span><span class="annot"><span class="annottext">finit
</span><a href="#local-6989586621679397360"><span class="hs-identifier hs-var">finit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Key, finit)]
</span><a href="#local-6989586621679397349"><span class="hs-identifier hs-var">new_calls</span></a></span><span>
</span><span id="line-212"></span><span>        </span><span class="annot"><span class="annottext">Graph
-&gt; IntMap IntSet
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Graph -&gt; IntMap IntSet -&gt; WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreFunctionEntries"><span class="hs-identifier hs-var">exploreFunctionEntries</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397354"><span class="hs-identifier hs-var">entries'</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397272"><span class="hs-identifier hs-var">recursions</span></a></span><span>
</span><span id="line-213"></span><span>      </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#AnalyzedWithResult"><span class="hs-identifier hs-type">AnalyzedWithResult</span></a></span><span> </span><span id="local-6989586621679397361"><span class="annot"><span class="annottext">FResult pred v
</span><a href="#local-6989586621679397361"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-214"></span><span>        </span><span class="hs-comment">-- Finished analysis of the function entry</span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><span class="annottext">(L0 pred finit v -&gt; L0 pred finit v)
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((L0 pred finit v -&gt; L0 pred finit v)
 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; (L0 pred finit v -&gt; L0 pred finit v)
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64
-&gt; Maybe (FResult pred v) -&gt; L0 pred finit v -&gt; L0 pred finit v
forall {a} {pred} {v} {finit}.
Integral a =&gt;
a -&gt; Maybe (FResult pred v) -&gt; L0 pred finit v -&gt; L0 pred finit v
</span><a href="Data.L0.html#l0_adjust_result"><span class="hs-identifier hs-var">l0_adjust_result</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397273"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FResult pred v -&gt; Maybe (FResult pred v)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FResult pred v
</span><a href="#local-6989586621679397361"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-216"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397364"><span class="annot"><span class="annottext">entries' :: Graph
</span><a href="#local-6989586621679397364"><span class="hs-identifier hs-var hs-var">entries'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph -&gt; Key -&gt; Graph
</span><a href="Base.html#graph_delete"><span class="hs-identifier hs-var">graph_delete</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397271"><span class="hs-identifier hs-var">entries</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Key
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397273"><span class="hs-identifier hs-var">entry</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>        </span><span id="local-6989586621679397365"><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397365"><span class="hs-identifier hs-var">recursions'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word64
-&gt; FResult pred v
-&gt; IntMap IntSet
-&gt; WithLifting bin pred finit v (IntMap IntSet)
forall pred v bin finit.
Word64
-&gt; FResult pred v
-&gt; IntMap IntSet
-&gt; WithLifting bin pred finit v (IntMap IntSet)
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#mark_mutual_recursive_calls"><span class="hs-identifier hs-var">mark_mutual_recursive_calls</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397273"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">FResult pred v
</span><a href="#local-6989586621679397361"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397272"><span class="hs-identifier hs-var">recursions</span></a></span><span>
</span><span id="line-218"></span><span>        </span><span class="annot"><span class="annottext">FResult pred v
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall {bin} {pred} {finit} {v} {pred} {v}.
(WithAbstractPredicates bin pred finit v, Show pred, Show v) =&gt;
FResult pred v
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
</span><a href="#local-6989586621679397367"><span class="hs-identifier hs-var">report_result</span></a></span><span> </span><span class="annot"><span class="annottext">FResult pred v
</span><a href="#local-6989586621679397361"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><span class="annottext">Graph
-&gt; IntMap IntSet
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Graph -&gt; IntMap IntSet -&gt; WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#exploreFunctionEntries"><span class="hs-identifier hs-var">exploreFunctionEntries</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679397364"><span class="hs-identifier hs-var">entries'</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397365"><span class="hs-identifier hs-var">recursions'</span></a></span><span>
</span><span id="line-220"></span><span>       </span><span>
</span><span id="line-221"></span><span>  </span><span id="local-6989586621679397367"><span class="annot"><span class="annottext">report_result :: FResult pred v
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
</span><a href="#local-6989586621679397367"><span class="hs-identifier hs-var hs-var">report_result</span></a></span></span><span> </span><span id="local-6989586621679397420"><span class="annot"><span class="annottext">FResult pred v
</span><a href="#local-6989586621679397420"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397273"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; lifted.&quot;</span></span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397421"><span class="annot"><span class="annottext">finit
</span><a href="#local-6989586621679397421"><span class="hs-identifier hs-var">finit</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (FResult pred v)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v)))
-&gt; StateT
     (L0 pred finit v)
     (ReaderT (bin, Config) IO)
     (Maybe (finit, Maybe (FResult pred v)))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v)))
 -&gt; StateT
      (L0 pred finit v)
      (ReaderT (bin, Config) IO)
      (Maybe (finit, Maybe (FResult pred v))))
-&gt; (L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v)))
-&gt; StateT
     (L0 pred finit v)
     (ReaderT (bin, Config) IO)
     (Maybe (finit, Maybe (FResult pred v)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v))
forall {a} {pred} {finit} {v}.
Integral a =&gt;
a -&gt; L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v))
</span><a href="Data.L0.html#l0_lookup_entry"><span class="hs-identifier hs-var">l0_lookup_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397273"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span id="local-6989586621679397424"><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397424"><span class="hs-identifier hs-var">static</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WithLifting bin pred finit v (Lifting bin pred finit v)
forall bin pred finit v.
WithLifting bin pred finit v (Lifting bin pred finit v)
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#mk_static"><span class="hs-identifier hs-var">mk_static</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397434"><span class="annot"><span class="annottext">empty_finit :: finit
</span><a href="#local-6989586621679397434"><span class="hs-identifier hs-var hs-var">empty_finit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v -&gt; finit
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Lifting bin pred finit v -&gt; finit
</span><a href="WithAbstractPredicates.Class.html#new_finit"><span class="hs-identifier hs-var">new_finit</span></a></span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397424"><span class="hs-identifier hs-var">static</span></a></span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">finit
</span><a href="#local-6989586621679397421"><span class="hs-identifier hs-var">finit</span></a></span><span> </span><span class="annot"><span class="annottext">finit -&gt; finit -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">finit
</span><a href="#local-6989586621679397434"><span class="hs-identifier hs-var">empty_finit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-227"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Function precondition:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v -&gt; finit -&gt; String
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Lifting bin pred finit v -&gt; finit -&gt; String
</span><a href="WithAbstractPredicates.Class.html#pp_finit"><span class="hs-identifier hs-var">pp_finit</span></a></span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397424"><span class="hs-identifier hs-var">static</span></a></span><span> </span><span class="annot"><span class="annottext">finit
</span><a href="#local-6989586621679397421"><span class="hs-identifier hs-var">finit</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Function postcondition: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Postcondition pred -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Postcondition pred -&gt; String) -&gt; Postcondition pred -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FResult pred v -&gt; Postcondition pred
forall pred v. FResult pred v -&gt; Postcondition pred
</span><a href="Data.L0.html#result_post"><span class="hs-identifier hs-var">result_post</span></a></span><span> </span><span class="annot"><span class="annottext">FResult pred v
</span><a href="#local-6989586621679397420"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(VerificationCondition v -&gt; String)
-&gt; [VerificationCondition v] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">VerificationCondition v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">([VerificationCondition v] -&gt; [String])
-&gt; [VerificationCondition v] -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set (VerificationCondition v) -&gt; [VerificationCondition v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">S.toList</span></span><span> </span><span class="annot"><span class="annottext">(Set (VerificationCondition v) -&gt; [VerificationCondition v])
-&gt; Set (VerificationCondition v) -&gt; [VerificationCondition v]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FResult pred v -&gt; Set (VerificationCondition v)
forall pred v. FResult pred v -&gt; Set (VerificationCondition v)
</span><a href="Data.L0.html#result_vcs"><span class="hs-identifier hs-var">result_vcs</span></a></span><span> </span><span class="annot"><span class="annottext">FResult pred v
</span><a href="#local-6989586621679397420"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span id="local-6989586621679396735"><span id="local-6989586621679396736"><span id="local-6989586621679396737"><span id="local-6989586621679396738"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#entry_has_been_done"><span class="hs-identifier hs-type">entry_has_been_done</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#Recursions"><span class="hs-identifier hs-type">Recursions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#WithLifting"><span class="hs-identifier hs-type">WithLifting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396735"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396736"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396737"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396738"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span><span>
</span><span id="line-232"></span><span id="entry_has_been_done"><span class="annot"><span class="annottext">entry_has_been_done :: forall bin pred finit v.
IntMap IntSet -&gt; Word64 -&gt; WithLifting bin pred finit v Bool
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#entry_has_been_done"><span class="hs-identifier hs-var hs-var">entry_has_been_done</span></a></span></span><span> </span><span id="local-6989586621679397449"><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397449"><span class="hs-identifier hs-var">recursions</span></a></span></span><span> </span><span id="local-6989586621679397450"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397450"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-233"></span><span>  </span><span id="local-6989586621679397451"><span class="annot"><span class="annottext">Maybe (finit, Maybe (FResult pred v))
</span><a href="#local-6989586621679397451"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v)))
-&gt; StateT
     (L0 pred finit v)
     (ReaderT (bin, Config) IO)
     (Maybe (finit, Maybe (FResult pred v)))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v)))
 -&gt; StateT
      (L0 pred finit v)
      (ReaderT (bin, Config) IO)
      (Maybe (finit, Maybe (FResult pred v))))
-&gt; (L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v)))
-&gt; StateT
     (L0 pred finit v)
     (ReaderT (bin, Config) IO)
     (Maybe (finit, Maybe (FResult pred v)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v))
forall {a} {pred} {finit} {v}.
Integral a =&gt;
a -&gt; L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v))
</span><a href="Data.L0.html#l0_lookup_entry"><span class="hs-identifier hs-var">l0_lookup_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397450"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (finit, Maybe (FResult pred v))
</span><a href="#local-6989586621679397451"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-235"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">finit
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FResult pred v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; WithLifting bin pred finit v Bool
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; WithLifting bin pred finit v Bool)
-&gt; Bool -&gt; WithLifting bin pred finit v Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Key
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397450"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; IntMap IntSet -&gt; Bool
forall a. Key -&gt; IntMap a -&gt; Bool
</span><span class="hs-operator hs-var">`IM.member`</span></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397449"><span class="hs-identifier hs-var">recursions</span></a></span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><span class="annottext">Maybe (finit, Maybe (FResult pred v))
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; WithLifting bin pred finit v Bool
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; WithLifting bin pred finit v Bool)
-&gt; Bool -&gt; WithLifting bin pred finit v Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span id="local-6989586621679396645"><span id="local-6989586621679396646"><span id="local-6989586621679396647"><span id="local-6989586621679396648"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#reconsider_mutual_recursive_call"><span class="hs-identifier hs-type">reconsider_mutual_recursive_call</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#Recursions"><span class="hs-identifier hs-type">Recursions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#WithLifting"><span class="hs-identifier hs-type">WithLifting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396645"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396646"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396647"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396648"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">IS.IntSet</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-241"></span><span id="reconsider_mutual_recursive_call"><span class="annot"><span class="annottext">reconsider_mutual_recursive_call :: forall bin pred finit v.
IntMap IntSet -&gt; WithLifting bin pred finit v (Maybe (Key, IntSet))
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#reconsider_mutual_recursive_call"><span class="hs-identifier hs-var hs-var">reconsider_mutual_recursive_call</span></a></span></span><span> </span><span id="local-6989586621679397456"><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397456"><span class="hs-identifier hs-var">recursions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Key, IntSet)
 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool)
-&gt; [(Key, IntSet)]
-&gt; StateT
     (L0 pred finit v) (ReaderT (bin, Config) IO) (Maybe (Key, IntSet))
forall (m :: * -&gt; *) a.
Monad m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">findM</span></span><span> </span><span class="annot"><span class="annottext">(Key, IntSet)
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool
forall {a} {pred} {finit} {v} {bin}.
(a, IntSet)
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool
</span><a href="#local-6989586621679397458"><span class="hs-identifier hs-var">to_be_reconsidered</span></a></span><span> </span><span class="annot"><span class="annottext">([(Key, IntSet)]
 -&gt; StateT
      (L0 pred finit v) (ReaderT (bin, Config) IO) (Maybe (Key, IntSet)))
-&gt; [(Key, IntSet)]
-&gt; StateT
     (L0 pred finit v) (ReaderT (bin, Config) IO) (Maybe (Key, IntSet))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet -&gt; [(Key, IntSet)]
forall a. IntMap a -&gt; [(Key, a)]
</span><span class="hs-identifier hs-var">IM.toList</span></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397456"><span class="hs-identifier hs-var">recursions</span></a></span><span>
</span><span id="line-242"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>  </span><span id="local-6989586621679397458"><span class="annot"><span class="annottext">to_be_reconsidered :: (a, IntSet)
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool
</span><a href="#local-6989586621679397458"><span class="hs-identifier hs-var hs-var">to_be_reconsidered</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397464"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397464"><span class="hs-identifier hs-var">entry</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679397465"><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679397465"><span class="hs-identifier hs-var">trgts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word64
 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool)
-&gt; [Word64]
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool
forall (m :: * -&gt; *) a. Monad m =&gt; (a -&gt; m Bool) -&gt; [a] -&gt; m Bool
</span><span class="hs-identifier hs-var">allM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap IntSet
-&gt; Word64
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool
forall bin pred finit v.
IntMap IntSet -&gt; Word64 -&gt; WithLifting bin pred finit v Bool
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#entry_has_been_done"><span class="hs-identifier hs-var">entry_has_been_done</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397456"><span class="hs-identifier hs-var">recursions</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Word64]
 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool)
-&gt; [Word64]
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Key -&gt; Word64) -&gt; [Key] -&gt; [Word64]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">([Key] -&gt; [Word64]) -&gt; [Key] -&gt; [Word64]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; [Key]
</span><span class="hs-identifier hs-var">IS.toList</span></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679397465"><span class="hs-identifier hs-var">trgts</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">-- If an entry has an FInit but no FResult, this means that it has been visited but not analyzed yet.</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- Calls to those functions indicate recursion. It is stored that the current entry did a recursive call to those functions,</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- so that it can be reconsidered later.</span><span>
</span><span id="line-249"></span><span id="local-6989586621679396758"><span id="local-6989586621679396759"><span id="local-6989586621679396760"><span id="local-6989586621679396761"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#mark_mutual_recursive_calls"><span class="hs-identifier hs-type">mark_mutual_recursive_calls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.L0.html#FResult"><span class="hs-identifier hs-type">FResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396758"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396759"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#Recursions"><span class="hs-identifier hs-type">Recursions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#WithLifting"><span class="hs-identifier hs-type">WithLifting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396760"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396758"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396761"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396759"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#Recursions"><span class="hs-identifier hs-type">Recursions</span></a></span></span></span></span></span><span>
</span><span id="line-250"></span><span id="mark_mutual_recursive_calls"><span class="annot"><span class="annottext">mark_mutual_recursive_calls :: forall pred v bin finit.
Word64
-&gt; FResult pred v
-&gt; IntMap IntSet
-&gt; WithLifting bin pred finit v (IntMap IntSet)
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#mark_mutual_recursive_calls"><span class="hs-identifier hs-var hs-var">mark_mutual_recursive_calls</span></a></span></span><span> </span><span id="local-6989586621679397486"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397486"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span id="local-6989586621679397487"><span class="annot"><span class="annottext">FResult pred v
</span><a href="#local-6989586621679397487"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span id="local-6989586621679397488"><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397488"><span class="hs-identifier hs-var">recursions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-251"></span><span>  </span><span id="local-6989586621679397489"><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679397489"><span class="hs-identifier hs-var">new_recursions</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Key] -&gt; IntSet
</span><span class="hs-identifier hs-var">IS.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Key] -&gt; IntSet) -&gt; ([Word64] -&gt; [Key]) -&gt; [Word64] -&gt; IntSet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Key) -&gt; [Word64] -&gt; [Key]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Key
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">([Word64] -&gt; IntSet)
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Word64]
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) IntSet
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word64
 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool)
-&gt; [Word64]
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Word64]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool
forall bin pred finit v.
Word64 -&gt; WithLifting bin pred finit v Bool
</span><a href="#local-6989586621679397491"><span class="hs-identifier hs-var">is_recursive</span></a></span><span> </span><span class="annot"><span class="annottext">([Word64]
 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Word64])
-&gt; [Word64]
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Word64]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Word64 -&gt; [Word64]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">S.toList</span></span><span> </span><span class="annot"><span class="annottext">(Set Word64 -&gt; [Word64]) -&gt; Set Word64 -&gt; [Word64]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FResult pred v -&gt; Set Word64
forall pred v. FResult pred v -&gt; Set Word64
</span><a href="Data.L0.html#result_calls"><span class="hs-identifier hs-var">result_calls</span></a></span><span> </span><span class="annot"><span class="annottext">FResult pred v
</span><a href="#local-6989586621679397487"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; Bool
</span><span class="hs-identifier hs-var">IS.null</span></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679397489"><span class="hs-identifier hs-var">new_recursions</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><span class="annottext">IntMap IntSet -&gt; WithLifting bin pred finit v (IntMap IntSet)
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397488"><span class="hs-identifier hs-var">recursions</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397486"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; is part of mutual recursion and treated entries &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; String
</span><a href="Base.html#showHex_set"><span class="hs-identifier hs-var">showHex_set</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679397489"><span class="hs-identifier hs-var">new_recursions</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; as external. It will be reconsidered after those entries have been done.&quot;</span></span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><span class="annottext">IntMap IntSet -&gt; WithLifting bin pred finit v (IntMap IntSet)
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(IntMap IntSet -&gt; WithLifting bin pred finit v (IntMap IntSet))
-&gt; IntMap IntSet -&gt; WithLifting bin pred finit v (IntMap IntSet)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(IntSet -&gt; IntSet -&gt; IntSet)
-&gt; Key -&gt; IntSet -&gt; IntMap IntSet -&gt; IntMap IntSet
forall a. (a -&gt; a -&gt; a) -&gt; Key -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insertWith</span></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; IntSet -&gt; IntSet
</span><span class="hs-identifier hs-var">IS.union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Key
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397486"><span class="hs-identifier hs-var">entry</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679397489"><span class="hs-identifier hs-var">new_recursions</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397488"><span class="hs-identifier hs-var">recursions</span></a></span><span>
</span><span id="line-257"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-258"></span><span>  </span><span id="local-6989586621679396814"><span id="local-6989586621679396815"><span id="local-6989586621679396816"><span id="local-6989586621679396817"><span class="annot"><a href="#local-6989586621679397491"><span class="hs-identifier hs-type">is_recursive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#WithLifting"><span class="hs-identifier hs-type">WithLifting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396814"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396815"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396816"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396817"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621679397491"><span class="annot"><span class="annottext">is_recursive :: forall bin pred finit v.
Word64 -&gt; WithLifting bin pred finit v Bool
</span><a href="#local-6989586621679397491"><span class="hs-identifier hs-var hs-var">is_recursive</span></a></span></span><span> </span><span id="local-6989586621679397504"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397504"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621679397505"><span class="annot"><span class="annottext">Maybe (finit, Maybe (FResult pred v))
</span><a href="#local-6989586621679397505"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v)))
-&gt; StateT
     (L0 pred finit v)
     (ReaderT (bin, Config) IO)
     (Maybe (finit, Maybe (FResult pred v)))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v)))
 -&gt; StateT
      (L0 pred finit v)
      (ReaderT (bin, Config) IO)
      (Maybe (finit, Maybe (FResult pred v))))
-&gt; (L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v)))
-&gt; StateT
     (L0 pred finit v)
     (ReaderT (bin, Config) IO)
     (Maybe (finit, Maybe (FResult pred v)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v))
forall {a} {pred} {finit} {v}.
Integral a =&gt;
a -&gt; L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v))
</span><a href="Data.L0.html#l0_lookup_entry"><span class="hs-identifier hs-var">l0_lookup_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397504"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (finit, Maybe (FResult pred v))
</span><a href="#local-6989586621679397505"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">finit
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (FResult pred v)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; WithLifting bin pred finit v Bool
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; WithLifting bin pred finit v Bool)
-&gt; Bool -&gt; WithLifting bin pred finit v Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><span class="annottext">Maybe (finit, Maybe (FResult pred v))
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; WithLifting bin pred finit v Bool
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; WithLifting bin pred finit v Bool)
-&gt; Bool -&gt; WithLifting bin pred finit v Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Key
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397504"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; IntMap IntSet -&gt; Bool
forall a. Key -&gt; IntMap a -&gt; Bool
</span><span class="hs-operator hs-var">`IM.member`</span></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679397488"><span class="hs-identifier hs-var">recursions</span></a></span><span> </span><span class="hs-comment">-- False</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span id="local-6989586621679396681"><span id="local-6989586621679396682"><span id="local-6989586621679396683"><span id="local-6989586621679396684"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#mk_static"><span class="hs-identifier hs-type">mk_static</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#WithLifting"><span class="hs-identifier hs-type">WithLifting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396681"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396682"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396683"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396684"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.L0.html#Lifting"><span class="hs-identifier hs-type">Lifting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396681"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396682"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396683"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396684"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-268"></span><span id="mk_static"><span class="annot"><span class="annottext">mk_static :: forall bin pred finit v.
WithLifting bin pred finit v (Lifting bin pred finit v)
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#mk_static"><span class="hs-identifier hs-var hs-var">mk_static</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621679397514"><span class="annot"><span class="annottext">L0 pred finit v
</span><a href="#local-6989586621679397514"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT
  (L0 pred finit v) (ReaderT (bin, Config) IO) (L0 pred finit v)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679397515"><span class="annot"><span class="annottext">bin
</span><a href="#local-6989586621679397515"><span class="hs-identifier hs-var">bin</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679397516"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679397516"><span class="hs-identifier hs-var">config</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (L0 pred finit v) (ReaderT (bin, Config) IO) (bin, Config)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><span class="annottext">Lifting bin pred finit v
-&gt; WithLifting bin pred finit v (Lifting bin pred finit v)
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">bin
</span><a href="#local-6989586621679397515"><span class="hs-identifier hs-var">bin</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679397516"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">L0 pred finit v
</span><a href="#local-6989586621679397514"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span id="local-6989586621679396753"><span id="local-6989586621679396754"><span id="local-6989586621679396755"><span id="local-6989586621679396756"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#analyze_entry"><span class="hs-identifier hs-type">analyze_entry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractPredicates.Class.html#WithAbstractPredicates"><span class="hs-identifier hs-type">WithAbstractPredicates</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396753"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396754"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396755"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396756"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#WithLifting"><span class="hs-identifier hs-type">WithLifting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396753"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396754"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396755"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396756"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#AnalysisResult"><span class="hs-identifier hs-type">AnalysisResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396754"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396755"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396756"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-274"></span><span id="analyze_entry"><span class="annot"><span class="annottext">analyze_entry :: forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Word64
-&gt; WithLifting bin pred finit v (AnalysisResult pred finit v)
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#analyze_entry"><span class="hs-identifier hs-var hs-var">analyze_entry</span></a></span></span><span> </span><span id="local-6989586621679397591"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397592"><span class="annot"><span class="annottext">finit
</span><a href="#local-6989586621679397592"><span class="hs-identifier hs-var">finit</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (FResult pred v)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v)))
-&gt; StateT
     (L0 pred finit v)
     (ReaderT (bin, Config) IO)
     (Maybe (finit, Maybe (FResult pred v)))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v)))
 -&gt; StateT
      (L0 pred finit v)
      (ReaderT (bin, Config) IO)
      (Maybe (finit, Maybe (FResult pred v))))
-&gt; (L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v)))
-&gt; StateT
     (L0 pred finit v)
     (ReaderT (bin, Config) IO)
     (Maybe (finit, Maybe (FResult pred v)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v))
forall {a} {pred} {finit} {v}.
Integral a =&gt;
a -&gt; L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v))
</span><a href="Data.L0.html#l0_lookup_entry"><span class="hs-identifier hs-var">l0_lookup_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span>  </span><span id="local-6989586621679397593"><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397593"><span class="hs-identifier hs-var">static</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WithLifting bin pred finit v (Lifting bin pred finit v)
forall bin pred finit v.
WithLifting bin pred finit v (Lifting bin pred finit v)
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#mk_static"><span class="hs-identifier hs-var">mk_static</span></a></span><span> </span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: starting CFG generation.&quot;</span></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679397603"><span class="annot"><span class="annottext">cfg :: CFG
</span><a href="#local-6989586621679397603"><span class="hs-identifier hs-var hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v -&gt; Word64 -&gt; CFG
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Lifting bin pred finit v -&gt; Word64 -&gt; CFG
</span><a href="WithAbstractPredicates.GenerateCFG.html#generate_cfg"><span class="hs-identifier hs-var">generate_cfg</span></a></span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397593"><span class="hs-identifier hs-var">static</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: CFG generation done: #basic blocks = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [Instruction] -&gt; Key
forall a. IntMap a -&gt; Key
</span><span class="hs-identifier hs-var">IM.size</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [Instruction] -&gt; Key) -&gt; IntMap [Instruction] -&gt; Key
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CFG -&gt; IntMap [Instruction]
</span><a href="Data.CFG.html#cfg_instrs"><span class="hs-identifier hs-var">cfg_instrs</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679397603"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, #instructions = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CFG -&gt; Key
</span><a href="Data.CFG.html#num_of_instructions"><span class="hs-identifier hs-var">num_of_instructions</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679397603"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: starting invariant generation.&quot;</span></span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679397616"><span class="annot"><span class="annottext">IntMap pred
</span><a href="#local-6989586621679397616"><span class="hs-identifier hs-var">invs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679397617"><span class="annot"><span class="annottext">VCS v
</span><a href="#local-6989586621679397617"><span class="hs-identifier hs-var">vcs</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LiftingEntry bin pred finit v
-&gt; CFG -&gt; finit -&gt; (IntMap pred, VCS v)
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
LiftingEntry bin pred finit v
-&gt; CFG -&gt; finit -&gt; (IntMap pred, VCS v)
</span><a href="WithAbstractPredicates.GenerateInvariants.html#generate_invariants"><span class="hs-identifier hs-var">generate_invariants</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Lifting bin pred finit v -&gt; LiftingEntry bin pred finit v
forall {d} {a} {b} {c}. d -&gt; (a, b, c) -&gt; (a, b, c, d)
</span><a href="WithAbstractPredicates.GenerateInvariants.html#withEntry"><span class="hs-identifier hs-var">withEntry</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397593"><span class="hs-identifier hs-var">static</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679397603"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">finit
</span><a href="#local-6989586621679397592"><span class="hs-identifier hs-var">finit</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621679397620"><span class="annot"><span class="annottext">[(Key, finit)]
</span><a href="#local-6989586621679397620"><span class="hs-identifier hs-var">new_calls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lifting bin pred finit v -&gt; [(Key, finit)] -&gt; [(Key, finit)]
forall {bin} {pred} {b} {v} {a}.
(WithAbstractPredicates bin pred b v, Integral a) =&gt;
(bin, Config, L0 pred b v) -&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="#local-6989586621679397621"><span class="hs-identifier hs-var">join_duplicate_new_calls</span></a></span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397593"><span class="hs-identifier hs-var">static</span></a></span><span> </span><span class="annot"><span class="annottext">([(Key, finit)] -&gt; [(Key, finit)])
-&gt; ([Maybe (Key, finit)] -&gt; [(Key, finit)])
-&gt; [Maybe (Key, finit)]
-&gt; [(Key, finit)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (Key, finit)] -&gt; [(Key, finit)]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Maybe (Key, finit)] -&gt; [(Key, finit)])
-&gt; StateT
     (L0 pred finit v) (ReaderT (bin, Config) IO) [Maybe (Key, finit)]
-&gt; StateT
     (L0 pred finit v) (ReaderT (bin, Config) IO) [(Key, finit)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Key, [Instruction])
 -&gt; StateT
      (L0 pred finit v) (ReaderT (bin, Config) IO) [Maybe (Key, finit)])
-&gt; [(Key, [Instruction])]
-&gt; StateT
     (L0 pred finit v) (ReaderT (bin, Config) IO) [Maybe (Key, finit)]
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m [b]) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">concatMapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap pred
-&gt; (Key, [Instruction])
-&gt; StateT
     (L0 pred finit v) (ReaderT (bin, Config) IO) [Maybe (Key, finit)]
forall {a} {bin} {pred} {finit} {v}.
(Num a, WithAbstractPredicates bin pred finit v) =&gt;
IntMap pred
-&gt; (Key, [Instruction])
-&gt; StateT
     (L0 pred finit v) (ReaderT (bin, Config) IO) [Maybe (a, finit)]
</span><a href="#local-6989586621679397624"><span class="hs-identifier hs-var">get_new_calls</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap pred
</span><a href="#local-6989586621679397616"><span class="hs-identifier hs-var">invs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Key, [Instruction])]
 -&gt; StateT
      (L0 pred finit v) (ReaderT (bin, Config) IO) [Maybe (Key, finit)])
-&gt; [(Key, [Instruction])]
-&gt; StateT
     (L0 pred finit v) (ReaderT (bin, Config) IO) [Maybe (Key, finit)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap [Instruction] -&gt; [(Key, [Instruction])]
forall a. IntMap a -&gt; [(Key, a)]
</span><span class="hs-identifier hs-var">IM.assocs</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [Instruction] -&gt; [(Key, [Instruction])])
-&gt; IntMap [Instruction] -&gt; [(Key, [Instruction])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CFG -&gt; IntMap [Instruction]
</span><a href="Data.CFG.html#cfg_instrs"><span class="hs-identifier hs-var">cfg_instrs</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679397603"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[(Key, finit)]
</span><a href="#local-6989586621679397620"><span class="hs-identifier hs-var">new_calls</span></a></span><span> </span><span class="annot"><span class="annottext">[(Key, finit)] -&gt; [(Key, finit)] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: Adding new internal functions at &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Key] -&gt; String
forall {a}. Integral a =&gt; [a] -&gt; String
</span><a href="Base.html#showHex_list"><span class="hs-identifier hs-var">showHex_list</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Key, finit) -&gt; Key) -&gt; [(Key, finit)] -&gt; [Key]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Key, finit) -&gt; Key
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Key, finit)]
</span><a href="#local-6989586621679397620"><span class="hs-identifier hs-var">new_calls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; to entries to be explored.&quot;</span></span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><span class="annottext">AnalysisResult pred finit v
-&gt; WithLifting bin pred finit v (AnalysisResult pred finit v)
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(AnalysisResult pred finit v
 -&gt; WithLifting bin pred finit v (AnalysisResult pred finit v))
-&gt; AnalysisResult pred finit v
-&gt; WithLifting bin pred finit v (AnalysisResult pred finit v)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap finit -&gt; AnalysisResult pred finit v
forall pred finit v. IntMap finit -&gt; AnalysisResult pred finit v
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#FoundNewCalls"><span class="hs-identifier hs-var">FoundNewCalls</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap finit -&gt; AnalysisResult pred finit v)
-&gt; IntMap finit -&gt; AnalysisResult pred finit v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Key, finit)] -&gt; IntMap finit
forall a. [(Key, a)] -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.fromList</span></span><span> </span><span class="annot"><span class="annottext">[(Key, finit)]
</span><a href="#local-6989586621679397620"><span class="hs-identifier hs-var">new_calls</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621679397628"><span class="annot"><span class="annottext">[(Key, [Instruction])]
</span><a href="#local-6989586621679397628"><span class="hs-identifier hs-var">to_be_resolved_blocks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Key, [Instruction])
 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool)
-&gt; [(Key, [Instruction])]
-&gt; StateT
     (L0 pred finit v) (ReaderT (bin, Config) IO) [(Key, [Instruction])]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Key, [Instruction])
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
(Key, [Instruction]) -&gt; WithLifting bin pred finit v Bool
</span><a href="#local-6989586621679397629"><span class="hs-identifier hs-var">is_to_be_resolved_block</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Key, [Instruction])]
 -&gt; StateT
      (L0 pred finit v)
      (ReaderT (bin, Config) IO)
      [(Key, [Instruction])])
-&gt; [(Key, [Instruction])]
-&gt; StateT
     (L0 pred finit v) (ReaderT (bin, Config) IO) [(Key, [Instruction])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap [Instruction] -&gt; [(Key, [Instruction])]
forall a. IntMap a -&gt; [(Key, a)]
</span><span class="hs-identifier hs-var">IM.assocs</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [Instruction] -&gt; [(Key, [Instruction])])
-&gt; IntMap [Instruction] -&gt; [(Key, [Instruction])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CFG -&gt; IntMap [Instruction]
</span><a href="Data.CFG.html#cfg_instrs"><span class="hs-identifier hs-var">cfg_instrs</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679397603"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-292"></span><span>    </span><span id="local-6989586621679397630"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679397630"><span class="hs-identifier hs-var">is_newly_resolved</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Key, [Instruction])
 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool)
-&gt; [(Key, [Instruction])]
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Bool]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap pred
-&gt; (Key, [Instruction])
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) Bool
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
IntMap pred
-&gt; (Key, [Instruction]) -&gt; WithLifting bin pred finit v Bool
</span><a href="#local-6989586621679397632"><span class="hs-identifier hs-var">try_resolve_indirection</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap pred
</span><a href="#local-6989586621679397616"><span class="hs-identifier hs-var">invs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Key, [Instruction])]
</span><a href="#local-6989586621679397628"><span class="hs-identifier hs-var">to_be_resolved_blocks</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679397630"><span class="hs-identifier hs-var">is_newly_resolved</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-294"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: Continuing to next round as there are newly resolved indirections.&quot;</span></span><span>
</span><span id="line-295"></span><span>      </span><span class="annot"><span class="annottext">Word64
-&gt; WithLifting bin pred finit v (AnalysisResult pred finit v)
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Word64
-&gt; WithLifting bin pred finit v (AnalysisResult pred finit v)
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#analyze_entry"><span class="hs-identifier hs-var">analyze_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-297"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: Terminating as no new indirections are resolved.&quot;</span></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-comment">-- liftIO $ putStrLn $ &quot;Invariants:\n&quot; ++ intercalate &quot;\n&quot; (map show $ IM.assocs invs)</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397643"><span class="annot"><span class="annottext">posts :: Postcondition pred
</span><a href="#local-6989586621679397643"><span class="hs-identifier hs-var hs-var">posts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LiftingEntry bin pred finit v
-&gt; CFG -&gt; IntMap pred -&gt; Postcondition pred
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
LiftingEntry bin pred finit v
-&gt; CFG -&gt; IntMap pred -&gt; Postcondition pred
</span><a href="WithAbstractPredicates.GenerateInvariants.html#invs_to_post"><span class="hs-identifier hs-var">invs_to_post</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Lifting bin pred finit v -&gt; LiftingEntry bin pred finit v
forall {d} {a} {b} {c}. d -&gt; (a, b, c) -&gt; (a, b, c, d)
</span><a href="WithAbstractPredicates.GenerateInvariants.html#withEntry"><span class="hs-identifier hs-var">withEntry</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397593"><span class="hs-identifier hs-var">static</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679397603"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap pred
</span><a href="#local-6989586621679397616"><span class="hs-identifier hs-var">invs</span></a></span><span>
</span><span id="line-302"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397654"><span class="annot"><span class="annottext">pars :: IntMap (PointerAnalysisResult v)
</span><a href="#local-6989586621679397654"><span class="hs-identifier hs-var hs-var">pars</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LiftingEntry bin pred finit v
-&gt; CFG -&gt; IntMap pred -&gt; IntMap (PointerAnalysisResult v)
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
LiftingEntry bin pred finit v
-&gt; CFG -&gt; IntMap pred -&gt; IntMap (PointerAnalysisResult v)
</span><a href="WithAbstractPredicates.GenerateInvariants.html#invs_to_PA"><span class="hs-identifier hs-var">invs_to_PA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Lifting bin pred finit v -&gt; LiftingEntry bin pred finit v
forall {d} {a} {b} {c}. d -&gt; (a, b, c) -&gt; (a, b, c, d)
</span><a href="WithAbstractPredicates.GenerateInvariants.html#withEntry"><span class="hs-identifier hs-var">withEntry</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397593"><span class="hs-identifier hs-var">static</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679397603"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap pred
</span><a href="#local-6989586621679397616"><span class="hs-identifier hs-var">invs</span></a></span><span>
</span><span id="line-303"></span><span>      </span><span id="local-6989586621679397656"><span class="annot"><span class="annottext">Set Word64
</span><a href="#local-6989586621679397656"><span class="hs-identifier hs-var">calls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Word64] -&gt; Set Word64
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Word64] -&gt; Set Word64)
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Word64]
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) (Set Word64)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Instruction
 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Word64])
-&gt; [Instruction]
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Word64]
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m [b]) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">concatMapM</span></span><span> </span><span class="annot"><span class="annottext">Instruction
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Word64]
forall {bin} {pred} {finit} {v}.
BinaryClass bin =&gt;
Instruction
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Word64]
</span><a href="#local-6989586621679397658"><span class="hs-identifier hs-var">get_internal_calls</span></a></span><span> </span><span class="annot"><span class="annottext">([Instruction]
 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Word64])
-&gt; [Instruction]
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Word64]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Instruction]] -&gt; [Instruction]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Instruction]] -&gt; [Instruction])
-&gt; [[Instruction]] -&gt; [Instruction]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap [Instruction] -&gt; [[Instruction]]
forall a. IntMap a -&gt; [a]
</span><span class="hs-identifier hs-var">IM.elems</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [Instruction] -&gt; [[Instruction]])
-&gt; IntMap [Instruction] -&gt; [[Instruction]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CFG -&gt; IntMap [Instruction]
</span><a href="Data.CFG.html#cfg_instrs"><span class="hs-identifier hs-var">cfg_instrs</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679397603"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>      </span><span class="annot"><span class="annottext">AnalysisResult pred finit v
-&gt; WithLifting bin pred finit v (AnalysisResult pred finit v)
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(AnalysisResult pred finit v
 -&gt; WithLifting bin pred finit v (AnalysisResult pred finit v))
-&gt; AnalysisResult pred finit v
-&gt; WithLifting bin pred finit v (AnalysisResult pred finit v)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FResult pred v -&gt; AnalysisResult pred finit v
forall pred finit v. FResult pred v -&gt; AnalysisResult pred finit v
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#AnalyzedWithResult"><span class="hs-identifier hs-var">AnalyzedWithResult</span></a></span><span> </span><span class="annot"><span class="annottext">(FResult pred v -&gt; AnalysisResult pred finit v)
-&gt; FResult pred v -&gt; AnalysisResult pred finit v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CFG
-&gt; Postcondition pred
-&gt; Set Word64
-&gt; VCS v
-&gt; IntMap (PointerAnalysisResult v)
-&gt; FResult pred v
forall pred v.
CFG
-&gt; Postcondition pred
-&gt; Set Word64
-&gt; Set (VerificationCondition v)
-&gt; IntMap (PointerAnalysisResult v)
-&gt; FResult pred v
</span><a href="Data.L0.html#FResult"><span class="hs-identifier hs-var">FResult</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679397603"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">Postcondition pred
</span><a href="#local-6989586621679397643"><span class="hs-identifier hs-var">posts</span></a></span><span> </span><span class="annot"><span class="annottext">Set Word64
</span><a href="#local-6989586621679397656"><span class="hs-identifier hs-var">calls</span></a></span><span> </span><span class="annot"><span class="annottext">VCS v
</span><a href="#local-6989586621679397617"><span class="hs-identifier hs-var">vcs</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (PointerAnalysisResult v)
</span><a href="#local-6989586621679397654"><span class="hs-identifier hs-var">pars</span></a></span><span>
</span><span id="line-305"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-306"></span><span>  </span><span id="local-6989586621679397621"><span class="annot"><span class="annottext">join_duplicate_new_calls :: (bin, Config, L0 pred b v) -&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="#local-6989586621679397621"><span class="hs-identifier hs-var hs-var">join_duplicate_new_calls</span></a></span></span><span> </span><span id="local-6989586621679397680"><span class="annot"><span class="annottext">(bin, Config, L0 pred b v)
</span><a href="#local-6989586621679397680"><span class="hs-identifier hs-var">static</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><a href="#local-6989586621679397621"><span class="hs-identifier hs-var">join_duplicate_new_calls</span></a></span><span> </span><span id="local-6989586621679397681"><span class="annot"><span class="annottext">(bin, Config, L0 pred b v)
</span><a href="#local-6989586621679397681"><span class="hs-identifier hs-var">static</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679397682"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397682"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679397683"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679397683"><span class="hs-identifier hs-var">finit</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679397684"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679397684"><span class="hs-identifier hs-var">new_calls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397686"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679397686"><span class="hs-identifier hs-var">same</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679397687"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679397687"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, b) -&gt; Bool) -&gt; [(a, b)] -&gt; ([(a, b)], [(a, b)])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679397689"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397689"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397682"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397689"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679397684"><span class="hs-identifier hs-var">new_calls</span></a></span><span>
</span><span id="line-309"></span><span>        </span><span id="local-6989586621679397707"><span class="annot"><span class="annottext">finit' :: b
</span><a href="#local-6989586621679397707"><span class="hs-identifier hs-var hs-var">finit'</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b -&gt; b -&gt; b) -&gt; [b] -&gt; b
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldr1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LiftingEntry bin pred b v -&gt; b -&gt; b -&gt; b
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
LiftingEntry bin pred finit v -&gt; finit -&gt; finit -&gt; finit
</span><a href="WithAbstractPredicates.Class.html#join_finits"><span class="hs-identifier hs-var">join_finits</span></a></span><span> </span><span class="annot"><span class="annottext">(LiftingEntry bin pred b v -&gt; b -&gt; b -&gt; b)
-&gt; LiftingEntry bin pred b v -&gt; b -&gt; b -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; (bin, Config, L0 pred b v) -&gt; LiftingEntry bin pred b v
forall {d} {a} {b} {c}. d -&gt; (a, b, c) -&gt; (a, b, c, d)
</span><a href="WithAbstractPredicates.GenerateInvariants.html#withEntry"><span class="hs-identifier hs-var">withEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397682"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(bin, Config, L0 pred b v)
</span><a href="#local-6989586621679397681"><span class="hs-identifier hs-var">static</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679397683"><span class="hs-identifier hs-var">finit</span></a></span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">((a, b) -&gt; b) -&gt; [(a, b)] -&gt; [b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; b
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679397686"><span class="hs-identifier hs-var">same</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-310"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397682"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679397707"><span class="hs-identifier hs-var">finit'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(bin, Config, L0 pred b v) -&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="#local-6989586621679397621"><span class="hs-identifier hs-var">join_duplicate_new_calls</span></a></span><span> </span><span class="annot"><span class="annottext">(bin, Config, L0 pred b v)
</span><a href="#local-6989586621679397681"><span class="hs-identifier hs-var">static</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679397687"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621679397624"><span class="annot"><span class="annottext">get_new_calls :: IntMap pred
-&gt; (Key, [Instruction])
-&gt; StateT
     (L0 pred finit v) (ReaderT (bin, Config) IO) [Maybe (a, finit)]
</span><a href="#local-6989586621679397624"><span class="hs-identifier hs-var hs-var">get_new_calls</span></a></span></span><span> </span><span id="local-6989586621679397739"><span class="annot"><span class="annottext">IntMap pred
</span><a href="#local-6989586621679397739"><span class="hs-identifier hs-var">invs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397740"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397740"><span class="hs-identifier hs-var">blockID</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679397741"><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397741"><span class="hs-identifier hs-var">instrs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-comment">-- Assumes calls are always last intruction in block (TODO jumps that are actually calls)</span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; Bool
</span><a href="Data.X86.Opcode.html#isCall"><span class="hs-identifier hs-var">isCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; Opcode
</span><a href="Data.X86.Instruction.html#inOperation"><span class="hs-identifier hs-var">inOperation</span></a></span><span> </span><span class="annot"><span class="annottext">(Instruction -&gt; Opcode) -&gt; Instruction -&gt; Opcode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Instruction] -&gt; Instruction
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397741"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-315"></span><span>      </span><span id="local-6989586621679397745"><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397745"><span class="hs-identifier hs-var">static</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WithLifting bin pred finit v (Lifting bin pred finit v)
forall bin pred finit v.
WithLifting bin pred finit v (Lifting bin pred finit v)
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#mk_static"><span class="hs-identifier hs-var">mk_static</span></a></span><span>
</span><span id="line-316"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397749"><span class="annot"><span class="annottext">trgts :: [ResolvedJumpTarget]
</span><a href="#local-6989586621679397749"><span class="hs-identifier hs-var hs-var">trgts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v -&gt; Instruction -&gt; [ResolvedJumpTarget]
forall bin pred finit v.
BinaryClass bin =&gt;
Lifting bin pred finit v -&gt; Instruction -&gt; [ResolvedJumpTarget]
</span><a href="WithAbstractPredicates.ControlFlow.html#get_known_jump_targets"><span class="hs-identifier hs-var">get_known_jump_targets</span></a></span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397745"><span class="hs-identifier hs-var">static</span></a></span><span> </span><span class="annot"><span class="annottext">(Instruction -&gt; [ResolvedJumpTarget])
-&gt; Instruction -&gt; [ResolvedJumpTarget]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Instruction] -&gt; Instruction
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397741"><span class="hs-identifier hs-var">instrs</span></a></span><span>
</span><span id="line-317"></span><span>      </span><span class="annot"><span class="annottext">(ResolvedJumpTarget
 -&gt; StateT
      (L0 pred finit v) (ReaderT (bin, Config) IO) (Maybe (a, finit)))
-&gt; [ResolvedJumpTarget]
-&gt; StateT
     (L0 pred finit v) (ReaderT (bin, Config) IO) [Maybe (a, finit)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap pred
-&gt; Key
-&gt; [Instruction]
-&gt; ResolvedJumpTarget
-&gt; StateT
     (L0 pred finit v) (ReaderT (bin, Config) IO) (Maybe (a, finit))
forall {a} {a} {pred} {a} {v}.
(Num a, WithAbstractPredicates a pred a v) =&gt;
IntMap pred
-&gt; Key
-&gt; [Instruction]
-&gt; ResolvedJumpTarget
-&gt; StateT (L0 pred a v) (ReaderT (a, Config) IO) (Maybe (a, a))
</span><a href="#local-6989586621679397751"><span class="hs-identifier hs-var">get_new_calls_from_trgt</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap pred
</span><a href="#local-6989586621679397739"><span class="hs-identifier hs-var">invs</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397740"><span class="hs-identifier hs-var">blockID</span></a></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397741"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedJumpTarget]
</span><a href="#local-6989586621679397749"><span class="hs-identifier hs-var">trgts</span></a></span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe (a, finit)]
-&gt; StateT
     (L0 pred finit v) (ReaderT (bin, Config) IO) [Maybe (a, finit)]
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe (a, finit)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">]</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621679397751"><span class="annot"><span class="annottext">get_new_calls_from_trgt :: IntMap pred
-&gt; Key
-&gt; [Instruction]
-&gt; ResolvedJumpTarget
-&gt; StateT (L0 pred a v) (ReaderT (a, Config) IO) (Maybe (a, a))
</span><a href="#local-6989586621679397751"><span class="hs-identifier hs-var hs-var">get_new_calls_from_trgt</span></a></span></span><span> </span><span id="local-6989586621679397783"><span class="annot"><span class="annottext">IntMap pred
</span><a href="#local-6989586621679397783"><span class="hs-identifier hs-var">invs</span></a></span></span><span> </span><span id="local-6989586621679397784"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397784"><span class="hs-identifier hs-var">blockID</span></a></span></span><span> </span><span id="local-6989586621679397785"><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397785"><span class="hs-identifier hs-var">instrs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.JumpTarget.html#ImmediateAddress"><span class="hs-identifier hs-type">ImmediateAddress</span></a></span><span> </span><span id="local-6989586621679397787"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397787"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-321"></span><span>    </span><span id="local-6989586621679397788"><span class="annot"><span class="annottext">Maybe (a, Maybe (FResult pred v))
</span><a href="#local-6989586621679397788"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(L0 pred a v -&gt; Maybe (a, Maybe (FResult pred v)))
-&gt; StateT
     (L0 pred a v)
     (ReaderT (a, Config) IO)
     (Maybe (a, Maybe (FResult pred v)))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((L0 pred a v -&gt; Maybe (a, Maybe (FResult pred v)))
 -&gt; StateT
      (L0 pred a v)
      (ReaderT (a, Config) IO)
      (Maybe (a, Maybe (FResult pred v))))
-&gt; (L0 pred a v -&gt; Maybe (a, Maybe (FResult pred v)))
-&gt; StateT
     (L0 pred a v)
     (ReaderT (a, Config) IO)
     (Maybe (a, Maybe (FResult pred v)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; L0 pred a v -&gt; Maybe (a, Maybe (FResult pred v))
forall {a} {pred} {finit} {v}.
Integral a =&gt;
a -&gt; L0 pred finit v -&gt; Maybe (finit, Maybe (FResult pred v))
</span><a href="Data.L0.html#l0_lookup_entry"><span class="hs-identifier hs-var">l0_lookup_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397787"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (a, Maybe (FResult pred v))
</span><a href="#local-6989586621679397788"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-323"></span><span>      </span><span class="annot"><span class="annottext">Maybe (a, Maybe (FResult pred v))
</span><span class="hs-identifier hs-var">Nothing</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- Unvisited</span><span>
</span><span id="line-324"></span><span>                               </span><span id="local-6989586621679397789"><span class="annot"><span class="annottext">(a, Config, L0 pred a v, Word64)
</span><a href="#local-6989586621679397789"><span class="hs-identifier hs-var">static</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word64
-&gt; (a, Config, L0 pred a v) -&gt; (a, Config, L0 pred a v, Word64)
forall {d} {a} {b} {c}. d -&gt; (a, b, c) -&gt; (a, b, c, d)
</span><a href="WithAbstractPredicates.GenerateInvariants.html#withEntry"><span class="hs-identifier hs-var">withEntry</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">((a, Config, L0 pred a v) -&gt; (a, Config, L0 pred a v, Word64))
-&gt; StateT
     (L0 pred a v) (ReaderT (a, Config) IO) (a, Config, L0 pred a v)
-&gt; StateT
     (L0 pred a v)
     (ReaderT (a, Config) IO)
     (a, Config, L0 pred a v, Word64)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateT
  (L0 pred a v) (ReaderT (a, Config) IO) (a, Config, L0 pred a v)
forall bin pred finit v.
WithLifting bin pred finit v (Lifting bin pred finit v)
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#mk_static"><span class="hs-identifier hs-var">mk_static</span></a></span><span>
</span><span id="line-325"></span><span>                               </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397801"><span class="annot"><span class="annottext">pred
</span><a href="#local-6989586621679397801"><span class="hs-identifier hs-var">post</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">VCS v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, Config, L0 pred a v, Word64)
-&gt; Key -&gt; [Instruction] -&gt; IntMap pred -&gt; (pred, VCS v)
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
LiftingEntry bin pred finit v
-&gt; Key -&gt; [Instruction] -&gt; IntMap pred -&gt; (pred, VCS v)
</span><a href="WithAbstractPredicates.GenerateInvariants.html#get_postcondition_for_block"><span class="hs-identifier hs-var">get_postcondition_for_block</span></a></span><span> </span><span class="annot"><span class="annottext">(a, Config, L0 pred a v, Word64)
</span><a href="#local-6989586621679397789"><span class="hs-identifier hs-var">static</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397784"><span class="hs-identifier hs-var">blockID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Instruction] -&gt; [Instruction]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397785"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap pred
</span><a href="#local-6989586621679397783"><span class="hs-identifier hs-var">invs</span></a></span><span>
</span><span id="line-326"></span><span>                               </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397813"><span class="annot"><span class="annottext">new_finit :: a
</span><a href="#local-6989586621679397813"><span class="hs-identifier hs-var hs-var">new_finit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, Config, L0 pred a v, Word64) -&gt; pred -&gt; a
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
LiftingEntry bin pred finit v -&gt; pred -&gt; finit
</span><a href="WithAbstractPredicates.Class.html#pred_to_finit"><span class="hs-identifier hs-var">pred_to_finit</span></a></span><span> </span><span class="annot"><span class="annottext">(a, Config, L0 pred a v, Word64)
</span><a href="#local-6989586621679397789"><span class="hs-identifier hs-var">static</span></a></span><span> </span><span class="annot"><span class="annottext">pred
</span><a href="#local-6989586621679397801"><span class="hs-identifier hs-var">post</span></a></span><span>
</span><span id="line-327"></span><span>                               </span><span class="annot"><span class="annottext">Maybe (a, a)
-&gt; StateT (L0 pred a v) (ReaderT (a, Config) IO) (Maybe (a, a))
forall a. a -&gt; StateT (L0 pred a v) (ReaderT (a, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (a, a)
 -&gt; StateT (L0 pred a v) (ReaderT (a, Config) IO) (Maybe (a, a)))
-&gt; Maybe (a, a)
-&gt; StateT (L0 pred a v) (ReaderT (a, Config) IO) (Maybe (a, a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; Maybe (a, a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397787"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397813"><span class="hs-identifier hs-var">new_finit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (FResult pred v)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- Recursive unanalyzed call</span><span>
</span><span id="line-329"></span><span>                               </span><span class="annot"><span class="annottext">Maybe (a, a)
-&gt; StateT (L0 pred a v) (ReaderT (a, Config) IO) (Maybe (a, a))
forall a. a -&gt; StateT (L0 pred a v) (ReaderT (a, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (a, a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-330"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397815"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397815"><span class="hs-identifier hs-var">finit</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679397816"><span class="annot"><span class="annottext">FResult pred v
</span><a href="#local-6989586621679397816"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- Already analyzed call</span><span>
</span><span id="line-331"></span><span>                               </span><span id="local-6989586621679397817"><span class="annot"><span class="annottext">(a, Config, L0 pred a v, Word64)
</span><a href="#local-6989586621679397817"><span class="hs-identifier hs-var">static</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word64
-&gt; (a, Config, L0 pred a v) -&gt; (a, Config, L0 pred a v, Word64)
forall {d} {a} {b} {c}. d -&gt; (a, b, c) -&gt; (a, b, c, d)
</span><a href="WithAbstractPredicates.GenerateInvariants.html#withEntry"><span class="hs-identifier hs-var">withEntry</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">((a, Config, L0 pred a v) -&gt; (a, Config, L0 pred a v, Word64))
-&gt; StateT
     (L0 pred a v) (ReaderT (a, Config) IO) (a, Config, L0 pred a v)
-&gt; StateT
     (L0 pred a v)
     (ReaderT (a, Config) IO)
     (a, Config, L0 pred a v, Word64)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateT
  (L0 pred a v) (ReaderT (a, Config) IO) (a, Config, L0 pred a v)
forall bin pred finit v.
WithLifting bin pred finit v (Lifting bin pred finit v)
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#mk_static"><span class="hs-identifier hs-var">mk_static</span></a></span><span> </span><span>
</span><span id="line-332"></span><span>                               </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397829"><span class="annot"><span class="annottext">pred
</span><a href="#local-6989586621679397829"><span class="hs-identifier hs-var">post</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">VCS v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, Config, L0 pred a v, Word64)
-&gt; Key -&gt; [Instruction] -&gt; IntMap pred -&gt; (pred, VCS v)
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
LiftingEntry bin pred finit v
-&gt; Key -&gt; [Instruction] -&gt; IntMap pred -&gt; (pred, VCS v)
</span><a href="WithAbstractPredicates.GenerateInvariants.html#get_postcondition_for_block"><span class="hs-identifier hs-var">get_postcondition_for_block</span></a></span><span> </span><span class="annot"><span class="annottext">(a, Config, L0 pred a v, Word64)
</span><a href="#local-6989586621679397817"><span class="hs-identifier hs-var">static</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397784"><span class="hs-identifier hs-var">blockID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Instruction] -&gt; [Instruction]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397785"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap pred
</span><a href="#local-6989586621679397783"><span class="hs-identifier hs-var">invs</span></a></span><span>
</span><span id="line-333"></span><span>                               </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397839"><span class="annot"><span class="annottext">new_finit :: a
</span><a href="#local-6989586621679397839"><span class="hs-identifier hs-var hs-var">new_finit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, Config, L0 pred a v, Word64) -&gt; pred -&gt; a
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
LiftingEntry bin pred finit v -&gt; pred -&gt; finit
</span><a href="WithAbstractPredicates.Class.html#pred_to_finit"><span class="hs-identifier hs-var">pred_to_finit</span></a></span><span> </span><span class="annot"><span class="annottext">(a, Config, L0 pred a v, Word64)
</span><a href="#local-6989586621679397817"><span class="hs-identifier hs-var">static</span></a></span><span> </span><span class="annot"><span class="annottext">pred
</span><a href="#local-6989586621679397829"><span class="hs-identifier hs-var">post</span></a></span><span>
</span><span id="line-334"></span><span>                               </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397849"><span class="annot"><span class="annottext">join :: a
</span><a href="#local-6989586621679397849"><span class="hs-identifier hs-var hs-var">join</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, Config, L0 pred a v, Word64) -&gt; a -&gt; a -&gt; a
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
LiftingEntry bin pred finit v -&gt; finit -&gt; finit -&gt; finit
</span><a href="WithAbstractPredicates.Class.html#join_finits"><span class="hs-identifier hs-var">join_finits</span></a></span><span> </span><span class="annot"><span class="annottext">(a, Config, L0 pred a v, Word64)
</span><a href="#local-6989586621679397817"><span class="hs-identifier hs-var">static</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397839"><span class="hs-identifier hs-var">new_finit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397815"><span class="hs-identifier hs-var">finit</span></a></span><span>
</span><span id="line-335"></span><span>                               </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397815"><span class="hs-identifier hs-var">finit</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397849"><span class="hs-identifier hs-var">join</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-336"></span><span>                                  </span><span class="annot"><span class="annottext">Maybe (a, a)
-&gt; StateT (L0 pred a v) (ReaderT (a, Config) IO) (Maybe (a, a))
forall a. a -&gt; StateT (L0 pred a v) (ReaderT (a, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (a, a)
 -&gt; StateT (L0 pred a v) (ReaderT (a, Config) IO) (Maybe (a, a)))
-&gt; Maybe (a, a)
-&gt; StateT (L0 pred a v) (ReaderT (a, Config) IO) (Maybe (a, a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; Maybe (a, a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397787"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397849"><span class="hs-identifier hs-var">join</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>                               </span><span class="hs-keyword">else</span><span>
</span><span id="line-338"></span><span>                                  </span><span class="annot"><span class="annottext">Maybe (a, a)
-&gt; StateT (L0 pred a v) (ReaderT (a, Config) IO) (Maybe (a, a))
forall a. a -&gt; StateT (L0 pred a v) (ReaderT (a, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (a, a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-339"></span><span>  </span><span class="annot"><a href="#local-6989586621679397751"><span class="hs-identifier hs-var">get_new_calls_from_trgt</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap pred
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ResolvedJumpTarget
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (a, a)
-&gt; StateT (L0 pred a v) (ReaderT (a, Config) IO) (Maybe (a, a))
forall a. a -&gt; StateT (L0 pred a v) (ReaderT (a, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (a, a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span>  </span><span id="local-6989586621679397658"><span class="annot"><span class="annottext">get_internal_calls :: Instruction
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Word64]
</span><a href="#local-6989586621679397658"><span class="hs-identifier hs-var hs-var">get_internal_calls</span></a></span></span><span> </span><span id="local-6989586621679397857"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679397857"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; Bool
</span><a href="Data.X86.Opcode.html#isCall"><span class="hs-identifier hs-var">isCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; Opcode
</span><a href="Data.X86.Instruction.html#inOperation"><span class="hs-identifier hs-var">inOperation</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679397857"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-344"></span><span>      </span><span id="local-6989586621679397858"><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397858"><span class="hs-identifier hs-var">static</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WithLifting bin pred finit v (Lifting bin pred finit v)
forall bin pred finit v.
WithLifting bin pred finit v (Lifting bin pred finit v)
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#mk_static"><span class="hs-identifier hs-var">mk_static</span></a></span><span> </span><span>
</span><span id="line-345"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397860"><span class="annot"><span class="annottext">trgts :: [ResolvedJumpTarget]
</span><a href="#local-6989586621679397860"><span class="hs-identifier hs-var hs-var">trgts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v -&gt; Instruction -&gt; [ResolvedJumpTarget]
forall bin pred finit v.
BinaryClass bin =&gt;
Lifting bin pred finit v -&gt; Instruction -&gt; [ResolvedJumpTarget]
</span><a href="WithAbstractPredicates.ControlFlow.html#get_known_jump_targets"><span class="hs-identifier hs-var">get_known_jump_targets</span></a></span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397858"><span class="hs-identifier hs-var">static</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679397857"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-346"></span><span>      </span><span class="annot"><span class="annottext">[Word64]
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Word64]
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([Word64]
 -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Word64])
-&gt; [Word64]
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Word64]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ResolvedJumpTarget -&gt; [Word64])
-&gt; [ResolvedJumpTarget] -&gt; [Word64]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">ResolvedJumpTarget -&gt; [Word64]
</span><a href="#local-6989586621679397861"><span class="hs-identifier hs-var">get_internal_call_from_trgt</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedJumpTarget]
</span><a href="#local-6989586621679397860"><span class="hs-identifier hs-var">trgts</span></a></span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-comment">-- TODO jump</span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word64]
-&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) [Word64]
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span>  </span><span id="local-6989586621679397861"><span class="annot"><span class="annottext">get_internal_call_from_trgt :: ResolvedJumpTarget -&gt; [Word64]
</span><a href="#local-6989586621679397861"><span class="hs-identifier hs-var hs-var">get_internal_call_from_trgt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.JumpTarget.html#ImmediateAddress"><span class="hs-identifier hs-type">ImmediateAddress</span></a></span><span> </span><span id="local-6989586621679397862"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397862"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397862"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-351"></span><span>  </span><span class="annot"><a href="#local-6989586621679397861"><span class="hs-identifier hs-var">get_internal_call_from_trgt</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedJumpTarget
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span>  </span><span id="local-6989586621679396872"><span id="local-6989586621679396873"><span id="local-6989586621679396874"><span id="local-6989586621679396875"><span class="annot"><a href="#local-6989586621679397629"><span class="hs-identifier hs-type">is_to_be_resolved_block</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractPredicates.Class.html#WithAbstractPredicates"><span class="hs-identifier hs-type">WithAbstractPredicates</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396872"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396873"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396874"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396875"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#WithLifting"><span class="hs-identifier hs-type">WithLifting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396872"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396873"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396874"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396875"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span><span>
</span><span id="line-355"></span><span>  </span><span id="local-6989586621679397629"><span class="annot"><span class="annottext">is_to_be_resolved_block :: forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
(Key, [Instruction]) -&gt; WithLifting bin pred finit v Bool
</span><a href="#local-6989586621679397629"><span class="hs-identifier hs-var hs-var">is_to_be_resolved_block</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397873"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397873"><span class="hs-identifier hs-var">blockID</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679397874"><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397874"><span class="hs-identifier hs-var">instrs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; Bool
</span><a href="Data.X86.Opcode.html#isJump"><span class="hs-identifier hs-var">isJump</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; Opcode
</span><a href="Data.X86.Instruction.html#inOperation"><span class="hs-identifier hs-var">inOperation</span></a></span><span> </span><span class="annot"><span class="annottext">(Instruction -&gt; Opcode) -&gt; Instruction -&gt; Opcode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Instruction] -&gt; Instruction
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397874"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; Bool
</span><a href="Data.X86.Opcode.html#isCall"><span class="hs-identifier hs-var">isCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; Opcode
</span><a href="Data.X86.Instruction.html#inOperation"><span class="hs-identifier hs-var">inOperation</span></a></span><span> </span><span class="annot"><span class="annottext">(Instruction -&gt; Opcode) -&gt; Instruction -&gt; Opcode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Instruction] -&gt; Instruction
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397874"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; WithLifting bin pred finit v Bool
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Instruction -&gt; WithLifting bin pred finit v Bool
</span><a href="#local-6989586621679397877"><span class="hs-identifier hs-var">is_to_be_resolved_indirection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Instruction] -&gt; Instruction
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397874"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; WithLifting bin pred finit v Bool
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span>  </span><span id="local-6989586621679396929"><span id="local-6989586621679396930"><span id="local-6989586621679396931"><span id="local-6989586621679396932"><span class="annot"><a href="#local-6989586621679397877"><span class="hs-identifier hs-type">is_to_be_resolved_indirection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractPredicates.Class.html#WithAbstractPredicates"><span class="hs-identifier hs-type">WithAbstractPredicates</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396929"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396930"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396931"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396932"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#WithLifting"><span class="hs-identifier hs-type">WithLifting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396929"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396930"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396931"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396932"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621679397877"><span class="annot"><span class="annottext">is_to_be_resolved_indirection :: forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
Instruction -&gt; WithLifting bin pred finit v Bool
</span><a href="#local-6989586621679397877"><span class="hs-identifier hs-var hs-var">is_to_be_resolved_indirection</span></a></span></span><span> </span><span id="local-6989586621679397890"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679397890"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-361"></span><span>   </span><span id="local-6989586621679397891"><span class="annot"><span class="annottext">L0 pred finit v
</span><a href="#local-6989586621679397891"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT
  (L0 pred finit v) (ReaderT (bin, Config) IO) (L0 pred finit v)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-362"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621679397892"><span class="annot"><span class="annottext">bin
</span><a href="#local-6989586621679397892"><span class="hs-identifier hs-var">bin</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679397893"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679397893"><span class="hs-identifier hs-var">config</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (L0 pred finit v) (ReaderT (bin, Config) IO) (bin, Config)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-363"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">bin -&gt; Instruction -&gt; ResolvedJumpTarget
forall bin.
BinaryClass bin =&gt;
bin -&gt; Instruction -&gt; ResolvedJumpTarget
</span><a href="Binary.FunctionNames.html#jump_target_for_instruction"><span class="hs-identifier hs-var">jump_target_for_instruction</span></a></span><span> </span><span class="annot"><span class="annottext">bin
</span><a href="#local-6989586621679397892"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679397890"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-364"></span><span>     </span><span class="annot"><span class="annottext">ResolvedJumpTarget
</span><a href="Data.JumpTarget.html#Unresolved"><span class="hs-identifier hs-var">Unresolved</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; WithLifting bin pred finit v Bool
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-365"></span><span>     </span><span class="annot"><a href="Data.JumpTarget.html#External"><span class="hs-identifier hs-type">External</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;error&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; WithLifting bin pred finit v Bool
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-366"></span><span>     </span><span class="annot"><span class="annottext">ResolvedJumpTarget
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; WithLifting bin pred finit v Bool
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span>  </span><span id="local-6989586621679396880"><span id="local-6989586621679396881"><span id="local-6989586621679396882"><span id="local-6989586621679396883"><span class="annot"><a href="#local-6989586621679397632"><span class="hs-identifier hs-type">try_resolve_indirection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractPredicates.Class.html#WithAbstractPredicates"><span class="hs-identifier hs-type">WithAbstractPredicates</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396880"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396881"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396882"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396883"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IM.IntMap</span></span><span> </span><span class="annot"><a href="#local-6989586621679396881"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="Data.X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#WithLifting"><span class="hs-identifier hs-type">WithLifting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396880"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396881"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396882"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679396883"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span><span>
</span><span id="line-369"></span><span>  </span><span id="local-6989586621679397632"><span class="annot"><span class="annottext">try_resolve_indirection :: forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
IntMap pred
-&gt; (Key, [Instruction]) -&gt; WithLifting bin pred finit v Bool
</span><a href="#local-6989586621679397632"><span class="hs-identifier hs-var hs-var">try_resolve_indirection</span></a></span></span><span> </span><span id="local-6989586621679397939"><span class="annot"><span class="annottext">IntMap pred
</span><a href="#local-6989586621679397939"><span class="hs-identifier hs-var">invs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397940"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397940"><span class="hs-identifier hs-var">blockID</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679397941"><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397941"><span class="hs-identifier hs-var">instrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397944"><span class="annot"><span class="annottext">pre :: pred
</span><a href="#local-6989586621679397944"><span class="hs-identifier hs-var hs-var">pre</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe pred -&gt; pred
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe pred -&gt; pred) -&gt; Maybe pred -&gt; pred
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; IntMap pred -&gt; Maybe pred
forall a. Key -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679397940"><span class="hs-identifier hs-var">blockID</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap pred
</span><a href="#local-6989586621679397939"><span class="hs-identifier hs-var">invs</span></a></span><span>
</span><span id="line-371"></span><span>    </span><span id="local-6989586621679397946"><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397946"><span class="hs-identifier hs-var">static</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WithLifting bin pred finit v (Lifting bin pred finit v)
forall bin pred finit v.
WithLifting bin pred finit v (Lifting bin pred finit v)
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#mk_static"><span class="hs-identifier hs-var">mk_static</span></a></span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397956"><span class="annot"><span class="annottext">inds :: Indirections
</span><a href="#local-6989586621679397956"><span class="hs-identifier hs-var hs-var">inds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LiftingEntry bin pred finit v
-&gt; pred -&gt; [Instruction] -&gt; Indirections
forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
LiftingEntry bin pred finit v
-&gt; pred -&gt; [Instruction] -&gt; Indirections
</span><a href="WithAbstractPredicates.Class.html#resolve_indirection"><span class="hs-identifier hs-var">resolve_indirection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Lifting bin pred finit v -&gt; LiftingEntry bin pred finit v
forall {d} {a} {b} {c}. d -&gt; (a, b, c) -&gt; (a, b, c, d)
</span><a href="WithAbstractPredicates.GenerateInvariants.html#withEntry"><span class="hs-identifier hs-var">withEntry</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">Lifting bin pred finit v
</span><a href="#local-6989586621679397946"><span class="hs-identifier hs-var">static</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">pred
</span><a href="#local-6989586621679397944"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397941"><span class="hs-identifier hs-var">instrs</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Indirection
</span><a href="Data.Indirection.html#Indirection_Unresolved"><span class="hs-identifier hs-var">Indirection_Unresolved</span></a></span><span> </span><span class="annot"><span class="annottext">Indirection -&gt; Indirections -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`S.member`</span></span><span> </span><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679397956"><span class="hs-identifier hs-var">inds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-374"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-375"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unresolved indirection: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Instruction] -&gt; Instruction
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397941"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">pred -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">pred
</span><a href="#local-6989586621679397944"><span class="hs-identifier hs-var">pre</span></a></span><span>
</span><span id="line-377"></span><span>        </span><span class="annot"><span class="annottext">Indirections -&gt; Word64 -&gt; WithLifting bin pred finit v Bool
forall {m :: * -&gt; *} {a} {pred} {finit} {v}.
(MonadIO m, Integral a, MonadState (L0 pred finit v) m) =&gt;
Indirections -&gt; a -&gt; m Bool
</span><a href="#local-6989586621679397960"><span class="hs-identifier hs-var">add_newly_resolved_indirection</span></a></span><span> </span><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679397956"><span class="hs-identifier hs-var">inds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; Word64
</span><a href="Data.X86.Instruction.html#inAddress"><span class="hs-identifier hs-var">inAddress</span></a></span><span> </span><span class="annot"><span class="annottext">(Instruction -&gt; Word64) -&gt; Instruction -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Instruction] -&gt; Instruction
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397941"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-379"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Resolved indirection: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Instruction] -&gt; Instruction
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397941"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
IO a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ())
-&gt; IO () -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Indirection -&gt; String) -&gt; [Indirection] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Indirection -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">([Indirection] -&gt; [String]) -&gt; [Indirection] -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Indirections -&gt; [Indirection]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">S.toList</span></span><span> </span><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679397956"><span class="hs-identifier hs-var">inds</span></a></span><span>
</span><span id="line-381"></span><span>        </span><span class="annot"><span class="annottext">Indirections -&gt; Word64 -&gt; WithLifting bin pred finit v Bool
forall {m :: * -&gt; *} {a} {pred} {finit} {v}.
(MonadIO m, Integral a, MonadState (L0 pred finit v) m) =&gt;
Indirections -&gt; a -&gt; m Bool
</span><a href="#local-6989586621679397960"><span class="hs-identifier hs-var">add_newly_resolved_indirection</span></a></span><span> </span><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679397956"><span class="hs-identifier hs-var">inds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; Word64
</span><a href="Data.X86.Instruction.html#inAddress"><span class="hs-identifier hs-var">inAddress</span></a></span><span> </span><span class="annot"><span class="annottext">(Instruction -&gt; Word64) -&gt; Instruction -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Instruction] -&gt; Instruction
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679397941"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span>  </span><span id="local-6989586621679397960"><span class="annot"><span class="annottext">add_newly_resolved_indirection :: Indirections -&gt; a -&gt; m Bool
</span><a href="#local-6989586621679397960"><span class="hs-identifier hs-var hs-var">add_newly_resolved_indirection</span></a></span></span><span> </span><span id="local-6989586621679398010"><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679398010"><span class="hs-identifier hs-var">inds</span></a></span></span><span> </span><span id="local-6989586621679398011"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398011"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-384"></span><span>    </span><span id="local-6989586621679398012"><span class="annot"><span class="annottext">Maybe Indirections
</span><a href="#local-6989586621679398012"><span class="hs-identifier hs-var">curr_inds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(L0 pred finit v -&gt; Maybe Indirections) -&gt; m (Maybe Indirections)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((L0 pred finit v -&gt; Maybe Indirections) -&gt; m (Maybe Indirections))
-&gt; (L0 pred finit v -&gt; Maybe Indirections)
-&gt; m (Maybe Indirections)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; L0 pred finit v -&gt; Maybe Indirections
forall {a} {pred} {finit} {v}.
Integral a =&gt;
a -&gt; L0 pred finit v -&gt; Maybe Indirections
</span><a href="Data.L0.html#l0_lookup_indirection"><span class="hs-identifier hs-var">l0_lookup_indirection</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398011"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Indirections
</span><a href="#local-6989586621679398012"><span class="hs-identifier hs-var">curr_inds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-386"></span><span>      </span><span class="annot"><span class="annottext">Maybe Indirections
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(L0 pred finit v -&gt; L0 pred finit v) -&gt; m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Indirections -&gt; L0 pred finit v -&gt; L0 pred finit v
forall {a} {pred} {finit} {v}.
Integral a =&gt;
a -&gt; Indirections -&gt; L0 pred finit v -&gt; L0 pred finit v
</span><a href="Data.L0.html#l0_insert_indirection"><span class="hs-identifier hs-var">l0_insert_indirection</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398011"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679398010"><span class="hs-identifier hs-var">inds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m () -&gt; m Bool -&gt; m Bool
forall a b. m a -&gt; m b -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-387"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679398015"><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679398015"><span class="hs-identifier hs-var">inds'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679398010"><span class="hs-identifier hs-var">inds</span></a></span><span> </span><span class="annot"><span class="annottext">Indirections -&gt; Indirections -&gt; Bool
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`S.isSubsetOf`</span></span><span> </span><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679398015"><span class="hs-identifier hs-var">inds'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span>
</span><span id="line-388"></span><span>                      </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-389"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-390"></span><span>                      </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Extending previous indirection resolving @ &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall {a}. Integral a =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398011"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Indirections -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679398015"><span class="hs-identifier hs-var">inds'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; with new resolving: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Indirections -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679398010"><span class="hs-identifier hs-var">inds</span></a></span><span>
</span><span id="line-391"></span><span>                      </span><span class="annot"><span class="annottext">(L0 pred finit v -&gt; L0 pred finit v) -&gt; m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((L0 pred finit v -&gt; L0 pred finit v) -&gt; m ())
-&gt; (L0 pred finit v -&gt; L0 pred finit v) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Indirections -&gt; L0 pred finit v -&gt; L0 pred finit v
forall {a} {pred} {finit} {v}.
Integral a =&gt;
a -&gt; Indirections -&gt; L0 pred finit v -&gt; L0 pred finit v
</span><a href="Data.L0.html#l0_insert_indirection"><span class="hs-identifier hs-var">l0_insert_indirection</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679398011"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Indirections -&gt; Indirections -&gt; Indirections
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">S.union</span></span><span> </span><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679398010"><span class="hs-identifier hs-var">inds</span></a></span><span> </span><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679398015"><span class="hs-identifier hs-var">inds'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>                      </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span id="local-6989586621679398018"><span id="local-6989586621679398019"><span id="local-6989586621679398020"><span id="local-6989586621679398021"><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#finishExploration"><span class="hs-identifier hs-type">finishExploration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="WithAbstractPredicates.Class.html#WithAbstractPredicates"><span class="hs-identifier hs-type">WithAbstractPredicates</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398018"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398019"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398020"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398021"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#WithLifting"><span class="hs-identifier hs-type">WithLifting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398018"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398019"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398020"><span class="hs-identifier hs-type">finit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398021"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-403"></span><span id="finishExploration"><span class="annot"><span class="annottext">finishExploration :: forall bin pred finit v.
WithAbstractPredicates bin pred finit v =&gt;
WithLifting bin pred finit v ()
</span><a href="WithAbstractPredicates.ContextSensitiveAnalysis.html#finishExploration"><span class="hs-identifier hs-var hs-var">finishExploration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) ()
forall a.
a -&gt; StateT (L0 pred finit v) (ReaderT (bin, Config) IO) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span></pre></body></html>