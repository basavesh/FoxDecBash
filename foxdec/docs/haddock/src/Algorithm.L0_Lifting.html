<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures , FlexibleContexts, StrictData #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Algorithm.L0_Lifting</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-5"></span><span>  </span><span class="annot"><a href="Algorithm.L0_Lifting.html#lift_to_L0"><span class="hs-identifier">lift_to_L0</span></a></span><span>
</span><span id="line-6"></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Base.html"><span class="hs-identifier">Base</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Config.html"><span class="hs-identifier">Config</span></a></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Analysis.Context.html"><span class="hs-identifier">Analysis.Context</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Analysis.FunctionNames.html"><span class="hs-identifier">Analysis.FunctionNames</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Analysis.ControlFlow.html"><span class="hs-identifier">Analysis.ControlFlow</span></a></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Generic.Binary.html"><span class="hs-identifier">Generic.Binary</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Generic.SymbolicPropagation.html"><span class="hs-identifier">Generic.SymbolicPropagation</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Generic.SymbolicConstituents.html"><span class="hs-identifier">Generic.SymbolicConstituents</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Instantiation.SymbolicPropagation.html"><span class="hs-identifier">Instantiation.SymbolicPropagation</span></a></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.JumpTarget.html"><span class="hs-identifier">Data.JumpTarget</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SymbolicExpression.html"><span class="hs-identifier">Data.SymbolicExpression</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Parser.ParserIndirections.html"><span class="hs-identifier">Parser.ParserIndirections</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OutputGeneration.Metrics.html"><span class="hs-identifier">OutputGeneration.Metrics</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OutputGeneration.JSON.html"><span class="hs-identifier">OutputGeneration.JSON</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OutputGeneration.CallGraph.html"><span class="hs-identifier">OutputGeneration.CallGraph</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-comment">-- import Pass.ACode_Gen</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="X86.Conventions.html"><span class="hs-identifier">X86.Conventions</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="X86.Register.html"><span class="hs-identifier">X86.Register</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="X86.Register.html#Register"><span class="hs-identifier">Register</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="X86.Opcode.html"><span class="hs-identifier">X86.Opcode</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="X86.Instruction.html"><span class="hs-identifier">X86.Instruction</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Generic.Instruction.html"><span class="hs-identifier">Generic.Instruction</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Instr</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Generic.Operand.html"><span class="hs-identifier">Generic.Operand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Generic.Operand.html#GenericOperand"><span class="hs-identifier">GenericOperand</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readHex</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State.Strict</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">filterM</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Extra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">whenM</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IM</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IS</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">delete</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">isInfixOf</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">partition</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">nub</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Serialize</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Cereal</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">put</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readFile</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">writeFile</span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.IORef</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Process</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">callCommand</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Timeout</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">timeout</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">doesFileExist</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">createDirectoryIfMissing</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Exit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">die</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Identity</span></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Unsafe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafePerformIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span id="to_out_r"><span class="annot"><span class="annottext">to_out_r :: String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out_r"><span class="hs-identifier hs-var hs-var">to_out_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; StateT Context IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT Context IO ())
-&gt; (String -&gt; IO ()) -&gt; String -&gt; StateT Context IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span>
</span><span id="line-77"></span><span id="to_out"><span class="annot"><span class="annottext">to_out :: String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var hs-var">to_out</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Bool
-&gt; StateT Context IO () -&gt; StateT Context IO ()
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m () -&gt; m ()
</span><span class="hs-identifier hs-var">whenM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Context -&gt; Bool) -&gt; StateT Context IO Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; Bool
</span><a href="Analysis.Context.html#ctxt_verbose"><span class="hs-identifier hs-var">ctxt_verbose</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StateT Context IO () -&gt; StateT Context IO ())
-&gt; (String -&gt; StateT Context IO ())
-&gt; String
-&gt; StateT Context IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out_r"><span class="hs-identifier hs-var">to_out_r</span></a></span><span>
</span><span id="line-78"></span><span id="to_log"><span class="annot"><span class="annottext">to_log :: String -&gt; String -&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#to_log"><span class="hs-identifier hs-var hs-var">to_log</span></a></span></span><span> </span><span id="local-6989586621679360753"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360753"><span class="hs-identifier hs-var">log</span></a></span></span><span> </span><span id="local-6989586621679360752"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360752"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">appendFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360753"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360752"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | The main algorithm for lifting a binary to an L0 representation (i.e., a Hoare Graph)</span><span>
</span><span id="line-82"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#lift_to_L0"><span class="hs-identifier hs-type">lift_to_L0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span id="lift_to_L0"><span class="annot"><span class="annottext">lift_to_L0 :: StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#lift_to_L0"><span class="hs-identifier hs-var hs-var">lift_to_L0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-comment">-- 1.) read entry points, clear .indirections file</span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><span class="annottext">StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_read_and_set_entries"><span class="hs-identifier hs-var">ctxt_read_and_set_entries</span></a></span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><span class="annottext">StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_init_indirections"><span class="hs-identifier hs-var">ctxt_init_indirections</span></a></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-comment">-- 2.) repeatedly, do 2.1 -&gt; 2.3</span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><span class="annottext">StateT Context IO ()
</span><a href="#local-6989586621679360748"><span class="hs-identifier hs-var">repeat</span></a></span><span>
</span><span id="line-90"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-comment">-- 2.)</span><span>
</span><span id="line-92"></span><span>  </span><span id="local-6989586621679360748"><span class="annot"><span class="annottext">repeat :: StateT Context IO ()
</span><a href="#local-6989586621679360748"><span class="hs-identifier hs-var hs-var">repeat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-93"></span><span>    </span><span id="local-6989586621679360747"><span class="annot"><span class="annottext">Maybe (Int, IntSet)
</span><a href="#local-6989586621679360747"><span class="hs-identifier hs-var">reconsider</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO (Maybe (Int, IntSet))
</span><a href="Algorithm.L0_Lifting.html#ctxt_reconsider_mutual_recursive_call"><span class="hs-identifier hs-var">ctxt_reconsider_mutual_recursive_call</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, IntSet)
</span><a href="#local-6989586621679360747"><span class="hs-identifier hs-var">reconsider</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-95"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679360745"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360745"><span class="hs-identifier hs-var">entry</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360744"><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679360744"><span class="hs-identifier hs-var">trgts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-96"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n\nReconsidering (due to mutual recursion) entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360745"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; as all entries &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; String
</span><a href="Base.html#showHex_set"><span class="hs-identifier hs-var">showHex_set</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679360744"><span class="hs-identifier hs-var">trgts</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; are now done.&quot;</span></span><span>
</span><span id="line-97"></span><span>        </span><span id="local-6989586621679360741"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360741"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_recursions"><span class="hs-identifier hs-var">set_ctxt_recursions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IntMap IntSet -&gt; IntMap IntSet
forall a. Int -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.delete</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360745"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap IntSet -&gt; IntMap IntSet) -&gt; IntMap IntSet -&gt; IntMap IntSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap IntSet
</span><a href="Analysis.Context.html#ctxt_recursions"><span class="hs-identifier hs-var">ctxt_recursions</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360741"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap FReturnBehavior -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_calls"><span class="hs-identifier hs-var">set_ctxt_calls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IntMap FReturnBehavior -&gt; IntMap FReturnBehavior
forall a. Int -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.delete</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360745"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap FReturnBehavior -&gt; IntMap FReturnBehavior)
-&gt; IntMap FReturnBehavior -&gt; IntMap FReturnBehavior
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap FReturnBehavior
</span><a href="Analysis.Context.html#ctxt_calls"><span class="hs-identifier hs-var">ctxt_calls</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360741"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>        </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Graph -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_entries"><span class="hs-identifier hs-var">set_ctxt_entries</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph -&gt; Int -&gt; IntSet -&gt; Graph
</span><a href="Base.html#graph_add_edges"><span class="hs-identifier hs-var">graph_add_edges</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; Graph
</span><a href="Analysis.Context.html#ctxt_entries"><span class="hs-identifier hs-var">ctxt_entries</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360741"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360745"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><span class="hs-identifier hs-var">IS.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>        </span><span class="annot"><span class="annottext">StateT Context IO ()
</span><a href="#local-6989586621679360748"><span class="hs-identifier hs-var">repeat</span></a></span><span>
</span><span id="line-102"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Int, IntSet)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-103"></span><span>        </span><span id="local-6989586621679360729"><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679360729"><span class="hs-identifier hs-var">entries</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; Graph) -&gt; StateT Context IO Graph
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; Graph
</span><a href="Analysis.Context.html#ctxt_entries"><span class="hs-identifier hs-var">ctxt_entries</span></a></span><span>
</span><span id="line-104"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Graph -&gt; Maybe Int
</span><a href="Base.html#graph_find_next"><span class="hs-identifier hs-var">graph_find_next</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621679360729"><span class="hs-identifier hs-var">entries</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-105"></span><span>          </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StateT Context IO ()
</span><a href="#local-6989586621679360727"><span class="hs-identifier hs-var">ctxt_finish_repeat</span></a></span><span>
</span><span id="line-106"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679360726"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360726"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO ()
</span><a href="#local-6989586621679360725"><span class="hs-identifier hs-var">ctxt_run_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360726"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679360727"><span class="annot"><span class="annottext">ctxt_finish_repeat :: StateT Context IO ()
</span><a href="#local-6989586621679360727"><span class="hs-identifier hs-var hs-var">ctxt_finish_repeat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-109"></span><span>    </span><span id="local-6989586621679360724"><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679360724"><span class="hs-identifier hs-var">dangling_fptrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO [(Int, Int)]
</span><a href="Algorithm.L0_Lifting.html#ctxt_find_dangling_function_pointers"><span class="hs-identifier hs-var">ctxt_find_dangling_function_pointers</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Done!&quot;</span></span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; StateT Context IO () -&gt; StateT Context IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679360724"><span class="hs-identifier hs-var">dangling_fptrs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)] -&gt; [(Int, Int)] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StateT Context IO () -&gt; StateT Context IO ())
-&gt; StateT Context IO () -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-112"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out_r"><span class="hs-identifier hs-var">to_out_r</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-113"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out_r"><span class="hs-identifier hs-var">to_out_r</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-114"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out_r"><span class="hs-identifier hs-var">to_out_r</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Dangling function pointers found, which may point to function entries currently not analyzed.&quot;</span></span><span>
</span><span id="line-115"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out_r"><span class="hs-identifier hs-var">to_out_r</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;These require manual analysis: if they correspond to real function entries, add them to the .entry file&quot;</span></span><span>
</span><span id="line-116"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out_r"><span class="hs-identifier hs-var">to_out_r</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)] -&gt; String
forall b a.
(Integral b, Integral a, Show b, Show a) =&gt;
[(a, b)] -&gt; String
</span><a href="Algorithm.L0_Lifting.html#show_dangling_function_pointers"><span class="hs-identifier hs-var">show_dangling_function_pointers</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679360724"><span class="hs-identifier hs-var">dangling_fptrs</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-comment">-- 2.1) consider the current entry address $a$</span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621679360725"><span class="annot"><span class="annottext">ctxt_run_entry :: Int -&gt; StateT Context IO ()
</span><a href="#local-6989586621679360725"><span class="hs-identifier hs-var hs-var">ctxt_run_entry</span></a></span></span><span> </span><span id="local-6989586621679360719"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-comment">-- 2.2) Start analysis at entry-address $a$</span><span>
</span><span id="line-124"></span><span>    </span><span id="local-6989586621679360718"><span class="annot"><span class="annottext">IntMap FReturnBehavior
</span><a href="#local-6989586621679360718"><span class="hs-identifier hs-var">calls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; IntMap FReturnBehavior)
-&gt; StateT Context IO (IntMap FReturnBehavior)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap FReturnBehavior
</span><a href="Analysis.Context.html#ctxt_calls"><span class="hs-identifier hs-var">ctxt_calls</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621679360717"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679360717"><span class="hs-identifier hs-var">has_instruction</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; Bool) -&gt; StateT Context IO Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Context -&gt; Int -&gt; Bool) -&gt; Int -&gt; Context -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; Int -&gt; Bool
forall a. Integral a =&gt; Context -&gt; a -&gt; Bool
</span><a href="Analysis.Context.html#address_has_instruction"><span class="hs-identifier hs-var">address_has_instruction</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Context -&gt; Bool) -&gt; Int -&gt; Context -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IntMap FReturnBehavior -&gt; Maybe FReturnBehavior
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap FReturnBehavior
</span><a href="#local-6989586621679360718"><span class="hs-identifier hs-var">calls</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679360717"><span class="hs-identifier hs-var">has_instruction</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-keyword">of</span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FReturnBehavior
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-128"></span><span>        </span><span class="hs-comment">-- 2.2.1) Entry is already done, delete it and continue</span><span>
</span><span id="line-129"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_del_entry"><span class="hs-identifier hs-var">ctxt_del_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><span class="annottext">StateT Context IO ()
</span><a href="#local-6989586621679360748"><span class="hs-identifier hs-var">repeat</span></a></span><span>
</span><span id="line-131"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FReturnBehavior
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n\nEntry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; ignored.&quot;</span></span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_del_entry"><span class="hs-identifier hs-var">ctxt_del_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><span class="annottext">StateT Context IO ()
</span><a href="#local-6989586621679360748"><span class="hs-identifier hs-var">repeat</span></a></span><span>
</span><span id="line-135"></span><span>      </span><span class="annot"><span class="annottext">(Maybe FReturnBehavior, Bool)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n\nEntry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-137"></span><span>        </span><span class="hs-comment">-- 2.2.3) Entry is new, generate a CFG</span><span>
</span><span id="line-138"></span><span>        </span><span id="local-6989586621679360712"><span class="annot"><span class="annottext">Maybe CFG
</span><a href="#local-6989586621679360712"><span class="hs-identifier hs-var">curr_g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; Maybe CFG) -&gt; StateT Context IO (Maybe CFG)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IntMap CFG -&gt; Maybe CFG
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap CFG -&gt; Maybe CFG)
-&gt; (Context -&gt; IntMap CFG) -&gt; Context -&gt; Maybe CFG
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap CFG
</span><a href="Analysis.Context.html#ctxt_cfgs"><span class="hs-identifier hs-var">ctxt_cfgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679360710"><span class="annot"><span class="annottext">FInit
</span><a href="#local-6989586621679360710"><span class="hs-identifier hs-var">curr_finit</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360709"><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360709"><span class="hs-identifier hs-var">curr_invs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360708"><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360708"><span class="hs-identifier hs-var">curr_posts</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360707"><span class="annot"><span class="annottext">Set SStatePart
</span><a href="#local-6989586621679360707"><span class="hs-identifier hs-var">curr_sps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; StateT
     Context
     IO
     (FInit, Invariants, Set (NodeInfo, Predicate), Set SStatePart)
</span><a href="Algorithm.L0_Lifting.html#ctxt_get_curr_posts"><span class="hs-identifier hs-var">ctxt_get_curr_posts</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: starting CFG generation.&quot;</span></span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO (Set (Instruction, Int))
</span><a href="Algorithm.L0_Lifting.html#ctxt_generate_cfg"><span class="hs-identifier hs-var">ctxt_generate_cfg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><span class="annottext">Int
-&gt; Invariants
-&gt; Set (NodeInfo, Predicate)
-&gt; Set SStatePart
-&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_generate_invs"><span class="hs-identifier hs-var">ctxt_generate_invs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360709"><span class="hs-identifier hs-var">curr_invs</span></a></span><span> </span><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360708"><span class="hs-identifier hs-var">curr_posts</span></a></span><span> </span><span class="annot"><span class="annottext">Set SStatePart
</span><a href="#local-6989586621679360707"><span class="hs-identifier hs-var">curr_sps</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span>        </span><span id="local-6989586621679360703"><span class="annot"><span class="annottext">Maybe CFG
</span><a href="#local-6989586621679360703"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; Maybe CFG) -&gt; StateT Context IO (Maybe CFG)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IntMap CFG -&gt; Maybe CFG
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap CFG -&gt; Maybe CFG)
-&gt; (Context -&gt; IntMap CFG) -&gt; Context -&gt; Maybe CFG
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap CFG
</span><a href="Analysis.Context.html#ctxt_cfgs"><span class="hs-identifier hs-var">ctxt_cfgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679360702"><span class="annot"><span class="annottext">FInit
</span><a href="#local-6989586621679360702"><span class="hs-identifier hs-var">finit</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360701"><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360701"><span class="hs-identifier hs-var">invs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360700"><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360700"><span class="hs-identifier hs-var">posts</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360699"><span class="annot"><span class="annottext">Set SStatePart
</span><a href="#local-6989586621679360699"><span class="hs-identifier hs-var">sps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; StateT
     Context
     IO
     (FInit, Invariants, Set (NodeInfo, Predicate), Set SStatePart)
</span><a href="Algorithm.L0_Lifting.html#ctxt_get_curr_posts"><span class="hs-identifier hs-var">ctxt_get_curr_posts</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-148"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360698"><span class="annot"><span class="annottext">do_repeat :: Bool
</span><a href="#local-6989586621679360698"><span class="hs-identifier hs-var hs-var">do_repeat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CFG
</span><a href="#local-6989586621679360712"><span class="hs-identifier hs-var">curr_g</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CFG -&gt; Maybe CFG -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Maybe CFG
</span><a href="#local-6989586621679360703"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Set SStatePart
</span><a href="#local-6989586621679360707"><span class="hs-identifier hs-var">curr_sps</span></a></span><span> </span><span class="annot"><span class="annottext">Set SStatePart -&gt; Set SStatePart -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Set SStatePart
</span><a href="#local-6989586621679360699"><span class="hs-identifier hs-var">sps</span></a></span><span> </span><span class="hs-comment">-- TODO why sps, not posts?</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>        </span><span id="local-6989586621679360696"><span class="annot"><span class="annottext">[(Int, FInit)]
</span><a href="#local-6989586621679360696"><span class="hs-identifier hs-var">new_calls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO [(Int, FInit)]
forall a. (Eq a, Num a) =&gt; Int -&gt; StateT Context IO [(a, FInit)]
</span><a href="Algorithm.L0_Lifting.html#ctxt_get_new_calls"><span class="hs-identifier hs-var">ctxt_get_new_calls</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-151"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[(Int, FInit)]
</span><a href="#local-6989586621679360696"><span class="hs-identifier hs-var">new_calls</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, FInit)] -&gt; [(Int, FInit)] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: no new entries.&quot;</span></span><span>
</span><span id="line-153"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Bool -&gt; StateT Context IO ()
</span><a href="#local-6989586621679360694"><span class="hs-identifier hs-var">ctxt_after_invgen</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679360698"><span class="hs-identifier hs-var">do_repeat</span></a></span><span> </span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-155"></span><span>          </span><span class="annot"><span class="annottext">((Int, FInit) -&gt; StateT Context IO ())
-&gt; [(Int, FInit)] -&gt; StateT Context IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (Int, FInit) -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_add_entry_edge"><span class="hs-identifier hs-var">ctxt_add_entry_edge</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, FInit)]
</span><a href="#local-6989586621679360696"><span class="hs-identifier hs-var">new_calls</span></a></span><span>
</span><span id="line-156"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360719"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: Adding new internal functions at &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; String
forall a. (Integral a, Show a) =&gt; [a] -&gt; String
</span><a href="Base.html#showHex_list"><span class="hs-identifier hs-var">showHex_list</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, FInit) -&gt; Int) -&gt; [(Int, FInit)] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Int, FInit) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Int, FInit)]
</span><a href="#local-6989586621679360696"><span class="hs-identifier hs-var">new_calls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; to graph of entries.&quot;</span></span><span>
</span><span id="line-157"></span><span>          </span><span class="annot"><span class="annottext">StateT Context IO ()
</span><a href="#local-6989586621679360748"><span class="hs-identifier hs-var">repeat</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-comment">-- 2.3) Analyze a CFG, either needing a new round (in case of newly resolved indirections) are not.</span><span>
</span><span id="line-160"></span><span>  </span><span id="local-6989586621679360694"><span class="annot"><span class="annottext">ctxt_after_invgen :: Int -&gt; Bool -&gt; StateT Context IO ()
</span><a href="#local-6989586621679360694"><span class="hs-identifier hs-var hs-var">ctxt_after_invgen</span></a></span></span><span> </span><span id="local-6989586621679360690"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360690"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span id="local-6989586621679360689"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679360689"><span class="hs-identifier hs-var">do_repeat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-comment">-- analyze unresolved jumps</span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621679360688"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679360688"><span class="hs-identifier hs-var">continue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO Bool
</span><a href="Algorithm.L0_Lifting.html#ctxt_analyze_unresolved_indirections"><span class="hs-identifier hs-var">ctxt_analyze_unresolved_indirections</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360690"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679360688"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-164"></span><span>      </span><span class="hs-comment">-- if new jumps where resolved, repeat with current function</span><span>
</span><span id="line-165"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360690"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: Continuing to next round as there are newly resolved indirections.&quot;</span></span><span>
</span><span id="line-166"></span><span>      </span><span class="annot"><span class="annottext">StateT Context IO ()
</span><a href="#local-6989586621679360748"><span class="hs-identifier hs-var">repeat</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679360689"><span class="hs-identifier hs-var">do_repeat</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-168"></span><span>      </span><span class="hs-comment">-- if new invariants were found, repeat with current function</span><span>
</span><span id="line-169"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360690"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: Continuing to next round as CFG or invariants where refined.&quot;</span></span><span>
</span><span id="line-170"></span><span>      </span><span class="annot"><span class="annottext">StateT Context IO ()
</span><a href="#local-6989586621679360748"><span class="hs-identifier hs-var">repeat</span></a></span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-comment">-- if no new jumps where resolved, this function is done: store entry address as an analyzed call and pop the entry-stack</span><span>
</span><span id="line-173"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360690"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: Terminating as no new indirections are resolved.&quot;</span></span><span>
</span><span id="line-174"></span><span>      </span><span id="local-6989586621679360686"><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621679360686"><span class="hs-identifier hs-var">verified</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO VerificationResult
</span><a href="Algorithm.L0_Lifting.html#ctxt_verify_proper_return"><span class="hs-identifier hs-var">ctxt_verify_proper_return</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360690"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-175"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360690"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: Verified == &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VerificationResult -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621679360686"><span class="hs-identifier hs-var">verified</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; VerificationResult -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_add_call"><span class="hs-identifier hs-var">ctxt_add_call</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360690"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621679360686"><span class="hs-identifier hs-var">verified</span></a></span><span>
</span><span id="line-178"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_del_entry"><span class="hs-identifier hs-var">ctxt_del_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360690"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-179"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; VerificationResult -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_add_to_results"><span class="hs-identifier hs-var">ctxt_add_to_results</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360690"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621679360686"><span class="hs-identifier hs-var">verified</span></a></span><span>
</span><span id="line-180"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_get_recursive_calls"><span class="hs-identifier hs-var">ctxt_get_recursive_calls</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360690"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><span class="annottext">StateT Context IO ()
</span><a href="#local-6989586621679360748"><span class="hs-identifier hs-var">repeat</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#ctxt_find_dangling_function_pointers"><span class="hs-identifier hs-type">ctxt_find_dangling_function_pointers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-186"></span><span id="ctxt_find_dangling_function_pointers"><span class="annot"><span class="annottext">ctxt_find_dangling_function_pointers :: StateT Context IO [(Int, Int)]
</span><a href="Algorithm.L0_Lifting.html#ctxt_find_dangling_function_pointers"><span class="hs-identifier hs-var hs-var">ctxt_find_dangling_function_pointers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-187"></span><span>  </span><span id="local-6989586621679360680"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360680"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360679"><span class="annot"><span class="annottext">ptrs :: [(Int, Int)]
</span><a href="#local-6989586621679360679"><span class="hs-identifier hs-var hs-var">ptrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VerificationCondition -&gt; [(Int, Int)])
-&gt; [VerificationCondition] -&gt; [(Int, Int)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">VerificationCondition -&gt; [(Int, Int)]
forall a. Num a =&gt; VerificationCondition -&gt; [(a, Int)]
</span><a href="#local-6989586621679360677"><span class="hs-identifier hs-var">mk_function_pointer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set VerificationCondition -&gt; [VerificationCondition]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">S.toList</span></span><span> </span><span class="annot"><span class="annottext">(Set VerificationCondition -&gt; [VerificationCondition])
-&gt; Set VerificationCondition -&gt; [VerificationCondition]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap (Set VerificationCondition) -&gt; Set VerificationCondition
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">S.unions</span></span><span> </span><span class="annot"><span class="annottext">(IntMap (Set VerificationCondition) -&gt; Set VerificationCondition)
-&gt; IntMap (Set VerificationCondition) -&gt; Set VerificationCondition
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap (Set VerificationCondition)
</span><a href="Analysis.Context.html#ctxt_vcs"><span class="hs-identifier hs-var">ctxt_vcs</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360680"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><span class="annottext">((Int, Int) -&gt; StateT Context IO Bool)
-&gt; [(Int, Int)] -&gt; StateT Context IO [(Int, Int)]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; StateT Context IO Bool
forall (m :: * -&gt; *) a. MonadState Context m =&gt; (a, Int) -&gt; m Bool
</span><a href="#local-6989586621679360673"><span class="hs-identifier hs-var">is_dangling</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679360679"><span class="hs-identifier hs-var">ptrs</span></a></span><span>
</span><span id="line-190"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-191"></span><span>  </span><span id="local-6989586621679360677"><span class="annot"><span class="annottext">mk_function_pointer :: VerificationCondition -&gt; [(a, Int)]
</span><a href="#local-6989586621679360677"><span class="hs-identifier hs-var hs-var">mk_function_pointer</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Generic.SymbolicConstituents.html#FunctionPointers"><span class="hs-identifier hs-type">FunctionPointers</span></a></span><span> </span><span id="local-6989586621679360671"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360671"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679360670"><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679360670"><span class="hs-identifier hs-var">ptrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; (a, Int)) -&gt; [Int] -&gt; [(a, Int)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Int -&gt; (a, Int)
forall a b. a -&gt; b -&gt; (a, b)
</span><a href="Base.html#pair"><span class="hs-identifier hs-var">pair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360671"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; [(a, Int)]) -&gt; [Int] -&gt; [(a, Int)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; [Int]
</span><span class="hs-identifier hs-var">IS.toList</span></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679360670"><span class="hs-identifier hs-var">ptrs</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><a href="#local-6989586621679360677"><span class="hs-identifier hs-var">mk_function_pointer</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationCondition
</span><span class="hs-identifier">_</span></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621679360673"><span class="annot"><span class="annottext">is_dangling :: (a, Int) -&gt; m Bool
</span><a href="#local-6989586621679360673"><span class="hs-identifier hs-var hs-var">is_dangling</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679360667"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360667"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360666"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360666"><span class="hs-identifier hs-var">ptr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-195"></span><span>    </span><span id="local-6989586621679360665"><span class="annot"><span class="annottext">IntMap FReturnBehavior
</span><a href="#local-6989586621679360665"><span class="hs-identifier hs-var">calls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; IntMap FReturnBehavior) -&gt; m (IntMap FReturnBehavior)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap FReturnBehavior
</span><a href="Analysis.Context.html#ctxt_calls"><span class="hs-identifier hs-var">ctxt_calls</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; m Bool) -&gt; Bool -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap FReturnBehavior -&gt; Maybe FReturnBehavior
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360666"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap FReturnBehavior
</span><a href="#local-6989586621679360665"><span class="hs-identifier hs-var">calls</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FReturnBehavior -&gt; Maybe FReturnBehavior -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe FReturnBehavior
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-197"></span><span>    </span><span>
</span><span id="line-198"></span><span>    </span><span>
</span><span id="line-199"></span><span id="show_dangling_function_pointers"><span class="annot"><span class="annottext">show_dangling_function_pointers :: [(a, b)] -&gt; String
</span><a href="Algorithm.L0_Lifting.html#show_dangling_function_pointers"><span class="hs-identifier hs-var hs-var">show_dangling_function_pointers</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-200"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#show_dangling_function_pointers"><span class="hs-identifier hs-var">show_dangling_function_pointers</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679360664"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360664"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360663"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679360663"><span class="hs-identifier hs-var">fptr</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679360662"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679360662"><span class="hs-identifier hs-var">fptrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679360661"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679360661"><span class="hs-identifier hs-var">match</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360660"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679360660"><span class="hs-identifier hs-var">remaining</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, b) -&gt; Bool) -&gt; [(a, b)] -&gt; ([(a, b)], [(a, b)])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; Bool
forall a. (a, b) -&gt; Bool
</span><a href="#local-6989586621679360659"><span class="hs-identifier hs-var">does_match</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679360662"><span class="hs-identifier hs-var">fptrs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Function pointer &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679360663"><span class="hs-identifier hs-var">fptr</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; introduced at &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; String
forall a. (Integral a, Show a) =&gt; [a] -&gt; String
</span><a href="Base.html#showHex_list"><span class="hs-identifier hs-var">showHex_list</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360664"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">((a, b) -&gt; a) -&gt; [(a, b)] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span>  </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679360661"><span class="hs-identifier hs-var">match</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; String
</span><a href="Algorithm.L0_Lifting.html#show_dangling_function_pointers"><span class="hs-identifier hs-var">show_dangling_function_pointers</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679360660"><span class="hs-identifier hs-var">remaining</span></a></span><span>
</span><span id="line-203"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621679360659"><span class="annot"><span class="annottext">does_match :: (a, b) -&gt; Bool
</span><a href="#local-6989586621679360659"><span class="hs-identifier hs-var hs-var">does_match</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679360658"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679360658"><span class="hs-identifier hs-var">fptr'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679360663"><span class="hs-identifier hs-var">fptr</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679360658"><span class="hs-identifier hs-var">fptr'</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#ctxt_get_recursive_calls"><span class="hs-identifier hs-type">ctxt_get_recursive_calls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span id="ctxt_get_recursive_calls"><span class="annot"><span class="annottext">ctxt_get_recursive_calls :: Int -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_get_recursive_calls"><span class="hs-identifier hs-var hs-var">ctxt_get_recursive_calls</span></a></span></span><span> </span><span id="local-6989586621679360657"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360657"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621679360656"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360656"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360655"><span class="annot"><span class="annottext">g :: CFG
</span><a href="#local-6989586621679360655"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap CFG
</span><a href="Analysis.Context.html#ctxt_cfgs"><span class="hs-identifier hs-var">ctxt_cfgs</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360656"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap CFG -&gt; Int -&gt; CFG
forall a. IntMap a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">IM.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360657"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360653"><span class="annot"><span class="annottext">recursions :: IntSet
</span><a href="#local-6989586621679360653"><span class="hs-identifier hs-var hs-var">recursions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; IntSet
</span><span class="hs-identifier hs-var">IS.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; IntSet) -&gt; [Int] -&gt; IntSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Int] -&gt; [Int]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">([Maybe Int] -&gt; [Int]) -&gt; [Maybe Int] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Maybe Int]] -&gt; [Maybe Int]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Maybe Int]] -&gt; [Maybe Int]) -&gt; [[Maybe Int]] -&gt; [Maybe Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Instruction] -&gt; [[Maybe Int]])
-&gt; [[Instruction]] -&gt; [[Maybe Int]]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; [Instruction] -&gt; [[Maybe Int]]
forall a. Num a =&gt; Context -&gt; [Instruction] -&gt; [[Maybe a]]
</span><a href="#local-6989586621679360650"><span class="hs-identifier hs-var">get_new_calls</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360656"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[Instruction]] -&gt; [[Maybe Int]])
-&gt; [[Instruction]] -&gt; [[Maybe Int]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap [Instruction] -&gt; [[Instruction]]
forall a. IntMap a -&gt; [a]
</span><span class="hs-identifier hs-var">IM.elems</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [Instruction] -&gt; [[Instruction]])
-&gt; IntMap [Instruction] -&gt; [[Instruction]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CFG -&gt; IntMap [Instruction]
</span><a href="Analysis.Context.html#cfg_instrs"><span class="hs-identifier hs-var hs-var">cfg_instrs</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360655"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; StateT Context IO () -&gt; StateT Context IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; Bool
</span><span class="hs-identifier hs-var">IS.null</span></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679360653"><span class="hs-identifier hs-var">recursions</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StateT Context IO () -&gt; StateT Context IO ())
-&gt; StateT Context IO () -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_recursions"><span class="hs-identifier hs-var">set_ctxt_recursions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(IntSet -&gt; IntSet -&gt; IntSet)
-&gt; Int -&gt; IntSet -&gt; IntMap IntSet -&gt; IntMap IntSet
forall a. (a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insertWith</span></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; IntSet -&gt; IntSet
</span><span class="hs-identifier hs-var">IS.union</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360657"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679360653"><span class="hs-identifier hs-var">recursions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; IntMap IntSet
</span><a href="Analysis.Context.html#ctxt_recursions"><span class="hs-identifier hs-var">ctxt_recursions</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360656"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360657"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; is part of mutual recursion and treated entries &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; String
</span><a href="Base.html#showHex_set"><span class="hs-identifier hs-var">showHex_set</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679360653"><span class="hs-identifier hs-var">recursions</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; as external. It will be reconsidered after those entries have been done.&quot;</span></span><span>
</span><span id="line-217"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621679360650"><span class="annot"><span class="annottext">get_new_calls :: Context -&gt; [Instruction] -&gt; [[Maybe a]]
</span><a href="#local-6989586621679360650"><span class="hs-identifier hs-var hs-var">get_new_calls</span></a></span></span><span> </span><span id="local-6989586621679360643"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360643"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679360642"><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679360642"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Instruction -&gt; [Maybe a]) -&gt; [Instruction] -&gt; [[Maybe a]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; Instruction -&gt; [Maybe a]
forall a. Num a =&gt; Context -&gt; Instruction -&gt; [Maybe a]
</span><a href="#local-6989586621679360641"><span class="hs-identifier hs-var">get_new_call</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360643"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679360642"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span id="local-6989586621679360641"><span class="annot"><span class="annottext">get_new_call :: Context -&gt; Instruction -&gt; [Maybe a]
</span><a href="#local-6989586621679360641"><span class="hs-identifier hs-var hs-var">get_new_call</span></a></span></span><span>  </span><span id="local-6989586621679360640"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360640"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679360639"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679360639"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; Bool
</span><a href="X86.Opcode.html#isCall"><span class="hs-identifier hs-var">isCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; Opcode
forall label storage prefix opcode annotation.
GenericInstruction label storage prefix opcode annotation -&gt; opcode
</span><a href="Generic.Instruction.html#opcode"><span class="hs-identifier hs-var hs-var">Instr.opcode</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679360639"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-221"></span><span>      </span><span class="annot"><span class="annottext">(ResolvedJumpTarget -&gt; Maybe a)
-&gt; [ResolvedJumpTarget] -&gt; [Maybe a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; ResolvedJumpTarget -&gt; Maybe a
forall a. Num a =&gt; Context -&gt; ResolvedJumpTarget -&gt; Maybe a
</span><a href="#local-6989586621679360636"><span class="hs-identifier hs-var">when_trgt_is_not_done_yet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360640"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ResolvedJumpTarget] -&gt; [Maybe a])
-&gt; [ResolvedJumpTarget] -&gt; [Maybe a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; Instruction -&gt; [ResolvedJumpTarget]
</span><a href="Analysis.ControlFlow.html#resolve_jump_target"><span class="hs-identifier hs-var">resolve_jump_target</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360640"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679360639"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-223"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621679360636"><span class="annot"><span class="annottext">when_trgt_is_not_done_yet :: Context -&gt; ResolvedJumpTarget -&gt; Maybe a
</span><a href="#local-6989586621679360636"><span class="hs-identifier hs-var hs-var">when_trgt_is_not_done_yet</span></a></span></span><span> </span><span id="local-6989586621679360634"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360634"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.JumpTarget.html#ImmediateAddress"><span class="hs-identifier hs-type">ImmediateAddress</span></a></span><span> </span><span id="local-6989586621679360632"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360632"><span class="hs-identifier hs-var">trgt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IntMap FReturnBehavior -&gt; Maybe FReturnBehavior
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360632"><span class="hs-identifier hs-var">trgt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IntMap FReturnBehavior -&gt; Maybe FReturnBehavior)
-&gt; IntMap FReturnBehavior -&gt; Maybe FReturnBehavior
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap FReturnBehavior
</span><a href="Analysis.Context.html#ctxt_calls"><span class="hs-identifier hs-var">ctxt_calls</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360634"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-227"></span><span>      </span><span class="annot"><span class="annottext">Maybe FReturnBehavior
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; a -&gt; Maybe a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360632"><span class="hs-identifier hs-var">trgt</span></a></span><span>
</span><span id="line-228"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FReturnBehavior
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><a href="#local-6989586621679360636"><span class="hs-identifier hs-var">when_trgt_is_not_done_yet</span></a></span><span> </span><span id="local-6989586621679360631"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360631"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="annot"><span class="annottext">ResolvedJumpTarget
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#ctxt_reconsider_mutual_recursive_call"><span class="hs-identifier hs-type">ctxt_reconsider_mutual_recursive_call</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">IS.IntSet</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span id="ctxt_reconsider_mutual_recursive_call"><span class="annot"><span class="annottext">ctxt_reconsider_mutual_recursive_call :: StateT Context IO (Maybe (Int, IntSet))
</span><a href="Algorithm.L0_Lifting.html#ctxt_reconsider_mutual_recursive_call"><span class="hs-identifier hs-var hs-var">ctxt_reconsider_mutual_recursive_call</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-234"></span><span>  </span><span id="local-6989586621679360630"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360630"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-235"></span><span>  </span><span id="local-6989586621679360629"><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679360629"><span class="hs-identifier hs-var">recursions</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; IntMap IntSet) -&gt; StateT Context IO (IntMap IntSet)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap IntSet
</span><a href="Analysis.Context.html#ctxt_recursions"><span class="hs-identifier hs-var">ctxt_recursions</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Int, IntSet) -&gt; StateT Context IO (Maybe (Int, IntSet))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Int, IntSet) -&gt; StateT Context IO (Maybe (Int, IntSet)))
-&gt; Maybe (Int, IntSet) -&gt; StateT Context IO (Maybe (Int, IntSet))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Int, IntSet) -&gt; Bool) -&gt; [(Int, IntSet)] -&gt; Maybe (Int, IntSet)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; (Int, IntSet) -&gt; Bool
forall a. Context -&gt; (a, IntSet) -&gt; Bool
</span><a href="#local-6989586621679360627"><span class="hs-identifier hs-var">to_be_reconsidered</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360630"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, IntSet)] -&gt; Maybe (Int, IntSet))
-&gt; [(Int, IntSet)] -&gt; Maybe (Int, IntSet)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet -&gt; [(Int, IntSet)]
forall a. IntMap a -&gt; [(Int, a)]
</span><span class="hs-identifier hs-var">IM.toList</span></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679360629"><span class="hs-identifier hs-var">recursions</span></a></span><span>
</span><span id="line-237"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621679360627"><span class="annot"><span class="annottext">to_be_reconsidered :: Context -&gt; (a, IntSet) -&gt; Bool
</span><a href="#local-6989586621679360627"><span class="hs-identifier hs-var hs-var">to_be_reconsidered</span></a></span></span><span> </span><span id="local-6989586621679360625"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360625"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679360624"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360624"><span class="hs-identifier hs-var">entry</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360623"><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679360623"><span class="hs-identifier hs-var">trgts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679360621"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360621"><span class="hs-identifier hs-var">trgt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap FReturnBehavior -&gt; Maybe FReturnBehavior
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360621"><span class="hs-identifier hs-var">trgt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; IntMap FReturnBehavior
</span><a href="Analysis.Context.html#ctxt_calls"><span class="hs-identifier hs-var">ctxt_calls</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360625"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe FReturnBehavior -&gt; Maybe FReturnBehavior -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Maybe FReturnBehavior
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Bool) -&gt; [Int] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; [Int]
</span><span class="hs-identifier hs-var">IS.toList</span></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="#local-6989586621679360623"><span class="hs-identifier hs-var">trgts</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span id="ctxt_get_new_calls"><span class="annot"><span class="annottext">ctxt_get_new_calls :: Int -&gt; StateT Context IO [(a, FInit)]
</span><a href="Algorithm.L0_Lifting.html#ctxt_get_new_calls"><span class="hs-identifier hs-var hs-var">ctxt_get_new_calls</span></a></span></span><span> </span><span id="local-6989586621679360620"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360620"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621679360619"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360619"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621679360618"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360618"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO FContext
</span><a href="Algorithm.L0_Lifting.html#ctxt_mk_fcontext"><span class="hs-identifier hs-var">ctxt_mk_fcontext</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360620"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360616"><span class="annot"><span class="annottext">g :: CFG
</span><a href="#local-6989586621679360616"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap CFG
</span><a href="Analysis.Context.html#ctxt_cfgs"><span class="hs-identifier hs-var">ctxt_cfgs</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360619"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap CFG -&gt; Int -&gt; CFG
forall a. IntMap a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">IM.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360620"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><span class="annottext">[(a, FInit)] -&gt; StateT Context IO [(a, FInit)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([(a, FInit)] -&gt; StateT Context IO [(a, FInit)])
-&gt; [(a, FInit)] -&gt; StateT Context IO [(a, FInit)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FContext -&gt; [(a, FInit)] -&gt; [(a, FInit)]
forall a. Eq a =&gt; FContext -&gt; [(a, FInit)] -&gt; [(a, FInit)]
</span><a href="#local-6989586621679360615"><span class="hs-identifier hs-var">gather</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360618"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">([(a, FInit)] -&gt; [(a, FInit)]) -&gt; [(a, FInit)] -&gt; [(a, FInit)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (a, FInit)] -&gt; [(a, FInit)]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">([Maybe (a, FInit)] -&gt; [(a, FInit)])
-&gt; [Maybe (a, FInit)] -&gt; [(a, FInit)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Maybe (a, FInit)]] -&gt; [Maybe (a, FInit)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Maybe (a, FInit)]] -&gt; [Maybe (a, FInit)])
-&gt; [[Maybe (a, FInit)]] -&gt; [Maybe (a, FInit)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Instruction] -&gt; [[Maybe (a, FInit)]])
-&gt; [[Instruction]] -&gt; [[Maybe (a, FInit)]]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext -&gt; [Instruction] -&gt; [[Maybe (a, FInit)]]
forall a.
Num a =&gt;
FContext -&gt; [Instruction] -&gt; [[Maybe (a, FInit)]]
</span><a href="#local-6989586621679360614"><span class="hs-identifier hs-var">get_new_calls</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360618"><span class="hs-identifier hs-var">fctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[Instruction]] -&gt; [[Maybe (a, FInit)]])
-&gt; [[Instruction]] -&gt; [[Maybe (a, FInit)]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap [Instruction] -&gt; [[Instruction]]
forall a. IntMap a -&gt; [a]
</span><span class="hs-identifier hs-var">IM.elems</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [Instruction] -&gt; [[Instruction]])
-&gt; IntMap [Instruction] -&gt; [[Instruction]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CFG -&gt; IntMap [Instruction]
</span><a href="Analysis.Context.html#cfg_instrs"><span class="hs-identifier hs-var hs-var">cfg_instrs</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360616"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-251"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621679360614"><span class="annot"><span class="annottext">get_new_calls :: FContext -&gt; [Instruction] -&gt; [[Maybe (a, FInit)]]
</span><a href="#local-6989586621679360614"><span class="hs-identifier hs-var hs-var">get_new_calls</span></a></span></span><span> </span><span id="local-6989586621679360613"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360613"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span> </span><span id="local-6989586621679360612"><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679360612"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Instruction -&gt; [Maybe (a, FInit)])
-&gt; [Instruction] -&gt; [[Maybe (a, FInit)]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext -&gt; Instruction -&gt; [Maybe (a, FInit)]
forall a. Num a =&gt; FContext -&gt; Instruction -&gt; [Maybe (a, FInit)]
</span><a href="#local-6989586621679360611"><span class="hs-identifier hs-var">get_new_call</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360613"><span class="hs-identifier hs-var">fctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679360612"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span id="local-6989586621679360611"><span class="annot"><span class="annottext">get_new_call :: FContext -&gt; Instruction -&gt; [Maybe (a, FInit)]
</span><a href="#local-6989586621679360611"><span class="hs-identifier hs-var hs-var">get_new_call</span></a></span></span><span>  </span><span id="local-6989586621679360610"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360610"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span> </span><span id="local-6989586621679360609"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679360609"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; Bool
</span><a href="X86.Opcode.html#isCall"><span class="hs-identifier hs-var">isCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; Opcode
forall label storage prefix opcode annotation.
GenericInstruction label storage prefix opcode annotation -&gt; opcode
</span><a href="Generic.Instruction.html#opcode"><span class="hs-identifier hs-var hs-var">Instr.opcode</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679360609"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Opcode -&gt; Bool
</span><a href="X86.Opcode.html#isJump"><span class="hs-identifier hs-var">isJump</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; Opcode
forall label storage prefix opcode annotation.
GenericInstruction label storage prefix opcode annotation -&gt; opcode
</span><a href="Generic.Instruction.html#opcode"><span class="hs-identifier hs-var hs-var">Instr.opcode</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679360609"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; Instruction -&gt; Bool
</span><a href="Analysis.ControlFlow.html#jump_is_actually_a_call"><span class="hs-identifier hs-var">jump_is_actually_a_call</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext -&gt; Context
</span><a href="Analysis.Context.html#f_ctxt"><span class="hs-identifier hs-var hs-var">f_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360610"><span class="hs-identifier hs-var">fctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679360609"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-255"></span><span>       </span><span class="annot"><span class="annottext">(ResolvedJumpTarget -&gt; Maybe (a, FInit))
-&gt; [ResolvedJumpTarget] -&gt; [Maybe (a, FInit)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext -&gt; Instruction -&gt; ResolvedJumpTarget -&gt; Maybe (a, FInit)
forall a storage prefix opcode annotation.
Num a =&gt;
FContext
-&gt; GenericInstruction
     AddressWord64 storage prefix opcode annotation
-&gt; ResolvedJumpTarget
-&gt; Maybe (a, FInit)
</span><a href="#local-6989586621679360604"><span class="hs-identifier hs-var">trgt_to_finit</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360610"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679360609"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ResolvedJumpTarget] -&gt; [Maybe (a, FInit)])
-&gt; [ResolvedJumpTarget] -&gt; [Maybe (a, FInit)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; Instruction -&gt; [ResolvedJumpTarget]
</span><a href="Analysis.ControlFlow.html#resolve_jump_target"><span class="hs-identifier hs-var">resolve_jump_target</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext -&gt; Context
</span><a href="Analysis.Context.html#f_ctxt"><span class="hs-identifier hs-var hs-var">f_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360610"><span class="hs-identifier hs-var">fctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679360609"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-257"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621679360604"><span class="annot"><span class="annottext">trgt_to_finit :: FContext
-&gt; GenericInstruction
     AddressWord64 storage prefix opcode annotation
-&gt; ResolvedJumpTarget
-&gt; Maybe (a, FInit)
</span><a href="#local-6989586621679360604"><span class="hs-identifier hs-var hs-var">trgt_to_finit</span></a></span></span><span> </span><span id="local-6989586621679360603"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360603"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span> </span><span id="local-6989586621679360602"><span class="annot"><span class="annottext">GenericInstruction AddressWord64 storage prefix opcode annotation
</span><a href="#local-6989586621679360602"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.JumpTarget.html#ImmediateAddress"><span class="hs-identifier hs-type">ImmediateAddress</span></a></span><span> </span><span id="local-6989586621679360601"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360601"><span class="hs-identifier hs-var">trgt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-260"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360600"><span class="annot"><span class="annottext">ctxt :: Context
</span><a href="#local-6989586621679360600"><span class="hs-identifier hs-var hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FContext -&gt; Context
</span><a href="Analysis.Context.html#f_ctxt"><span class="hs-identifier hs-var hs-var">f_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360603"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IntMap FReturnBehavior -&gt; Maybe FReturnBehavior
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360601"><span class="hs-identifier hs-var">trgt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IntMap FReturnBehavior -&gt; Maybe FReturnBehavior)
-&gt; IntMap FReturnBehavior -&gt; Maybe FReturnBehavior
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap FReturnBehavior
</span><a href="Analysis.Context.html#ctxt_calls"><span class="hs-identifier hs-var">ctxt_calls</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360600"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap FInit -&gt; Maybe FInit
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360601"><span class="hs-identifier hs-var">trgt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IntMap FInit -&gt; Maybe FInit) -&gt; IntMap FInit -&gt; Maybe FInit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap FInit
</span><a href="Analysis.Context.html#ctxt_finits"><span class="hs-identifier hs-var">ctxt_finits</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360600"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FContext -&gt; Int -&gt; Maybe Predicate
</span><a href="Instantiation.SymbolicPropagation.html#get_invariant"><span class="hs-identifier hs-var">get_invariant</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360603"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Maybe Predicate) -&gt; Int -&gt; Maybe Predicate
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Int) -&gt; Word64 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenericInstruction AddressWord64 storage prefix opcode annotation
-&gt; Word64
forall storage prefix opcode annotation.
GenericInstruction AddressWord64 storage prefix opcode annotation
-&gt; Word64
</span><a href="X86.Instruction.html#addressof"><span class="hs-identifier hs-var">addressof</span></a></span><span> </span><span class="annot"><span class="annottext">GenericInstruction AddressWord64 storage prefix opcode annotation
</span><a href="#local-6989586621679360602"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-262"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FReturnBehavior
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe FInit
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679360596"><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360596"><span class="hs-identifier hs-var">inv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, FInit) -&gt; Maybe (a, FInit)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((a, FInit) -&gt; Maybe (a, FInit)) -&gt; (a, FInit) -&gt; Maybe (a, FInit)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360601"><span class="hs-identifier hs-var">trgt</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FContext -&gt; Predicate -&gt; FInit
</span><a href="Instantiation.SymbolicPropagation.html#invariant_to_finit"><span class="hs-identifier hs-var">invariant_to_finit</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360603"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360596"><span class="hs-identifier hs-var">inv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FReturnBehavior
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679360594"><span class="annot"><span class="annottext">FInit
</span><a href="#local-6989586621679360594"><span class="hs-identifier hs-var">finit</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679360593"><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360593"><span class="hs-identifier hs-var">inv</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-264"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360592"><span class="annot"><span class="annottext">finit' :: FInit
</span><a href="#local-6989586621679360592"><span class="hs-identifier hs-var hs-var">finit'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FContext -&gt; FInit -&gt; FInit -&gt; FInit
</span><a href="Instantiation.SymbolicPropagation.html#join_finit"><span class="hs-identifier hs-var">join_finit</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360603"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext -&gt; Predicate -&gt; FInit
</span><a href="Instantiation.SymbolicPropagation.html#invariant_to_finit"><span class="hs-identifier hs-var">invariant_to_finit</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360603"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360593"><span class="hs-identifier hs-var">inv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FInit
</span><a href="#local-6989586621679360594"><span class="hs-identifier hs-var">finit</span></a></span><span>
</span><span id="line-265"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FInit
</span><a href="#local-6989586621679360594"><span class="hs-identifier hs-var">finit</span></a></span><span> </span><span class="annot"><span class="annottext">FInit -&gt; FInit -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">FInit
</span><a href="#local-6989586621679360592"><span class="hs-identifier hs-var">finit'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph -&gt; Int -&gt; Bool
</span><a href="Base.html#graph_is_vertex"><span class="hs-identifier hs-var">graph_is_vertex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; Graph
</span><a href="Analysis.Context.html#ctxt_entries"><span class="hs-identifier hs-var">ctxt_entries</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360600"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360601"><span class="hs-identifier hs-var">trgt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph -&gt; Int -&gt; Int -&gt; Bool
</span><a href="Base.html#graph_is_edge"><span class="hs-identifier hs-var">graph_is_edge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; Graph
</span><a href="Analysis.Context.html#ctxt_entries"><span class="hs-identifier hs-var">ctxt_entries</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360600"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360620"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360601"><span class="hs-identifier hs-var">trgt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-266"></span><span>          </span><span class="annot"><span class="annottext">(a, FInit) -&gt; Maybe (a, FInit)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360601"><span class="hs-identifier hs-var">trgt</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FInit
</span><a href="#local-6989586621679360592"><span class="hs-identifier hs-var">finit'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- trace (&quot;new finit@&quot; ++ showHex trgt ++ &quot;\n&quot; ++ show finit ++ &quot;\n&quot; ++ show (invariant_to_finit fctxt inv) ++ &quot;\n&quot; ++ show finit') </span><span>
</span><span id="line-267"></span><span>        </span><span class="hs-keyword">else</span><span>
</span><span id="line-268"></span><span>          </span><span class="annot"><span class="annottext">Maybe (a, FInit)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-269"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FReturnBehavior
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe FInit
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe Predicate
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (a, FInit)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- time out</span><span>
</span><span id="line-270"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679360588"><span class="annot"><span class="annottext">Maybe FReturnBehavior
</span><a href="#local-6989586621679360588"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360587"><span class="annot"><span class="annottext">Maybe FInit
</span><a href="#local-6989586621679360587"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360586"><span class="annot"><span class="annottext">Maybe Predicate
</span><a href="#local-6989586621679360586"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe (a, FInit)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe FReturnBehavior, Maybe FInit, Maybe Predicate) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FReturnBehavior
</span><a href="#local-6989586621679360588"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe FInit
</span><a href="#local-6989586621679360587"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe Predicate
</span><a href="#local-6989586621679360586"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><a href="#local-6989586621679360604"><span class="hs-identifier hs-var">trgt_to_finit</span></a></span><span> </span><span id="local-6989586621679360584"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360584"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679360583"><span class="annot"><span class="annottext">GenericInstruction AddressWord64 storage prefix opcode annotation
</span><a href="#local-6989586621679360583"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">ResolvedJumpTarget
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (a, FInit)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span>  </span><span id="local-6989586621679360615"><span class="annot"><span class="annottext">gather :: FContext -&gt; [(a, FInit)] -&gt; [(a, FInit)]
</span><a href="#local-6989586621679360615"><span class="hs-identifier hs-var hs-var">gather</span></a></span></span><span> </span><span id="local-6989586621679360582"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360582"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><a href="#local-6989586621679360615"><span class="hs-identifier hs-var">gather</span></a></span><span> </span><span id="local-6989586621679360581"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360581"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679360580"><span class="annot"><span class="annottext">(a, FInit)
</span><a href="#local-6989586621679360580"><span class="hs-identifier hs-var">new_call</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(a, FInit)
</span><a href="#local-6989586621679360580"><span class="hs-identifier hs-var">new_call</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-275"></span><span>  </span><span class="annot"><a href="#local-6989586621679360615"><span class="hs-identifier hs-var">gather</span></a></span><span> </span><span id="local-6989586621679360579"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360579"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679360578"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360578"><span class="hs-identifier hs-var">entry'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360577"><span class="annot"><span class="annottext">FInit
</span><a href="#local-6989586621679360577"><span class="hs-identifier hs-var">finit</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679360576"><span class="annot"><span class="annottext">[(a, FInit)]
</span><a href="#local-6989586621679360576"><span class="hs-identifier hs-var">new_calls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679360575"><span class="annot"><span class="annottext">[(a, FInit)]
</span><a href="#local-6989586621679360575"><span class="hs-identifier hs-var">same</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360574"><span class="annot"><span class="annottext">[(a, FInit)]
</span><a href="#local-6989586621679360574"><span class="hs-identifier hs-var">others</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, FInit) -&gt; Bool)
-&gt; [(a, FInit)] -&gt; ([(a, FInit)], [(a, FInit)])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360578"><span class="hs-identifier hs-var">entry'</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; ((a, FInit) -&gt; a) -&gt; (a, FInit) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, FInit) -&gt; a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, FInit)]
</span><a href="#local-6989586621679360576"><span class="hs-identifier hs-var">new_calls</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-277"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360578"><span class="hs-identifier hs-var">entry'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(FInit -&gt; FInit -&gt; FInit) -&gt; [FInit] -&gt; FInit
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldr1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext -&gt; FInit -&gt; FInit -&gt; FInit
</span><a href="Instantiation.SymbolicPropagation.html#join_finit"><span class="hs-identifier hs-var">join_finit</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360579"><span class="hs-identifier hs-var">fctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FInit
</span><a href="#local-6989586621679360577"><span class="hs-identifier hs-var">finit</span></a></span><span class="annot"><span class="annottext">FInit -&gt; [FInit] -&gt; [FInit]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">((a, FInit) -&gt; FInit) -&gt; [(a, FInit)] -&gt; [FInit]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(a, FInit) -&gt; FInit
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(a, FInit)]
</span><a href="#local-6989586621679360575"><span class="hs-identifier hs-var">same</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, FInit) -&gt; [(a, FInit)] -&gt; [(a, FInit)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">FContext -&gt; [(a, FInit)] -&gt; [(a, FInit)]
</span><a href="#local-6989586621679360615"><span class="hs-identifier hs-var">gather</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360579"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, FInit)]
</span><a href="#local-6989586621679360574"><span class="hs-identifier hs-var">others</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#ctxt_add_entry_edge"><span class="hs-identifier hs-type">ctxt_add_entry_edge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><a href="Analysis.Context.html#FInit"><span class="hs-identifier hs-type">FInit</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span id="ctxt_add_entry_edge"><span class="annot"><span class="annottext">ctxt_add_entry_edge :: Int -&gt; (Int, FInit) -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_add_entry_edge"><span class="hs-identifier hs-var hs-var">ctxt_add_entry_edge</span></a></span></span><span> </span><span id="local-6989586621679360572"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360572"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679360571"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360571"><span class="hs-identifier hs-var">trgt</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360570"><span class="annot"><span class="annottext">FInit
</span><a href="#local-6989586621679360570"><span class="hs-identifier hs-var">finit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621679360569"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360569"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-285"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Graph -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_entries"><span class="hs-identifier hs-var">set_ctxt_entries</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph -&gt; Int -&gt; IntSet -&gt; Graph
</span><a href="Base.html#graph_add_edges"><span class="hs-identifier hs-var">graph_add_edges</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; Graph
</span><a href="Analysis.Context.html#ctxt_entries"><span class="hs-identifier hs-var">ctxt_entries</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360569"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360572"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IntSet
</span><span class="hs-identifier hs-var">IS.singleton</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360571"><span class="hs-identifier hs-var">trgt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap FInit -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_finits"><span class="hs-identifier hs-var">set_ctxt_finits</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FInit -&gt; IntMap FInit -&gt; IntMap FInit
forall a. Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insert</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360571"><span class="hs-identifier hs-var">trgt</span></a></span><span> </span><span class="annot"><span class="annottext">FInit
</span><a href="#local-6989586621679360570"><span class="hs-identifier hs-var">finit</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap FInit -&gt; IntMap FInit) -&gt; IntMap FInit -&gt; IntMap FInit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap FInit
</span><a href="Analysis.Context.html#ctxt_finits"><span class="hs-identifier hs-var">ctxt_finits</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360569"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap FReturnBehavior -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_calls"><span class="hs-identifier hs-var">set_ctxt_calls</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IntMap FReturnBehavior -&gt; IntMap FReturnBehavior
forall a. Int -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.delete</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360571"><span class="hs-identifier hs-var">trgt</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap FReturnBehavior -&gt; IntMap FReturnBehavior)
-&gt; IntMap FReturnBehavior -&gt; IntMap FReturnBehavior
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap FReturnBehavior
</span><a href="Analysis.Context.html#ctxt_calls"><span class="hs-identifier hs-var">ctxt_calls</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360569"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap Invariants -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_invs"><span class="hs-identifier hs-var">set_ctxt_invs</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IntMap Invariants -&gt; IntMap Invariants
forall a. Int -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.delete</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360571"><span class="hs-identifier hs-var">trgt</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap Invariants -&gt; IntMap Invariants)
-&gt; IntMap Invariants -&gt; IntMap Invariants
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap Invariants
</span><a href="Analysis.Context.html#ctxt_invs"><span class="hs-identifier hs-var">ctxt_invs</span></a></span><span>  </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360569"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap (Set (NodeInfo, Predicate)) -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_posts"><span class="hs-identifier hs-var">set_ctxt_posts</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; IntMap (Set (NodeInfo, Predicate))
-&gt; IntMap (Set (NodeInfo, Predicate))
forall a. Int -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.delete</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360571"><span class="hs-identifier hs-var">trgt</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap (Set (NodeInfo, Predicate))
 -&gt; IntMap (Set (NodeInfo, Predicate)))
-&gt; IntMap (Set (NodeInfo, Predicate))
-&gt; IntMap (Set (NodeInfo, Predicate))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap (Set (NodeInfo, Predicate))
</span><a href="Analysis.Context.html#ctxt_posts"><span class="hs-identifier hs-var">ctxt_posts</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360569"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#ctxt_get_curr_posts"><span class="hs-identifier hs-type">ctxt_get_curr_posts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Analysis.Context.html#FInit"><span class="hs-identifier hs-type">FInit</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Analysis.Context.html#Invariants"><span class="hs-identifier hs-type">Invariants</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Analysis.Context.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Analysis.Context.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#SStatePart"><span class="hs-identifier hs-type">SStatePart</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span id="ctxt_get_curr_posts"><span class="annot"><span class="annottext">ctxt_get_curr_posts :: Int
-&gt; StateT
     Context
     IO
     (FInit, Invariants, Set (NodeInfo, Predicate), Set SStatePart)
</span><a href="Algorithm.L0_Lifting.html#ctxt_get_curr_posts"><span class="hs-identifier hs-var hs-var">ctxt_get_curr_posts</span></a></span></span><span> </span><span id="local-6989586621679360561"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360561"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621679360560"><span class="annot"><span class="annottext">IntMap FInit
</span><a href="#local-6989586621679360560"><span class="hs-identifier hs-var">finits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; IntMap FInit) -&gt; StateT Context IO (IntMap FInit)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap FInit
</span><a href="Analysis.Context.html#ctxt_finits"><span class="hs-identifier hs-var">ctxt_finits</span></a></span><span>
</span><span id="line-295"></span><span>  </span><span id="local-6989586621679360559"><span class="annot"><span class="annottext">IntMap Invariants
</span><a href="#local-6989586621679360559"><span class="hs-identifier hs-var">invs</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; IntMap Invariants)
-&gt; StateT Context IO (IntMap Invariants)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap Invariants
</span><a href="Analysis.Context.html#ctxt_invs"><span class="hs-identifier hs-var">ctxt_invs</span></a></span><span>
</span><span id="line-296"></span><span>  </span><span id="local-6989586621679360558"><span class="annot"><span class="annottext">IntMap (Set (NodeInfo, Predicate))
</span><a href="#local-6989586621679360558"><span class="hs-identifier hs-var">posts</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; IntMap (Set (NodeInfo, Predicate)))
-&gt; StateT Context IO (IntMap (Set (NodeInfo, Predicate)))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap (Set (NodeInfo, Predicate))
</span><a href="Analysis.Context.html#ctxt_posts"><span class="hs-identifier hs-var">ctxt_posts</span></a></span><span>
</span><span id="line-297"></span><span>  </span><span id="local-6989586621679360557"><span class="annot"><span class="annottext">IntMap (Set SStatePart)
</span><a href="#local-6989586621679360557"><span class="hs-identifier hs-var">sps</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; IntMap (Set SStatePart))
-&gt; StateT Context IO (IntMap (Set SStatePart))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap (Set SStatePart)
</span><a href="Analysis.Context.html#ctxt_stateparts"><span class="hs-identifier hs-var">ctxt_stateparts</span></a></span><span>
</span><span id="line-298"></span><span>  </span><span class="annot"><span class="annottext">(FInit, Invariants, Set (NodeInfo, Predicate), Set SStatePart)
-&gt; StateT
     Context
     IO
     (FInit, Invariants, Set (NodeInfo, Predicate), Set SStatePart)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IntMap FInit -&gt; Maybe FInit
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360561"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap FInit
</span><a href="#local-6989586621679360560"><span class="hs-identifier hs-var">finits</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FInit -&gt; FInit -&gt; FInit
forall a. Eq a =&gt; Maybe a -&gt; a -&gt; a
</span><a href="Base.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">FInit
</span><a href="Analysis.Context.html#init_finit"><span class="hs-identifier hs-var">init_finit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap Invariants -&gt; Maybe Invariants
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360561"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap Invariants
</span><a href="#local-6989586621679360559"><span class="hs-identifier hs-var">invs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Invariants -&gt; Invariants -&gt; Invariants
forall a. Eq a =&gt; Maybe a -&gt; a -&gt; a
</span><a href="Base.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">Invariants
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; IntMap (Set (NodeInfo, Predicate))
-&gt; Maybe (Set (NodeInfo, Predicate))
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360561"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (Set (NodeInfo, Predicate))
</span><a href="#local-6989586621679360558"><span class="hs-identifier hs-var">posts</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Set (NodeInfo, Predicate))
-&gt; Set (NodeInfo, Predicate) -&gt; Set (NodeInfo, Predicate)
forall a. Eq a =&gt; Maybe a -&gt; a -&gt; a
</span><a href="Base.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int -&gt; IntMap (Set SStatePart) -&gt; Maybe (Set SStatePart)
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360561"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (Set SStatePart)
</span><a href="#local-6989586621679360557"><span class="hs-identifier hs-var">sps</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Set SStatePart) -&gt; Set SStatePart -&gt; Set SStatePart
forall a. Eq a =&gt; Maybe a -&gt; a -&gt; a
</span><a href="Base.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">Set SStatePart
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- Assuming a CFG and invariants are generated, verify for each block $b$ that is an end-node in the CFG whether:</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- if the end-node &quot;returns normally&quot;, i.e., ends in a RET, then it returns correctly, i.e., the return address is </span><span>
</span><span id="line-305"></span><span class="hs-comment">-- not overwritten and callee-saved registers are preserved and RSP is set to RSP0+8</span><span>
</span><span id="line-306"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#ctxt_verify_proper_return"><span class="hs-identifier hs-type">ctxt_verify_proper_return</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#VerificationResult"><span class="hs-identifier hs-type">VerificationResult</span></a></span><span>
</span><span id="line-307"></span><span id="ctxt_verify_proper_return"><span class="annot"><span class="annottext">ctxt_verify_proper_return :: Int -&gt; StateT Context IO VerificationResult
</span><a href="Algorithm.L0_Lifting.html#ctxt_verify_proper_return"><span class="hs-identifier hs-var hs-var">ctxt_verify_proper_return</span></a></span></span><span> </span><span id="local-6989586621679360551"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360551"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621679360550"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360550"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-309"></span><span>  </span><span id="local-6989586621679360549"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360549"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO FContext
</span><a href="Algorithm.L0_Lifting.html#ctxt_mk_fcontext"><span class="hs-identifier hs-var">ctxt_mk_fcontext</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360551"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360548"><span class="annot"><span class="annottext">vcs :: Set VerificationCondition
</span><a href="#local-6989586621679360548"><span class="hs-identifier hs-var hs-var">vcs</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; IntMap (Set VerificationCondition)
-&gt; Maybe (Set VerificationCondition)
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360551"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; IntMap (Set VerificationCondition)
</span><a href="Analysis.Context.html#ctxt_vcs"><span class="hs-identifier hs-var">ctxt_vcs</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360550"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Set VerificationCondition)
-&gt; Set VerificationCondition -&gt; Set VerificationCondition
forall a. Eq a =&gt; Maybe a -&gt; a -&gt; a
</span><a href="Base.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">Set VerificationCondition
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FInit
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Invariants
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679360547"><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360547"><span class="hs-identifier hs-var">posts</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set SStatePart
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; StateT
     Context
     IO
     (FInit, Invariants, Set (NodeInfo, Predicate), Set SStatePart)
</span><a href="Algorithm.L0_Lifting.html#ctxt_get_curr_posts"><span class="hs-identifier hs-var">ctxt_get_curr_posts</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360551"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621679360546"><span class="annot"><span class="annottext">[[Maybe String]]
</span><a href="#local-6989586621679360546"><span class="hs-identifier hs-var">all_checks</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((NodeInfo, Predicate) -&gt; StateT Context IO [Maybe String])
-&gt; [(NodeInfo, Predicate)] -&gt; StateT Context IO [[Maybe String]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext
-&gt; (NodeInfo, Predicate) -&gt; StateT Context IO [Maybe String]
</span><a href="#local-6989586621679360544"><span class="hs-identifier hs-var">correct</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360549"><span class="hs-identifier hs-var">fctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(NodeInfo, Predicate)] -&gt; StateT Context IO [[Maybe String]])
-&gt; [(NodeInfo, Predicate)] -&gt; StateT Context IO [[Maybe String]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((NodeInfo, Predicate) -&gt; Bool)
-&gt; [(NodeInfo, Predicate)] -&gt; [(NodeInfo, Predicate)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679360543"><span class="annot"><span class="annottext">NodeInfo
</span><a href="#local-6989586621679360543"><span class="hs-identifier hs-var">ni</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360542"><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360542"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeInfo
</span><a href="#local-6989586621679360543"><span class="hs-identifier hs-var">ni</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo -&gt; NodeInfo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">NodeInfo
</span><a href="Analysis.Context.html#Terminal"><span class="hs-identifier hs-var">Terminal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(NodeInfo, Predicate)] -&gt; [(NodeInfo, Predicate)])
-&gt; [(NodeInfo, Predicate)] -&gt; [(NodeInfo, Predicate)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set (NodeInfo, Predicate) -&gt; [(NodeInfo, Predicate)]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">S.toList</span></span><span> </span><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360547"><span class="hs-identifier hs-var">posts</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Set (NodeInfo, Predicate) -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">S.null</span></span><span> </span><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360547"><span class="hs-identifier hs-var">posts</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><span class="annottext">VerificationResult -&gt; StateT Context IO VerificationResult
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; VerificationResult
</span><a href="Analysis.Context.html#VerificationError"><span class="hs-identifier hs-var">VerificationError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;time out reached&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">((NodeInfo, Predicate) -&gt; Bool)
-&gt; Set (NodeInfo, Predicate) -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679360537"><span class="annot"><span class="annottext">NodeInfo
</span><a href="#local-6989586621679360537"><span class="hs-identifier hs-var">ni</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360536"><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360536"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeInfo
</span><a href="#local-6989586621679360537"><span class="hs-identifier hs-var">ni</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo -&gt; NodeInfo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NodeInfo
</span><a href="Analysis.Context.html#UnresolvedIndirection"><span class="hs-identifier hs-var">UnresolvedIndirection</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360547"><span class="hs-identifier hs-var">posts</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><span class="annottext">VerificationResult -&gt; StateT Context IO VerificationResult
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="Analysis.Context.html#VerificationUnresolvedIndirection"><span class="hs-identifier hs-var">VerificationUnresolvedIndirection</span></a></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(Maybe String -&gt; Bool) -&gt; [Maybe String] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe String -&gt; Maybe String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Maybe String] -&gt; Bool) -&gt; [Maybe String] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Maybe String]] -&gt; [Maybe String]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[Maybe String]]
</span><a href="#local-6989586621679360546"><span class="hs-identifier hs-var">all_checks</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><span class="annottext">VerificationResult -&gt; StateT Context IO VerificationResult
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; VerificationResult
</span><a href="Analysis.Context.html#VerificationError"><span class="hs-identifier hs-var">VerificationError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; VerificationResult) -&gt; String -&gt; VerificationResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Maybe String] -&gt; [String]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">([Maybe String] -&gt; [String]) -&gt; [Maybe String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Maybe String]] -&gt; [Maybe String]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[Maybe String]]
</span><a href="#local-6989586621679360546"><span class="hs-identifier hs-var">all_checks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(VerificationCondition -&gt; Bool)
-&gt; Set VerificationCondition -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; (VerificationCondition -&gt; Bool) -&gt; VerificationCondition -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VerificationCondition -&gt; Bool
</span><a href="Analysis.Context.html#is_precondition"><span class="hs-identifier hs-var">is_precondition</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set VerificationCondition
</span><a href="#local-6989586621679360548"><span class="hs-identifier hs-var">vcs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><span class="annottext">VerificationResult -&gt; StateT Context IO VerificationResult
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="Analysis.Context.html#VerificationSuccesWithAssumptions"><span class="hs-identifier hs-var">VerificationSuccesWithAssumptions</span></a></span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-keyword">else</span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><span class="annottext">VerificationResult -&gt; StateT Context IO VerificationResult
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="Analysis.Context.html#VerificationSuccess"><span class="hs-identifier hs-var">VerificationSuccess</span></a></span><span>
</span><span id="line-324"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-comment">-- is the postcondition &quot;correct&quot;? </span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-comment">-- A succesfull check returns Nothing, a verification error produces a &quot;Just err&quot; with an error-message</span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><a href="#local-6989586621679360544"><span class="hs-identifier hs-type">correct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Analysis.Context.html#FContext"><span class="hs-identifier hs-type">FContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Analysis.Context.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Analysis.Context.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-328"></span><span>  </span><span id="local-6989586621679360544"><span class="annot"><span class="annottext">correct :: FContext
-&gt; (NodeInfo, Predicate) -&gt; StateT Context IO [Maybe String]
</span><a href="#local-6989586621679360544"><span class="hs-identifier hs-var hs-var">correct</span></a></span></span><span> </span><span id="local-6989586621679360530"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360530"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeInfo
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679360529"><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360529"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><span class="annottext">[Maybe String] -&gt; StateT Context IO [Maybe String]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([Maybe String] -&gt; StateT Context IO [Maybe String])
-&gt; [Maybe String] -&gt; StateT Context IO [Maybe String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Identity [Maybe String] -&gt; [Maybe String]
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity [Maybe String] -&gt; [Maybe String])
-&gt; Identity [Maybe String] -&gt; [Maybe String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT
  (Predicate, Set VerificationCondition) Identity [Maybe String]
-&gt; (Predicate, Set VerificationCondition)
-&gt; Identity [Maybe String]
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m a
</span><span class="hs-identifier hs-var">evalStateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext
-&gt; StateT
     (Predicate, Set VerificationCondition) Identity [Maybe String]
</span><a href="#local-6989586621679360526"><span class="hs-identifier hs-var">do_post_check</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360530"><span class="hs-identifier hs-var">fctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360529"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set VerificationCondition
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-comment">-- do one more tau-transformation on the node, as the stored invariant is a </span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-comment">-- precondition (not a postcondition) of the node.</span><span>
</span><span id="line-334"></span><span>  </span><span class="annot"><a href="#local-6989586621679360526"><span class="hs-identifier hs-type">do_post_check</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Analysis.Context.html#FContext"><span class="hs-identifier hs-type">FContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Analysis.Context.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Generic.SymbolicConstituents.html#VCS"><span class="hs-identifier hs-type">VCS</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-335"></span><span>  </span><span id="local-6989586621679360526"><span class="annot"><span class="annottext">do_post_check :: FContext
-&gt; StateT
     (Predicate, Set VerificationCondition) Identity [Maybe String]
</span><a href="#local-6989586621679360526"><span class="hs-identifier hs-var hs-var">do_post_check</span></a></span></span><span> </span><span id="local-6989586621679360524"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360524"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360523"><span class="annot"><span class="annottext">f :: String
</span><a href="#local-6989586621679360523"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; Int -&gt; String
</span><a href="Analysis.FunctionNames.html#function_name_of_entry"><span class="hs-identifier hs-var">function_name_of_entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext -&gt; Context
</span><a href="Analysis.Context.html#f_ctxt"><span class="hs-identifier hs-var hs-var">f_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360524"><span class="hs-identifier hs-var">fctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext -&gt; Int
</span><a href="Analysis.Context.html#f_entry"><span class="hs-identifier hs-var hs-var">f_entry</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360524"><span class="hs-identifier hs-var">fctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>    </span><span id="local-6989586621679360520"><span class="annot"><span class="annottext">SValue
</span><a href="#local-6989586621679360520"><span class="hs-identifier hs-var">rsp</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FContext
-&gt; Register -&gt; State (Predicate, Set VerificationCondition) SValue
forall ctxt v p.
SymbolicExecutable ctxt v p =&gt;
ctxt -&gt; Register -&gt; State (Sstate v p, Set VerificationCondition) v
</span><a href="Generic.SymbolicConstituents.html#sread_reg"><span class="hs-identifier hs-var">sread_reg</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360524"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="X86.Register.html#RSP"><span class="hs-identifier hs-var">RSP</span></a></span><span>
</span><span id="line-338"></span><span>    </span><span id="local-6989586621679360517"><span class="annot"><span class="annottext">SValue
</span><a href="#local-6989586621679360517"><span class="hs-identifier hs-var">rip</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FContext
-&gt; Register -&gt; State (Predicate, Set VerificationCondition) SValue
forall ctxt v p.
SymbolicExecutable ctxt v p =&gt;
ctxt -&gt; Register -&gt; State (Sstate v p, Set VerificationCondition) v
</span><a href="Generic.SymbolicConstituents.html#sread_reg"><span class="hs-identifier hs-var">sread_reg</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360524"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Register
</span><a href="X86.Register.html#RIP"><span class="hs-identifier hs-var">RIP</span></a></span><span>
</span><span id="line-339"></span><span>    </span><span id="local-6989586621679360515"><span class="annot"><span class="annottext">[Maybe String]
</span><a href="#local-6989586621679360515"><span class="hs-identifier hs-var">checks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Maybe String]
-&gt; StateT
     (Predicate, Set VerificationCondition) Identity [Maybe String]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- forM (delete RSP callee_saved_registers) (\r -&gt; read_reg ctxt r &gt;&gt;= return . reg_check r) </span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679360514"><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360514"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set VerificationCondition
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT
  (Predicate, Set VerificationCondition)
  Identity
  (Predicate, Set VerificationCondition)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><span class="annottext">[Maybe String]
-&gt; StateT
     (Predicate, Set VerificationCondition) Identity [Maybe String]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([Maybe String]
 -&gt; StateT
      (Predicate, Set VerificationCondition) Identity [Maybe String])
-&gt; [Maybe String]
-&gt; StateT
     (Predicate, Set VerificationCondition) Identity [Maybe String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FContext -&gt; String -&gt; SValue -&gt; Maybe String
forall ctxt a p.
SymbolicExecutable ctxt a p =&gt;
ctxt -&gt; String -&gt; a -&gt; Maybe String
</span><a href="#local-6989586621679360513"><span class="hs-identifier hs-var">rsp_check</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360524"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360523"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SValue
</span><a href="#local-6989586621679360520"><span class="hs-identifier hs-var">rsp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FContext -&gt; Predicate -&gt; String -&gt; SValue -&gt; Maybe String
forall ctxt a p a p.
(SymbolicExecutable ctxt a p, Show a) =&gt;
ctxt -&gt; a -&gt; p -&gt; a -&gt; Maybe String
</span><a href="#local-6989586621679360512"><span class="hs-identifier hs-var">rip_check</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360524"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360514"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360523"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SValue
</span><a href="#local-6989586621679360517"><span class="hs-identifier hs-var">rip</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Maybe String] -&gt; [Maybe String] -&gt; [Maybe String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Maybe String]
</span><a href="#local-6989586621679360515"><span class="hs-identifier hs-var">checks</span></a></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-comment">-- check: are all caller-saved-registers restored to their initial values?</span><span>
</span><span id="line-344"></span><span>  </span><span id="local-6989586621679360511"><span class="annot"><span class="annottext">reg_check :: ctxt -&gt; a -&gt; a -&gt; Maybe String
</span><a href="#local-6989586621679360511"><span class="hs-identifier hs-var hs-var">reg_check</span></a></span></span><span> </span><span id="local-6989586621679360510"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679360510"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span> </span><span id="local-6989586621679360509"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360509"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621679360508"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360508"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; a -&gt; Maybe SimpleExpr
forall ctxt v p.
SymbolicExecutable ctxt v p =&gt;
ctxt -&gt; v -&gt; Maybe SimpleExpr
</span><a href="Generic.SymbolicConstituents.html#stry_deterministic"><span class="hs-identifier hs-var">stry_deterministic</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679360510"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360508"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-346"></span><span>      </span><span class="hs-comment">-- REG == REG_0</span><span>
</span><span id="line-347"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SymbolicExpression.html#SE_Var"><span class="hs-identifier hs-type">SE_Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SymbolicExpression.html#SP_Reg"><span class="hs-identifier hs-type">SP_Reg</span></a></span><span> </span><span id="local-6989586621679360504"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621679360504"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-348"></span><span>      </span><span class="annot"><span class="annottext">Maybe SimpleExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe String) -&gt; String -&gt; Maybe String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Verification error: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360509"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; == &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360508"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-comment">-- check: is RSP restored to RSP_0 + 8 ?</span><span>
</span><span id="line-351"></span><span>  </span><span id="local-6989586621679360513"><span class="annot"><span class="annottext">rsp_check :: ctxt -&gt; String -&gt; a -&gt; Maybe String
</span><a href="#local-6989586621679360513"><span class="hs-identifier hs-var hs-var">rsp_check</span></a></span></span><span> </span><span id="local-6989586621679360503"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679360503"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span>  </span><span id="local-6989586621679360502"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360502"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679360501"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360501"><span class="hs-identifier hs-var">rsp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; a -&gt; Maybe SimpleExpr
forall ctxt v p.
SymbolicExecutable ctxt v p =&gt;
ctxt -&gt; v -&gt; Maybe SimpleExpr
</span><a href="Generic.SymbolicConstituents.html#stry_deterministic"><span class="hs-identifier hs-var">stry_deterministic</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679360503"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360501"><span class="hs-identifier hs-var">rsp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-353"></span><span>      </span><span class="hs-comment">-- RSP == RSP_0 + 8</span><span>
</span><span id="line-354"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SymbolicExpression.html#SE_Op"><span class="hs-identifier hs-type">SE_Op</span></a></span><span> </span><span class="annot"><span class="annottext">Operator
</span><a href="Data.SymbolicExpression.html#Plus"><span class="hs-identifier hs-var">Plus</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.SymbolicExpression.html#SE_Var"><span class="hs-identifier hs-type">SE_Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SymbolicExpression.html#SP_StackPointer"><span class="hs-identifier hs-type">SP_StackPointer</span></a></span><span> </span><span id="local-6989586621679360497"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360497"><span class="hs-identifier hs-var">f'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SymbolicExpression.html#SE_Immediate"><span class="hs-identifier hs-type">SE_Immediate</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0x8</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360502"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360497"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe String
forall a. Show a =&gt; a -&gt; Maybe String
</span><a href="#local-6989586621679360495"><span class="hs-identifier hs-var">v_error</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360501"><span class="hs-identifier hs-var">rsp</span></a></span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-comment">-- RSP == RSP_0 - 0xfffffffffffffff8</span><span>
</span><span id="line-356"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SymbolicExpression.html#SE_Op"><span class="hs-identifier hs-type">SE_Op</span></a></span><span> </span><span class="annot"><span class="annottext">Operator
</span><a href="Data.SymbolicExpression.html#Minus"><span class="hs-identifier hs-var">Minus</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.SymbolicExpression.html#SE_Var"><span class="hs-identifier hs-type">SE_Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SymbolicExpression.html#SP_StackPointer"><span class="hs-identifier hs-type">SP_StackPointer</span></a></span><span> </span><span id="local-6989586621679360493"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360493"><span class="hs-identifier hs-var">f'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SymbolicExpression.html#SE_Immediate"><span class="hs-identifier hs-type">SE_Immediate</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xfffffffffffffff8</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360502"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360493"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe String
forall a. Show a =&gt; a -&gt; Maybe String
</span><a href="#local-6989586621679360495"><span class="hs-identifier hs-var">v_error</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360501"><span class="hs-identifier hs-var">rsp</span></a></span><span>
</span><span id="line-357"></span><span>      </span><span class="annot"><span class="annottext">Maybe SimpleExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe String
forall a. Show a =&gt; a -&gt; Maybe String
</span><a href="#local-6989586621679360495"><span class="hs-identifier hs-var">v_error</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360501"><span class="hs-identifier hs-var">rsp</span></a></span><span>
</span><span id="line-358"></span><span>  </span><span id="local-6989586621679360495"><span class="annot"><span class="annottext">v_error :: a -&gt; Maybe String
</span><a href="#local-6989586621679360495"><span class="hs-identifier hs-var hs-var">v_error</span></a></span></span><span> </span><span id="local-6989586621679360492"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360492"><span class="hs-identifier hs-var">rsp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe String) -&gt; String -&gt; Maybe String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Verification error: RSP == &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360492"><span class="hs-identifier hs-var">rsp</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-comment">-- check: is RIP set to the value originally stored at the top of the stack frame?</span><span>
</span><span id="line-361"></span><span>  </span><span id="local-6989586621679360512"><span class="annot"><span class="annottext">rip_check :: ctxt -&gt; a -&gt; p -&gt; a -&gt; Maybe String
</span><a href="#local-6989586621679360512"><span class="hs-identifier hs-var hs-var">rip_check</span></a></span></span><span> </span><span id="local-6989586621679360491"><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679360491"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span>  </span><span id="local-6989586621679360490"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360490"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679360489"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679360489"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679360488"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360488"><span class="hs-identifier hs-var">rip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-362"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ctxt -&gt; a -&gt; Maybe SimpleExpr
forall ctxt v p.
SymbolicExecutable ctxt v p =&gt;
ctxt -&gt; v -&gt; Maybe SimpleExpr
</span><a href="Generic.SymbolicConstituents.html#stry_deterministic"><span class="hs-identifier hs-var">stry_deterministic</span></a></span><span> </span><span class="annot"><span class="annottext">ctxt
</span><a href="#local-6989586621679360491"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360488"><span class="hs-identifier hs-var">rip</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-363"></span><span>      </span><span class="hs-comment">-- RIP == *[RSP_0,8]</span><span>
</span><span id="line-364"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SymbolicExpression.html#SE_Var"><span class="hs-identifier hs-type">SE_Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SymbolicExpression.html#SP_Mem"><span class="hs-identifier hs-type">SP_Mem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SymbolicExpression.html#SE_Var"><span class="hs-identifier hs-type">SE_Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SymbolicExpression.html#SP_StackPointer"><span class="hs-identifier hs-type">SP_StackPointer</span></a></span><span> </span><span id="local-6989586621679360486"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360486"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-365"></span><span>      </span><span id="local-6989586621679360485"><span class="annot"><span class="annottext">Maybe SimpleExpr
</span><a href="#local-6989586621679360485"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe String) -&gt; String -&gt; Maybe String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Verification error: RIP == &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360488"><span class="hs-identifier hs-var">rip</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nState: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360490"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="hs-comment">-- After a succesfull effort, store the current CFG, the invariants,...,  in the &quot;report&quot;-field of the context</span><span>
</span><span id="line-370"></span><span id="ctxt_add_to_results"><span class="annot"><span class="annottext">ctxt_add_to_results :: Int -&gt; VerificationResult -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_add_to_results"><span class="hs-identifier hs-var hs-var">ctxt_add_to_results</span></a></span></span><span> </span><span id="local-6989586621679360484"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360484"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span id="local-6989586621679360483"><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621679360483"><span class="hs-identifier hs-var">verified</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-371"></span><span>  </span><span id="local-6989586621679360482"><span class="annot"><span class="annottext">IntMap VerificationResult
</span><a href="#local-6989586621679360482"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; IntMap VerificationResult)
-&gt; StateT Context IO (IntMap VerificationResult)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap VerificationResult
</span><a href="Analysis.Context.html#ctxt_results"><span class="hs-identifier hs-var">ctxt_results</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap VerificationResult -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_results"><span class="hs-identifier hs-var">set_ctxt_results</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; VerificationResult
-&gt; IntMap VerificationResult
-&gt; IntMap VerificationResult
forall a. Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insert</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360484"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621679360483"><span class="hs-identifier hs-var">verified</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap VerificationResult
</span><a href="#local-6989586621679360482"><span class="hs-identifier hs-var">results</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621679360479"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360479"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-375"></span><span>  </span><span id="local-6989586621679360478"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360478"><span class="hs-identifier hs-var">base</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO String
</span><a href="Algorithm.L0_Lifting.html#ctxt_base_name"><span class="hs-identifier hs-var">ctxt_base_name</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360484"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360476"><span class="annot"><span class="annottext">invs :: Invariants
</span><a href="#local-6989586621679360476"><span class="hs-identifier hs-var hs-var">invs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap Invariants
</span><a href="Analysis.Context.html#ctxt_invs"><span class="hs-identifier hs-var">ctxt_invs</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360479"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap Invariants -&gt; Int -&gt; Invariants
forall a. IntMap a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">IM.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360484"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360475"><span class="annot"><span class="annottext">g :: CFG
</span><a href="#local-6989586621679360475"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap CFG
</span><a href="Analysis.Context.html#ctxt_cfgs"><span class="hs-identifier hs-var">ctxt_cfgs</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360479"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap CFG -&gt; Int -&gt; CFG
forall a. IntMap a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">IM.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360484"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360474"><span class="annot"><span class="annottext">ret :: FReturnBehavior
</span><a href="#local-6989586621679360474"><span class="hs-identifier hs-var hs-var">ret</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap FReturnBehavior
</span><a href="Analysis.Context.html#ctxt_calls"><span class="hs-identifier hs-var">ctxt_calls</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360479"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap FReturnBehavior -&gt; Int -&gt; FReturnBehavior
forall a. IntMap a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">IM.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360484"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360473"><span class="annot"><span class="annottext">finit :: Maybe FInit
</span><a href="#local-6989586621679360473"><span class="hs-identifier hs-var hs-var">finit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap FInit -&gt; Maybe FInit
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360484"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap FInit -&gt; Maybe FInit) -&gt; IntMap FInit -&gt; Maybe FInit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap FInit
</span><a href="Analysis.Context.html#ctxt_finits"><span class="hs-identifier hs-var">ctxt_finits</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360479"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360472"><span class="annot"><span class="annottext">vcs :: Set VerificationCondition
</span><a href="#local-6989586621679360472"><span class="hs-identifier hs-var hs-var">vcs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; IntMap (Set VerificationCondition)
-&gt; Maybe (Set VerificationCondition)
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360484"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; IntMap (Set VerificationCondition)
</span><a href="Analysis.Context.html#ctxt_vcs"><span class="hs-identifier hs-var">ctxt_vcs</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360479"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Set VerificationCondition)
-&gt; Set VerificationCondition -&gt; Set VerificationCondition
forall a. Eq a =&gt; Maybe a -&gt; a -&gt; a
</span><a href="Base.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">Set VerificationCondition
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360471"><span class="annot"><span class="annottext">log :: String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var hs-var">log</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360478"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.log&quot;</span></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; StateT Context IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT Context IO ()) -&gt; IO () -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; StateT Context IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; String -&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#to_log"><span class="hs-identifier hs-var">to_log</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Function entry:             &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360484"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-386"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; StateT Context IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; String -&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#to_log"><span class="hs-identifier hs-var">to_log</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Verification result:        &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VerificationResult -&gt; String
</span><a href="#local-6989586621679360469"><span class="hs-identifier hs-var">show_verification_result</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621679360483"><span class="hs-identifier hs-var">verified</span></a></span><span>
</span><span id="line-387"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; StateT Context IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; String -&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#to_log"><span class="hs-identifier hs-var">to_log</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;#instructions:              &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CFG -&gt; Int
</span><a href="OutputGeneration.Metrics.html#num_of_instructions"><span class="hs-identifier hs-var">num_of_instructions</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360475"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; StateT Context IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; String -&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#to_log"><span class="hs-identifier hs-var">to_log</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;#assertions:                &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set VerificationCondition -&gt; Int
</span><a href="Analysis.Context.html#count_instructions_with_assertions"><span class="hs-identifier hs-var">count_instructions_with_assertions</span></a></span><span> </span><span class="annot"><span class="annottext">Set VerificationCondition
</span><a href="#local-6989586621679360472"><span class="hs-identifier hs-var">vcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; StateT Context IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; String -&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#to_log"><span class="hs-identifier hs-var">to_log</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;#unresolved indirect jumps: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; (Opcode -&gt; Bool) -&gt; CFG -&gt; Int
</span><a href="OutputGeneration.Metrics.html#num_of_unres_inds_in_cfg"><span class="hs-identifier hs-var">num_of_unres_inds_in_cfg</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360479"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; Bool
</span><a href="X86.Opcode.html#isJump"><span class="hs-identifier hs-var">isJump</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360475"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; StateT Context IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; String -&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#to_log"><span class="hs-identifier hs-var">to_log</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;#unresolved indirect calls: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; (Opcode -&gt; Bool) -&gt; CFG -&gt; Int
</span><a href="OutputGeneration.Metrics.html#num_of_unres_inds_in_cfg"><span class="hs-identifier hs-var">num_of_unres_inds_in_cfg</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360479"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Opcode -&gt; Bool
</span><a href="X86.Opcode.html#isCall"><span class="hs-identifier hs-var">isCall</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360475"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; StateT Context IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; String -&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#to_log"><span class="hs-identifier hs-var">to_log</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;#blocks:                    &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CFG -&gt; Int
</span><a href="OutputGeneration.Metrics.html#num_of_blocks"><span class="hs-identifier hs-var">num_of_blocks</span></a></span><span>       </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360475"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; StateT Context IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; String -&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#to_log"><span class="hs-identifier hs-var">to_log</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;#edges:                     &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CFG -&gt; Int
</span><a href="OutputGeneration.Metrics.html#num_of_edges"><span class="hs-identifier hs-var">num_of_edges</span></a></span><span>        </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360475"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; StateT Context IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; String -&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#to_log"><span class="hs-identifier hs-var">to_log</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; StateT Context IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; String -&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#to_log"><span class="hs-identifier hs-var">to_log</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe FInit -&gt; String
</span><a href="OutputGeneration.CallGraph.html#summarize_finit"><span class="hs-identifier hs-var">summarize_finit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FInit
</span><a href="#local-6989586621679360473"><span class="hs-identifier hs-var">finit</span></a></span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; StateT Context IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; String -&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#to_log"><span class="hs-identifier hs-var">to_log</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; StateT Context IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; String -&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#to_log"><span class="hs-identifier hs-var">to_log</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Return behavior: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FReturnBehavior -&gt; String
</span><a href="#local-6989586621679360462"><span class="hs-identifier hs-var">show_return_behavior</span></a></span><span> </span><span class="annot"><span class="annottext">FReturnBehavior
</span><a href="#local-6989586621679360474"><span class="hs-identifier hs-var">ret</span></a></span><span>  </span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-comment">--to_log log $ summarize_preconditions_long ctxt vcs -- TODO make configurable</span><span>
</span><span id="line-401"></span><span>  </span><span class="hs-comment">--to_log log $ summarize_assertions_long ctxt vcs</span><span>
</span><span id="line-402"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; StateT Context IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; String -&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#to_log"><span class="hs-identifier hs-var">to_log</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; Set VerificationCondition -&gt; String
</span><a href="OutputGeneration.CallGraph.html#summarize_function_constraints_long"><span class="hs-identifier hs-var">summarize_function_constraints_long</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360479"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Set VerificationCondition
</span><a href="#local-6989586621679360472"><span class="hs-identifier hs-var">vcs</span></a></span><span>
</span><span id="line-403"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; StateT Context IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; String -&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#to_log"><span class="hs-identifier hs-var">to_log</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; Set VerificationCondition -&gt; String
forall p. p -&gt; Set VerificationCondition -&gt; String
</span><a href="OutputGeneration.CallGraph.html#summarize_function_pointers"><span class="hs-identifier hs-var">summarize_function_pointers</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360479"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Set VerificationCondition
</span><a href="#local-6989586621679360472"><span class="hs-identifier hs-var">vcs</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; StateT Context IO () -&gt; StateT Context IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; Bool
</span><a href="Analysis.Context.html#ctxt_verbose_logs"><span class="hs-identifier hs-var">ctxt_verbose_logs</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360479"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StateT Context IO () -&gt; StateT Context IO ())
-&gt; StateT Context IO () -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-407"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; StateT Context IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; String -&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#to_log"><span class="hs-identifier hs-var">to_log</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360471"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CFG -&gt; Invariants -&gt; String
</span><a href="Analysis.ControlFlow.html#show_invariants"><span class="hs-identifier hs-var">show_invariants</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360475"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360476"><span class="hs-identifier hs-var">invs</span></a></span><span>
</span><span id="line-408"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-409"></span><span>  </span><span id="local-6989586621679360462"><span class="annot"><span class="annottext">show_return_behavior :: FReturnBehavior -&gt; String
</span><a href="#local-6989586621679360462"><span class="hs-identifier hs-var hs-var">show_return_behavior</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Analysis.Context.html#ReturningWith"><span class="hs-identifier hs-type">ReturningWith</span></a></span><span> </span><span id="local-6989586621679360456"><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360456"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;returning with\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Predicate -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360456"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n\n&quot;</span></span><span>
</span><span id="line-410"></span><span>  </span><span class="annot"><a href="#local-6989586621679360462"><span class="hs-identifier hs-var">show_return_behavior</span></a></span><span> </span><span class="annot"><span class="annottext">FReturnBehavior
</span><a href="Analysis.Context.html#Terminating"><span class="hs-identifier hs-var">Terminating</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;terminating&quot;</span></span><span>
</span><span id="line-411"></span><span>  </span><span class="annot"><a href="#local-6989586621679360462"><span class="hs-identifier hs-var">show_return_behavior</span></a></span><span> </span><span class="annot"><span class="annottext">FReturnBehavior
</span><a href="Analysis.Context.html#UnknownRetBehavior"><span class="hs-identifier hs-var">UnknownRetBehavior</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unknown&quot;</span></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span>  </span><span id="local-6989586621679360469"><span class="annot"><span class="annottext">show_verification_result :: VerificationResult -&gt; String
</span><a href="#local-6989586621679360469"><span class="hs-identifier hs-var hs-var">show_verification_result</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Analysis.Context.html#VerificationError"><span class="hs-identifier hs-type">VerificationError</span></a></span><span> </span><span id="local-6989586621679360453"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360453"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n\n\n---------------------\nVerification error!!!\n---------------------\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360453"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-414"></span><span>  </span><span class="annot"><a href="#local-6989586621679360469"><span class="hs-identifier hs-var">show_verification_result</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="Analysis.Context.html#VerificationSuccesWithAssumptions"><span class="hs-identifier hs-var">VerificationSuccesWithAssumptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Verified (with assumptions)&quot;</span></span><span>
</span><span id="line-415"></span><span>  </span><span class="annot"><a href="#local-6989586621679360469"><span class="hs-identifier hs-var">show_verification_result</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="Analysis.Context.html#VerificationSuccess"><span class="hs-identifier hs-var">VerificationSuccess</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Verified&quot;</span></span><span>
</span><span id="line-416"></span><span>  </span><span class="annot"><a href="#local-6989586621679360469"><span class="hs-identifier hs-var">show_verification_result</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="Analysis.Context.html#VerificationUnresolvedIndirection"><span class="hs-identifier hs-var">VerificationUnresolvedIndirection</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unresolved indirections&quot;</span></span><span>
</span><span id="line-417"></span><span>  </span><span class="annot"><a href="#local-6989586621679360469"><span class="hs-identifier hs-var">show_verification_result</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="Analysis.Context.html#Unverified"><span class="hs-identifier hs-var">Unverified</span></a></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;UNVERIFIED&quot;</span></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-comment">-- Read entry from file producing entries :: [Int]</span><span>
</span><span id="line-436"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#ctxt_read_entries"><span class="hs-identifier hs-type">ctxt_read_entries</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-437"></span><span id="ctxt_read_entries"><span class="annot"><span class="annottext">ctxt_read_entries :: StateT Context IO [Int]
</span><a href="Algorithm.L0_Lifting.html#ctxt_read_entries"><span class="hs-identifier hs-var hs-var">ctxt_read_entries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-438"></span><span>  </span><span id="local-6989586621679360450"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360450"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-439"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360449"><span class="annot"><span class="annottext">dirname :: String
</span><a href="#local-6989586621679360449"><span class="hs-identifier hs-var hs-var">dirname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; String
</span><a href="Analysis.Context.html#ctxt_dirname"><span class="hs-identifier hs-var">ctxt_dirname</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360450"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-440"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360447"><span class="annot"><span class="annottext">name :: String
</span><a href="#local-6989586621679360447"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; String
</span><a href="Analysis.Context.html#ctxt_name"><span class="hs-identifier hs-var">ctxt_name</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360450"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-441"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360445"><span class="annot"><span class="annottext">fname :: String
</span><a href="#local-6989586621679360445"><span class="hs-identifier hs-var hs-var">fname</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360449"><span class="hs-identifier hs-var">dirname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360447"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.entry&quot;</span></span><span> </span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span>  </span><span class="annot"><span class="annottext">IO [Int] -&gt; StateT Context IO [Int]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO [Int] -&gt; StateT Context IO [Int])
-&gt; IO [Int] -&gt; StateT Context IO [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [Int]
</span><a href="#local-6989586621679360444"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO [Int]) -&gt; String -&gt; IO [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360445"><span class="hs-identifier hs-var">fname</span></a></span><span>
</span><span id="line-444"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-445"></span><span>  </span><span id="local-6989586621679360444"><span class="annot"><span class="annottext">parse :: String -&gt; IO [Int]
</span><a href="#local-6989586621679360444"><span class="hs-identifier hs-var hs-var">parse</span></a></span></span><span> </span><span id="local-6989586621679360442"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360442"><span class="hs-identifier hs-var">filename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-446"></span><span>    </span><span id="local-6989586621679360441"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360441"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><span class="hs-identifier hs-var">readFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360442"><span class="hs-identifier hs-var">filename</span></a></span><span>
</span><span id="line-447"></span><span>    </span><span class="annot"><span class="annottext">[Int] -&gt; IO [Int]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; IO [Int]) -&gt; [Int] -&gt; IO [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int) -&gt; [String] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
</span><a href="#local-6989586621679360439"><span class="hs-identifier hs-var">read_line</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [Int]) -&gt; [String] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">lines</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360441"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-448"></span><span>  </span><span id="local-6989586621679360439"><span class="annot"><span class="annottext">read_line :: String -&gt; Int
</span><a href="#local-6989586621679360439"><span class="hs-identifier hs-var hs-var">read_line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. (Eq a, Num a) =&gt; String -&gt; a
</span><a href="Base.html#readHex%27"><span class="hs-identifier hs-var">readHex'</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int) -&gt; (String -&gt; String) -&gt; String -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="hs-comment">-- Read entry from file producing entry :: Int</span><span>
</span><span id="line-455"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#ctxt_read_and_set_entries"><span class="hs-identifier hs-type">ctxt_read_and_set_entries</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span id="ctxt_read_and_set_entries"><span class="annot"><span class="annottext">ctxt_read_and_set_entries :: StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_read_and_set_entries"><span class="hs-identifier hs-var hs-var">ctxt_read_and_set_entries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-457"></span><span>  </span><span id="local-6989586621679360435"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679360435"><span class="hs-identifier hs-var">entries</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO [Int]
</span><a href="Algorithm.L0_Lifting.html#ctxt_read_entries"><span class="hs-identifier hs-var">ctxt_read_entries</span></a></span><span>
</span><span id="line-458"></span><span>  </span><span id="local-6989586621679360434"><span class="annot"><span class="annottext">[[Word64]]
</span><a href="#local-6989586621679360434"><span class="hs-identifier hs-var">read_arrays</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO [[Word64]]
</span><a href="#local-6989586621679360433"><span class="hs-identifier hs-var">ctxt_read_init_fini_arrays</span></a></span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360432"><span class="annot"><span class="annottext">extra_ptrs :: [Int]
</span><a href="#local-6989586621679360432"><span class="hs-identifier hs-var hs-var">extra_ptrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Int) -&gt; [Word64] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">([Word64] -&gt; [Int]) -&gt; [Word64] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Bool) -&gt; [Word64] -&gt; [Word64]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Word64] -&gt; [Word64]) -&gt; [Word64] -&gt; [Word64]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Bool) -&gt; [Word64] -&gt; [Word64]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Word64] -&gt; [Word64]) -&gt; [Word64] -&gt; [Word64]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Word64]] -&gt; [Word64]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[Word64]]
</span><a href="#local-6989586621679360434"><span class="hs-identifier hs-var">read_arrays</span></a></span><span>
</span><span id="line-460"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Graph -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_entries"><span class="hs-identifier hs-var">set_ctxt_entries</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap IntSet -&gt; Graph
</span><a href="Base.html#Edges"><span class="hs-identifier hs-var">Edges</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap IntSet -&gt; Graph) -&gt; IntMap IntSet -&gt; Graph
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Int, IntSet)] -&gt; IntMap IntSet
forall a. [(Int, a)] -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; [IntSet] -&gt; [(Int, IntSet)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679360435"><span class="hs-identifier hs-var">entries</span></a></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; [Int]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679360432"><span class="hs-identifier hs-var">extra_ptrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([IntSet] -&gt; [(Int, IntSet)]) -&gt; [IntSet] -&gt; [(Int, IntSet)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; [IntSet]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><span class="hs-identifier hs-var">IS.empty</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_start"><span class="hs-identifier hs-var">set_ctxt_start</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679360435"><span class="hs-identifier hs-var">entries</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-463"></span><span>  </span><span id="local-6989586621679360433"><span class="annot"><span class="annottext">ctxt_read_init_fini_arrays :: StateT Context IO [[Word64]]
</span><a href="#local-6989586621679360433"><span class="hs-identifier hs-var hs-var">ctxt_read_init_fini_arrays</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; [(String, String, Word64, Word64)])
-&gt; StateT Context IO [(String, String, Word64, Word64)]
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SectionsInfo -&gt; [(String, String, Word64, Word64)]
</span><a href="Generic.Binary.html#si_sections"><span class="hs-identifier hs-var hs-var">si_sections</span></a></span><span> </span><span class="annot"><span class="annottext">(SectionsInfo -&gt; [(String, String, Word64, Word64)])
-&gt; (Context -&gt; SectionsInfo)
-&gt; Context
-&gt; [(String, String, Word64, Word64)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; SectionsInfo
</span><a href="Analysis.Context.html#ctxt_sections"><span class="hs-identifier hs-var">ctxt_sections</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT Context IO [(String, String, Word64, Word64)]
-&gt; ([(String, String, Word64, Word64)]
    -&gt; StateT Context IO [[Word64]])
-&gt; StateT Context IO [[Word64]]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">((String, String, Word64, Word64) -&gt; StateT Context IO [Word64])
-&gt; [(String, String, Word64, Word64)]
-&gt; StateT Context IO [[Word64]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">(String, String, Word64, Word64) -&gt; StateT Context IO [Word64]
forall (m :: * -&gt; *) t.
(MonadState Context m, Integral t) =&gt;
(String, String, Word64, t) -&gt; m [Word64]
</span><a href="#local-6989586621679360424"><span class="hs-identifier hs-var">ctxt_read_init_fini_array</span></a></span><span> </span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span>  </span><span id="local-6989586621679360424"><span class="annot"><span class="annottext">ctxt_read_init_fini_array :: (String, String, Word64, t) -&gt; m [Word64]
</span><a href="#local-6989586621679360424"><span class="hs-identifier hs-var hs-var">ctxt_read_init_fini_array</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.init_array&quot;</span></span><span class="hs-special">,</span><span id="local-6989586621679360423"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360423"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360422"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679360422"><span class="hs-identifier hs-var">si</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; t -&gt; m [Word64]
forall t (m :: * -&gt; *).
(MonadState Context m, Integral t) =&gt;
Word64 -&gt; t -&gt; m [Word64]
</span><a href="#local-6989586621679360421"><span class="hs-identifier hs-var">read_pointers_from_ro_data_section</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360423"><span class="hs-identifier hs-var">a0</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679360422"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-466"></span><span>  </span><span class="annot"><a href="#local-6989586621679360424"><span class="hs-identifier hs-var">ctxt_read_init_fini_array</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.fini_array&quot;</span></span><span class="hs-special">,</span><span id="local-6989586621679360420"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360420"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360419"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679360419"><span class="hs-identifier hs-var">si</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; t -&gt; m [Word64]
forall t (m :: * -&gt; *).
(MonadState Context m, Integral t) =&gt;
Word64 -&gt; t -&gt; m [Word64]
</span><a href="#local-6989586621679360421"><span class="hs-identifier hs-var">read_pointers_from_ro_data_section</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360420"><span class="hs-identifier hs-var">a0</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679360419"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-467"></span><span>  </span><span class="annot"><a href="#local-6989586621679360424"><span class="hs-identifier hs-var">ctxt_read_init_fini_array</span></a></span><span> </span><span class="annot"><span class="annottext">(String, String, Word64, t)
</span><span class="hs-identifier">_</span></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word64] -&gt; m [Word64]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span>  </span><span id="local-6989586621679360421"><span class="annot"><span class="annottext">read_pointers_from_ro_data_section :: Word64 -&gt; t -&gt; m [Word64]
</span><a href="#local-6989586621679360421"><span class="hs-identifier hs-var hs-var">read_pointers_from_ro_data_section</span></a></span></span><span> </span><span id="local-6989586621679360418"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360418"><span class="hs-identifier hs-var">a0</span></a></span></span><span> </span><span id="local-6989586621679360417"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679360417"><span class="hs-identifier hs-var">si</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-470"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679360417"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">8</span></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-471"></span><span>      </span><span class="annot"><span class="annottext">[Word64] -&gt; m [Word64]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-472"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-473"></span><span>      </span><span id="local-6989586621679360415"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360415"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-474"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360414"><span class="annot"><span class="annottext">ptr :: Maybe Word64
</span><a href="#local-6989586621679360414"><span class="hs-identifier hs-var hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; Word64 -&gt; Int -&gt; Maybe Word64
</span><a href="Analysis.Context.html#read_from_ro_datasection"><span class="hs-identifier hs-var">read_from_ro_datasection</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360415"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360418"><span class="hs-identifier hs-var">a0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679360417"><span class="hs-identifier hs-var">si</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>      </span><span id="local-6989586621679360412"><span class="annot"><span class="annottext">[Word64]
</span><a href="#local-6989586621679360412"><span class="hs-identifier hs-var">ptrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; t -&gt; m [Word64]
</span><a href="#local-6989586621679360421"><span class="hs-identifier hs-var">read_pointers_from_ro_data_section</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360418"><span class="hs-identifier hs-var">a0</span></a></span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679360417"><span class="hs-identifier hs-var">si</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>      </span><span class="annot"><span class="annottext">[Word64] -&gt; m [Word64]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([Word64] -&gt; m [Word64]) -&gt; [Word64] -&gt; m [Word64]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Word64 -&gt; Word64
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679360414"><span class="hs-identifier hs-var">ptr</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Word64 -&gt; [Word64] -&gt; [Word64]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Word64]
</span><a href="#local-6989586621679360412"><span class="hs-identifier hs-var">ptrs</span></a></span><span>
</span><span id="line-477"></span><span>      </span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="hs-comment">-- Produce a base file name (without .extension) based on the current entry under consideration</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- If necessary, make the directory</span><span>
</span><span id="line-484"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#ctxt_base_name"><span class="hs-identifier hs-type">ctxt_base_name</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-485"></span><span id="ctxt_base_name"><span class="annot"><span class="annottext">ctxt_base_name :: Int -&gt; StateT Context IO String
</span><a href="Algorithm.L0_Lifting.html#ctxt_base_name"><span class="hs-identifier hs-var hs-var">ctxt_base_name</span></a></span></span><span> </span><span id="local-6989586621679360410"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360410"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-486"></span><span>  </span><span id="local-6989586621679360409"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360409"><span class="hs-identifier hs-var">dirname</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; String) -&gt; StateT Context IO String
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; String
</span><a href="Analysis.Context.html#ctxt_dirname"><span class="hs-identifier hs-var">ctxt_dirname</span></a></span><span>
</span><span id="line-487"></span><span>  </span><span id="local-6989586621679360408"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360408"><span class="hs-identifier hs-var">name</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; String) -&gt; StateT Context IO String
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; String
</span><a href="Analysis.Context.html#ctxt_name"><span class="hs-identifier hs-var">ctxt_name</span></a></span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360407"><span class="annot"><span class="annottext">functions_dirname :: String
</span><a href="#local-6989586621679360407"><span class="hs-identifier hs-var hs-var">functions_dirname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360409"><span class="hs-identifier hs-var">dirname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;functions/&quot;</span></span><span>
</span><span id="line-490"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; StateT Context IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT Context IO ()) -&gt; IO () -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">createDirectoryIfMissing</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360407"><span class="hs-identifier hs-var">functions_dirname</span></a></span><span>      </span><span>
</span><span id="line-491"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360406"><span class="annot"><span class="annottext">entry_dirname :: String
</span><a href="#local-6989586621679360406"><span class="hs-identifier hs-var hs-var">entry_dirname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360407"><span class="hs-identifier hs-var">functions_dirname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360410"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span>
</span><span id="line-492"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; StateT Context IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT Context IO ()) -&gt; IO () -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">createDirectoryIfMissing</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360406"><span class="hs-identifier hs-var">entry_dirname</span></a></span><span>      </span><span>
</span><span id="line-493"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO String)
-&gt; String -&gt; StateT Context IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360406"><span class="hs-identifier hs-var">entry_dirname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360408"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="hs-comment">-- For the current entry under consideration, read indirections producing inds :: IM.IntMap IS.IntSet</span><span>
</span><span id="line-496"></span><span class="hs-comment">-- Per address a set of next addresses (jump targets).</span><span>
</span><span id="line-497"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#ctxt_init_indirections"><span class="hs-identifier hs-type">ctxt_init_indirections</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span id="ctxt_init_indirections"><span class="annot"><span class="annottext">ctxt_init_indirections :: StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_init_indirections"><span class="hs-identifier hs-var hs-var">ctxt_init_indirections</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-499"></span><span>  </span><span id="local-6989586621679360405"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360405"><span class="hs-identifier hs-var">dirname</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; String) -&gt; StateT Context IO String
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; String
</span><a href="Analysis.Context.html#ctxt_dirname"><span class="hs-identifier hs-var">ctxt_dirname</span></a></span><span>
</span><span id="line-500"></span><span>  </span><span id="local-6989586621679360404"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360404"><span class="hs-identifier hs-var">name</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; String) -&gt; StateT Context IO String
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; String
</span><a href="Analysis.Context.html#ctxt_name"><span class="hs-identifier hs-var">ctxt_name</span></a></span><span>
</span><span id="line-501"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360403"><span class="annot"><span class="annottext">fname :: String
</span><a href="#local-6989586621679360403"><span class="hs-identifier hs-var hs-var">fname</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360405"><span class="hs-identifier hs-var">dirname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360404"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.indirections&quot;</span></span><span> </span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span>  </span><span class="hs-comment">--exists &lt;- liftIO $ doesFileExist fname</span><span>
</span><span id="line-504"></span><span>  </span><span class="hs-comment">--if exists then do</span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-comment">--  inds &lt;- liftIO $ parse fname</span><span>
</span><span id="line-506"></span><span>  </span><span class="hs-comment">--  ctxt &lt;- get</span><span>
</span><span id="line-507"></span><span>  </span><span class="hs-comment">--  put $ ctxt { ctxt_inds = inds }</span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-comment">--else do</span><span>
</span><span id="line-509"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; StateT Context IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT Context IO ()) -&gt; IO () -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360403"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-510"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Indirections -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_inds"><span class="hs-identifier hs-var">set_ctxt_inds</span></a></span><span> </span><span class="annot"><span class="annottext">Indirections
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span>
</span><span id="line-511"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-512"></span><span>  </span><span id="local-6989586621679360401"><span class="annot"><span class="annottext">parse :: String -&gt; IO (IntMap IntSet)
</span><a href="#local-6989586621679360401"><span class="hs-identifier hs-var hs-var">parse</span></a></span></span><span> </span><span id="local-6989586621679360400"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360400"><span class="hs-identifier hs-var">fname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-513"></span><span>    </span><span id="local-6989586621679360399"><span class="annot"><span class="annottext">Either ParseError (IntMap IntSet)
</span><a href="#local-6989586621679360399"><span class="hs-identifier hs-var">ret0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either ParseError (IntMap IntSet))
</span><a href="Parser.ParserIndirections.html#parse_indirections"><span class="hs-identifier hs-var">parse_indirections</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360400"><span class="hs-identifier hs-var">fname</span></a></span><span>
</span><span id="line-514"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either ParseError (IntMap IntSet)
</span><a href="#local-6989586621679360399"><span class="hs-identifier hs-var">ret0</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-515"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679360397"><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679360397"><span class="hs-identifier hs-var">err</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (IntMap IntSet)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO (IntMap IntSet)) -&gt; String -&gt; IO (IntMap IntSet)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ParseError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679360397"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-516"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679360396"><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679360396"><span class="hs-identifier hs-var">inds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IntMap IntSet -&gt; IO (IntMap IntSet)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">IntMap IntSet
</span><a href="#local-6989586621679360396"><span class="hs-identifier hs-var">inds</span></a></span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span>
</span><span id="line-520"></span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="hs-comment">-- TODO generate dot only once</span><span>
</span><span id="line-523"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#ctxt_generate_cfg"><span class="hs-identifier hs-type">ctxt_generate_cfg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="X86.Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span id="ctxt_generate_cfg"><span class="annot"><span class="annottext">ctxt_generate_cfg :: Int -&gt; StateT Context IO (Set (Instruction, Int))
</span><a href="Algorithm.L0_Lifting.html#ctxt_generate_cfg"><span class="hs-identifier hs-var hs-var">ctxt_generate_cfg</span></a></span></span><span> </span><span id="local-6989586621679360395"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360395"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-comment">-- Generate a CFG, write dot file if no new calls discovered</span><span>
</span><span id="line-526"></span><span>  </span><span id="local-6989586621679360394"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360394"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-527"></span><span>  </span><span id="local-6989586621679360393"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360393"><span class="hs-identifier hs-var">base</span></a></span></span><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO String
</span><a href="Algorithm.L0_Lifting.html#ctxt_base_name"><span class="hs-identifier hs-var">ctxt_base_name</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360395"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360392"><span class="annot"><span class="annottext">log :: String
</span><a href="#local-6989586621679360392"><span class="hs-identifier hs-var hs-var">log</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360393"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.log&quot;</span></span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360391"><span class="annot"><span class="annottext">fname :: String
</span><a href="#local-6989586621679360391"><span class="hs-identifier hs-var hs-var">fname</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360393"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.dot&quot;</span></span><span>
</span><span id="line-530"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360390"><span class="annot"><span class="annottext">pdf :: String
</span><a href="#local-6989586621679360390"><span class="hs-identifier hs-var hs-var">pdf</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360393"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.pdf&quot;</span></span><span>
</span><span id="line-531"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360389"><span class="annot"><span class="annottext">do_pdfs :: Bool
</span><a href="#local-6989586621679360389"><span class="hs-identifier hs-var hs-var">do_pdfs</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; Bool
</span><a href="Analysis.Context.html#ctxt_generate_pdfs"><span class="hs-identifier hs-var">ctxt_generate_pdfs</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360394"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-532"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679360387"><span class="annot"><span class="annottext">Set (Instruction, Int)
</span><a href="#local-6989586621679360387"><span class="hs-identifier hs-var">new_calls</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360386"><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360386"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Set (Instruction, Int), CFG)
-&gt; StateT Context IO (Set (Instruction, Int), CFG)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Set (Instruction, Int), CFG)
 -&gt; StateT Context IO (Set (Instruction, Int), CFG))
-&gt; IO (Set (Instruction, Int), CFG)
-&gt; StateT Context IO (Set (Instruction, Int), CFG)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; Int -&gt; IO (Set (Instruction, Int), CFG)
</span><a href="Analysis.ControlFlow.html#cfg_gen"><span class="hs-identifier hs-var">cfg_gen</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360394"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360395"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span>  </span><span id="local-6989586621679360384"><span class="annot"><span class="annottext">IntMap CFG
</span><a href="#local-6989586621679360384"><span class="hs-identifier hs-var">cfgs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; IntMap CFG) -&gt; StateT Context IO (IntMap CFG)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap CFG
</span><a href="Analysis.Context.html#ctxt_cfgs"><span class="hs-identifier hs-var">ctxt_cfgs</span></a></span><span>
</span><span id="line-535"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap CFG -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_cfgs"><span class="hs-identifier hs-var">set_ctxt_cfgs</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap CFG -&gt; Context -&gt; Context)
-&gt; IntMap CFG -&gt; Context -&gt; Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; CFG -&gt; IntMap CFG -&gt; IntMap CFG
forall a. Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insert</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360395"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360386"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap CFG
</span><a href="#local-6989586621679360384"><span class="hs-identifier hs-var">cfgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Set (Instruction, Int) -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">S.null</span></span><span> </span><span class="annot"><span class="annottext">Set (Instruction, Int)
</span><a href="#local-6989586621679360387"><span class="hs-identifier hs-var">new_calls</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-538"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; StateT Context IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT Context IO ()) -&gt; IO () -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360391"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; CFG -&gt; String
</span><a href="Analysis.ControlFlow.html#cfg_to_dot"><span class="hs-identifier hs-var">cfg_to_dot</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360394"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360386"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679360389"><span class="hs-identifier hs-var">do_pdfs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-540"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; StateT Context IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT Context IO ()) -&gt; IO () -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">callCommand</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dot -Tpdf &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360391"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -o &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360390"><span class="hs-identifier hs-var">pdf</span></a></span><span>
</span><span id="line-541"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Generated CFG, exported to files: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360391"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; and &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360390"><span class="hs-identifier hs-var">pdf</span></a></span><span>
</span><span id="line-542"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-543"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Generated CFG, exported to file: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360391"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span>
</span><span id="line-544"></span><span>    </span><span class="annot"><span class="annottext">Set (Instruction, Int)
-&gt; StateT Context IO (Set (Instruction, Int))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Set (Instruction, Int)
</span><a href="#local-6989586621679360387"><span class="hs-identifier hs-var">new_calls</span></a></span><span>
</span><span id="line-545"></span><span>  </span><span class="hs-keyword">else</span><span>
</span><span id="line-546"></span><span>    </span><span class="annot"><span class="annottext">Set (Instruction, Int)
-&gt; StateT Context IO (Set (Instruction, Int))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Set (Instruction, Int)
</span><a href="#local-6989586621679360387"><span class="hs-identifier hs-var">new_calls</span></a></span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span>     </span><span>
</span><span id="line-549"></span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span id="ctxt_add_invariants"><span class="annot"><span class="annottext">ctxt_add_invariants :: Int
-&gt; FInit
-&gt; Invariants
-&gt; Set (NodeInfo, Predicate)
-&gt; Set VerificationCondition
-&gt; Set SStatePart
-&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_add_invariants"><span class="hs-identifier hs-var hs-var">ctxt_add_invariants</span></a></span></span><span> </span><span id="local-6989586621679360380"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360380"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span id="local-6989586621679360379"><span class="annot"><span class="annottext">FInit
</span><a href="#local-6989586621679360379"><span class="hs-identifier hs-var">finit</span></a></span></span><span> </span><span id="local-6989586621679360378"><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360378"><span class="hs-identifier hs-var">invs</span></a></span></span><span> </span><span id="local-6989586621679360377"><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360377"><span class="hs-identifier hs-var">posts</span></a></span></span><span> </span><span id="local-6989586621679360376"><span class="annot"><span class="annottext">Set VerificationCondition
</span><a href="#local-6989586621679360376"><span class="hs-identifier hs-var">vcs</span></a></span></span><span> </span><span id="local-6989586621679360375"><span class="annot"><span class="annottext">Set SStatePart
</span><a href="#local-6989586621679360375"><span class="hs-identifier hs-var">sps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-552"></span><span>  </span><span id="local-6989586621679360374"><span class="annot"><span class="annottext">IntMap Invariants
</span><a href="#local-6989586621679360374"><span class="hs-identifier hs-var">all_invs</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; IntMap Invariants) -&gt; m (IntMap Invariants)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap Invariants
</span><a href="Analysis.Context.html#ctxt_invs"><span class="hs-identifier hs-var">ctxt_invs</span></a></span><span>
</span><span id="line-553"></span><span>  </span><span id="local-6989586621679360373"><span class="annot"><span class="annottext">IntMap (Set (NodeInfo, Predicate))
</span><a href="#local-6989586621679360373"><span class="hs-identifier hs-var">all_posts</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; IntMap (Set (NodeInfo, Predicate)))
-&gt; m (IntMap (Set (NodeInfo, Predicate)))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap (Set (NodeInfo, Predicate))
</span><a href="Analysis.Context.html#ctxt_posts"><span class="hs-identifier hs-var">ctxt_posts</span></a></span><span>
</span><span id="line-554"></span><span>  </span><span id="local-6989586621679360372"><span class="annot"><span class="annottext">IntMap (Set VerificationCondition)
</span><a href="#local-6989586621679360372"><span class="hs-identifier hs-var">all_vcs</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; IntMap (Set VerificationCondition))
-&gt; m (IntMap (Set VerificationCondition))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap (Set VerificationCondition)
</span><a href="Analysis.Context.html#ctxt_vcs"><span class="hs-identifier hs-var">ctxt_vcs</span></a></span><span>
</span><span id="line-555"></span><span>  </span><span id="local-6989586621679360371"><span class="annot"><span class="annottext">IntMap FInit
</span><a href="#local-6989586621679360371"><span class="hs-identifier hs-var">all_finits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; IntMap FInit) -&gt; m (IntMap FInit)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap FInit
</span><a href="Analysis.Context.html#ctxt_finits"><span class="hs-identifier hs-var">ctxt_finits</span></a></span><span>
</span><span id="line-556"></span><span>  </span><span id="local-6989586621679360370"><span class="annot"><span class="annottext">IntMap (Set SStatePart)
</span><a href="#local-6989586621679360370"><span class="hs-identifier hs-var">all_sps</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; IntMap (Set SStatePart)) -&gt; m (IntMap (Set SStatePart))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap (Set SStatePart)
</span><a href="Analysis.Context.html#ctxt_stateparts"><span class="hs-identifier hs-var">ctxt_stateparts</span></a></span><span>
</span><span id="line-557"></span><span>
</span><span id="line-558"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap Invariants -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_invs"><span class="hs-identifier hs-var">set_ctxt_invs</span></a></span><span>       </span><span class="annot"><span class="annottext">(IntMap Invariants -&gt; Context -&gt; Context)
-&gt; IntMap Invariants -&gt; Context -&gt; Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Invariants -&gt; IntMap Invariants -&gt; IntMap Invariants
forall a. Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insert</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360380"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360378"><span class="hs-identifier hs-var">invs</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap Invariants
</span><a href="#local-6989586621679360374"><span class="hs-identifier hs-var">all_invs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap (Set (NodeInfo, Predicate)) -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_posts"><span class="hs-identifier hs-var">set_ctxt_posts</span></a></span><span>      </span><span class="annot"><span class="annottext">(IntMap (Set (NodeInfo, Predicate)) -&gt; Context -&gt; Context)
-&gt; IntMap (Set (NodeInfo, Predicate)) -&gt; Context -&gt; Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Set (NodeInfo, Predicate)
-&gt; IntMap (Set (NodeInfo, Predicate))
-&gt; IntMap (Set (NodeInfo, Predicate))
forall a. Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insert</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360380"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360377"><span class="hs-identifier hs-var">posts</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (Set (NodeInfo, Predicate))
</span><a href="#local-6989586621679360373"><span class="hs-identifier hs-var">all_posts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap (Set VerificationCondition) -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_vcs"><span class="hs-identifier hs-var">set_ctxt_vcs</span></a></span><span>        </span><span class="annot"><span class="annottext">(IntMap (Set VerificationCondition) -&gt; Context -&gt; Context)
-&gt; IntMap (Set VerificationCondition) -&gt; Context -&gt; Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Set VerificationCondition
-&gt; IntMap (Set VerificationCondition)
-&gt; IntMap (Set VerificationCondition)
forall a. Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insert</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360380"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">Set VerificationCondition
</span><a href="#local-6989586621679360376"><span class="hs-identifier hs-var">vcs</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (Set VerificationCondition)
</span><a href="#local-6989586621679360372"><span class="hs-identifier hs-var">all_vcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap FInit -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_finits"><span class="hs-identifier hs-var">set_ctxt_finits</span></a></span><span>     </span><span class="annot"><span class="annottext">(IntMap FInit -&gt; Context -&gt; Context)
-&gt; IntMap FInit -&gt; Context -&gt; Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FInit -&gt; IntMap FInit -&gt; IntMap FInit
forall a. Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insert</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360380"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">FInit
</span><a href="#local-6989586621679360379"><span class="hs-identifier hs-var">finit</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap FInit
</span><a href="#local-6989586621679360371"><span class="hs-identifier hs-var">all_finits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap (Set SStatePart) -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_stateparts"><span class="hs-identifier hs-var">set_ctxt_stateparts</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap (Set SStatePart) -&gt; Context -&gt; Context)
-&gt; IntMap (Set SStatePart) -&gt; Context -&gt; Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Set SStatePart
-&gt; IntMap (Set SStatePart)
-&gt; IntMap (Set SStatePart)
forall a. Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insert</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360380"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">Set SStatePart
</span><a href="#local-6989586621679360375"><span class="hs-identifier hs-var">sps</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (Set SStatePart)
</span><a href="#local-6989586621679360370"><span class="hs-identifier hs-var">all_sps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#ctxt_mk_fcontext"><span class="hs-identifier hs-type">ctxt_mk_fcontext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#FContext"><span class="hs-identifier hs-type">FContext</span></a></span><span>
</span><span id="line-568"></span><span id="ctxt_mk_fcontext"><span class="annot"><span class="annottext">ctxt_mk_fcontext :: Int -&gt; StateT Context IO FContext
</span><a href="Algorithm.L0_Lifting.html#ctxt_mk_fcontext"><span class="hs-identifier hs-var hs-var">ctxt_mk_fcontext</span></a></span></span><span> </span><span id="local-6989586621679360367"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360367"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-569"></span><span>  </span><span id="local-6989586621679360366"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360366"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-570"></span><span>  </span><span class="annot"><span class="annottext">FContext -&gt; StateT Context IO FContext
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FContext -&gt; StateT Context IO FContext)
-&gt; FContext -&gt; StateT Context IO FContext
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; Int -&gt; FContext
</span><a href="Analysis.Context.html#mk_fcontext"><span class="hs-identifier hs-var">mk_fcontext</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360366"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360367"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#ctxt_generate_invs"><span class="hs-identifier hs-type">ctxt_generate_invs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Analysis.Context.html#Invariants"><span class="hs-identifier hs-type">Invariants</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Analysis.Context.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Analysis.Context.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#SStatePart"><span class="hs-identifier hs-type">SStatePart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span id="ctxt_generate_invs"><span class="annot"><span class="annottext">ctxt_generate_invs :: Int
-&gt; Invariants
-&gt; Set (NodeInfo, Predicate)
-&gt; Set SStatePart
-&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_generate_invs"><span class="hs-identifier hs-var hs-var">ctxt_generate_invs</span></a></span></span><span> </span><span id="local-6989586621679360364"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360364"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span id="local-6989586621679360363"><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360363"><span class="hs-identifier hs-var">curr_invs</span></a></span></span><span> </span><span id="local-6989586621679360362"><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360362"><span class="hs-identifier hs-var">curr_posts</span></a></span></span><span> </span><span id="local-6989586621679360361"><span class="annot"><span class="annottext">Set SStatePart
</span><a href="#local-6989586621679360361"><span class="hs-identifier hs-var">curr_sps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-574"></span><span>  </span><span class="hs-comment">-- Generate invariants</span><span>
</span><span id="line-575"></span><span>  </span><span id="local-6989586621679360360"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360360"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360359"><span class="annot"><span class="annottext">get_max_time :: Int
</span><a href="#local-6989586621679360359"><span class="hs-identifier hs-var hs-var">get_max_time</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; Int
</span><a href="Analysis.Context.html#ctxt_max_time"><span class="hs-identifier hs-var">ctxt_max_time</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360360"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-577"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360357"><span class="annot"><span class="annottext">get_max_time_minutes :: Int
</span><a href="#local-6989586621679360357"><span class="hs-identifier hs-var hs-var">get_max_time_minutes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360359"><span class="hs-identifier hs-var">get_max_time</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">60000000</span></span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span>  </span><span id="local-6989586621679360355"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360355"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO FContext
</span><a href="Algorithm.L0_Lifting.html#ctxt_mk_fcontext"><span class="hs-identifier hs-var">ctxt_mk_fcontext</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360364"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-580"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360354"><span class="annot"><span class="annottext">finit :: FInit
</span><a href="#local-6989586621679360354"><span class="hs-identifier hs-var hs-var">finit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FContext -&gt; FInit
</span><a href="Analysis.Context.html#f_init"><span class="hs-identifier hs-var hs-var">f_init</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360355"><span class="hs-identifier hs-var">fctxt</span></a></span><span>
</span><span id="line-581"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360352"><span class="annot"><span class="annottext">f :: String
</span><a href="#local-6989586621679360352"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; Int -&gt; String
</span><a href="Analysis.FunctionNames.html#function_name_of_entry"><span class="hs-identifier hs-var">function_name_of_entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext -&gt; Context
</span><a href="Analysis.Context.html#f_ctxt"><span class="hs-identifier hs-var hs-var">f_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360355"><span class="hs-identifier hs-var">fctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext -&gt; Int
</span><a href="Analysis.Context.html#f_entry"><span class="hs-identifier hs-var hs-var">f_entry</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360355"><span class="hs-identifier hs-var">fctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span>  </span><span>
</span><span id="line-584"></span><span>  </span><span class="hs-comment">-- when (finit /= init_finit) $ to_out $ &quot;Function initialisation: &quot; ++ show finit</span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span>  </span><span class="hs-comment">-- let a       = acode_simp $ cfg_to_acode g 0 IS.empty</span><span>
</span><span id="line-587"></span><span>  </span><span id="local-6989586621679360351"><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360351"><span class="hs-identifier hs-var">g</span></a></span></span><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; CFG) -&gt; StateT Context IO CFG
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe CFG -&gt; CFG
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe CFG -&gt; CFG) -&gt; (Context -&gt; Maybe CFG) -&gt; Context -&gt; CFG
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap CFG -&gt; Maybe CFG
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360364"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap CFG -&gt; Maybe CFG)
-&gt; (Context -&gt; IntMap CFG) -&gt; Context -&gt; Maybe CFG
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap CFG
</span><a href="Analysis.Context.html#ctxt_cfgs"><span class="hs-identifier hs-var">ctxt_cfgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360350"><span class="annot"><span class="annottext">p :: Predicate
</span><a href="#local-6989586621679360350"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FContext
-&gt; String
-&gt; Invariants
-&gt; Set (NodeInfo, Predicate)
-&gt; Set SStatePart
-&gt; Predicate
</span><a href="Instantiation.SymbolicPropagation.html#init_pred"><span class="hs-identifier hs-var">init_pred</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360355"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360352"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360363"><span class="hs-identifier hs-var">curr_invs</span></a></span><span> </span><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360362"><span class="hs-identifier hs-var">curr_posts</span></a></span><span> </span><span class="annot"><span class="annottext">Set SStatePart
</span><a href="#local-6989586621679360361"><span class="hs-identifier hs-var">curr_sps</span></a></span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span>  </span><span id="local-6989586621679360348"><span class="annot"><span class="annottext">Maybe (Invariants, Set VerificationCondition)
</span><a href="#local-6989586621679360348"><span class="hs-identifier hs-var">result</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe (Invariants, Set VerificationCondition))
-&gt; StateT
     Context IO (Maybe (Invariants, Set VerificationCondition))
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; IO (Invariants, Set VerificationCondition)
-&gt; IO (Maybe (Invariants, Set VerificationCondition))
forall a. Int -&gt; IO a -&gt; IO (Maybe a)
</span><span class="hs-identifier hs-var">timeout</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360359"><span class="hs-identifier hs-var">get_max_time</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Invariants, Set VerificationCondition)
 -&gt; IO (Maybe (Invariants, Set VerificationCondition)))
-&gt; IO (Invariants, Set VerificationCondition)
-&gt; IO (Maybe (Invariants, Set VerificationCondition))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Invariants, Set VerificationCondition)
-&gt; IO (Invariants, Set VerificationCondition)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Invariants, Set VerificationCondition)
 -&gt; IO (Invariants, Set VerificationCondition))
-&gt; (Invariants, Set VerificationCondition)
-&gt; IO (Invariants, Set VerificationCondition)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">FContext
-&gt; CFG
-&gt; Int
-&gt; Predicate
-&gt; (Invariants, Set VerificationCondition)
forall ctxt pred.
Propagator ctxt pred =&gt;
ctxt
-&gt; CFG -&gt; Int -&gt; pred -&gt; (IntMap pred, Set VerificationCondition)
</span><a href="Generic.SymbolicPropagation.html#do_prop"><span class="hs-identifier hs-var">do_prop</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360355"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360351"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360350"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- TODO always 0?</span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Invariants, Set VerificationCondition)
</span><a href="#local-6989586621679360348"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-593"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Invariants, Set VerificationCondition)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-594"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Entry &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360364"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: time out of &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360357"><span class="hs-identifier hs-var">get_max_time_minutes</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; minutes reached.&quot;</span></span><span>
</span><span id="line-595"></span><span>      </span><span class="annot"><span class="annottext">Int
-&gt; FInit
-&gt; Invariants
-&gt; Set (NodeInfo, Predicate)
-&gt; Set VerificationCondition
-&gt; Set SStatePart
-&gt; StateT Context IO ()
forall (m :: * -&gt; *).
MonadState Context m =&gt;
Int
-&gt; FInit
-&gt; Invariants
-&gt; Set (NodeInfo, Predicate)
-&gt; Set VerificationCondition
-&gt; Set SStatePart
-&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_add_invariants"><span class="hs-identifier hs-var">ctxt_add_invariants</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360364"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">FInit
</span><a href="#local-6989586621679360354"><span class="hs-identifier hs-var">finit</span></a></span><span> </span><span class="annot"><span class="annottext">Invariants
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span> </span><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span> </span><span class="annot"><span class="annottext">Set VerificationCondition
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span> </span><span class="annot"><span class="annottext">Set SStatePart
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span>
</span><span id="line-596"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679360346"><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360346"><span class="hs-identifier hs-var">invs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360345"><span class="annot"><span class="annottext">Set VerificationCondition
</span><a href="#local-6989586621679360345"><span class="hs-identifier hs-var">vcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-597"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360344"><span class="annot"><span class="annottext">blocks :: [Int]
</span><a href="#local-6989586621679360344"><span class="hs-identifier hs-var hs-var">blocks</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntMap [Int] -&gt; [Int]
forall a. IntMap a -&gt; [Int]
</span><span class="hs-identifier hs-var">IM.keys</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [Int] -&gt; [Int]) -&gt; IntMap [Int] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CFG -&gt; IntMap [Int]
</span><a href="Analysis.Context.html#cfg_blocks"><span class="hs-identifier hs-var hs-var">cfg_blocks</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360351"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-598"></span><span>      </span><span id="local-6989586621679360341"><span class="annot"><span class="annottext">[((NodeInfo, Predicate), Set VerificationCondition)]
</span><a href="#local-6989586621679360341"><span class="hs-identifier hs-var">postss</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Maybe ((NodeInfo, Predicate), Set VerificationCondition)]
-&gt; [((NodeInfo, Predicate), Set VerificationCondition)]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">([Maybe ((NodeInfo, Predicate), Set VerificationCondition)]
 -&gt; [((NodeInfo, Predicate), Set VerificationCondition)])
-&gt; StateT
     Context
     IO
     [Maybe ((NodeInfo, Predicate), Set VerificationCondition)]
-&gt; StateT
     Context IO [((NodeInfo, Predicate), Set VerificationCondition)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Int
 -&gt; StateT
      Context
      IO
      (Maybe ((NodeInfo, Predicate), Set VerificationCondition)))
-&gt; [Int]
-&gt; StateT
     Context
     IO
     [Maybe ((NodeInfo, Predicate), Set VerificationCondition)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext
-&gt; CFG
-&gt; Invariants
-&gt; Int
-&gt; StateT
     Context
     IO
     (Maybe ((NodeInfo, Predicate), Set VerificationCondition))
</span><a href="#local-6989586621679360339"><span class="hs-identifier hs-var">get_post</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360355"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360351"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360346"><span class="hs-identifier hs-var">invs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679360344"><span class="hs-identifier hs-var">blocks</span></a></span><span>
</span><span id="line-599"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360338"><span class="annot"><span class="annottext">posts :: Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360338"><span class="hs-identifier hs-var hs-var">posts</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(NodeInfo, Predicate)] -&gt; Set (NodeInfo, Predicate)
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(NodeInfo, Predicate)] -&gt; Set (NodeInfo, Predicate))
-&gt; [(NodeInfo, Predicate)] -&gt; Set (NodeInfo, Predicate)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(((NodeInfo, Predicate), Set VerificationCondition)
 -&gt; (NodeInfo, Predicate))
-&gt; [((NodeInfo, Predicate), Set VerificationCondition)]
-&gt; [(NodeInfo, Predicate)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((NodeInfo, Predicate), Set VerificationCondition)
-&gt; (NodeInfo, Predicate)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[((NodeInfo, Predicate), Set VerificationCondition)]
</span><a href="#local-6989586621679360341"><span class="hs-identifier hs-var">postss</span></a></span><span>
</span><span id="line-600"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360336"><span class="annot"><span class="annottext">vcs' :: Set VerificationCondition
</span><a href="#local-6989586621679360336"><span class="hs-identifier hs-var hs-var">vcs'</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Set VerificationCondition] -&gt; Set VerificationCondition
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">S.unions</span></span><span> </span><span class="annot"><span class="annottext">([Set VerificationCondition] -&gt; Set VerificationCondition)
-&gt; [Set VerificationCondition] -&gt; Set VerificationCondition
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(((NodeInfo, Predicate), Set VerificationCondition)
 -&gt; Set VerificationCondition)
-&gt; [((NodeInfo, Predicate), Set VerificationCondition)]
-&gt; [Set VerificationCondition]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((NodeInfo, Predicate), Set VerificationCondition)
-&gt; Set VerificationCondition
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[((NodeInfo, Predicate), Set VerificationCondition)]
</span><a href="#local-6989586621679360341"><span class="hs-identifier hs-var">postss</span></a></span><span> </span><span>
</span><span id="line-601"></span><span>      </span><span class="annot"><span class="annottext">Int
-&gt; FInit
-&gt; Invariants
-&gt; Set (NodeInfo, Predicate)
-&gt; Set VerificationCondition
-&gt; Set SStatePart
-&gt; StateT Context IO ()
forall (m :: * -&gt; *).
MonadState Context m =&gt;
Int
-&gt; FInit
-&gt; Invariants
-&gt; Set (NodeInfo, Predicate)
-&gt; Set VerificationCondition
-&gt; Set SStatePart
-&gt; m ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_add_invariants"><span class="hs-identifier hs-var">ctxt_add_invariants</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360364"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">FInit
</span><a href="#local-6989586621679360354"><span class="hs-identifier hs-var">finit</span></a></span><span> </span><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360346"><span class="hs-identifier hs-var">invs</span></a></span><span> </span><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360338"><span class="hs-identifier hs-var">posts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set VerificationCondition
-&gt; Set VerificationCondition -&gt; Set VerificationCondition
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">S.union</span></span><span> </span><span class="annot"><span class="annottext">Set VerificationCondition
</span><a href="#local-6989586621679360345"><span class="hs-identifier hs-var">vcs</span></a></span><span> </span><span class="annot"><span class="annottext">Set VerificationCondition
</span><a href="#local-6989586621679360336"><span class="hs-identifier hs-var">vcs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set SStatePart -&gt; Set SStatePart -&gt; Set SStatePart
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">S.union</span></span><span> </span><span class="annot"><span class="annottext">Set SStatePart
</span><a href="#local-6989586621679360361"><span class="hs-identifier hs-var">curr_sps</span></a></span><span> </span><span class="annot"><span class="annottext">(Set SStatePart -&gt; Set SStatePart)
-&gt; Set SStatePart -&gt; Set SStatePart
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Invariants -&gt; Set (NodeInfo, Predicate) -&gt; Set SStatePart
</span><a href="Instantiation.SymbolicPropagation.html#gather_stateparts"><span class="hs-identifier hs-var">gather_stateparts</span></a></span><span> </span><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360346"><span class="hs-identifier hs-var">invs</span></a></span><span> </span><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360338"><span class="hs-identifier hs-var">posts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-603"></span><span>  </span><span class="annot"><a href="#local-6989586621679360339"><span class="hs-identifier hs-type">get_post</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Analysis.Context.html#FContext"><span class="hs-identifier hs-type">FContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Analysis.Context.html#CFG"><span class="hs-identifier hs-type">CFG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Analysis.Context.html#Invariants"><span class="hs-identifier hs-type">Invariants</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Analysis.Context.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Analysis.Context.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="Generic.SymbolicConstituents.html#VCS"><span class="hs-identifier hs-type">VCS</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-604"></span><span>  </span><span id="local-6989586621679360339"><span class="annot"><span class="annottext">get_post :: FContext
-&gt; CFG
-&gt; Invariants
-&gt; Int
-&gt; StateT
     Context
     IO
     (Maybe ((NodeInfo, Predicate), Set VerificationCondition))
</span><a href="#local-6989586621679360339"><span class="hs-identifier hs-var hs-var">get_post</span></a></span></span><span> </span><span id="local-6989586621679360333"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360333"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span> </span><span id="local-6989586621679360332"><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360332"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679360331"><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360331"><span class="hs-identifier hs-var">invs</span></a></span></span><span> </span><span id="local-6989586621679360330"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360330"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-605"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360329"><span class="annot"><span class="annottext">ctxt :: Context
</span><a href="#local-6989586621679360329"><span class="hs-identifier hs-var hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FContext -&gt; Context
</span><a href="Analysis.Context.html#f_ctxt"><span class="hs-identifier hs-var hs-var">f_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360333"><span class="hs-identifier hs-var">fctxt</span></a></span><span>
</span><span id="line-606"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CFG -&gt; Int -&gt; Bool
</span><a href="Analysis.ControlFlow.html#is_end_node"><span class="hs-identifier hs-var">is_end_node</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360332"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360330"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-607"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679360327"><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360327"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360326"><span class="annot"><span class="annottext">Set VerificationCondition
</span><a href="#local-6989586621679360326"><span class="hs-identifier hs-var">vcs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity (Predicate, Set VerificationCondition)
-&gt; (Predicate, Set VerificationCondition)
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity (Predicate, Set VerificationCondition)
 -&gt; (Predicate, Set VerificationCondition))
-&gt; Identity (Predicate, Set VerificationCondition)
-&gt; (Predicate, Set VerificationCondition)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT (Predicate, Set VerificationCondition) Identity ()
-&gt; (Predicate, Set VerificationCondition)
-&gt; Identity (Predicate, Set VerificationCondition)
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m s
</span><span class="hs-identifier hs-var">execStateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext
-&gt; CFG
-&gt; Int
-&gt; StateT (Predicate, Set VerificationCondition) Identity ()
</span><a href="#local-6989586621679360324"><span class="hs-identifier hs-var">do_tau</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360333"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360332"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360330"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Invariants -&gt; Int -&gt; Predicate
forall p. String -&gt; IntMap p -&gt; Int -&gt; p
</span><a href="Base.html#im_lookup"><span class="hs-identifier hs-var">im_lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;B.) Block &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360330"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; in invs&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360331"><span class="hs-identifier hs-var">invs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360330"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set VerificationCondition
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>      </span><span class="annot"><span class="annottext">Maybe ((NodeInfo, Predicate), Set VerificationCondition)
-&gt; StateT
     Context
     IO
     (Maybe ((NodeInfo, Predicate), Set VerificationCondition))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ((NodeInfo, Predicate), Set VerificationCondition)
 -&gt; StateT
      Context
      IO
      (Maybe ((NodeInfo, Predicate), Set VerificationCondition)))
-&gt; Maybe ((NodeInfo, Predicate), Set VerificationCondition)
-&gt; StateT
     Context
     IO
     (Maybe ((NodeInfo, Predicate), Set VerificationCondition))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((NodeInfo, Predicate), Set VerificationCondition)
-&gt; Maybe ((NodeInfo, Predicate), Set VerificationCondition)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; CFG -&gt; Int -&gt; NodeInfo
</span><a href="Analysis.ControlFlow.html#node_info_of"><span class="hs-identifier hs-var">node_info_of</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360329"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360332"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360330"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360327"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set VerificationCondition
</span><a href="#local-6989586621679360326"><span class="hs-identifier hs-var">vcs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-610"></span><span>      </span><span class="annot"><span class="annottext">Maybe ((NodeInfo, Predicate), Set VerificationCondition)
-&gt; StateT
     Context
     IO
     (Maybe ((NodeInfo, Predicate), Set VerificationCondition))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ((NodeInfo, Predicate), Set VerificationCondition)
 -&gt; StateT
      Context
      IO
      (Maybe ((NodeInfo, Predicate), Set VerificationCondition)))
-&gt; Maybe ((NodeInfo, Predicate), Set VerificationCondition)
-&gt; StateT
     Context
     IO
     (Maybe ((NodeInfo, Predicate), Set VerificationCondition))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe ((NodeInfo, Predicate), Set VerificationCondition)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span>  </span><span class="hs-comment">-- do one more tau-transformation on the node, as the stored invariant is a </span><span>
</span><span id="line-613"></span><span>  </span><span class="hs-comment">-- precondition (not a postcondition) of the node.</span><span>
</span><span id="line-614"></span><span>  </span><span class="annot"><a href="#local-6989586621679360324"><span class="hs-identifier hs-type">do_tau</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Analysis.Context.html#FContext"><span class="hs-identifier hs-type">FContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Analysis.Context.html#CFG"><span class="hs-identifier hs-type">CFG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Analysis.Context.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Generic.SymbolicConstituents.html#VCS"><span class="hs-identifier hs-type">VCS</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-615"></span><span>  </span><span id="local-6989586621679360324"><span class="annot"><span class="annottext">do_tau :: FContext
-&gt; CFG
-&gt; Int
-&gt; StateT (Predicate, Set VerificationCondition) Identity ()
</span><a href="#local-6989586621679360324"><span class="hs-identifier hs-var hs-var">do_tau</span></a></span></span><span> </span><span id="local-6989586621679360321"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360321"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span> </span><span id="local-6989586621679360320"><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360320"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679360319"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360319"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Predicate, Set VerificationCondition)
 -&gt; (Predicate, Set VerificationCondition))
-&gt; StateT (Predicate, Set VerificationCondition) Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">(((Predicate, Set VerificationCondition)
  -&gt; (Predicate, Set VerificationCondition))
 -&gt; StateT (Predicate, Set VerificationCondition) Identity ())
-&gt; ((Predicate, Set VerificationCondition)
    -&gt; (Predicate, Set VerificationCondition))
-&gt; StateT (Predicate, Set VerificationCondition) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext
-&gt; [Instruction]
-&gt; Maybe [Instruction]
-&gt; Predicate
-&gt; (Predicate, Set VerificationCondition)
forall ctxt pred.
Propagator ctxt pred =&gt;
ctxt
-&gt; [Instruction]
-&gt; Maybe [Instruction]
-&gt; pred
-&gt; (pred, Set VerificationCondition)
</span><a href="Generic.SymbolicPropagation.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360321"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CFG -&gt; Int -&gt; [Instruction]
</span><a href="Analysis.ControlFlow.html#fetch_block"><span class="hs-identifier hs-var">fetch_block</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360320"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360319"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [Instruction]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">(Predicate -&gt; (Predicate, Set VerificationCondition))
-&gt; ((Predicate, Set VerificationCondition) -&gt; Predicate)
-&gt; (Predicate, Set VerificationCondition)
-&gt; (Predicate, Set VerificationCondition)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Predicate, Set VerificationCondition) -&gt; Predicate
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#ctxt_del_entry"><span class="hs-identifier hs-type">ctxt_del_entry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span id="ctxt_del_entry"><span class="annot"><span class="annottext">ctxt_del_entry :: Int -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_del_entry"><span class="hs-identifier hs-var hs-var">ctxt_del_entry</span></a></span></span><span> </span><span id="local-6989586621679360316"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360316"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-625"></span><span>  </span><span id="local-6989586621679360315"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360315"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-626"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Graph -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_entries"><span class="hs-identifier hs-var">set_ctxt_entries</span></a></span><span> </span><span class="annot"><span class="annottext">(Graph -&gt; Context -&gt; Context) -&gt; Graph -&gt; Context -&gt; Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Graph -&gt; Int -&gt; Graph
</span><a href="Base.html#graph_delete"><span class="hs-identifier hs-var">graph_delete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; Graph
</span><a href="Analysis.Context.html#ctxt_entries"><span class="hs-identifier hs-var">ctxt_entries</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360315"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360316"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span id="ctxt_add_call"><span class="annot"><span class="annottext">ctxt_add_call :: Int -&gt; VerificationResult -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#ctxt_add_call"><span class="hs-identifier hs-var hs-var">ctxt_add_call</span></a></span></span><span> </span><span id="local-6989586621679360313"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360313"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span id="local-6989586621679360312"><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621679360312"><span class="hs-identifier hs-var">verified</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-629"></span><span>  </span><span id="local-6989586621679360311"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360311"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-630"></span><span>  </span><span id="local-6989586621679360310"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360310"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO FContext
</span><a href="Algorithm.L0_Lifting.html#ctxt_mk_fcontext"><span class="hs-identifier hs-var">ctxt_mk_fcontext</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360313"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-631"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360309"><span class="annot"><span class="annottext">calls :: IntMap FReturnBehavior
</span><a href="#local-6989586621679360309"><span class="hs-identifier hs-var hs-var">calls</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; IntMap FReturnBehavior
</span><a href="Analysis.Context.html#ctxt_calls"><span class="hs-identifier hs-var">ctxt_calls</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360311"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-632"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360308"><span class="annot"><span class="annottext">dirname :: String
</span><a href="#local-6989586621679360308"><span class="hs-identifier hs-var hs-var">dirname</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; String
</span><a href="Analysis.Context.html#ctxt_dirname"><span class="hs-identifier hs-var">ctxt_dirname</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360311"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-633"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360307"><span class="annot"><span class="annottext">name :: String
</span><a href="#local-6989586621679360307"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; String
</span><a href="Analysis.Context.html#ctxt_name"><span class="hs-identifier hs-var">ctxt_name</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360311"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-634"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360306"><span class="annot"><span class="annottext">fname :: String
</span><a href="#local-6989586621679360306"><span class="hs-identifier hs-var hs-var">fname</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360308"><span class="hs-identifier hs-var">dirname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360307"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.calls&quot;</span></span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FInit
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679360305"><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360305"><span class="hs-identifier hs-var">invs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360304"><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360304"><span class="hs-identifier hs-var">posts</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set SStatePart
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; StateT
     Context
     IO
     (FInit, Invariants, Set (NodeInfo, Predicate), Set SStatePart)
</span><a href="Algorithm.L0_Lifting.html#ctxt_get_curr_posts"><span class="hs-identifier hs-var">ctxt_get_curr_posts</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360313"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-637"></span><span>  </span><span>
</span><span id="line-638"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679360303"><span class="annot"><span class="annottext">FReturnBehavior
</span><a href="#local-6989586621679360303"><span class="hs-identifier hs-var">ret</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360302"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360302"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-639"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NodeInfo -&gt; Bool) -&gt; Set NodeInfo -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeInfo -&gt; NodeInfo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">NodeInfo
</span><a href="Analysis.Context.html#UnresolvedIndirection"><span class="hs-identifier hs-var">UnresolvedIndirection</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Set NodeInfo -&gt; Bool) -&gt; Set NodeInfo -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((NodeInfo, Predicate) -&gt; NodeInfo)
-&gt; Set (NodeInfo, Predicate) -&gt; Set NodeInfo
forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><span class="hs-identifier hs-var">S.map</span></span><span> </span><span class="annot"><span class="annottext">(NodeInfo, Predicate) -&gt; NodeInfo
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360304"><span class="hs-identifier hs-var">posts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621679360312"><span class="hs-identifier hs-var">verified</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationResult -&gt; [VerificationResult] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VerificationResult
</span><a href="Analysis.Context.html#VerificationSuccesWithAssumptions"><span class="hs-identifier hs-var">VerificationSuccesWithAssumptions</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">VerificationResult
</span><a href="Analysis.Context.html#VerificationSuccess"><span class="hs-identifier hs-var">VerificationSuccess</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-640"></span><span>      </span><span class="annot"><span class="annottext">(FReturnBehavior, String)
-&gt; StateT Context IO (FReturnBehavior, String)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FReturnBehavior
</span><a href="Analysis.Context.html#UnknownRetBehavior"><span class="hs-identifier hs-var">UnknownRetBehavior</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unknown.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(NodeInfo -&gt; Bool) -&gt; Set NodeInfo -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeInfo -&gt; NodeInfo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">NodeInfo
</span><a href="Analysis.Context.html#Terminal"><span class="hs-identifier hs-var">Terminal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Set NodeInfo -&gt; Bool) -&gt; Set NodeInfo -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((NodeInfo, Predicate) -&gt; NodeInfo)
-&gt; Set (NodeInfo, Predicate) -&gt; Set NodeInfo
forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><span class="hs-identifier hs-var">S.map</span></span><span> </span><span class="annot"><span class="annottext">(NodeInfo, Predicate) -&gt; NodeInfo
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360304"><span class="hs-identifier hs-var">posts</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-642"></span><span>      </span><span class="annot"><span class="annottext">(FReturnBehavior, String)
-&gt; StateT Context IO (FReturnBehavior, String)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FReturnBehavior
</span><a href="Analysis.Context.html#Terminating"><span class="hs-identifier hs-var">Terminating</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;always terminating.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360299"><span class="annot"><span class="annottext">q :: Predicate
</span><a href="#local-6989586621679360299"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FContext -&gt; [Predicate] -&gt; Predicate
forall ctxt v p.
SymbolicExecutable ctxt v p =&gt;
ctxt -&gt; [Sstate v p] -&gt; Sstate v p
</span><a href="Generic.SymbolicConstituents.html#supremum"><span class="hs-identifier hs-var">supremum</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360310"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">([Predicate] -&gt; Predicate) -&gt; [Predicate] -&gt; Predicate
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((NodeInfo, Predicate) -&gt; Predicate)
-&gt; [(NodeInfo, Predicate)] -&gt; [Predicate]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(NodeInfo, Predicate) -&gt; Predicate
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([(NodeInfo, Predicate)] -&gt; [Predicate])
-&gt; [(NodeInfo, Predicate)] -&gt; [Predicate]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set (NodeInfo, Predicate) -&gt; [(NodeInfo, Predicate)]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">S.toList</span></span><span> </span><span class="annot"><span class="annottext">(Set (NodeInfo, Predicate) -&gt; [(NodeInfo, Predicate)])
-&gt; Set (NodeInfo, Predicate) -&gt; [(NodeInfo, Predicate)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((NodeInfo, Predicate) -&gt; Bool)
-&gt; Set (NodeInfo, Predicate) -&gt; Set (NodeInfo, Predicate)
forall a. (a -&gt; Bool) -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">S.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeInfo -&gt; NodeInfo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">NodeInfo
</span><a href="Analysis.Context.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeInfo -&gt; Bool)
-&gt; ((NodeInfo, Predicate) -&gt; NodeInfo)
-&gt; (NodeInfo, Predicate)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(NodeInfo, Predicate) -&gt; NodeInfo
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Set (NodeInfo, Predicate) -&gt; Set (NodeInfo, Predicate))
-&gt; Set (NodeInfo, Predicate) -&gt; Set (NodeInfo, Predicate)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360304"><span class="hs-identifier hs-var">posts</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-644"></span><span>      </span><span class="annot"><span class="annottext">(FReturnBehavior, String)
-&gt; StateT Context IO (FReturnBehavior, String)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Predicate -&gt; FReturnBehavior
</span><a href="Analysis.Context.html#ReturningWith"><span class="hs-identifier hs-var">ReturningWith</span></a></span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360299"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;normally returning.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span>  </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap FReturnBehavior -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_calls"><span class="hs-identifier hs-var">set_ctxt_calls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; FReturnBehavior
-&gt; IntMap FReturnBehavior
-&gt; IntMap FReturnBehavior
forall a. Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insert</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360313"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">FReturnBehavior
</span><a href="#local-6989586621679360303"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">(IntMap FReturnBehavior -&gt; IntMap FReturnBehavior)
-&gt; IntMap FReturnBehavior -&gt; IntMap FReturnBehavior
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap FReturnBehavior
</span><a href="#local-6989586621679360309"><span class="hs-identifier hs-var">calls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Function at entry: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360313"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; analyzed, return behavior is &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360302"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-648"></span><span>
</span><span id="line-649"></span><span>
</span><span id="line-650"></span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span>
</span><span id="line-654"></span><span class="annot"><a href="Algorithm.L0_Lifting.html#ctxt_analyze_unresolved_indirections"><span class="hs-identifier hs-type">ctxt_analyze_unresolved_indirections</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="Analysis.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-655"></span><span id="ctxt_analyze_unresolved_indirections"><span class="annot"><span class="annottext">ctxt_analyze_unresolved_indirections :: Int -&gt; StateT Context IO Bool
</span><a href="Algorithm.L0_Lifting.html#ctxt_analyze_unresolved_indirections"><span class="hs-identifier hs-var hs-var">ctxt_analyze_unresolved_indirections</span></a></span></span><span> </span><span id="local-6989586621679360295"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360295"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-656"></span><span>  </span><span id="local-6989586621679360294"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360294"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679360293"><span class="annot"><span class="annottext">FInit
</span><a href="#local-6989586621679360293"><span class="hs-identifier hs-var">finit</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360292"><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360292"><span class="hs-identifier hs-var">invs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360291"><span class="annot"><span class="annottext">Set (NodeInfo, Predicate)
</span><a href="#local-6989586621679360291"><span class="hs-identifier hs-var">posts</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set SStatePart
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; StateT
     Context
     IO
     (FInit, Invariants, Set (NodeInfo, Predicate), Set SStatePart)
</span><a href="Algorithm.L0_Lifting.html#ctxt_get_curr_posts"><span class="hs-identifier hs-var">ctxt_get_curr_posts</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360295"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-659"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360290"><span class="annot"><span class="annottext">f :: String
</span><a href="#local-6989586621679360290"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; Int -&gt; String
</span><a href="Analysis.FunctionNames.html#function_name_of_entry"><span class="hs-identifier hs-var">function_name_of_entry</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360294"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360295"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-660"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360289"><span class="annot"><span class="annottext">g :: CFG
</span><a href="#local-6989586621679360289"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Context -&gt; IntMap CFG
</span><a href="Analysis.Context.html#ctxt_cfgs"><span class="hs-identifier hs-var">ctxt_cfgs</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360294"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap CFG -&gt; Int -&gt; CFG
forall a. IntMap a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">IM.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360295"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-661"></span><span>
</span><span id="line-662"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360288"><span class="annot"><span class="annottext">bs :: [Int]
</span><a href="#local-6989586621679360288"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; [Int]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679360287"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360287"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Context -&gt; CFG -&gt; Int -&gt; NodeInfo
</span><a href="Analysis.ControlFlow.html#node_info_of"><span class="hs-identifier hs-var">node_info_of</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360294"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360289"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360287"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">NodeInfo -&gt; NodeInfo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NodeInfo
</span><a href="Analysis.Context.html#UnresolvedIndirection"><span class="hs-identifier hs-var">UnresolvedIndirection</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; [Int]) -&gt; [Int] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap [Int] -&gt; [Int]
forall a. IntMap a -&gt; [Int]
</span><span class="hs-identifier hs-var">IM.keys</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [Int] -&gt; [Int]) -&gt; IntMap [Int] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CFG -&gt; IntMap [Int]
</span><a href="Analysis.Context.html#cfg_blocks"><span class="hs-identifier hs-var hs-var">cfg_blocks</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360289"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-663"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679360288"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-664"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No unresolved indirections.&quot;</span></span><span>
</span><span id="line-665"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; StateT Context IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-666"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Invariants -&gt; Bool
forall a. IntMap a -&gt; Bool
</span><span class="hs-identifier hs-var">IM.null</span></span><span> </span><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360292"><span class="hs-identifier hs-var">invs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-667"></span><span>    </span><span class="hs-comment">-- time out</span><span>
</span><span id="line-668"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; StateT Context IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-669"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-670"></span><span>    </span><span id="local-6989586621679360285"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679360285"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int]
-&gt; (Int -&gt; StateT Context IO Bool) -&gt; StateT Context IO [Bool]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679360288"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; StateT Context IO Bool) -&gt; StateT Context IO [Bool])
-&gt; (Int -&gt; StateT Context IO Bool) -&gt; StateT Context IO [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; CFG -&gt; Invariants -&gt; Int -&gt; StateT Context IO Bool
forall p. p -&gt; CFG -&gt; Invariants -&gt; Int -&gt; StateT Context IO Bool
</span><a href="#local-6989586621679360283"><span class="hs-identifier hs-var">try_to_resolve_indirection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360290"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360289"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360292"><span class="hs-identifier hs-var">invs</span></a></span><span>
</span><span id="line-671"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; StateT Context IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; StateT Context IO Bool) -&gt; Bool -&gt; StateT Context IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; [Bool] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679360285"><span class="hs-identifier hs-var">results</span></a></span><span> </span><span class="hs-comment">-- prevent lazy execution</span><span>
</span><span id="line-672"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-673"></span><span>  </span><span id="local-6989586621679360283"><span class="annot"><span class="annottext">try_to_resolve_indirection :: p -&gt; CFG -&gt; Invariants -&gt; Int -&gt; StateT Context IO Bool
</span><a href="#local-6989586621679360283"><span class="hs-identifier hs-var hs-var">try_to_resolve_indirection</span></a></span></span><span> </span><span id="local-6989586621679360282"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679360282"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679360281"><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360281"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679360280"><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360280"><span class="hs-identifier hs-var">invs</span></a></span></span><span> </span><span id="local-6989586621679360279"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360279"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-674"></span><span>    </span><span id="local-6989586621679360278"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360278"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-675"></span><span>    </span><span id="local-6989586621679360277"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360277"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO FContext
</span><a href="Algorithm.L0_Lifting.html#ctxt_mk_fcontext"><span class="hs-identifier hs-var">ctxt_mk_fcontext</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360295"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-676"></span><span>    </span><span id="local-6989586621679360276"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360276"><span class="hs-identifier hs-var">max_tries</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; Int) -&gt; StateT Context IO Int
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; Int
</span><a href="Analysis.Context.html#ctxt_max_jump_table_size"><span class="hs-identifier hs-var">ctxt_max_jump_table_size</span></a></span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span>    </span><span id="local-6989586621679360274"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360274"><span class="hs-identifier hs-var">dirname</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; String) -&gt; StateT Context IO String
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; String
</span><a href="Analysis.Context.html#ctxt_dirname"><span class="hs-identifier hs-var">ctxt_dirname</span></a></span><span>
</span><span id="line-679"></span><span>    </span><span id="local-6989586621679360273"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360273"><span class="hs-identifier hs-var">name</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; String) -&gt; StateT Context IO String
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; String
</span><a href="Analysis.Context.html#ctxt_name"><span class="hs-identifier hs-var">ctxt_name</span></a></span><span>
</span><span id="line-680"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360272"><span class="annot"><span class="annottext">fname :: String
</span><a href="#local-6989586621679360272"><span class="hs-identifier hs-var hs-var">fname</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360274"><span class="hs-identifier hs-var">dirname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360273"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.indirections&quot;</span></span><span> </span><span>
</span><span id="line-681"></span><span>
</span><span id="line-682"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360271"><span class="annot"><span class="annottext">i :: Instruction
</span><a href="#local-6989586621679360271"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Instruction] -&gt; Instruction
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CFG -&gt; Int -&gt; [Instruction]
</span><a href="Analysis.ControlFlow.html#fetch_block"><span class="hs-identifier hs-var">fetch_block</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360281"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360279"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679360269"><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360269"><span class="hs-identifier hs-var">trgt</span></a></span></span><span class="hs-special">]</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; [GenericOperand Register]
forall label storage prefix opcode annotation.
GenericInstruction label storage prefix opcode annotation
-&gt; [GenericOperand storage]
</span><a href="Generic.Instruction.html#srcs"><span class="hs-identifier hs-var hs-var">Instr.srcs</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679360271"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-684"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360267"><span class="annot"><span class="annottext">p :: Predicate
</span><a href="#local-6989586621679360267"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Invariants -&gt; Int -&gt; Predicate
forall p. String -&gt; IntMap p -&gt; Int -&gt; p
</span><a href="Base.html#im_lookup"><span class="hs-identifier hs-var">im_lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;A.) Block &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360279"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; in invs&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Invariants
</span><a href="#local-6989586621679360280"><span class="hs-identifier hs-var">invs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360279"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span>
</span><span id="line-687"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; FlagStatus -&gt; Maybe (GenericOperand Register, Word64)
forall a.
Integral a =&gt;
a -&gt; FlagStatus -&gt; Maybe (GenericOperand Register, Word64)
</span><a href="#local-6989586621679360266"><span class="hs-identifier hs-var">flagstatus_to_tries</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360276"><span class="hs-identifier hs-var">max_tries</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Predicate -&gt; FlagStatus
forall v p. Sstate v p -&gt; FlagStatus
</span><a href="Generic.SymbolicConstituents.html#sflags"><span class="hs-identifier hs-var hs-var">sflags</span></a></span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360267"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-688"></span><span>      </span><span class="annot"><span class="annottext">Maybe (GenericOperand Register, Word64)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
-&gt; p
-&gt; CFG
-&gt; Int
-&gt; Predicate
-&gt; Instruction
-&gt; GenericOperand Register
-&gt; StateT Context IO Bool
forall storage prefix opcode annotation p.
(Show storage, Show prefix, Show opcode, Show annotation) =&gt;
String
-&gt; p
-&gt; CFG
-&gt; Int
-&gt; Predicate
-&gt; GenericInstruction
     AddressWord64 storage prefix opcode annotation
-&gt; GenericOperand Register
-&gt; StateT Context IO Bool
</span><a href="#local-6989586621679360264"><span class="hs-identifier hs-var">try_to_resolve_from_invariant</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360272"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679360282"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360281"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360279"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360267"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679360271"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360269"><span class="hs-identifier hs-var">trgt</span></a></span><span>
</span><span id="line-689"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679360263"><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360263"><span class="hs-identifier hs-var">op1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679360262"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360262"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-690"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360261"><span class="annot"><span class="annottext">values1 :: [Maybe (Set ResolvedJumpTarget)]
</span><a href="#local-6989586621679360261"><span class="hs-identifier hs-var hs-var">values1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Maybe (Set ResolvedJumpTarget))
-&gt; [Word64] -&gt; [Maybe (Set ResolvedJumpTarget)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679360260"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360260"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State
  (Predicate, Set VerificationCondition)
  (Maybe (Set ResolvedJumpTarget))
-&gt; Predicate -&gt; Maybe (Set ResolvedJumpTarget)
forall v p a.
State (Sstate v p, Set VerificationCondition) a -&gt; Sstate v p -&gt; a
</span><a href="Generic.SymbolicConstituents.html#evalSstate"><span class="hs-identifier hs-var">evalSstate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext
-&gt; p
-&gt; Word64
-&gt; CFG
-&gt; Int
-&gt; GenericOperand Register
-&gt; GenericOperand Register
-&gt; Word64
-&gt; State
     (Predicate, Set VerificationCondition)
     (Maybe (Set ResolvedJumpTarget))
forall i p p.
Integral i =&gt;
FContext
-&gt; p
-&gt; p
-&gt; CFG
-&gt; Int
-&gt; GenericOperand Register
-&gt; GenericOperand Register
-&gt; i
-&gt; State
     (Predicate, Set VerificationCondition)
     (Maybe (Set ResolvedJumpTarget))
</span><a href="#local-6989586621679360258"><span class="hs-identifier hs-var">try</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360277"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679360282"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; Word64
forall storage prefix opcode annotation.
GenericInstruction AddressWord64 storage prefix opcode annotation
-&gt; Word64
</span><a href="X86.Instruction.html#addressof"><span class="hs-identifier hs-var">addressof</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679360271"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360281"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360279"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360263"><span class="hs-identifier hs-var">op1</span></a></span><span> </span><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360269"><span class="hs-identifier hs-var">trgt</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360260"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360267"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360262"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-691"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Maybe (Set ResolvedJumpTarget)]
</span><a href="#local-6989586621679360261"><span class="hs-identifier hs-var">values1</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe (Set ResolvedJumpTarget)]
-&gt; [Maybe (Set ResolvedJumpTarget)] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Set ResolvedJumpTarget) -&gt; Bool)
-&gt; [Maybe (Set ResolvedJumpTarget)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Set ResolvedJumpTarget)
-&gt; Maybe (Set ResolvedJumpTarget) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Set ResolvedJumpTarget)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe (Set ResolvedJumpTarget)]
</span><a href="#local-6989586621679360261"><span class="hs-identifier hs-var">values1</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-692"></span><span>          </span><span class="annot"><span class="annottext">String
-&gt; p
-&gt; CFG
-&gt; Int
-&gt; Predicate
-&gt; Instruction
-&gt; GenericOperand Register
-&gt; StateT Context IO Bool
forall storage prefix opcode annotation p.
(Show storage, Show prefix, Show opcode, Show annotation) =&gt;
String
-&gt; p
-&gt; CFG
-&gt; Int
-&gt; Predicate
-&gt; GenericInstruction
     AddressWord64 storage prefix opcode annotation
-&gt; GenericOperand Register
-&gt; StateT Context IO Bool
</span><a href="#local-6989586621679360264"><span class="hs-identifier hs-var">try_to_resolve_from_invariant</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360272"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679360282"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360281"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360279"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360267"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679360271"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360269"><span class="hs-identifier hs-var">trgt</span></a></span><span>
</span><span id="line-693"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(Maybe (Set ResolvedJumpTarget) -&gt; Bool)
-&gt; [Maybe (Set ResolvedJumpTarget)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Set ResolvedJumpTarget) -&gt; Bool
</span><a href="#local-6989586621679360257"><span class="hs-identifier hs-var">is_jump_table_entry</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe (Set ResolvedJumpTarget)]
</span><a href="#local-6989586621679360261"><span class="hs-identifier hs-var">values1</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-694"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360256"><span class="annot"><span class="annottext">trgts :: [Word64]
</span><a href="#local-6989586621679360256"><span class="hs-identifier hs-var hs-var">trgts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe (Set ResolvedJumpTarget) -&gt; Word64)
-&gt; [Maybe (Set ResolvedJumpTarget)] -&gt; [Word64]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Word64)
-&gt; (Maybe (Set ResolvedJumpTarget) -&gt; Word64)
-&gt; Maybe (Set ResolvedJumpTarget)
-&gt; Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ResolvedJumpTarget -&gt; Word64
</span><a href="#local-6989586621679360255"><span class="hs-identifier hs-var">get_immediate</span></a></span><span> </span><span class="annot"><span class="annottext">(ResolvedJumpTarget -&gt; Word64)
-&gt; (Maybe (Set ResolvedJumpTarget) -&gt; ResolvedJumpTarget)
-&gt; Maybe (Set ResolvedJumpTarget)
-&gt; Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set ResolvedJumpTarget -&gt; ResolvedJumpTarget
forall a. Set a -&gt; a
</span><span class="hs-identifier hs-var">S.findMin</span></span><span> </span><span class="annot"><span class="annottext">(Set ResolvedJumpTarget -&gt; ResolvedJumpTarget)
-&gt; (Maybe (Set ResolvedJumpTarget) -&gt; Set ResolvedJumpTarget)
-&gt; Maybe (Set ResolvedJumpTarget)
-&gt; ResolvedJumpTarget
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Set ResolvedJumpTarget) -&gt; Set ResolvedJumpTarget
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe (Set ResolvedJumpTarget)]
</span><a href="#local-6989586621679360261"><span class="hs-identifier hs-var">values1</span></a></span><span>
</span><span id="line-695"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Resolved indirection at block &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360279"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-696"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Instruction = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679360271"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-697"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Operand &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">GenericOperand Register -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360269"><span class="hs-identifier hs-var">trgt</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; evaluates to: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Word64] -&gt; String
forall a. (Integral a, Show a) =&gt; [a] -&gt; String
</span><a href="Base.html#showHex_list"><span class="hs-identifier hs-var">showHex_list</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Word64] -&gt; [Word64]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="annot"><span class="annottext">[Word64]
</span><a href="#local-6989586621679360256"><span class="hs-identifier hs-var">trgts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-698"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Because of bounded jump table access: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FlagStatus -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Predicate -&gt; FlagStatus
forall v p. Sstate v p -&gt; FlagStatus
</span><a href="Generic.SymbolicConstituents.html#sflags"><span class="hs-identifier hs-var hs-var">sflags</span></a></span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360267"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-699"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Updated file: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360272"><span class="hs-identifier hs-var">fname</span></a></span><span>
</span><span id="line-700"></span><span>
</span><span id="line-701"></span><span>          </span><span id="local-6989586621679360253"><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679360253"><span class="hs-identifier hs-var">inds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; Indirections) -&gt; StateT Context IO Indirections
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; Indirections
</span><a href="Analysis.Context.html#ctxt_inds"><span class="hs-identifier hs-var">ctxt_inds</span></a></span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360251"><span class="annot"><span class="annottext">tbl :: JumpTable
</span><a href="#local-6989586621679360251"><span class="hs-identifier hs-var hs-var">tbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenericOperand Register
-&gt; Int -&gt; GenericOperand Register -&gt; IntMap Word64 -&gt; JumpTable
</span><a href="Analysis.Context.html#JumpTable"><span class="hs-identifier hs-var">JumpTable</span></a></span><span> </span><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360263"><span class="hs-identifier hs-var">op1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360262"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360269"><span class="hs-identifier hs-var">trgt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Int, Word64)] -&gt; IntMap Word64
forall a. [(Int, a)] -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Int, Word64)] -&gt; IntMap Word64)
-&gt; [(Int, Word64)] -&gt; IntMap Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Word64] -&gt; [(Int, Word64)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360262"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Word64]
</span><a href="#local-6989586621679360256"><span class="hs-identifier hs-var">trgts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-704"></span><span>          </span><span class="annot"><span class="annottext">IO () -&gt; StateT Context IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT Context IO ()) -&gt; IO () -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">appendFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360272"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; Word64
forall storage prefix opcode annotation.
GenericInstruction AddressWord64 storage prefix opcode annotation
-&gt; Word64
</span><a href="X86.Instruction.html#addressof"><span class="hs-identifier hs-var">addressof</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679360271"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">JumpTable -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">JumpTable
</span><a href="#local-6989586621679360251"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-705"></span><span>
</span><span id="line-706"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360249"><span class="annot"><span class="annottext">inds' :: Indirections
</span><a href="#local-6989586621679360249"><span class="hs-identifier hs-var hs-var">inds'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Indirection -&gt; Indirections -&gt; Indirections
forall a. Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Int) -&gt; Word64 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; Word64
forall storage prefix opcode annotation.
GenericInstruction AddressWord64 storage prefix opcode annotation
-&gt; Word64
</span><a href="X86.Instruction.html#addressof"><span class="hs-identifier hs-var">addressof</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679360271"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JumpTable -&gt; Indirection
</span><a href="Analysis.Context.html#Indirection_JumpTable"><span class="hs-identifier hs-var">Indirection_JumpTable</span></a></span><span> </span><span class="annot"><span class="annottext">JumpTable
</span><a href="#local-6989586621679360251"><span class="hs-identifier hs-var">tbl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679360253"><span class="hs-identifier hs-var">inds</span></a></span><span> </span><span class="hs-comment">-- TODO check if already exists</span><span>
</span><span id="line-707"></span><span>          </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Indirections -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_inds"><span class="hs-identifier hs-var">set_ctxt_inds</span></a></span><span> </span><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679360249"><span class="hs-identifier hs-var">inds'</span></a></span><span>
</span><span id="line-708"></span><span>
</span><span id="line-709"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; StateT Context IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-710"></span><span>        </span><span class="hs-keyword">else</span><span>
</span><span id="line-711"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO Bool
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO Bool)
-&gt; String -&gt; StateT Context IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String, [Maybe (Set ResolvedJumpTarget)]) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;resolving:&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Maybe (Set ResolvedJumpTarget)]
</span><a href="#local-6989586621679360261"><span class="hs-identifier hs-var">values1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span>
</span><span id="line-714"></span><span>  </span><span id="local-6989586621679360264"><span class="annot"><span class="annottext">try_to_resolve_from_invariant :: String
-&gt; p
-&gt; CFG
-&gt; Int
-&gt; Predicate
-&gt; GenericInstruction
     AddressWord64 storage prefix opcode annotation
-&gt; GenericOperand Register
-&gt; StateT Context IO Bool
</span><a href="#local-6989586621679360264"><span class="hs-identifier hs-var hs-var">try_to_resolve_from_invariant</span></a></span></span><span> </span><span id="local-6989586621679360247"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360247"><span class="hs-identifier hs-var">fname</span></a></span></span><span> </span><span id="local-6989586621679360246"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679360246"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679360245"><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360245"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679360244"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360244"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679360243"><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360243"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679360242"><span class="annot"><span class="annottext">GenericInstruction AddressWord64 storage prefix opcode annotation
</span><a href="#local-6989586621679360242"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679360241"><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360241"><span class="hs-identifier hs-var">trgt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-715"></span><span>    </span><span id="local-6989586621679360240"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679360240"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Context IO Context
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-716"></span><span>    </span><span id="local-6989586621679360239"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360239"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; StateT Context IO FContext
</span><a href="Algorithm.L0_Lifting.html#ctxt_mk_fcontext"><span class="hs-identifier hs-var">ctxt_mk_fcontext</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360295"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-717"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360238"><span class="annot"><span class="annottext">values0 :: Maybe (Set ResolvedJumpTarget)
</span><a href="#local-6989586621679360238"><span class="hs-identifier hs-var hs-var">values0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State
  (Predicate, Set VerificationCondition)
  (Maybe (Set ResolvedJumpTarget))
-&gt; Predicate -&gt; Maybe (Set ResolvedJumpTarget)
forall v p a.
State (Sstate v p, Set VerificationCondition) a -&gt; Sstate v p -&gt; a
</span><a href="Generic.SymbolicConstituents.html#evalSstate"><span class="hs-identifier hs-var">evalSstate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext
-&gt; p
-&gt; CFG
-&gt; Int
-&gt; GenericOperand Register
-&gt; State
     (Predicate, Set VerificationCondition)
     (Maybe (Set ResolvedJumpTarget))
forall p.
FContext
-&gt; p
-&gt; CFG
-&gt; Int
-&gt; GenericOperand Register
-&gt; State
     (Predicate, Set VerificationCondition)
     (Maybe (Set ResolvedJumpTarget))
</span><a href="#local-6989586621679360237"><span class="hs-identifier hs-var">try'</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360239"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679360246"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360245"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360244"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360241"><span class="hs-identifier hs-var">trgt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360243"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-718"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe (Set ResolvedJumpTarget)
</span><a href="#local-6989586621679360238"><span class="hs-identifier hs-var">values0</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Set ResolvedJumpTarget)
-&gt; Maybe (Set ResolvedJumpTarget) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Set ResolvedJumpTarget)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-719"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360236"><span class="annot"><span class="annottext">value :: Set ResolvedJumpTarget
</span><a href="#local-6989586621679360236"><span class="hs-identifier hs-var hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Set ResolvedJumpTarget) -&gt; Set ResolvedJumpTarget
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Set ResolvedJumpTarget)
</span><a href="#local-6989586621679360238"><span class="hs-identifier hs-var">values0</span></a></span><span>
</span><span id="line-720"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Resolved indirection at block &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360244"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-721"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Instruction = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">GenericInstruction AddressWord64 storage prefix opcode annotation
-&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">GenericInstruction AddressWord64 storage prefix opcode annotation
</span><a href="#local-6989586621679360242"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-722"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Operand &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">GenericOperand Register -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360241"><span class="hs-identifier hs-var">trgt</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; evaluates to: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Set ResolvedJumpTarget -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Set ResolvedJumpTarget
</span><a href="#local-6989586621679360236"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-723"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;State:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Predicate -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360243"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-724"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Updated file: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360247"><span class="hs-identifier hs-var">fname</span></a></span><span>
</span><span id="line-725"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; StateT Context IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT Context IO ()) -&gt; IO () -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">appendFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360247"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String
</span><a href="Base.html#showHex"><span class="hs-identifier hs-var">showHex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericInstruction AddressWord64 storage prefix opcode annotation
-&gt; Word64
forall storage prefix opcode annotation.
GenericInstruction AddressWord64 storage prefix opcode annotation
-&gt; Word64
</span><a href="X86.Instruction.html#addressof"><span class="hs-identifier hs-var">addressof</span></a></span><span> </span><span class="annot"><span class="annottext">GenericInstruction AddressWord64 storage prefix opcode annotation
</span><a href="#local-6989586621679360242"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Indirection -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set ResolvedJumpTarget -&gt; Indirection
</span><a href="Analysis.Context.html#Indirection_Resolved"><span class="hs-identifier hs-var">Indirection_Resolved</span></a></span><span> </span><span class="annot"><span class="annottext">Set ResolvedJumpTarget
</span><a href="#local-6989586621679360236"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-726"></span><span>
</span><span id="line-727"></span><span>      </span><span id="local-6989586621679360234"><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679360234"><span class="hs-identifier hs-var">inds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context -&gt; Indirections) -&gt; StateT Context IO Indirections
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; Indirections
</span><a href="Analysis.Context.html#ctxt_inds"><span class="hs-identifier hs-var">ctxt_inds</span></a></span><span>
</span><span id="line-728"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360233"><span class="annot"><span class="annottext">inds' :: Indirections
</span><a href="#local-6989586621679360233"><span class="hs-identifier hs-var hs-var">inds'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Indirection -&gt; Indirections -&gt; Indirections
forall a. Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Int) -&gt; Word64 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenericInstruction AddressWord64 storage prefix opcode annotation
-&gt; Word64
forall storage prefix opcode annotation.
GenericInstruction AddressWord64 storage prefix opcode annotation
-&gt; Word64
</span><a href="X86.Instruction.html#addressof"><span class="hs-identifier hs-var">addressof</span></a></span><span> </span><span class="annot"><span class="annottext">GenericInstruction AddressWord64 storage prefix opcode annotation
</span><a href="#local-6989586621679360242"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set ResolvedJumpTarget -&gt; Indirection
</span><a href="Analysis.Context.html#Indirection_Resolved"><span class="hs-identifier hs-var">Indirection_Resolved</span></a></span><span> </span><span class="annot"><span class="annottext">Set ResolvedJumpTarget
</span><a href="#local-6989586621679360236"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679360234"><span class="hs-identifier hs-var">inds</span></a></span><span> </span><span class="hs-comment">-- TODO check if already exists</span><span>
</span><span id="line-729"></span><span>      </span><span class="annot"><span class="annottext">(Context -&gt; Context) -&gt; StateT Context IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Context -&gt; Context) -&gt; StateT Context IO ())
-&gt; (Context -&gt; Context) -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Indirections -&gt; Context -&gt; Context
</span><a href="Analysis.Context.html#set_ctxt_inds"><span class="hs-identifier hs-var">set_ctxt_inds</span></a></span><span> </span><span class="annot"><span class="annottext">Indirections
</span><a href="#local-6989586621679360233"><span class="hs-identifier hs-var">inds'</span></a></span><span>
</span><span id="line-730"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; StateT Context IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-731"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-732"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; StateT Context IO ()
</span><a href="Algorithm.L0_Lifting.html#to_out"><span class="hs-identifier hs-var">to_out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT Context IO ()) -&gt; String -&gt; StateT Context IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unresolved block &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360244"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">GenericInstruction AddressWord64 storage prefix opcode annotation
-&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">GenericInstruction AddressWord64 storage prefix opcode annotation
</span><a href="#local-6989586621679360242"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Predicate -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679360243"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-733"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; StateT Context IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-734"></span><span>
</span><span id="line-735"></span><span>
</span><span id="line-736"></span><span>  </span><span id="local-6989586621679360266"><span class="annot"><span class="annottext">flagstatus_to_tries :: a -&gt; FlagStatus -&gt; Maybe (GenericOperand Register, Word64)
</span><a href="#local-6989586621679360266"><span class="hs-identifier hs-var hs-var">flagstatus_to_tries</span></a></span></span><span> </span><span id="local-6989586621679360232"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360232"><span class="hs-identifier hs-var">max_tries</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SymbolicExpression.html#FS_CMP"><span class="hs-identifier hs-type">FS_CMP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679360230"><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360230"><span class="hs-identifier hs-var">op1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Generic.Operand.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span id="local-6989586621679360228"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360228"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360228"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360232"><span class="hs-identifier hs-var">max_tries</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(GenericOperand Register, Word64)
-&gt; Maybe (GenericOperand Register, Word64)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360230"><span class="hs-identifier hs-var">op1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360228"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (GenericOperand Register, Word64)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-737"></span><span>  </span><span class="annot"><a href="#local-6989586621679360266"><span class="hs-identifier hs-var">flagstatus_to_tries</span></a></span><span> </span><span id="local-6989586621679360226"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360226"><span class="hs-identifier hs-var">max_tries</span></a></span></span><span> </span><span class="annot"><span class="annottext">FlagStatus
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (GenericOperand Register, Word64)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-738"></span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span>  </span><span id="local-6989586621679360257"><span class="annot"><span class="annottext">is_jump_table_entry :: Maybe (Set ResolvedJumpTarget) -&gt; Bool
</span><a href="#local-6989586621679360257"><span class="hs-identifier hs-var hs-var">is_jump_table_entry</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Set ResolvedJumpTarget)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-741"></span><span>  </span><span class="annot"><a href="#local-6989586621679360257"><span class="hs-identifier hs-var">is_jump_table_entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679360225"><span class="annot"><span class="annottext">Set ResolvedJumpTarget
</span><a href="#local-6989586621679360225"><span class="hs-identifier hs-var">trgts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set ResolvedJumpTarget -&gt; Int
forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">S.size</span></span><span> </span><span class="annot"><span class="annottext">Set ResolvedJumpTarget
</span><a href="#local-6989586621679360225"><span class="hs-identifier hs-var">trgts</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(ResolvedJumpTarget -&gt; Bool) -&gt; Set ResolvedJumpTarget -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">ResolvedJumpTarget -&gt; Bool
</span><a href="#local-6989586621679360223"><span class="hs-identifier hs-var">is_immediate</span></a></span><span> </span><span class="annot"><span class="annottext">Set ResolvedJumpTarget
</span><a href="#local-6989586621679360225"><span class="hs-identifier hs-var">trgts</span></a></span><span>
</span><span id="line-742"></span><span>  </span><span id="local-6989586621679360223"><span class="annot"><span class="annottext">is_immediate :: ResolvedJumpTarget -&gt; Bool
</span><a href="#local-6989586621679360223"><span class="hs-identifier hs-var hs-var">is_immediate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.JumpTarget.html#ImmediateAddress"><span class="hs-identifier hs-type">ImmediateAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-743"></span><span>  </span><span class="annot"><a href="#local-6989586621679360223"><span class="hs-identifier hs-var">is_immediate</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedJumpTarget
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-744"></span><span>  </span><span id="local-6989586621679360255"><span class="annot"><span class="annottext">get_immediate :: ResolvedJumpTarget -&gt; Word64
</span><a href="#local-6989586621679360255"><span class="hs-identifier hs-var hs-var">get_immediate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.JumpTarget.html#ImmediateAddress"><span class="hs-identifier hs-type">ImmediateAddress</span></a></span><span> </span><span id="local-6989586621679360222"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360222"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679360222"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span>  </span><span class="hs-comment">-- write an immediate value to operand op1, then run symbolic exection to see if</span><span>
</span><span id="line-747"></span><span>  </span><span class="hs-comment">-- after executing a block the target-operand is an immediate value as well.</span><span>
</span><span id="line-748"></span><span>  </span><span id="local-6989586621679360258"><span class="annot"><span class="annottext">try :: FContext
-&gt; p
-&gt; p
-&gt; CFG
-&gt; Int
-&gt; GenericOperand Register
-&gt; GenericOperand Register
-&gt; i
-&gt; State
     (Predicate, Set VerificationCondition)
     (Maybe (Set ResolvedJumpTarget))
</span><a href="#local-6989586621679360258"><span class="hs-identifier hs-var hs-var">try</span></a></span></span><span> </span><span id="local-6989586621679360221"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360221"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span> </span><span id="local-6989586621679360220"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679360220"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679360219"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679360219"><span class="hs-identifier hs-var">i_a</span></a></span></span><span> </span><span id="local-6989586621679360218"><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360218"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679360217"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360217"><span class="hs-identifier hs-var">blockId</span></a></span></span><span> </span><span id="local-6989586621679360216"><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360216"><span class="hs-identifier hs-var">op1</span></a></span></span><span> </span><span id="local-6989586621679360215"><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360215"><span class="hs-identifier hs-var">trgt</span></a></span></span><span> </span><span id="local-6989586621679360214"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679360214"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-749"></span><span>    </span><span class="annot"><span class="annottext">FContext
-&gt; Bool
-&gt; GenericOperand Register
-&gt; SValue
-&gt; StateT (Predicate, Set VerificationCondition) Identity ()
forall ctxt v p.
SymbolicExecutable ctxt v p =&gt;
ctxt
-&gt; Bool
-&gt; GenericOperand Register
-&gt; v
-&gt; State (Sstate v p, Set VerificationCondition) ()
</span><a href="Generic.SymbolicConstituents.html#swrite_operand"><span class="hs-identifier hs-var">swrite_operand</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360221"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360216"><span class="hs-identifier hs-var">op1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext -&gt; i -&gt; SValue
forall ctxt v p i.
(SymbolicExecutable ctxt v p, Integral i) =&gt;
ctxt -&gt; i -&gt; v
</span><a href="Generic.SymbolicConstituents.html#simmediate"><span class="hs-identifier hs-var">simmediate</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360221"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679360214"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-750"></span><span>    </span><span class="annot"><span class="annottext">FContext
-&gt; p
-&gt; CFG
-&gt; Int
-&gt; GenericOperand Register
-&gt; State
     (Predicate, Set VerificationCondition)
     (Maybe (Set ResolvedJumpTarget))
forall p.
FContext
-&gt; p
-&gt; CFG
-&gt; Int
-&gt; GenericOperand Register
-&gt; State
     (Predicate, Set VerificationCondition)
     (Maybe (Set ResolvedJumpTarget))
</span><a href="#local-6989586621679360237"><span class="hs-identifier hs-var">try'</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360221"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679360220"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360218"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360217"><span class="hs-identifier hs-var">blockId</span></a></span><span> </span><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360215"><span class="hs-identifier hs-var">trgt</span></a></span><span>
</span><span id="line-751"></span><span>
</span><span id="line-752"></span><span>  </span><span id="local-6989586621679360237"><span class="annot"><span class="annottext">try' :: FContext
-&gt; p
-&gt; CFG
-&gt; Int
-&gt; GenericOperand Register
-&gt; State
     (Predicate, Set VerificationCondition)
     (Maybe (Set ResolvedJumpTarget))
</span><a href="#local-6989586621679360237"><span class="hs-identifier hs-var hs-var">try'</span></a></span></span><span> </span><span id="local-6989586621679360211"><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360211"><span class="hs-identifier hs-var">fctxt</span></a></span></span><span> </span><span id="local-6989586621679360210"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679360210"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679360209"><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360209"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679360208"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360208"><span class="hs-identifier hs-var">blockId</span></a></span></span><span> </span><span id="local-6989586621679360207"><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360207"><span class="hs-identifier hs-var">trgt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-753"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360206"><span class="annot"><span class="annottext">ctxt :: Context
</span><a href="#local-6989586621679360206"><span class="hs-identifier hs-var hs-var">ctxt</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FContext -&gt; Context
</span><a href="Analysis.Context.html#f_ctxt"><span class="hs-identifier hs-var hs-var">f_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360211"><span class="hs-identifier hs-var">fctxt</span></a></span><span>
</span><span id="line-754"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360205"><span class="annot"><span class="annottext">instrs :: [Instruction]
</span><a href="#local-6989586621679360205"><span class="hs-identifier hs-var hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CFG -&gt; Int -&gt; [Instruction]
</span><a href="Analysis.ControlFlow.html#fetch_block"><span class="hs-identifier hs-var">fetch_block</span></a></span><span> </span><span class="annot"><span class="annottext">CFG
</span><a href="#local-6989586621679360209"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360208"><span class="hs-identifier hs-var">blockId</span></a></span><span>
</span><span id="line-755"></span><span>    </span><span class="annot"><span class="annottext">((Predicate, Set VerificationCondition)
 -&gt; (Predicate, Set VerificationCondition))
-&gt; StateT (Predicate, Set VerificationCondition) Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">(((Predicate, Set VerificationCondition)
  -&gt; (Predicate, Set VerificationCondition))
 -&gt; StateT (Predicate, Set VerificationCondition) Identity ())
-&gt; ((Predicate, Set VerificationCondition)
    -&gt; (Predicate, Set VerificationCondition))
-&gt; StateT (Predicate, Set VerificationCondition) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FContext
-&gt; [Instruction]
-&gt; Maybe [Instruction]
-&gt; Predicate
-&gt; (Predicate, Set VerificationCondition)
forall ctxt v p.
SymbolicExecutable ctxt v p =&gt;
ctxt
-&gt; [Instruction]
-&gt; Maybe [Instruction]
-&gt; Sstate v p
-&gt; (Sstate v p, Set VerificationCondition)
</span><a href="Generic.SymbolicConstituents.html#sexec_block"><span class="hs-identifier hs-var">sexec_block</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360211"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Instruction] -&gt; [Instruction]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679360205"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [Instruction]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">(Predicate -&gt; (Predicate, Set VerificationCondition))
-&gt; ((Predicate, Set VerificationCondition) -&gt; Predicate)
-&gt; (Predicate, Set VerificationCondition)
-&gt; (Predicate, Set VerificationCondition)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Predicate, Set VerificationCondition) -&gt; Predicate
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span>    </span><span class="annot"><span class="annottext">FContext
-&gt; Instruction
-&gt; StateT (Predicate, Set VerificationCondition) Identity ()
forall ctxt v p.
SymbolicExecutable ctxt v p =&gt;
ctxt
-&gt; Instruction -&gt; State (Sstate v p, Set VerificationCondition) ()
</span><a href="Generic.SymbolicConstituents.html#sset_rip"><span class="hs-identifier hs-var">sset_rip</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360211"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Instruction] -&gt; Instruction
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Instruction]
</span><a href="#local-6989586621679360205"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-757"></span><span>    </span><span id="local-6989586621679360201"><span class="annot"><span class="annottext">SValue
</span><a href="#local-6989586621679360201"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FContext
-&gt; String
-&gt; GenericOperand Register
-&gt; State (Predicate, Set VerificationCondition) SValue
forall ctxt v p.
SymbolicExecutable ctxt v p =&gt;
ctxt
-&gt; String
-&gt; GenericOperand Register
-&gt; State (Sstate v p, Set VerificationCondition) v
</span><a href="Generic.SymbolicConstituents.html#sread_operand"><span class="hs-identifier hs-var">sread_operand</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360211"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;indirection resolving&quot;</span></span><span> </span><span class="annot"><span class="annottext">GenericOperand Register
</span><a href="#local-6989586621679360207"><span class="hs-identifier hs-var">trgt</span></a></span><span>
</span><span id="line-758"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Set ResolvedJumpTarget)
-&gt; State
     (Predicate, Set VerificationCondition)
     (Maybe (Set ResolvedJumpTarget))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Set ResolvedJumpTarget)
 -&gt; State
      (Predicate, Set VerificationCondition)
      (Maybe (Set ResolvedJumpTarget)))
-&gt; Maybe (Set ResolvedJumpTarget)
-&gt; State
     (Predicate, Set VerificationCondition)
     (Maybe (Set ResolvedJumpTarget))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FContext -&gt; SValue -&gt; Maybe (Set ResolvedJumpTarget)
forall ctxt v p.
SymbolicExecutable ctxt v p =&gt;
ctxt -&gt; v -&gt; Maybe (Set ResolvedJumpTarget)
</span><a href="Generic.SymbolicConstituents.html#stry_jump_targets"><span class="hs-identifier hs-var">stry_jump_targets</span></a></span><span> </span><span class="annot"><span class="annottext">FContext
</span><a href="#local-6989586621679360211"><span class="hs-identifier hs-var">fctxt</span></a></span><span> </span><span class="annot"><span class="annottext">SValue
</span><a href="#local-6989586621679360201"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span>
</span><span id="line-761"></span></pre></body></html>